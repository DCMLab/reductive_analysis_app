/*! For license information please see app.js.LICENSE.txt */
(()=>{var __webpack_modules__={729:t=>{t.exports=function(t){var o=t.createGain(),r=o._voltage=function(t){var e=t.createBufferSource(),i=t.createBuffer(1,2,t.sampleRate);return i.getChannelData(0).set(n),e.buffer=i,e.loop=!0,e}(t),s=i(r),a=i(r),l=i(r);return o._startAmount=i(a),o._endAmount=i(l),o._multiplier=i(s),o._multiplier.connect(o),o._startAmount.connect(o),o._endAmount.connect(o),o.value=s.gain,o.startValue=a.gain,o.endValue=l.gain,o.startValue.value=0,o.endValue.value=0,Object.defineProperties(o,e),o};var e={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(t){var e=this._multiplier.gain,n=this._startAmount.gain,i=this._endAmount.gain;this._voltage.start(t),this._decayFrom=this._decayFrom=t+this.attack,this._startedAt=t;var r=this.sustain;e.cancelScheduledValues(t),n.cancelScheduledValues(t),i.cancelScheduledValues(t),i.setValueAtTime(0,t),this.attack?(e.setValueAtTime(0,t),e.linearRampToValueAtTime(1,t+this.attack),n.setValueAtTime(1,t),n.linearRampToValueAtTime(0,t+this.attack)):(e.setValueAtTime(1,t),n.setValueAtTime(0,t)),this.decay&&e.setTargetAtTime(r,this._decayFrom,o(this.decay))}},stop:{value:function(t,e){e&&(t-=this.release);var n=t+this.release;if(this.release){var i=this._multiplier.gain,r=this._startAmount.gain,s=this._endAmount.gain;i.cancelScheduledValues(t),r.cancelScheduledValues(t),s.cancelScheduledValues(t);var a=o(this.release);if(this.attack&&t<this._decayFrom){var l=function(t,e,n,i,o){var r=0+(o-n)/(i-n)*1;return r<=0&&(r=0),r>=1&&(r=1),r}(0,0,this._startedAt,this._decayFrom,t);i.linearRampToValueAtTime(l,t),r.linearRampToValueAtTime(1-l,t),r.setTargetAtTime(0,t,a)}s.setTargetAtTime(1,t,a),i.setTargetAtTime(0,t,a)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(t){this._voltage.onended=t}}},n=new Float32Array([1,1]);function i(t){var e=t.context.createGain();return t.connect(e),e}function o(t){return Math.log(t+1)/Math.log(100)}},158:t=>{"use strict";t.exports={decode:function(t,e){for(var n,i,o,r=t.replace(/[^A-Za-z0-9\+\/]/g,""),s=r.length,a=e?Math.ceil((3*s+1>>2)/e)*e:3*s+1>>2,l=new Uint8Array(a),c=0,u=0,d=0;d<s;d++)if(i=3&d,c|=((o=r.charCodeAt(d))>64&&o<91?o-65:o>96&&o<123?o-71:o>47&&o<58?o+4:43===o?62:47===o?63:0)<<18-6*i,3===i||s-d==1){for(n=0;n<3&&u<a;n++,u++)l[u]=c>>>(16>>>n&24)&255;c=0}return l}}},799:t=>{"use strict";t.exports=function(t,e){return new Promise((function(n,i){var o=new XMLHttpRequest;e&&(o.responseType=e),o.open("GET",t),o.onload=function(){200===o.status?n(o.response):i(Error(o.statusText))},o.onerror=function(){i(Error("Network Error"))},o.send()}))}},665:(t,e,n)=>{"use strict";var i=n(158),o=n(799);function r(t){return function(e){return"string"==typeof e&&t.test(e)}}function s(t,e){return"string"==typeof t?t+e:"function"==typeof t?t(e):e}function a(t,e,n,i){var o,r=e instanceof ArrayBuffer?l:c(e)?u:(o=e)&&"function"==typeof o.then?d:h(e)?p:function(t){return t&&"object"==typeof t}(e)?f:g(e)?m:y(e)?v:b(e)?_:null;return r?r(t,e,n||{}):i?Promise.resolve(i):Promise.reject("Source not valid ("+e+")")}function l(t,e,n){return new Promise((function(n,i){t.decodeAudioData(e,(function(t){n(t)}),(function(){i("Can't decode audio data ("+e.slice(0,30)+"...)")}))}))}a.fetch=o;var c=r(/\.(mp3|wav|ogg)(\?.*)?$/i);function u(t,e,n){var i=s(n.from,e);return a(t,a.fetch(i,"arraybuffer"),n)}function d(t,e,n){return e.then((function(e){return a(t,e,n)}))}var h=Array.isArray;function p(t,e,n){return Promise.all(e.map((function(e){return a(t,e,n,e)})))}function f(t,e,n){var i={},o=Object.keys(e).map((function(o){if(n.only&&-1===n.only.indexOf(o))return null;var r=e[o];return a(t,r,n,r).then((function(t){i[o]=t}))}));return Promise.all(o).then((function(){return i}))}var g=r(/\.json(\?.*)?$/i);function m(t,e,n){var i=s(n.from,e);return a(t,a.fetch(i,"text").then(JSON.parse),n)}var y=r(/^data:audio/);function v(t,e,n){var o=e.indexOf(",");return a(t,i.decode(e.slice(o+1)).buffer,n)}var b=r(/\.js(\?.*)?$/i);function _(t,e,n){var i=s(n.from,e);return a(t,a.fetch(i,"text").then(x),n)}function x(t){var e=t.indexOf("MIDI.Soundfont.");if(e<0)throw Error("Invalid MIDI.js Soundfont format");e=t.indexOf("=",e)+2;var n=t.lastIndexOf(",");return JSON.parse(t.slice(e,n)+"}")}t.exports&&(t.exports=a),"undefined"!=typeof window&&(window.loadAudio=a)},898:(t,e,n)=>{"use strict";n.r(e),n.d(e,{naturalize_notes:()=>s});var i=n(419),o=n(3),r=n(624);function s(){if(selected[0].classList.contains("note"))if((0,r.get_by_id)(document,(0,r.draw_context_of)(selected[0]).id_prefix+"editcb").checked){var t=selected.concat(extraselected);t.forEach(a),t.forEach(o.dB)}else console.log("No modifications allowed to non-editable layer.");else console.log("Can only naturalize notes.")}function a(t){let e=t.querySelector(".accid");if(!e)return void console.log("No accidental to remove");!function(t){for(var e=t.parentElement;!e.classList.contains("note");)e=e.parentElement;var n,i=(0,r.get_id)(e);(n=(0,r.get_by_id)(mei,i)).removeAttribute("accid"),Array.from(n.children).filter((t=>"accid"==t.tagName)).forEach((t=>n.removeChild(t)))}(e),e.classList.add("hidden");let n=(0,r.get_id)(e);var o=(0,i.kg)();for(const t of o){let e=t.id_prefix+n,i=document.getElementById(e);i&&i.classList.add("hidden")}}document.getElementById("naturalizebutton").addEventListener("click",s)},419:(t,e,n)=>{"use strict";n.d(e,{Jt:()=>z,lk:()=>j,qG:()=>I,i9:()=>M,lC:()=>B,Yu:()=>W,kg:()=>H,ro:()=>U,p8:()=>q,LO:()=>F,jA:()=>X,tu:()=>Y,DR:()=>V,xM:()=>O,Ln:()=>$});var i=n(865),o=n.n(i),r=n(803),s=n(83),a=n(787),l=(n(360),n(944),n(359),n(480),n(863),n(121),n(879),n(624));function c(t,e,n){if(("beam"==e.tagName||"measure"==e.tagName)&&-1==n.findIndex((t=>t.nodeType==Node.ELEMENT_NODE&&("note"==t.tagName||t.getElementsByTagName("note").length>0))))return null;var i=e.cloneNode();return t?i.setAttribute("corresp",e.getAttribute("xml:id")):i.setAttribute("copyof",e.getAttribute("xml:id")),n.forEach((t=>i.appendChild(t))),i}function u(t,e){if(e.nodeType!=Node.ELEMENT_NODE)return[e.cloneNode(),!1];var n=document.getElementById((0,l.id_in_svg)(t,(0,l.get_id)(e)));if("note"==e.tagName&&(!n||n.classList.contains("hidden")))return[note_to_space(mei,e),!0];var i=Array.from(e.childNodes).map((e=>u(t,e))),o=i.map((t=>t[0])).filter((t=>null!=t)),r=o.length!=e.childNodes.length||null!=i.find((t=>t[1]));return[c(r,e,o),r]}function d(t=null){t||(t=H()[0]);var e=t.mei_score,[n,i]=u(t,e),o=e.parentElement.getElementsByTagName("score").length+"-";return(0,l.prefix_ids)(n,o),e.parentNode.insertBefore(n,e.nextSibling),n}function h(t,e){if(!t.contains(e))return console.log("Score element not in MEI, aborting"),null;var n,i=(0,l.clone_mei)(t),o=(n=e.hasAttribute("xml:id")?(0,l.get_by_id)(i,e.getAttribute("xml:id")):i.getElementsByTagName("score")[0]).parentElement;for(let t of Array.from(o.getElementsByTagName("score")))t!==n&&o.removeChild(t);return i}var p=n(3);function f(t,e,n){var i=[],o=t.svg_elem,r=t.id_prefix,s=r+n.getAttribute("xml:id"),a=(0,l.relation_type)(n),c=(0,l.relation_primaries)(e,n).map((e=>document.getElementById((0,l.id_in_svg)(t,(0,l.node_to_note_id)(e))))),u=(0,l.relation_secondaries)(e,n).map((e=>document.getElementById((0,l.id_in_svg)(t,(0,l.node_to_note_id)(e))))),d=c.concat(u);if(d.sort(((t,e)=>{if(!t)return-1;if(!e)return 1;var n=(0,l.note_coords)(t),i=(0,l.note_coords)(e);return n[0]-i[0]?n[0]-i[0]:n[1]-i[1]})),!d[0])return console.log("Note missing, relation not drawn"),null;var h=(0,l.roundedHull)(d.map(l.note_coords));return h.setAttribute("id",s),""!=r&&h.setAttribute("oldid",n.getAttribute("xml:id")),h.classList.add("relation"),h.setAttribute("type",a),(0,p.U2)()&&(0,p.up)(h),h.onwheel=t=>{var e=t.target;return(0,l.flip_to_bg)(e),h.onmouseout(),!1},h.onclick=function(t){(0,p.dB)(h,t.shiftKey)},h.onmouseover=function(t){c.forEach((t=>{t.classList.add("extrahover")})),u.forEach((t=>{t.classList.add("selecthover")}))},h.onmouseout=function(t){c.forEach((t=>{t.classList.remove("extrahover")})),u.forEach((t=>{t.classList.remove("selecthover")}))},(0,l.add_to_svg_bg)(o,h),i.push(h),i}function g(t,e,n){var i=[],o=t.svg_elem,r=t.id_prefix+n.getAttribute("xml:id"),s=(0,l.relation_type)(n),a=(0,l.relation_allnodes)(e,n).map((e=>document.getElementById(t.id_prefix+(0,l.get_id)(e))));if(-1!=a.indexOf(null))return console.log("Missing relation, not drawing metarelation"),[];var c=a.map(l.get_metarelation_target),u=(0,l.average)(c.map((t=>t[0]))),d=a.concat([o.getElementsByClassName("system")[0]]).map((t=>t.getBBox().y)).sort(((t,e)=>t>e))[0]-500;return c.push([u,d]),(n=(0,l.g)()).setAttribute("id",r),n.classList.add("metarelation"),n.setAttribute("type",s),n.appendChild((0,l.circle)([u,d],200)),c.forEach((t=>{var e=(0,l.line)([u,d],t);n.appendChild(e)})),(0,p.U2)()&&(0,p.up)(n),n.onwheel=t=>{var e=t.target;return(0,l.flip_to_bg)(e.closest("g")),n.onmouseout(),!1},n.onclick=function(t){(0,p.dB)(n,t.shiftKey)},n.onmouseover=function(t){a.forEach((t=>{t.classList.add("relationhover")}))},n.onmouseout=function(t){a.forEach((t=>{t.classList.remove("relationhover")}))},(0,l.add_to_svg_bg)(o,n),i.push(n),i}var m,y,v,b,_,x=n(506),w=n(235),E=n(362);window.selected=[],window.extraselected=[],n(898),window.mei=null;var S,T,k=new FileReader,A=[],C=[],N=[],D=[];function M(t,e,n=!1){if(console.debug("Using globals: selected, extraselected, mei, undo_actions"),0!=selected.length||0!=extraselected){var i,o;if(selected.concat(extraselected)[0].classList.contains("relation")){var r=[];selected.concat(extraselected).forEach((e=>{r.push([e.getAttribute("type"),t]);var n=(0,l.id_or_oldid)(e),i=[(0,l.get_by_id)(document,n)].concat((0,l.get_by_oldid)(document,n));i.forEach((e=>e.setAttribute("type",t))),(0,l.get_by_id)(mei,n).getElementsByTagName("label")[0].setAttribute("type",t),i.forEach(p.up)})),A.push(["change relation type",r.reverse(),selected,extraselected])}else if(selected.concat(extraselected)[0].classList.contains("note")){(0,l.check_for_duplicate_relations)(t,extraselected,selected);var s=[],a=extraselected.map((t=>(0,l.add_mei_node_for)(y,t))),c=selected.map((t=>(0,l.add_mei_node_for)(y,t)));s.push(a.concat(c)),[i,o]=function(t,e,n,i,o){var r=[],s=t.getRootNode().createElement("node");s.setAttribute("type","relation");var a,c=t.getRootNode().createElement("label");void 0!==i&&c.setAttribute("type",i),s.appendChild(c),a=void 0===o?"he-"+(0,l.random_id)(5):o,s.setAttribute("xml:id",a),t.appendChild(s),r.push(s);for(var u=0;u<e.length;u++)(d=mei.createElement("arc")).setAttribute("from","#"+a),d.setAttribute("to","#"+e[u].getAttribute("xml:id")),d.setAttribute("type","primary"),t.appendChild(d),r.push(d);for(u=0;u<n.length;u++){var d;(d=mei.createElement("arc")).setAttribute("from","#"+a),d.setAttribute("to","#"+n[u].getAttribute("xml:id")),d.setAttribute("type","secondary"),t.appendChild(d),r.push(d)}return[a,r.reverse()]}(y,a,c,t,e),s.push(o);for(var u=0;u<N.length;u++){let t=f(N[u],y,(0,l.get_by_id)(y.getRootNode(),i));t&&(s.push(t),(0,l.mark_secondaries)(N[u],y,(0,l.get_by_id)(y.getRootNode(),i)))}A.push(["relation",s.reverse(),selected,extraselected]),selected.concat(extraselected).forEach(p.dB)}n||(0,w.I$)(),(0,p.e6)()}}function j(t){var e=selected.concat(extraselected);if(!(e.length<3||extraselected.length>2)){e.sort(((t,e)=>{var[n,i]=(0,l.note_coords)(t),[o,r]=(0,l.note_coords)(e);return n-o}));var n=e.shift(),i=e.pop();selected=selected.filter((t=>t==n||t==i)),M(E.yu.main[t].outer),extraselected=[n,i],selected=e,M(E.yu.main[t].total),(0,p.e6)()}}function I(t,e,n=!1){if(console.debug("Using globals:  mei_graph, selected, extraselected"),0!=selected.length||0!=extraselected){var i=(0,l.get_class_from_classlist)(selected.concat(extraselected)[0]);if("relation"==i||"metarelation"==i){var o,r,s=[],a=extraselected.map((t=>(0,l.get_by_id)(y.getRootNode(),(0,l.id_or_oldid)(t)))),c=selected.map((t=>(0,l.get_by_id)(y.getRootNode(),(0,l.id_or_oldid)(t)))),[o,r]=function(t,e,n,i,o){var r=[],s=t.getRootNode().createElement("node");s.setAttribute("type","metarelation");var a,l=t.getRootNode().createElement("label");void 0!==i&&l.setAttribute("type",i),s.appendChild(l),a=void 0===o?"he-"+Math.floor(Math.random()*(1<<20)).toString(16):o,s.setAttribute("xml:id",a),t.appendChild(s),r.push(s);for(var c=0;c<e.length;c++)(u=t.getRootNode().createElement("arc")).setAttribute("from","#"+a),u.setAttribute("to","#"+e[c].getAttribute("xml:id")),u.setAttribute("type","primary"),t.appendChild(u),r.push(u);for(c=0;c<n.length;c++){var u;(u=t.getRootNode().createElement("arc")).setAttribute("from","#"+a),u.setAttribute("to","#"+n[c].getAttribute("xml:id")),u.setAttribute("type","secondary"),t.appendChild(u),r.push(u)}return[a,r.reverse()]}(y,a,c,t,e);s.push(r);for(var u=0;u<N.length;u++)s.push(g(N[u],y,(0,l.get_by_id)(y.getRootNode(),o)));A.push(["metarelation",s,selected,extraselected]),selected.concat(extraselected).forEach(p.dB),(0,p.e6)(),n||(0,w.I$)()}}}function L(){var t=mei.cloneNode(!0);for(var e of N)if(!(0,l.get_by_id)(document,e.id_prefix+"savecb").checked){console.log("Trying to remove layer",e);var n=(0,l.get_by_id)(t,e.mei_score.getAttribute("xml:id"));n.parentElement.removeChild(n),console.log("Found and tried to remove ",n)}!function(t,e,n){console.debug("Using globals: document, window");var i=new Blob([t],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,e);else{var o=document.createElement("a"),r=URL.createObjectURL(i);o.href=r,o.download=e,document.body.appendChild(o),o.click(),setTimeout((()=>{document.body.removeChild(o),window.URL.revokeObjectURL(r)}),0)}}((new XMLSerializer).serializeToString(t),S+".mei","text/xml")}function B(t){console.debug("Using globals: mei_graph, mei, selected, extraselected, document");var e=Array.from(y.getElementsByTagName("node")),n=e.filter((t=>"relation"==t.getAttribute("type"))),i=e.filter((t=>"metarelation"==t.getAttribute("type")));n.forEach((e=>{f(t,y,e)&&(0,l.mark_secondaries)(t,y,e)})),i.forEach((e=>g(t,y,e)))}function O(t=!1,e=N[0]){e.svg_elem;var n=h(mei,e.layer.score_elem);return Array.from(n.getElementsByTagName("note")).forEach((i=>{let o=document.getElementById((0,l.id_in_svg)(e,(0,l.get_id)(i)));if(!o||o.classList.contains("hidden")){var r=i.parentNode;if(t&&!["chord","bTrem","fTrem"].includes(r.tagName)){var s=(0,l.note_to_rest)(n,i);r.insertBefore(s,i)}r.removeChild(i)}})),Array.from(n.getElementsByTagName("chord")).forEach((t=>{t.parentNode,0==t.getElementsByTagName("note").length&&t.parentNode.removeChild(t)})),n}function z(t,e=!1,n=!1){var i;i=e?function(t,e=!1){var n=t.mei_score,i=function(t,e,n=!1){var i=V(),o=O(!0,t),r=(new XMLSerializer).serializeToString(o);i.loadData(r),i.renderToMIDI();var s=Array.from(o.getElementsByTagName("note")).map((t=>t.getAttribute("xml:id"))),a={};if(s.forEach((t=>{if(!t)return;let e=i.getTimeForElement(t);a[e]?a[e].push(t):a[e]=[t]})),n){let t=Object.keys(a);a={},t.forEach((t=>a[t]=i.getElementsAtTime(Number(t)+1).notes))}var c=e.getElementsByTagName("scoreDef")[0].cloneNode(!0),u=c.getElementsByTagName("staffDef"),d=mei.createElement("score");d.setAttribute("xml:id",e.getAttribute("xml:id")+"-sliced");var h=mei.createElement("section");h.setAttribute("xml:id",e.getAttribute("xml:id")+"-slicedsection"),d.appendChild(c),d.appendChild(h);var p=Object.keys(a);for(var f in console.log(a),p){let t=p[f],e=a[t],n=mei.createElement("measure");for(var g of(n.setAttribute("xml:id","measure-"+t),h.appendChild(n),u)){let t=mei.createElement("staff");t.setAttribute("n",g.getAttribute("n")),n.appendChild(t)}for(var m of(e.forEach((e=>{let i=(0,l.get_by_id)(mei,e),o=i.cloneNode(!0);o.setAttribute("corresp",e);let r=i.closest("staff").getAttribute("n"),s=i.closest("layer").getAttribute("n"),c=i.closest("chord"),u=n.querySelector('staff[n="'+r+'"]');u||(console.log("Could not find staff"),abort());let d=u.querySelector('layer[n="'+s+'"]');if(d||(d=mei.createElement("layer"),d.setAttribute("n",s),u.appendChild(d)),o.removeAttribute("dots"),o.removeAttribute("dots.ges"),c){let t=c.getAttribute("xml:id"),e=d.querySelector('chord[corresp="'+t+'"]');e||(e=mei.createElement("chord"),e.setAttribute("corresp",t),e.setAttribute("dur",4),e.setAttribute("dur.ges",4),e.setAttribute("dur.ppq",2),d.appendChild(e)),e.appendChild(o)}else o.setAttribute("dur",4),o.setAttribute("dur.ges",4),o.setAttribute("dur.ppq",2),d.appendChild(o);if(f>0&&a[p[f-1]].includes(e)){o.setAttribute("xml:id",t+e);let i=mei.createElement("tie");i.setAttribute("xml:id","tie"+t+e),i.setAttribute("endid",t+e),f>1&&a[p[f-2]].includes(e)?i.setAttribute("startid",p[f-1]+e):i.setAttribute("startid",e),n.appendChild(i)}})),n.querySelectorAll("staff")))if(!m.querySelector("note")){let t=m.querySelector("layer");t||(t=mei.createElement("layer"),m.appendChild(t));let e=mei.createElement("rest");e.setAttribute("dur",4),e.setAttribute("dur.ges",4),e.setAttribute("dur.ppq",2),t.appendChild(e)}}return d}(t,n,e),o=n.parentElement.getElementsByTagName("score").length+"-";return(0,l.prefix_ids)(i,o),n.parentNode.insertBefore(i,n.nextSibling),i}(t,n):d(t);let o=h(mei,i);var[r,s]=R(o);if(!s)return console.log("Verovio could not generate SVG from MEI."),!1;var a=(0,l.new_layer_element)(),[c,u]=(0,l.new_view_elements)(a);u.innerHTML=s;var p={mei:o,layer_elem:a,layer_number:D.length,score_elem:i,id_mapping:(0,l.get_id_pairs)(i),original_score:!1,number_of_views:1};D.push(p);var f={mei_score:i,svg_elem:u,view_elem:c,layer:p,layer_number:p.layer_number,view_number:0,id_prefix:"",zoom:1,reductions:[]};f.id_prefix=N.length,P(f)}function P(t){t.measure_map=(0,x.Vk)(t),N.reverse(),N.push(t),N.reverse(),(0,p.N7)(t);for(let e of t.svg_elem.getElementsByClassName("note"))e.onclick=function(t){(0,p.dB)(e,t.shiftKey)};for(let e of t.svg_elem.getElementsByClassName("staff")){let[t,n]=(0,x.e6)(e);e.y_to_p=t,e.p_to_y=n}B(t),(0,p.rp)()}function R(t){var e=(new XMLSerializer).serializeToString((0,l.sanitize_xml)(t));return[e,m.renderData(e,{pageWidth:2e4,pageHeight:1e4,breaks:"none"})]}window.addEventListener("beforeunload",(function(t){var e="Leave app? You may lose unsaved changes.";return t.preventDefault(),t.returnValue=e,e})),o()(document).ready((function(){document.getElementsByTagName("html")[0].classList.remove("loader"),(0,p.XG)(),o()("#hull_controller").on("change",p.PB),(0,p.K5)(document.getElementById("relations_panel")),(0,p.rp)(),[["delete_all","deletebutton"],["add_bookmark","addbookmarkbutton"],["show_hide_notation","equalizebutton"],["toggle_type_shades","shadesbutton"],["toggle_add_note","addnotebutton"],["jump_to_next_bookmark","previousbookmarkbutton"],["jump_to_previous_bookmark","nextbookmarkbutton"],["jump_to_context_below","previouscontextbutton"],["jump_to_context_above","nextcontextbutton"]].forEach((t=>document.getElementById(t[1]).setAttribute("title",a.custom_conf[t[0]]||s.navigation_conf[t[0]]||r.action_conf[t[0]])))})),window.onerror=function(t,e,n){return document.getElementsByTagName("html")[0].classList.remove("loader"),alert(`An error occured: ${t}\n Please report the relevant console log as a GitHub issue.\n The app will try to continue running nonetheless.`),!1},document.getElementById("downloadbutton").addEventListener("click",L),document.getElementById("svgdownloadbutton").addEventListener("click",L),document.getElementById("fileupload").addEventListener("change",(function(){console.debug("Using globals: selected_extraselected, upload, reader, filenmae"),selected=[],extraselected=[];var t=document.getElementById("fileupload");1==t.files.length&&(k.onload=function(t){_=k.result,setTimeout((()=>{setTimeout((()=>{!function(t){console.debug("Using globals data, parser, mei, jquery document, document, mei_graph, midi, changes, undo_cations, redo_actions, reduce_actions, rerendered_after_action, shades");var e=new DOMParser;try{mei=e.parseFromString(_,"text/xml"),mei.getElementsByTagName("parsererror").length>0&&console.log("This is not a valid XML or MEI file. However it could be ABC or Humdrum, for instance")}catch(t){o()("#fileupload").val("")}if(m=new verovio.toolkit,"http://www.music-encoding.org/ns/mei"!=mei.documentElement.namespaceURI){try{m.renderData(_,{pageWidth:2e4,pageHeight:1e4,breaks:"none"})}catch(t){if(!new_svg)return console.log("Verovio could not generate SVG from non-MEI file."),o()("#fileupload").val(""),!1}_=m.getMEI(),e=new DOMParser;try{mei=e.parseFromString(_,"text/xml")}catch(t){return alert("Cannot parse this XML file as valid MEI."),o()("#fileupload").val(""),!1}}else mei=(0,l.fix_synonyms)(mei);try{y=function(){console.debug("Using globals: mei");var t=mei.getElementsByTagName("graph");if(t.length)return t[0];var e=mei.createElement("graph");return e.setAttribute("type","directed"),mei.getElementsByTagName("body")[0].appendChild(e),e}()}catch(t){return alert("Cannot parse this XML file as valid MEI."),o()("#fileupload").val(""),!1}N=[],D=[],document.getElementById("layers").innerHTML="",o()("#hull_controller").val(200),N.hullPadding=o()("#hull_controller").val();var n=Array.from(mei.getElementsByTagName("body")[0].getElementsByTagName("score"));for(let t in n){let e=n[t],o=h(mei,e),[u,d]=R(o);if(!d)return console.log("Verovio could not generate SVG from MEI."),!1;var i=(0,l.new_layer_element)(),[r,s]=(0,l.new_view_elements)(i);s.innerHTML=d;var a={mei:o,layer_elem:i,layer_number:0,score_elem:e,id_mapping:(0,l.get_id_pairs)(e),original_score:0==t,number_of_views:1};D.push(a);var c={mei_score:e,svg_elem:s,view_elem:r,layer:a,layer_number:0,view_number:0,id_prefix:"",zoom:1,reductions:[]};0==t?(v=m.renderToMIDI(),b=v):c.id_prefix=N.length,P(c)}A=[],C=[],T=0,(0,p.U2)()||(0,p.XG)(),document.onkeypress=function(t){(0,p.Z6)(t)},document.onkeydown=p.qY,document.onkeyup=p.$Z,document.getElementById("layers").onclick=p.oq,document.dispatchEvent(new Event("scoreload")),(0,p.Pw)()}(),(0,p.bf)(),(0,l.indicate_current_context)()}),1e3)}),1e3)},k.readAsText(t.files[0]),""==(S=t.files[0].name.split(".").slice(0,-1).join("."))&&(S=t.files[0].name))})),console.log("Main webapp library is loaded");const H=()=>N,U=()=>y,q=()=>b,V=()=>m,W=()=>_,Y=()=>A,F=()=>C,$=t=>C=t,X=()=>T},36:(t,e,n)=>{"use strict";n.r(e),n.d(e,{shades_array:()=>i,type_keys:()=>o,type_shades:()=>r,meta_keys:()=>s,meta_shades:()=>a,combo_keys:()=>l,button_shades:()=>c,action_conf:()=>u,navigation_conf:()=>d,custom_conf:()=>h,meta_conf:()=>p,type_conf:()=>f,combo_conf:()=>g,type_synonym:()=>m,type_full_conf:()=>y,meta_full_conf:()=>v,hide_classes:()=>b,strip_mei_tags:()=>_,strip_xml_tags:()=>x,CONFIG_OK:()=>w});const i=n(617).K2I,o={},r={},s={},a={},l={},c={},u={undo:"U",redo:"I",deselect_all:"d",delete_all:"D",add_bookmark:"^",move_relation_to_front:"z",reduce_relations:"r",show_hide_notation:"s",toggle_type_shades:"h",select_same_notes:"+",toggle_add_note:"x",naturalize_note:"Z"},d={pan_left:"[",pan_right:"]",jump_to_next_bookmark:"{",jump_to_previous_bookmark:"}",jump_to_context_below:",",jump_to_context_above:".",toggle_palette:"-",zoom_out:"(",zoom_in:")",switch_context_on_hover:!1},h={relation:"R",meta_relation:"M"},p={context:{key:"c",colour:0},layer:{key:"l",colour:6},phrase:{key:"r",colour:2},section:{key:"t",colour:3}},f={repeat:{key:"e",colour:0},passing:{key:"p",colour:6},neighbour:{key:"n",colour:2},harmonic:{key:"i",colour:3},arpeggio:{key:"a",colour:4},urlinie:{key:"u",colour:5},bassbrechung:{key:"b",colour:5}},g={passing_comb:{key:"P",total:"passing",outer:"arpeggio"},neighbour_comb:{key:"N",total:"neighbour",outer:"repeat"}},m={prolongation:"passing",arp:"arpeggio",bassbrech:"bassbrechung"},y=["neighbour","repetition","arpeggiation","passing","back_relating_dominant","displacement","register_transfer","56_shift","added_root","initial_ascent","arpeggiated_ascent","urlinie","urlinie_transference","bassbrechung_component","coupling","voice_exchange_component","voice_exchange_component_chromaticized","mixture","phrygian_ii"],v=["auxiliary_cadence","superposition","reaching_over","urlinie_meta","ursatz","bassbrechung","bassbrechung_transference","ursatz_transference","unfolding","motion_into_the_inner_voice","motion_from_the_inner_voice","linear_intervallic_progression","linear_intervallic_progression_module","interruption","interruption_branch_1","interruption_branch_2","voice_exchange","motivic_parallelism","motive","contradiction","indeterminacy","parallel_fifths","parallel_octaves"],b=["barLineAttr","fermata","rest","stem","flag","tie","artic","slur","dynam","tempo","tupletNum","dir","verse"],_=["label","labelAbbr","tempo"],x=[],w=!0},506:(t,e,n)=>{"use strict";n.d(e,{Vk:()=>l,e6:()=>u,f5:()=>f,r4:()=>g,xy:()=>m,Kd:()=>y,M_:()=>v,TU:()=>b});var i=n(419),o=n(3),r=n(235),s=n(624),a="cdefgab";function l(t){let e=t.svg_elem;var n=Array.from(e.getElementsByClassName("measure")),i=(n.length&&Array.from(n[0].getElementsByClassName("staff")),Array.from(e.getElementsByClassName("note")),n.map((t=>[t.getBBox().x+t.getBBox().width,t])));return i.sort(((t,e)=>t[0]-e[0])),i}function c(t){let e=t.children[2].getBBox();return e.y+e.height/2}function u(t){const e=c(t),n=-Math.abs(function(t){let e=t.children[2].getBBox(),n=t.children[1].getBBox();return Math.abs(e.y-n.y)}(t)),i=n/2,o=t.getElementsByClassName("note");var r;if(o.length>0)r=o[0];else{const n=t.closest(".system");r=Array.from(n.getElementsByClassName("staff")).find((t=>c(t)==e&&t.getElementsByClassName("note").length>0)).getElementsByClassName("note")[0]}const l=function(t){var e=(0,s.get_by_id)(mei,(0,s.get_id)(t)),n=e.getAttribute("pname");return 7*e.getAttribute("oct")+a.indexOf(n)}(r)-Math.floor(((0,s.note_coords)(r)[1]-e)/i);return[t=>{var n=Math.floor((t+i/2-e)/i)+l,o=Math.floor(n/7);return[a[(0,s.mod)(n,7)],o]},(t,n)=>{var o=7*n+a.indexOf(t);return e+(o-l)*i}]}function d(){var t=(0,o.c)();const e=function(){var t=(0,o.c)(),e=t.svg_elem.children[0],n=t.svg_elem.getElementsByClassName("system")[0],i=e.createSVGPoint();return i.x=(0,o.jM)(),i.y=(0,o.hT)(),i.matrixTransform(n.parentElement.getScreenCTM().inverse())}(),n=function(t,e){let n=t.measure_map.find((t=>t[0]>e.x));return n?n[1]:void 0}(t,e);if(!n)return console.log("Pointer outside measures"),[null,null,null];const i=function(t,e,n){var i=Array.from(n.getElementsByClassName("staff")).map((t=>[c(t),t]));i.sort(((t,e)=>t[0]-e[0]));var o=i.findIndex((t=>e.y<t[0]));if(0==o)return i[0][1];if(-1==o)return i[i.length-1][1];const r=(0,s.average2)(i[o-1][0],i[o][0]);return e.y<r?i[o-1][1]:i[o][1]}(0,e,n),[r,a]=function(t,e,n){return n.getElementsByClassName("note")[0],n.y_to_p(e.y)}(0,e,i),l=function(t,e,n){var i=Array.from(n.getElementsByClassName("note")).map((t=>[(0,s.note_coords)(t)[0],t]));if(0==i.length)return null;i.sort(((t,e)=>t[0]-e[0]));var o=i.findIndex((t=>e.x<t[0]));if(0==o)return i[0][1];if(-1==o)return i[i.length-1][1];const r=(0,s.average2)(i[o-1][0],i[o][0]);return e.x<r?i[o-1][1]:i[o][1]}(0,e,i);return l?[r,a,l]:[null,null,null]}function h(t,e,n){var i=n.closest(".staff");return i.getElementsByClassName("note")[0],[(0,s.note_coords)(n)[0],i.p_to_y(t,e)]}function p(t,e,n,i=!0,r=""){(0,o.c)();var a=document.getElementById(r);if(a&&a.parentElement.removeChild(a),i){let[i,o]=h(t,e,n),[a,c]=(0,s.note_coords)(n);var l=document.createElementNS("http://www.w3.org/2000/svg","use");l.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+n.id),l.setAttribute("x",i-a),l.setAttribute("y",o-c),l.id=r,n.parentElement.appendChild(l)}}function f(t,e,n,a,l,c=!1){var u="new-"+(0,s.random_id)();let d=n;void 0!==l&&(u=l);var p=[];console.log(n),p.push(function(t,e,n,i=!0,r=""){(0,o.c)();var s=document.getElementById(r),a=[];if(s&&s.parentElement.removeChild(s),i){let[i,s]=h(t,e,n);var l=document.createElementNS("http://www.w3.org/2000/svg","g"),c=document.createElementNS("http://www.w3.org/2000/svg","g"),u=document.createElementNS("http://www.w3.org/2000/svg","use");u.setAttributeNS("http://www.w3.org/1999/xlink","href",n.getElementsByTagName("use")[0].getAttributeNS("http://www.w3.org/1999/xlink","href")),u.setAttribute("x",i-100),u.setAttribute("y",s),u.setAttribute("height","720px"),u.setAttribute("width","720px"),l.id=r,l.classList.add("note"),c.classList.add("notehead"),c.appendChild(u),l.appendChild(c),n.parentElement.appendChild(l),l.onclick=function(t){(0,o.dB)(l,t.shiftKey)},a.push(l)}return a.reverse()}(t,e,n,a,u));var f=(0,o.c)();p.push(function(t,e,n,i,o=!0,r=""){var a=(0,s.get_by_id)(mei,(0,s.get_id)(i));if(!t.score_elem.contains(a))return console.log("Note not in layer?"),!1;var l=mei.createElement("note"),c=[];if(l.setAttribute("xml:id",r),!o)return console.log("Not implemented"),!1;{let i;a.closest("chord")?i=a.closest("chord"):(i=(0,s.note_to_chord)(mei,a),a.parentElement.insertBefore(i,a),a.parentElement.removeChild(a),i.appendChild(a),c.push(i)),l.setAttribute("pname",e),l.setAttribute("oct",n),i.appendChild(l),c.push(l),t.id_mapping.push([r,r])}return c.reverse()}(f.layer,t,e,n,a,u)),v(),c||(0,r.I$)(),(0,i.tu)().push(["add note",p.reverse(),[d],[]])}function g(){var t=(0,o.c)();if(""!=(0,o.h4)()&&!t.layer.original_score){let[t,e,n]=d();if(!t)return;f(t,e,n,!0)}}function m(){var t=(0,o.c)(),e=(0,o.h4)();if(void 0!==t){if(!(0,s.get_by_id)(document,t.id_prefix+"editcb").checked)return;let[n,i,r]=d();e="temp"+(0,s.random_id)(),(0,o.vI)(e),$("#addnotebutton").addClass("active"),document.getElementById("layers").style.cursor="crosshair",n&&p(n,i,r,!0,e)}}function y(){var t=(0,o.h4)();let e=document.getElementById(t);e&&e.parentElement.removeChild(e),t="",(0,o.vI)(t),$("#addnotebutton").removeClass("active"),document.getElementById("layers").style.cursor="default"}function v(){var t=(0,o.c)(),e=(0,o.h4)();null!=t&&t.layer.original_score||(e?y():m())}function b(){if((0,o.c)().layer.original_score)return;let[t,e,n]=d();t&&p(t,e,n,!0,(0,o.h4)())}document.getElementById("addnotebutton").addEventListener("click",v)},504:(t,e,n)=>{"use strict";n.d(e,{x:()=>l});var i=n(419),o=n(3),r=n(235),s=n(624);function a(t){console.debug("Using globals: mei for element selection");var e=(0,s.get_id)(t),n=(0,s.get_by_id)(mei,e),r=[],a="metarelation"==(0,s.get_class_from_classlist)(t),l=(0,i.ro)(),c=(0,i.kg)();for(const t of c){let i=(0,s.get_by_id)(document,t.id_prefix+e);i&&(r.push(i),a||(0,s.unmark_secondaries)(t,l,n))}var u=Array.from(mei.getElementsByTagName("arc")).filter((e=>e.getAttribute("to")=="#"+t.id||e.getAttribute("from")=="#"+t.id)).concat(r);u.push(n);var d=u.map((t=>{var e=[t,t.parentElement,t.nextSibling];try{$(`g #${t.getAttribute("to").substring(4)}`).removeClass().addClass("note")}catch(t){}return t.parentElement.removeChild(t),e}));return(0,o.e6)(),d}function l(t=!1){console.debug("Using globals: selected for element selection, undo_actions for storing the action");var e=selected.concat(extraselected);if(0==e.length||"relation"!=(0,s.get_class_from_classlist)(e[0])&&"metarelation"!=(0,s.get_class_from_classlist)(e[0]))console.log("No (meta)relation selected!");else{var n=e.flatMap(a);(0,i.tu)().push(["delete relation",n.reverse(),selected,extraselected]),e.forEach(o.dB),t||(0,r.I$)()}}document.getElementById("deletebutton").addEventListener("click",l)},362:(t,e,n)=>{"use strict";n.d(e,{W3:()=>o,pX:()=>r,yu:()=>s,Ti:()=>a});const i={note:["relations","metarelations","comborelations"],relation:["metarelations","relations","comborelations"],metarelation:["metarelations","comborelations","relations"]},o={name:"relation",main:{repeat:{key:"e",color:0},passing:{key:"p",color:6},neighbour:{key:"n",color:2},harmonic:{key:"i",color:3},arpeggio:{key:"a",color:4},urlinie:{key:"u",color:5},bassbrechung:{key:"b",color:5},untyped:{color:5}},additional:["repetition","arpeggiation","back_relating_dominant","displacement","register_transfer","56_shift","added_root","initial_ascent","arpeggiated_ascent","urlinie_transference","bassbrechung_component","coupling","voice_exchange_component","voice_exchange_component_chromaticized","mixture","phrygian_ii"]},r={name:"metarelation",main:{context:{key:"c",colour:0},layer:{key:"l",colour:6},phrase:{key:"r",colour:2},section:{key:"t",colour:3}},additional:["auxiliary_cadence","superposition","reaching_over","urlinie_meta","ursatz","bassbrechung","bassbrechung_transference","ursatz_transference","unfolding","motion_into_the_inner_voice","motion_from_the_inner_voice","linear_intervallic_progression","linear_intervallic_progression_module","interruption","interruption_branch_1","interruption_branch_2","voice_exchange","motivic_parallelism","motive","contradiction","indeterminacy","parallel_fifths","parallel_octaves"]},s={name:"comborelation",main:{"passing comborelation":{key:"P",total:"passing",outer:"arpeggio"},"neighbour comborelation":{key:"N",total:"neighbour",outer:"repeat"}}},a=t=>i[t]},3:(t,e,n)=>{"use strict";n.d(e,{N7:()=>Ce,Sr:()=>Qe,hv:()=>Ke,Nv:()=>Ve,Pw:()=>Fe,c:()=>ln,jM:()=>xe,hT:()=>we,h4:()=>sn,U2:()=>on,gB:()=>rn,oq:()=>Me,PB:()=>We,qY:()=>Ne,Z6:()=>je,$Z:()=>De,K5:()=>Ye,rp:()=>Ge,bf:()=>Xe,Au:()=>Ae,vI:()=>an,dB:()=>ke,up:()=>Be,XG:()=>ze,e6:()=>$e});var o=n(986),r=n.n(o),s=n(501),a=n.n(s);const l=document.documentElement,c=(document.body,getComputedStyle(l),()=>["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)),u=Object.freeze({escape:27,left:37,right:39,a:65,z:90}),d=({keyCode:t},e)=>t===u[e];function h(t,e=null){const n=function({metaKey:t,shiftKey:e,ctrlKey:n,altKey:i}){const o={meta:t,shift:e,ctrl:n,alt:i},r=Object.keys(o).filter((t=>o[t]));return r.length?r:null}(t);return e?(i=n,o=[e].flat(),null!==(r=null==o?void 0:o.every((t=>null==i?void 0:i.includes(t))))&&void 0!==r&&r):null!==n;var i,o,r}const p=/Macintosh/.test(navigator.userAgent)?"meta":"ctrl";function f(t){let e=!1,n=Object.defineProperty({},t,{get:()=>{e=!0}});try{window.addEventListener("test",n,n),window.removeEventListener("test",n,n)}catch(t){e=!1}return e}f("passive");const g=f("capture"),m=function({capture:t=!1,passive:e=!0,once:n=!1}={}){return g?{capture:t,passive:e,once:n}:t},y=(m(),m({passive:!1}),m({capture:!0,passive:!1}));m({once:!0}),m({capture:!0,passive:!1,once:!0});let v=null;const b={x:0,y:0},_=new class{tick({x:t,y:e},n){v||window.requestAnimationFrame((n=>{this.update(t,e);const i=v;v=null,i(b)})),v=n}update(t,e){b.x=t,b.y=e}};let x=null;class w{constructor(t){this.app=t,this.init()}init(){window.addEventListener("resize",this.onResize.bind(this)),document.addEventListener("click",this.onTap.bind(this),y),document.addEventListener("mousedown",this.onTapStart.bind(this),y),document.addEventListener("mousemove",this.onMouseMove.bind(this),y),document.addEventListener("mouseup",this.onTapEnd.bind(this),y),document.addEventListener("touchstart",this.onTapStart.bind(this),y),document.addEventListener("touchmove",this.onTouchMove.bind(this),y),document.addEventListener("touchend",this.onTapEnd.bind(this),y),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),document.addEventListener("change",this.onChange.bind(this),y),document.addEventListener("blur",this.onBlur.bind(this),y),document.addEventListener("undoredo",this.onUndoRedo.bind(this)),document.addEventListener("scoreload",this.onScoreLoad.bind(this)),document.addEventListener("scoreselection",this.onScoreSelection.bind(this))}onResize(){!function(t,e=100){clearTimeout(x),l.classList.add("resizing"),x=setTimeout((()=>{l.classList.remove("resizing"),t()}),e)}((()=>{var t,e;null===(t=this.app.viewport)||void 0===t||t.onResize(),null===(e=this.app.ui)||void 0===e||e.onResize()}))}onTap(t){var e,n,i;null===(e=this.app.player)||void 0===e||e.onTap(t),null===(n=this.app.ui)||void 0===n||n.onTap(t),null===(i=this.app.history)||void 0===i||i.onTap(t)}onTapStart(t){var e;null===(e=this.app.ui)||void 0===e||e.onTapStart(t)}onTapEnd(){var t;null===(t=this.app.ui)||void 0===t||t.onTapEnd()}onMouseMove(t){_.tick(t,(({x:t,y:e})=>{var n;null===(n=this.app.ui)||void 0===n||n.onTapMove(t,e)}))}onTouchMove(t){const e={x:Math.round(t.touches[0].clientX),y:Math.round(t.touches[0].clientY)};_.tick(e,(({x:t,y:e})=>{var n;null===(n=this.app.ui)||void 0===n||n.onTapMove(t,e)}))}onChange(t){var e,n,i;null===(e=this.app.player)||void 0===e||e.onChange(t),null===(n=this.app.ui)||void 0===n||null===(i=n.filters)||void 0===i||i.onChange(t)}onBlur(t){var e,n;null===(e=this.app.ui)||void 0===e||null===(n=e.relations)||void 0===n||n.onBlur(t)}onUndoRedo(t){var e;null===(e=this.app.history)||void 0===e||e.onUndoRedo(t)}onScoreLoad(t){var e,n;null===(e=this.app.score)||void 0===e||e.onScoreLoad(t),null===(n=this.app.ui)||void 0===n||n.onScoreLoad(t)}onScoreSelection(t){var e,n;null===(e=this.app.score)||void 0===e||e.onScoreSelection(t),null===(n=this.app.ui)||void 0===n||n.onScoreSelection(t)}onKeyDown(t){if(!c()){if(d(t,"z")){if(h(t,[p,"shift"]))return this.app.history.redo();if(h(t,p))return this.app.history.undo()}return d(t,"a")&&h(t,p)?this.app.ui.selection.selectAll():void 0}}onKeyUp(t){h(t)||d(t,"escape")&&c()&&document.activeElement.blur()}}function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function k(t,e,n){return e&&T(t.prototype,e),n&&T(t,n),t}for(var A={VERSION:"2.0.16",NOTES:[],HEADER_CHUNK_LENGTH:14,CIRCLE_OF_FOURTHS:["C","F","Bb","Eb","Ab","Db","Gb","Cb","Fb","Bbb","Ebb","Abb"],CIRCLE_OF_FIFTHS:["C","G","D","A","E","B","F#","C#","G#","D#","A#","E#"]},C=[["C"],["C#","Db"],["D"],["D#","Eb"],["E"],["F"],["F#","Gb"],["G"],["G#","Ab"],["A"],["A#","Bb"],["B"]],N=0,D=function(t){C.forEach((function(e){e.forEach((function(e){return A.NOTES[N]=e+t})),N++}))},M=-1;M<=9;M++)D(M);var j=function(){function t(){S(this,t)}return k(t,null,[{key:"byteToHex",value:function(t){return("0"+t.toString(16)).slice(-2)}},{key:"bytesToHex",value:function(e){var n=[];return e.forEach((function(e){return n.push(t.byteToHex(e))})),n.join("")}},{key:"hexToNumber",value:function(t){return parseInt(t,16)}},{key:"bytesToNumber",value:function(e){return t.hexToNumber(t.bytesToHex(e))}},{key:"bytesToLetters",value:function(t){var e=[];return t.forEach((function(t){return e.push(String.fromCharCode(t))})),e.join("")}},{key:"decToBinary",value:function(t){return(t>>>0).toString(2)}},{key:"getVarIntLength",value:function(t){for(var e=t[0],n=1;e>=128;)e=t[n],n++;return n}},{key:"readVarInt",value:function(t){var e=0;return t.forEach((function(t){128&t?(e+=127&t,e<<=7):e+=t})),e}},{key:"atob",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return"function"==typeof atob?atob(t):Buffer.from(t,"base64").toString("binary")}))}]),t}(),I=function(){function t(e,n){S(this,t),this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.index=e,this.data=n,this.delta=0,this.runningDelta=0,this.events=[];var i=this.data.subarray(this.data.length-3,this.data.length);if(255!==i[0]||47!==i[1]||0!==i[2])throw"Invalid MIDI file; Last three bytes of track "+this.index+"must be FF 2F 00 to mark end of track"}return k(t,[{key:"reset",value:function(){return this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.delta=0,this.runningDelta=0,this}},{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"setEventIndexByTick",value:function(t){for(var e in t=t||0,this.events)if(this.events[e].tick>=t)return this.eventIndex=e,this}},{key:"getCurrentByte",value:function(){return this.data[this.pointer]}},{key:"getDeltaByteCount",value:function(){return j.getVarIntLength(this.data.subarray(this.pointer))}},{key:"getDelta",value:function(){return j.readVarInt(this.data.subarray(this.pointer,this.pointer+this.getDeltaByteCount()))}},{key:"handleEvent",value:function(t,e){if(e=e||!1){var n=t-this.lastTick>=this.getDelta();if(this.pointer<this.data.length&&(e||n)){var i=this.parseEvent();if(this.enabled)return i}}else if(this.events[this.eventIndex]&&this.events[this.eventIndex].tick<=t&&(this.eventIndex++,this.enabled))return this.events[this.eventIndex-1];return null}},{key:"getStringData",value:function(t){var e=j.getVarIntLength(this.data.subarray(t+2)),n=j.readVarInt(this.data.subarray(t+2,t+2+e));return j.bytesToLetters(this.data.subarray(t+2+e,t+2+e+n))}},{key:"parseEvent",value:function(){var t=this.pointer+this.getDeltaByteCount(),e={},n=this.getDeltaByteCount();if(e.track=this.index+1,e.delta=this.getDelta(),this.lastTick=this.lastTick+e.delta,this.runningDelta+=e.delta,e.tick=this.runningDelta,e.byteIndex=this.pointer,255==this.data[t]){switch(this.data[t+1]){case 0:e.name="Sequence Number";break;case 1:e.name="Text Event",e.string=this.getStringData(t);break;case 2:e.name="Copyright Notice";break;case 3:e.name="Sequence/Track Name",e.string=this.getStringData(t);break;case 4:e.name="Instrument Name",e.string=this.getStringData(t);break;case 5:e.name="Lyric",e.string=this.getStringData(t);break;case 6:e.name="Marker";break;case 7:e.name="Cue Point",e.string=this.getStringData(t);break;case 9:e.name="Device Name",e.string=this.getStringData(t);break;case 32:e.name="MIDI Channel Prefix";break;case 33:e.name="MIDI Port",e.data=j.bytesToNumber([this.data[t+3]]);break;case 47:e.name="End of Track";break;case 81:e.name="Set Tempo",e.data=Math.round(6e7/j.bytesToNumber(this.data.subarray(t+3,t+6))),this.tempo=e.data;break;case 84:e.name="SMTPE Offset";break;case 88:e.name="Time Signature",e.data=this.data.subarray(t+3,t+7),e.timeSignature=e.data[0]+"/"+Math.pow(2,e.data[1]);break;case 89:e.name="Key Signature",e.data=this.data.subarray(t+3,t+5),e.data[0]>=0?e.keySignature=A.CIRCLE_OF_FIFTHS[e.data[0]]:e.data[0]<0&&(e.keySignature=A.CIRCLE_OF_FOURTHS[Math.abs(e.data[0])]),0==e.data[1]?e.keySignature+=" Major":1==e.data[1]&&(e.keySignature+=" Minor");break;case 127:e.name="Sequencer-Specific Meta-event";break;default:e.name="Unknown: "+this.data[t+1].toString(16)}var i=j.getVarIntLength(this.data.subarray(t+2)),o=j.readVarInt(this.data.subarray(t+2,t+2+i));this.pointer+=n+3+o}else if(240===this.data[t]){e.name="Sysex";var r=j.getVarIntLength(this.data.subarray(t+1)),s=j.readVarInt(this.data.subarray(t+1,t+1+r));e.data=this.data.subarray(t+1+r,t+1+r+s),this.pointer+=n+1+r+s}else if(247===this.data[t]){e.name="Sysex (escape)";var a=j.getVarIntLength(this.data.subarray(t+1)),l=j.readVarInt(this.data.subarray(t+1,t+1+a));e.data=this.data.subarray(t+1+a,t+1+a+l),this.pointer+=n+1+a+l}else if(this.data[t]<128)if(e.running=!0,e.noteNumber=this.data[t],e.noteName=A.NOTES[this.data[t]],e.velocity=this.data[t+1],this.lastStatus<=143)e.name="Note off",e.channel=this.lastStatus-128+1,this.pointer+=n+2;else if(this.lastStatus<=159)e.name="Note on",e.channel=this.lastStatus-144+1,this.pointer+=n+2;else if(this.lastStatus<=175)e.name="Polyphonic Key Pressure",e.channel=this.lastStatus-160+1,e.note=A.NOTES[this.data[t+1]],e.pressure=event[1],this.pointer+=n+2;else if(this.lastStatus<=191)e.name="Controller Change",e.channel=this.lastStatus-176+1,e.number=this.data[t+1],e.value=this.data[t+2],this.pointer+=n+2;else if(this.lastStatus<=207)e.name="Program Change",e.channel=this.lastStatus-192+1,e.value=this.data[t+1],this.pointer+=n+1;else if(this.lastStatus<=223)e.name="Channel Key Pressure",e.channel=this.lastStatus-208+1,this.pointer+=n+1;else{if(!(this.lastStatus<=239))throw"Unknown event (running): ".concat(this.lastStatus);e.name="Pitch Bend",e.channel=this.lastStatus-224+1,e.value=this.data[t+2],this.pointer+=n+2}else if(this.lastStatus=this.data[t],this.data[t]<=143)e.name="Note off",e.channel=this.lastStatus-128+1,e.noteNumber=this.data[t+1],e.noteName=A.NOTES[this.data[t+1]],e.velocity=Math.round(this.data[t+2]/127*100),this.pointer+=n+3;else if(this.data[t]<=159)e.name="Note on",e.channel=this.lastStatus-144+1,e.noteNumber=this.data[t+1],e.noteName=A.NOTES[this.data[t+1]],e.velocity=Math.round(this.data[t+2]/127*100),this.pointer+=n+3;else if(this.data[t]<=175)e.name="Polyphonic Key Pressure",e.channel=this.lastStatus-160+1,e.note=A.NOTES[this.data[t+1]],e.pressure=event[2],this.pointer+=n+3;else if(this.data[t]<=191)e.name="Controller Change",e.channel=this.lastStatus-176+1,e.number=this.data[t+1],e.value=this.data[t+2],this.pointer+=n+3;else if(this.data[t]<=207)e.name="Program Change",e.channel=this.lastStatus-192+1,e.value=this.data[t+1],this.pointer+=n+2;else if(this.data[t]<=223)e.name="Channel Key Pressure",e.channel=this.lastStatus-208+1,this.pointer+=n+2;else{if(!(this.data[t]<=239))throw"Unknown event: ".concat(this.data[t]);e.name="Pitch Bend",e.channel=this.lastStatus-224+1,this.pointer+=n+3}return this.delta+=e.delta,this.events.push(e),e}},{key:"endOfTrack",value:function(){return 255==this.data[this.pointer+1]&&47==this.data[this.pointer+2]&&0==this.data[this.pointer+3]}}]),t}();Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach});var L={Player:function(){function t(e,n){S(this,t),this.sampleRate=5,this.startTime=0,this.buffer=n||null,this.midiChunksByteLength=null,this.division,this.format,this.setIntervalId=!1,this.tracks=[],this.instruments=[],this.defaultTempo=120,this.tempo=null,this.startTick=0,this.tick=0,this.lastTick=null,this.inLoop=!1,this.totalTicks=0,this.events=[],this.totalEvents=0,this.eventListeners={},"function"==typeof e&&this.on("midiEvent",e)}return k(t,[{key:"loadFile",value:function(t){throw"loadFile is only supported on Node.js"}},{key:"loadArrayBuffer",value:function(t){return this.buffer=new Uint8Array(t),this.fileLoaded()}},{key:"loadDataUri",value:function(t){for(var e=j.atob(t.split(",")[1]),n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return this.buffer=n,this.fileLoaded()}},{key:"getFilesize",value:function(){return this.buffer?this.buffer.length:0}},{key:"fileLoaded",value:function(){if(!this.validate())throw"Invalid MIDI file; should start with MThd";return this.setTempo(this.defaultTempo).getDivision().getFormat().getTracks().dryRun()}},{key:"validate",value:function(){return"MThd"===j.bytesToLetters(this.buffer.subarray(0,4))}},{key:"getFormat",value:function(){return this.format=j.bytesToNumber(this.buffer.subarray(8,10)),this}},{key:"getTracks",value:function(){this.tracks=[];for(var t=0;t<this.buffer.length;){if("MTrk"==j.bytesToLetters(this.buffer.subarray(t,t+4))){var e=j.bytesToNumber(this.buffer.subarray(t+4,t+8));this.tracks.push(new I(this.tracks.length,this.buffer.subarray(t+8,t+8+e)))}t+=j.bytesToNumber(this.buffer.subarray(t+4,t+8))+8}var n=0;return this.tracks.forEach((function(t){n+=8+t.data.length})),this.midiChunksByteLength=A.HEADER_CHUNK_LENGTH+n,this}},{key:"enableTrack",value:function(t){return this.tracks[t-1].enable(),this}},{key:"disableTrack",value:function(t){return this.tracks[t-1].disable(),this}},{key:"getDivision",value:function(){return this.division=j.bytesToNumber(this.buffer.subarray(12,A.HEADER_CHUNK_LENGTH)),this}},{key:"playLoop",value:function(t){this.inLoop||(this.inLoop=!0,this.tick=this.getCurrentTick(),this.tracks.forEach((function(e,n){if(!t&&this.endOfFile())this.triggerPlayerEvent("endOfFile"),this.stop();else{var i=e.handleEvent(this.tick,t);t&&i?(i.hasOwnProperty("name")&&"Set Tempo"===i.name&&(this.defaultTempo=i.data,this.setTempo(i.data)),i.hasOwnProperty("name")&&"Program Change"===i.name&&(this.instruments.includes(i.value)||this.instruments.push(i.value))):i&&(i.hasOwnProperty("name")&&"Set Tempo"===i.name&&(this.setTempo(i.data),this.isPlaying()&&this.pause().play()),this.emitEvent(i))}}),this),t||this.triggerPlayerEvent("playing",{tick:this.tick}),this.inLoop=!1)}},{key:"setTempo",value:function(t){return this.tempo=t,this}},{key:"setStartTime",value:function(t){return this.startTime=t,this}},{key:"play",value:function(){if(this.isPlaying())throw"Already playing...";return this.startTime||(this.startTime=(new Date).getTime()),this.setIntervalId=setInterval(this.playLoop.bind(this),this.sampleRate),this}},{key:"loop",value:function(){setTimeout(function(){this.playLoop(),this.loop()}.bind(this),this.sampleRate)}},{key:"pause",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=this.tick,this.startTime=0,this}},{key:"stop",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=0,this.startTime=0,this.resetTracks(),this}},{key:"skipToTick",value:function(t){return this.stop(),this.startTick=t,this.tracks.forEach((function(e){e.setEventIndexByTick(t)})),this}},{key:"skipToPercent",value:function(t){if(t<0||t>100)throw"Percent must be number between 1 and 100.";return this.skipToTick(Math.round(t/100*this.totalTicks)),this}},{key:"skipToSeconds",value:function(t){var e=this.getSongTime();if(t<0||t>e)throw t+" seconds not within song time of "+e;return this.skipToPercent(t/e*100),this}},{key:"isPlaying",value:function(){return this.setIntervalId>0||"object"===E(this.setIntervalId)}},{key:"dryRun",value:function(){for(this.resetTracks();!this.endOfFile();)this.playLoop(!0);return this.events=this.getEvents(),this.totalEvents=this.getTotalEvents(),this.totalTicks=this.getTotalTicks(),this.startTick=0,this.startTime=0,this.resetTracks(),this.triggerPlayerEvent("fileLoaded",this),this}},{key:"resetTracks",value:function(){return this.tracks.forEach((function(t){return t.reset()})),this}},{key:"getEvents",value:function(){return this.tracks.map((function(t){return t.events}))}},{key:"getTotalTicks",value:function(){return Math.max.apply(null,this.tracks.map((function(t){return t.delta})))}},{key:"getTotalEvents",value:function(){return this.tracks.reduce((function(t,e){return{events:{length:t.events.length+e.events.length}}}),{events:{length:0}}).events.length}},{key:"getSongTime",value:function(){return this.totalTicks/this.division/this.tempo*60}},{key:"getSongTimeRemaining",value:function(){return Math.round((this.totalTicks-this.getCurrentTick())/this.division/this.tempo*60)}},{key:"getSongPercentRemaining",value:function(){return Math.round(this.getSongTimeRemaining()/this.getSongTime()*100)}},{key:"bytesProcessed",value:function(){return A.HEADER_CHUNK_LENGTH+8*this.tracks.length+this.tracks.reduce((function(t,e){return{pointer:t.pointer+e.pointer}}),{pointer:0}).pointer}},{key:"eventsPlayed",value:function(){return this.tracks.reduce((function(t,e){return{eventIndex:t.eventIndex+e.eventIndex}}),{eventIndex:0}).eventIndex}},{key:"endOfFile",value:function(){return this.isPlaying()?this.totalTicks-this.tick<=0:this.bytesProcessed()>=this.midiChunksByteLength}},{key:"getCurrentTick",value:function(){return this.startTime?Math.round(((new Date).getTime()-this.startTime)/1e3*(this.division*(this.tempo/60)))+this.startTick:this.startTick}},{key:"emitEvent",value:function(t){return this.triggerPlayerEvent("midiEvent",t),this}},{key:"on",value:function(t,e){return this.eventListeners.hasOwnProperty(t)||(this.eventListeners[t]=[]),this.eventListeners[t].push(e),this}},{key:"triggerPlayerEvent",value:function(t,e){return this.eventListeners.hasOwnProperty(t)&&this.eventListeners[t].forEach((function(t){return t(e||{})})),this}}]),t}(),Utils:j,Constants:A},B=n(346),O=n.n(B),z=n(419);const P=(t,e,n)=>Math.max(e,Math.min(n,t));class R{constructor(t=""){this.ctn=document.getElementById(`${t}-progress-ctn`),this.el=document.getElementById(`${t}-progress`),this.doneEl=document.getElementById(`${t}-progress-done`),this.maxEl=document.getElementById(`${t}-progress-max`),this.reset()}update(t=this.done,e=this.max){if(e<=0)return this.reset();this.done=t,this.max=e,this.el.max=e,this.el.value=t,this.el.innerHTML=`${t} / ${e}`;const n=((t,e=0)=>(e=10**e,Math.round(t*e)/e))(this.el.position,3);this.setBar(n),this.updateLabel()}setBar(t){this.ctn.style.setProperty("--progress",P(0,t,1))}updateLabel(){this.doneEl.innerHTML=this.formatTime(this.done),this.maxEl.innerHTML=this.formatTime(this.max)}formatTime(t){return`${Math.floor(t/60)}:${(t%60).toString().padStart(2,0)}`}reset(){this.el.innerHTML="",this.el.removeAttribute("value"),this.el.removeAttribute("max"),this.setBar(0),this.done=0,this.max=0}}const H=new AudioContext;let U;const q=new class{constructor(){this.midiId=null,this.playhead=0,this.playBtn=document.getElementById("player-play"),this.pauseBtn=document.getElementById("player-pause"),this.stopBtn=document.getElementById("player-stop"),this.timelineRange=document.getElementById("player-timeline-input"),this.init()}loadSound(t,e=""){this.midiId!=e&&(this.stop(),this.midiId=e),U.loadDataUri(`data:audio/midi;base64,${t}`)}onTap({target:t}){if(t==this.playBtn&&!U.isPlaying()){const t=(0,z.p8)();return"original"!=this.midiId&&this.loadSound(t,"original"),void this.play()}t==this.pauseBtn&&U.isPlaying()?this.pause():t==this.stopBtn&&U.isPlaying()&&this.stop()}onChange({target:t}){t==this.timelineRange&&U.skipToSeconds(t.value).play()}updateProgress(){let t=U.getSongTime(),e=U.getSongTimeRemaining();(isNaN(t)||isNaN(e))&&(t=0,e=0);const n=t-e;this.progressBar.update(n,t),this.timelineRange.setAttribute("max",t),this.timelineRange.setAttribute("value",n)}play(){this.playhead&&U.skipToTick(this.playhead),U.play()}stop(){U.stop(),this.updateProgress(),this.playhead=0}pause(){this.playhead=U.getCurrentTick(),U.pause()}init(){O().instrument(H,"/instruments/acoustic-grand-piano-mp3.js").then((t=>{U=new L.Player((e=>{"Note on"==e.name&&e.velocity>0&&t.play(e.noteName,H.currentTime,{gain:e.velocity/100}),this.updateProgress()})),U.on("endOfFile",(()=>this.stop()))})),this.progressBar=new R("player")}},V=(t,e=null)=>{const n={},i=t.getBoundingClientRect();for(const t in i)e&&!e.includes(t)||(n[t]=i[t]);return n};class W{}var Y,F,X;X=t=>1==t.nodeType,(F="isElement")in(Y=W)?Object.defineProperty(Y,F,{value:X,enumerable:!0,configurable:!0,writable:!0}):Y[F]=X;const K=t=>t[0].toUpperCase()+t.slice(1);class Q{constructor(t,e){!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(this,"createFilterElement",(({type:t,checked:e})=>`\n    <li>\n        <label class="checkable color-${this.namespace}-${t}" for="${this.namespace}-filter-${t}">\n            ${K(t)}\n            <input class="checkable__input" type="checkbox" id="${this.namespace}-filter-${t}" data-type="${t}" ${e?"checked":""}>\n            <span class="checkbox checkbox--colored">\n                <svg class="checkable__icon btn__icon" width="12" height="10">\n                    <use xlink:href="#check-path"/>\n                </svg>\n            </span>\n        </label>\n    </li>\n  `)),this.namespace=t,this.ctn=document.getElementById(e.filterCtnId),this.paths=e.svgCtn.getElementsByClassName(t),this.fields=[]}onChange(t){t.composedPath().includes(this.ctn)&&this.toggleRelationsPaths(t.target.dataset.type,t.target.checked)}toggleRelationsPaths(t,e){Array.from(this.paths).filter((e=>e.getAttribute("type")==t)).forEach((t=>t.classList.toggle("relation--filtered",!e)))}getRelations(){const t=new Set(Array.from(this.paths,(t=>t.getAttribute("type"))));this.fields=Array.from(t,(t=>({type:t,checked:!0,el:null})))}hasRelationType(t){return this.fields.some((e=>e.type==t))}wasLastOfType(t){return!Array.from(this.paths).some((e=>e.getAttribute("type")==t))}render(){let t=this.fields.map((t=>this.createFilterElement(t))).join(" ");this.ctn.innerHTML=t}}function G(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Z=new class{constructor(){G(this,"createFiltersGroups",(()=>[new Q("relation",{filterCtnId:"relations-filters",svgCtn:this.svgCtn}),new Q("metarelation",{filterCtnId:"meta-relations-filters",svgCtn:this.svgCtn})])),G(this,"createMutationObserver",(()=>new MutationObserver((t=>{if(t.filter((t=>"attributes"==t.type&&"type"==t.attributeName)).filter((t=>t.target.getAttribute("type")!=t.oldValue)).length>0)return this.update();const e=1==t.length&&t.filter((t=>{var e;return"childList"==t.type&&1==(null===(e=t.addedNodes)||void 0===e?void 0:e.length)})).map((t=>{var e;return null===(e=t.addedNodes)||void 0===e?void 0:e.item(0)})).find(W.isElement);if(e){const t=e.getAttribute("type");if(!this.groups.some((e=>e.hasRelationType(t))))return this.update()}const n=1==t.length&&t.filter((t=>{var e;return"childList"==t.type&&1==(null===(e=t.removedNodes)||void 0===e?void 0:e.length)})).map((t=>{var e;return null===(e=t.removedNodes)||void 0===e?void 0:e.item(0)})).find(W.isElement);if(n){const t=n.getAttribute("type");if(this.groups.some((e=>e.wasLastOfType(t))))return this.update()}})))),this.visible=!1,this.ctn=document.getElementById("filters"),this.toggleBtn=document.getElementById("filters-toggle"),this.svgCtn=document.getElementById("layers"),this.observer=this.createMutationObserver(),this.groups=this.createFiltersGroups()}onTap({target:t}){t==this.toggleBtn&&this.toggle()}onChange(t){this.groups.forEach((e=>e.onChange(t)))}onScoreLoad(){this.toggle(!1),this.observer.disconnect(),this.update(),this.observe()}observe(){this.observer.observe(document.querySelector("#layers .svg_container > svg .page-margin"),{subtree:!0,childList:!0,attributeOldValue:!0,attributeFilter:["type"]})}toggle(t=!this.visible){this.visible=t,this.ctn.classList.toggle("fly-out--expanded",t),this.ctn.classList.toggle("fly-out--collapsed",!t)}update(){this.groups.forEach((t=>t.getRelations())),this.groups.forEach((t=>t.render()))}};var J=n(624);function tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class et extends Map{constructor(...t){super(...t),tt(this,"add",((t,e)=>this.has(t)?this:this.set(t,e))),tt(this,"remember",((t,e)=>(this.add(t,e),e)))}}function nt(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function it(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,ot(t,e,"get"))}function ot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}const rt=["note","relation","metarelation"];var st=new WeakMap,at=new WeakMap;const lt=new class{constructor(){nt(this,st,{writable:!0,value:void 0}),nt(this,at,{writable:!0,value:new et}),this.loaded=!1,this.mei=null}get selection(){return it(this,st)}set selection(t){it(this,at).clear(),function(t,e,n){(function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}})(t,ot(t,e,"set"),n)}(this,st,t)}get flatSelection(){return it(this,at).remember("flatSelection",Object.values(this.selection).flat())}get selectionType(){var t;const e=null!==(t=rt.find((t=>{var e;return null===(e=this.flatSelection[0])||void 0===e?void 0:e.classList.contains(t)})))&&void 0!==t?t:null;return it(this,at).remember("selectionType",e)}onScoreLoad(){this.loaded=!0,this.mei=window.mei,it(this,at).clear()}onScoreSelection({detail:t}){this.selection=t}},ct=lt,ut={title:{label:"Title",saveBtn:"Update title",placeholder:"The name  of the song "},roles:{composer:{label:"Composer",saveBtn:"Update composer",placeholder:"Wolfgang Amadeus Mozart"},analyst:{label:"Analyst",saveBtn:"Assign responsibility",placeholder:"Maybe you?"},annotator:{label:"Annotator",saveBtn:"Assign responsibility",placeholder:"Maybe you?"}}},dt=(t,{label:e,placeholder:n=""},i="")=>`\n  <label class="fillable fly-out__title" for="metadata-${t}">\n      ${e}\n      <input\n          class="fillable__input"\n          id="metadata-${t}"\n          type="text"\n          placeholder="${n}"\n          value="${i}"\n      >\n  </label>\n`,ht=(t,{saveBtn:e})=>`\n  <button\n      class="btn btn--plain btn--small"\n      id="metadata-${t}-assign"\n      type="button"\n      data-role="${t}"\n  >${e}</button>\n`,pt=new DOMParser,ft=new RegExp(/^metadata-\w+-assign$/),gt=new class{constructor(){this.visible=!1,this.ctn=document.getElementById("metadata"),this.toggleBtn=document.getElementById("metadata-toggle"),this.persRoles=Object.keys(ut.roles),this.formDOM={ctn:document.getElementById("metadata-form")},this.formDOM.inputs=this.formDOM.ctn.getElementsByClassName("fillable__input"),this.scoreHead={titleStmt:null,title:null,respStmt:null,respPersName:[]}}onTap({target:t}){if(t==this.toggleBtn)return this.toggle();if(ft.test(t.id)){const e=t.id.replace("metadata-","").replace("-assign","");this.updateScoreMetadata(e)}}onScoreLoad(){this.initScore(),this.initFields()}toggle(t=!this.visible){this.visible=t,this.ctn.classList.toggle("fly-out--expanded",t),this.ctn.classList.toggle("fly-out--collapsed",!t)}updateScoreMetadata(t){const e=[...this.formDOM.inputs].find((({id:e})=>`metadata-${t}`));if(!e)return;const n=e.value;if("title"==t)return void(this.scoreHead.title[0].innerHTML=n);const i=this.persNames.find((e=>e.role==t));i.value=n,i.el.innerHTML=n,"composer"!=t&&ct.flatSelection.forEach((e=>{const n=(0,J.get_id)(e),i=(0,J.get_by_id)(ct.mei,n);("note"==i.tagName?i:i.firstChild).setAttribute("resp",t)}))}initScore(){this.scoreHead.titleStmt=ct.mei.querySelector("meiHead fileDesc titleStmt"),this.scoreHead.titleStmt&&(this.initStmtEl("title"),this.initStmtEl("respStmt"),this.initRoles())}initStmtEl(t){if(this.scoreHead[t]=this.scoreHead.titleStmt.getElementsByTagName(t),!this.scoreHead[t].length){const e=ct.mei.createElement(t);this.scoreHead.titleStmt.appendChild(e)}}initRoles(){this.scoreHead.respPersName=this.scoreHead.respStmt[0].getElementsByTagName("persName"),this.persNames=Array.from(this.scoreHead.respPersName).filter((t=>this.persRoles.includes(t.getAttribute("role")))).map((t=>({el:t,role:t.getAttribute("role"),value:t.innerHTML,config:ut.roles[t.getAttribute("role")]}))),this.persRoles.filter((t=>!this.persNames.find((e=>e.role==t)))).forEach((t=>this.initRole(t)))}initRole(t){const e=pt.parseFromString(`<persName role="${t}" xml:id="${t}" />`,"text/xml").firstChild;this.scoreHead.respStmt[0].appendChild(e),this.persNames.push({el:e,role:t,value:"",config:ut.roles[t]})}initFields(){this.formDOM.ctn.innerHTML=dt("title",ut.title,this.scoreHead.title[0].innerHTML)+ht("title",ut.title)+this.persNames.map((({role:t,config:e,value:n})=>`\n    <hr class="fly-out__hr">\n    ${dt(t,e,n)}\n    ${ht(t,e)}\n  `)).join("")}},mt=gt,yt=new class{constructor(){this.update()}onResize(){this.update()}update(){this.w=window.innerWidth,this.h=window.innerHeight}},vt=new class{constructor(){this.toLeftBtn=document.getElementById("to-left"),this.toRightBtn=document.getElementById("to-right")}onTap(t){return t.target==this.toLeftBtn?this.toLeft():t.target==this.toRightBtn?this.toRight():void 0}toLeft(){this.goTo(-(yt.w-200))}toRight(){this.goTo(yt.w-200)}goTo(t){l.scrollBy(t,0)}};var bt=n(362);class _t{constructor(t){!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t.hide=n}(this,"hide",(()=>this.toggleVisibility(!1))),this.ctn={el:document.getElementById(t)},this.closeBtn=this.ctn.el.querySelector(".fly-out__closeBtn"),this.visible=!1}onTap(t){if(t.composedPath().includes(this.ctn.el))return t.target==this.closeBtn?this.toggleVisibility(!1):void 0}toggleVisibility(t=!this.visible){this.ctn.el.classList.toggle("fly-out--visible",t),this.visible=t}}const xt=t=>t/10+"rem";function wt(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Et(t,e,"get"))}function Et(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var St=new WeakMap;class Tt extends _t{constructor(t){super(t),function(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}(this,St,{writable:!0,value:!1}),this.dragHandle={el:this.ctn.el.querySelector(".fly-out__drag")},this.visible=!1,this.x=0,this.y=0,this.computeValues()}onTapStart(t){t.target==this.dragHandle.el&&function(t,e=null){t.preventDefault(),e&&e.call()}(t,(()=>this.toggleDragging(!0)))}onTapMove(t,e){this.visible&&wt(this,St)&&this.updatePosition(t,e)}onTapEnd(){this.visible&&wt(this,St)&&(this.toggleDragging(!1),this.computeValues())}onResize(){this.visible&&this.computeValues()}updatePosition(t=this.x,e=this.y){this.x=t-this.ctn.handleDeltaX,this.y=e-this.ctn.handleDeltaY,this.ctn.el.style.setProperty("--fly-out-x",xt(this.x)),this.ctn.el.style.setProperty("--fly-out-y",xt(this.y))}toggleDragging(t=!wt(this,St)){(function(t,e,n){(function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}})(t,Et(t,e,"set"),n)})(this,St,t),this.ctn.el.classList.toggle("fly-out--grabbing",t),l.classList.toggle("dragging-fly-out",t)}snapInViewport(){const t=P(this.x,10,yt.w-this.ctn.width-10),e=P(this.y,10,yt.h-this.ctn.height-10);t==this.x&&e==this.y||(this.ctn.el.classList.add("fly-out--snapping"),this.ctn.el.addEventListener("transitionend",this.onSnapTransitionEnd.bind(this)),this.updatePosition(t+this.ctn.handleDeltaX,e+this.ctn.handleDeltaY))}onSnapTransitionEnd({propertyName:t}){"transform"==t&&(this.ctn.el.classList.remove("fly-out--snapping"),this.ctn.el.removeEventListener("transitionend",this.onSnapTransitionEnd.bind(this)))}computeValues(){const t=V(this.ctn.el,["x","y","width","height"]);Object.assign(this.ctn,t);const e=V(this.dragHandle.el,["width","height"]);Object.assign(this.dragHandle,e,{offsetLeft:this.dragHandle.el.offsetLeft,offsetTop:this.dragHandle.el.offsetTop}),this.ctn.handleDeltaX=this.dragHandle.offsetLeft+this.dragHandle.width/2,this.ctn.handleDeltaY=this.dragHandle.offsetTop+this.dragHandle.height/2,this.snapInViewport()}}const kt=t=>`<option value="${t}">`;function At(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Ct(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Dt(t,e,"set"),n),n}function Nt(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Dt(t,e,"get"))}function Dt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Mt=new WeakMap,jt=new WeakMap;class It{constructor(t,e,n={}){At(this,Mt,{writable:!0,value:!1}),At(this,jt,{writable:!0,value:!1}),this.type=t,this.name=e.name,this.eventCallbacks=n,this.initHtml(e)}get isVisible(){return Nt(this,Mt)}get isExpanded(){return Nt(this,jt)}onTap(){this.toggle()}show(){this.toggleVisibility(!0)}hide(){this.toggleVisibility(!1)}expand(){this.toggle(!0)}collapse(){this.toggle(!1)}toggleVisibility(t=!Nt(this,Mt)){Ct(this,Mt,t),this.ctn.classList.toggle("fly-out__btnGroup--visible",t)}toggle(t=!Nt(this,jt)){Ct(this,jt,t),this.ctn.classList.toggle("fly-out__btnGroup--expanded",t)}initHtml(t){const e=Object.keys(t.main).map((t=>((t,e)=>`\n  <button\n      type="button"\n      class="btn btn--hollow btn--relation color-relation-${t}"\n      data-relation-name="${t}"\n      data-relation-type="${this.type}"\n  >\n      ${K(t)}\n  </button>\n`)(t))).join("");let n="";var i,o;(t.main.length>3||"additional"in t)&&(n+=`\n  <button\n      type="button"\n      class="fly-out__showMore | btn btn--hollow"\n      data-relation-type="${i=this.type}"\n  >\n      <span class="visually-hidden">View more ${i}</span>\n      &hellip;\n  </button>\n`),"additional"in t&&(n+='<hr class="fly-out__hr">'+((t,{label:e,placeholder:n=""})=>`\n  <label class="fillable fly-out__title" for="free-field-${t}">\n      <span class="fillable__label">\n          <span class="fillable__label__text">${e}</span>\n          <svg class="fillable__label__triangle | btn__icon" width="10" height="8">\n              <use xlink:href="#triangle-path"/>\n          </svg>\n      </span>\n\n      <input\n          class="fillable__input"\n          id="free-field-${t}"\n          type="text"\n          list="datalist-${t}"\n          placeholder="${e}"\n          data-relation-type="${t}"\n      >\n  </label>\n`)(this.type,{label:"Select a "+this.name})+(o=t.additional,`\n  <datalist id="datalist-${this.type}">${(t=>t.map(kt).join(""))(o)}</datalist>\n`)),this.ctn=document.getElementById(`${this.type}-btns`),this.ctn.innerHTML=e+n,this.btns=this.ctn.getElementsByClassName("btn--relation"),this.freeField=this.ctn.querySelector(`#free-field-${this.type}`)}}const Lt=new class extends Tt{constructor(){super("relations-menu"),this.innerCtn=this.ctn.el.querySelector(".fly-out__innerSomething"),this.init()}get visibleGroups(){return[this.relations,this.metarelations,this.comborelations].filter((({isVisible:t})=>t))}onTap(t){super.onTap(t);const{dataset:e,classList:n}=t.target;if(!("relationType"in e))return;const i=e.relationType;if(n.contains("btn--relation"))return this[i].eventCallbacks.tap(e.relationName);n.contains("btn")&&(this[i].onTap(),this.compact(),this.computeValues())}onBlur({target:{dataset:t,value:e,id:n},target:i}){if(null==t||!t.hasOwnProperty("relationType"))return;const{relationType:o}=t;return e&&n==`free-field-${o}`?this[o].eventCallbacks.tap(e):void 0}onScoreSelection({detail:t}){this.toggleVisibility(ct.flatSelection.length),this.reorder(),this.relations.show(),this.metarelations.toggleVisibility("note"!=ct.selectionType),this.compact(),1==ct.flatSelection.length&&this.computeValues()}reorder(){if(1!==ct.flatSelection.length)return;const t=(0,bt.Ti)(ct.selectionType);for(let e=t.length-1;e>0;e--)this.innerCtn.insertBefore(this[t[e-1]].ctn,this[t[e]].ctn),e>1&&this[t[e-1]].toggle(!0)}compact(){if(1!==ct.flatSelection.length)return;const t=!this[(0,bt.Ti)(ct.selectionType)[0]].isExpanded;this.ctn.el.classList.toggle("fly-out--relations-compact",t),this.ctn.el.classList.toggle("fly-out--big",!t);const e=this.relations.isExpanded&&"note"==ct.selectionType&&ct.flatSelection.length>2&&ct.selection.extraselected.length<3;this.comborelations.toggleVisibility(e)}init(){this.relations=new It("relations",bt.W3,{tap:z.i9}),this.metarelations=new It("metarelations",bt.pX,{tap:z.qG}),this.comborelations=new It("comborelations",bt.yu,{tap:z.lk}),this.title=this.ctn.el.querySelector(".fly-out__title")}},Bt=Lt,Ot=t=>`<li class="selection__listItem">${t.toUpperCase()}</li>`,zt=t=>`<li class="selection__listItem">${t.getAttribute("type")}</li>`;class Pt extends _t{constructor(){super("selection-legend"),this.title=document.getElementById("selection-type"),this.primary=document.getElementById("selection-primary"),this.primaryList=document.getElementById("selection-list-primary"),this.secondary=document.getElementById("selection-secondary"),this.secondaryList=document.getElementById("selection-list-secondary"),this.hide()}update({selected:t,extraselected:e}){this.toggleVisibility(ct.flatSelection.length>0),this.visible&&(this.updateTitle(),this.updateRow("primary",t),this.updateRow("secondary",e))}updateTitle(){this.title.innerHTML=ct.selectionType?`Selected ${ct.selectionType}s`:"Selection is empty"}updateRow(t,e){this[t].classList.toggle("none",!e.length),this[`${t}List`].innerHTML=(t=>{console.log(t);const e=ct.selectionType;return t.length?("note"==e?(0,J.to_text)(t).map(Ot):t.map(zt)).join(""):"-"})(e)}}const Rt=new class{constructor(){this.selectBtn=document.getElementById("select-all"),this.unselectBtn=document.getElementById("unselect-all"),this.legend=new Pt}selectAll(){const t=ln();t&&Ae(t)}selectNone(){Ve()}onTap({target:t}){return t==this.selectBtn?this.selectAll():t==this.unselectBtn?this.selectNone():void 0}onScoreSelection(t){this.legend.update(t)}},Ht=new class{constructor(){this.zoomInBtn=document.getElementById("zoom-in"),this.zoomOutBtn=document.getElementById("zoom-out"),this.resetBtn=document.getElementById("zoom-reset"),this.levelEl=document.getElementById("zoom-level")}onTap({target:t}){return t==this.zoomInBtn?this.in():t==this.zoomOutBtn?this.out():t==this.resetBtn?this.reset():void 0}in(){this.by(1.1)}out(){this.by(.9090909090909091)}reset(){this.by(1)}by(t=1){const e=ln();e&&(e.zoom=1==t?1:e.zoom*t,e.svg_elem.style.transform=`scale(${e.zoom})`,this.levelEl.innerHTML=this.format(e.zoom))}format(t){return`${Math.round(100*t)}%`}},Ut=new class{constructor(){this.ctn=document.getElementById("ui"),this.init()}onTap(t){var e,n,i,o,r,s;null===(e=this.relations)||void 0===e||e.onTap(t),t.composedPath().includes(this.ctn)&&(null===(n=this.zoom)||void 0===n||n.onTap(t),null===(i=this.selection)||void 0===i||i.onTap(t),null===(o=this.metadata)||void 0===o||o.onTap(t),null===(r=this.navigation)||void 0===r||r.onTap(t),null===(s=this.filters)||void 0===s||s.onTap(t))}onTapStart(t){var e;null===(e=this.relations)||void 0===e||e.onTapStart(t)}onTapMove(t,e){var n;null===(n=this.relations)||void 0===n||n.onTapMove(t,e)}onTapEnd(){var t;null===(t=this.relations)||void 0===t||t.onTapEnd()}onResize(){var t;null===(t=this.relations)||void 0===t||t.onResize()}onScoreLoad(t){var e,n;null===(e=this.filters)||void 0===e||e.onScoreLoad(t),null===(n=this.metadata)||void 0===n||n.onScoreLoad(t)}onScoreSelection({detail:t}){var e,n;null===(e=this.selection)||void 0===e||e.onScoreSelection(t),null===(n=this.relations)||void 0===n||n.onScoreSelection(t)}init(){this.zoom=Ht,this.selection=Rt,this.navigation=vt,this.metadata=mt,this.filters=Z,this.relations=Bt}};var qt=n(235);const Vt=new class{constructor(){this.undoBtn=document.getElementById("undo"),this.redoBtn=document.getElementById("redo"),this.updateBtns(0,0)}onTap({target:t}){return t==this.undoBtn?this.undo():t==this.redoBtn?this.redo():void 0}undo(){(0,qt.FB)()}redo(){(0,qt.VJ)()}updateBtns(t=0,e=0){this.undoBtn.toggleAttribute("disabled",0==t),this.redoBtn.toggleAttribute("disabled",0==e)}onUndoRedo({detail:t}){this.updateBtns(t.undoAbleCount,t.redoAbleCount)}},Wt=new class{constructor(){this.init()}init(){l.classList.remove("loading"),l.classList.add("ready"),this.viewport=yt,(t=>{new w(this)})(),this.ui=Ut,this.score=ct,this.player=q,this.history=Vt}};var Yt=n(238),Ft=n.n(Yt),$t=n(36);function Xt(t,e,n){var i=e.map((e=>(0,J.relation_primaries)(t,e))).flat();e=e.filter((t=>!n.includes(t))),i=i.concat(e.map((e=>(0,J.relation_secondaries)(t,e))).flat());do{var o=n.filter((e=>(0,J.relation_secondaries)(t,e).findIndex((t=>i.includes(t)))>-1));e=e.concat(o),n=n.filter((t=>!o.includes(t))),i=i.concat(o.map((e=>(0,J.relation_secondaries)(t,e))).flat())}while(o.length>0);return[n,[...new Set(n.flatMap((e=>(0,J.relation_secondaries)(t,e))))]]}function Kt(t){!function(t,e,n,i){var o=n.concat(i).map((t=>(0,J.get_by_id)(e.getRootNode(),(0,J.get_id)(t)))),r=Array.from(e.getElementsByTagName("node")).filter((t=>"relation"==t.getAttribute("type"))).filter((e=>{var n=(0,J.get_by_id)(document,t.id_prefix+e.getAttribute("xml:id"));return null!=n&&!n.classList.contains("hidden")}));0==o.length&&(o=r);var[s,a]=Xt(e,r,o),l=[];l.push(s.map((e=>(0,J.hide_he)(t,e)))),l.push(a.map((e=>(0,J.hide_note)(t,e)))),l.push(s.map((e=>(0,J.hide_he_hier)(t,e)))),l.push(a.map((e=>(0,J.hide_note_hier)(t,e))));var c=[s,a,l];t.reductions.push(["reduce",c,n,i])}(t,(0,z.ro)(),selected,extraselected)}function Qt(t,e=200,n=!0){var i=t.svg_elem,o=t.id_prefix,r=(Ke(t),(0,J.g)());r.id="hier"+o;var s=Array.from(i.getElementsByClassName("note")).map(J.get_id).map((t=>(0,J.get_by_id)(mei,t))).map(J.get_id).map((t=>(0,J.get_by_id)(mei,"gn-"+t))).filter((t=>null!=t)),a=Array.from(i.getElementsByClassName("relation")).map(J.get_id).map((t=>(0,J.get_by_id)(mei,t))),l=function(t,e,n=!0){var i=(0,z.ro)(),o=[],r=e,s=t.filter((t=>null!=t));do{let t=[];n&&(t=s.filter((t=>!r.find((e=>(0,J.relation_allnodes)(i,e).includes(t))))));var[a,l]=Xt(i,r,r);t=t.concat(l.filter((t=>s.includes(t)))),o.push(t),s=s.filter((e=>!t.includes(e))),r=r.filter((t=>!a.includes(t)))}while(l.length+a.length>0);return o.push(s),o}(s,a,n),c=l.flatMap(((e,n)=>e.map((e=>{let i=document.getElementById((0,J.id_in_svg)(t,(0,J.node_to_note_id)(e))),[o,r]=(0,J.note_coords)(i);return[e,[o,0-500*n]]})))),u={};c.forEach((([t,n])=>{let i,s=e<100?50:e/2,a=s<100?200:s>200?400:2*s,l=(0,J.node_to_note_id)(t),c=u[n],d=[n[0]+s+10,n[1]+s+25-a];if(c)i=c.getElementsByTagName("text")[0];else{c=(0,J.g)();let t=(0,J.circle)(n,s);c.appendChild(t),c.id="hier"+o+l,i=(0,J.text)("",d),i.style.fontFamiy="sans-serif",i.style.fontSize=a+"px",i.classList.add("nodetext"),c.appendChild(i),r.appendChild(c),u[n]=c}let h=(0,J.tspan)((0,J.note_to_text)(l),d,a);i.appendChild(h)})),a.forEach((t=>{let n=o+t.getAttribute("xml:id"),i=(0,J.relation_type)(t),s=document.getElementById(n),a=(0,J.relation_allnodes)((0,z.ro)(),t).map((t=>c.find((e=>e[0]==t))[1])),l=(0,J.roundedHull)(a,e);l.setAttribute("id","hier"+n),""!=o&&l.setAttribute("oldid",r.getAttribute("xml:id")),l.classList.add("relation"),l.setAttribute("type",i),on()&&Be(l),l.onclick=function(t){ke(s,t.shiftKey)},l.onmouseover=function(t){s.classList.add("relationhover"),s.onmouseover()},l.onmouseout=function(t){s.classList.remove("relationhover"),s.onmouseout()},l.onwheel=t=>{var e=t.target;return(0,J.flip_to_bg)(e),l.onmouseout(),!1},r.appendChild(l)})),(0,J.add_to_svg_bg)(i,r),Qe(t,500*l.length)}function Gt(t,e,n){0!=t.children.length?(t.children.forEach((t=>Gt(t,e,n))),t.y=n+t.children.map((t=>t.y)).reduce(((t,e)=>t>e?t:e))):t.y=e}function Zt(t,e,n){0!=t.children.length&&(Math.abs(e-t.y)>n&&(t.y+=(e-n-t.y)/2),t.children.forEach((e=>Zt(e,t.y,n))))}function Jt(t){return 0==t.children.length?[t]:t.children.flatMap(Jt)}function te(t){t.children.forEach(te),0!=t.children.length&&null==t.x&&(t.x=(0,J.average)(t.children.map((t=>t.x))))}function ee(t,e=0,n=-500){te(t),Gt(t,e,n),Zt(t,t.y,n)}function ne(t,e=100){var n=(0,J.g)(),i=(0,J.text)(t.label,[t.x,t.y+(0==t.children.length?e:0)]);i.style.fontFamiy="sans-serif",i.style.fontSize=e+"px",i.style.textAnchor="middle",i.classList.add("nodetext");var o=t.children.map((e=>(0,J.line)([t.x,t.y],[e.x,e.y]))),r=t.children.flatMap((t=>ne(t,e)));return o.forEach((t=>n.appendChild(t))),r.forEach((t=>n.appendChild(t))),n.appendChild(i),n}function ie(t,e=25){var n=t.getBBox(),i=(0,J.rect)([n.x-e,n.y-e],n.width+e,n.height+e);t.parentNode.insertBefore(i,t)}function oe(t){var e,n,i=mei.createElement("label");if(i.append(t.label),console.log(t.note_id),t.note_id){var o=mei.createElement("note");o.setAttribute("sameas","#"+t.note_id),i.appendChild(o)}return 0==t.children.length?e=mei.createElement("eLeaf"):(e=mei.createElement("eTree"),n=t.children.map(oe)),e.appendChild(i),n&&n.forEach((t=>e.appendChild(t))),e}function re(t){var e=t.children[0],n={label:e.textContent};0!=e.children.length&&(n.note_id=e.querySelector("note").getAttribute("sameas").replace("#",""));var i=Array.from(t.children);return i.shift(),n.children=i.map(re),n}function se(t,e){e.note_id&&(e.x=(0,J.note_coords)((0,J.get_by_id)(document,(0,J.id_in_svg)(t,e.note_id)))[0]),e.children.forEach((e=>se(t,e)))}function ae(t){var e=mei.querySelector("eTree");if(e){var n=function(t){return re(t)}(e),i=JSON.stringify(n);document.getElementById(t.id_prefix+"treeinput").value=i}else console.log("No tree to load")}function le(t){var e=document.getElementById(t.id_prefix+"treeinput");if(""!=e.value){var n=e.value,i=JSON.parse(n);if(i)return i;console.log("Failed to parse tree.")}else console.log("No tree to be parsed")}function ce(t){var e=le(t);if(e){var n=document.getElementById(t.id_prefix+"treeinput"),o=selected.concat(extraselected);0==selected.length?o=Array.from(t.svg_elem.getElementsByClassName("note")):1==selected.length?selected[0].classList.contains("relation")&&(o=relation_get_notes(selected[0]).map((e=>(0,J.get_by_id)(document,(0,J.id_in_svg)(t,e.getAttribute("xml:id")))))):selected[0].classList.contains("metarelation")||selected.length;var r=o.map((t=>[(0,J.note_coords)(t)[0],t]));r.sort(((t,e)=>t[0]-e[0]));var s=Jt(e);if(s.length==r.length){for(i in s)s[i].x=r[i][0],s[i].note_id=r[i][1].id;var a=JSON.stringify(e);n.value=a,t.svg_elem.getRootNode().getElementById("tree"+t.id_prefix)&&ue(t)}else console.log("Wrong length of list, expected "+s.length+" got "+r.length)}}function ue(t,e=0,n=-1e3){var i=t.svg_elem,o=t.id_prefix,r=(Ke(t),le(t));if((r||(console.log("No tree in input, attempting to load from XML"),ae(t),r=le(t)))&&(function(t){return Jt(t)[0].hasOwnProperty("note_id")}(r)||(console.log("Tree not aligned, attempting to align to selection"),ce(t),r=le(t)))){(function(t){return Jt(t)[0].hasOwnProperty("x")})(r)||se(t,r),ee(r,e,n);var s=ne(r);s.id="tree"+o,(0,J.add_to_svg_bg)(i,s),Array.from(s.getElementsByTagName("text")).forEach(ie),adjust_top(t,-r.y)}}var de,he,pe,fe=n(506),ge=n(504),me=n(898),ye=!1,ve=!1,be=!1,_e="";const xe=()=>he,we=()=>pe;var Ee,Se=null,Te=!0;function ke(t,e){console.debug("Using globals: selected, extraselected for adding/removing selected items. JQuery for changing displayed text of selected items");var n=(0,J.get_class_from_classlist)(t),i=t.closest("div");if(selected.length>0||extraselected.length>0){var o=(0,J.get_class_from_classlist)(selected.concat(extraselected)[0]),r=selected.concat(extraselected)[0].closest("div");if(n!=o)return;if(i!=r)return}"note"==n?selected.find((e=>e===t))||extraselected.find((e=>e===t))?(t.classList.remove("selectednote"),t.classList.remove("extraselectednote"),selected=selected.filter((e=>e!==t)),extraselected=extraselected.filter((e=>e!==t))):e?(t.classList.add("extraselectednote"),extraselected.push(t),Se=t):(t.classList.add("selectednote"),selected.push(t),Se=t):"relation"!=n&&"metarelation"!=n||(0==selected.concat(extraselected).length&&Ie(!0),selected.find((e=>e===t))||extraselected.find((e=>e===t))?(t.classList.remove("extraselectedrelation"),t.classList.remove("selectedrelation"),selected=selected.filter((e=>e!==t)),extraselected=extraselected.filter((e=>e!==t))):e?(t.classList.add("extraselectedrelation"),extraselected.push(t),Se=t):(t.classList.add("selectedrelation"),selected.push(t),Se=t),0==selected.concat(extraselected).length&&(Ie(!1),Se=null)),document.dispatchEvent(new CustomEvent("scoreselection",{detail:{selected,extraselected}}))}function Ae(t){var e=Array.from(t.svg_elem.getElementsByClassName("relation")).filter((t=>!t.classList.contains("relation--filtered")));if(e.length>0){(0,J.get_class_from_classlist)(e[0]);var n=e[0].closest("div");if(selected.length>0||extraselected.length>0){var i=(0,J.get_class_from_classlist)(selected.concat(extraselected)[0]),o=selected.concat(extraselected)[0].closest("div");"relation"!=i&&Ve(),n!=o&&Ve()}e.forEach((t=>{t.classList.contains("selectedrelation")||ke(t)}))}}function Ce(t){!function(t){var e=document.createElement("div");e.id=t.id_prefix+"sidebardiv",e.classList.add("sidebar"),t.view_elem.prepend(e);var n=document.createElement("div");n.id=t.id_prefix+"filterdiv",n.classList.add("filterdiv"),n.innerHTML=`&#9776;&nbsp;L${t.layer_number}&nbsp;V${t.view_number}<br/></br>`,e.prepend(n);var i=document.createElement("div");i.classList.add("zoom_buttons");var o=(0,J.button)("+");o.classList.add("zoominbutton"),o.id=t.id_prefix+"zoominbutton";var r=(0,J.button)("");r.classList.add("zoomoutbutton"),r.id=t.id_prefix+"zoomoutbutton",o.onclick=()=>{Ue(t)},r.onclick=()=>{qe(t)},i.appendChild(o),i.appendChild(r),n.appendChild(i)}(t);var e=t,n=document.createElement("div");n.classList.add("view_buttons"),n.id=t.id_prefix+"view_buttons";var i=(0,J.button)("Create new layer");i.classList.add("newlayerbutton"),i.id=t.id_prefix+"newlayerbutton";var o=(0,J.checkbox)("Sliced");o.id=t.id_prefix+"slicedcb",o.checked=!1;var r=(0,J.checkbox)("Tied");r.id=t.id_prefix+"tiedcb",r.checked=!1;var s=(0,J.button)("Reduce");s.classList.add("reducebutton"),s.id=t.id_prefix+"reducebutton";var a=(0,J.button)("Unreduce");a.classList.add("unreducebutton"),a.id=t.id_prefix+"unreducebutton";var l=(0,J.button)("Play reduction");l.classList.add("midireducebutton"),l.id=t.id_prefix+"midireducebutton";var c=(0,J.button)("Show/update hierarchy");c.classList.add("hierarchybutton"),c.id=t.id_prefix+"hierarchybutton";var u=(0,J.button)("Hide tree/hierarchy");u.classList.add("hidetopbutton"),u.id=t.id_prefix+"hidetopbutton";var d=(0,J.checkbox)("Roots low");d.id=t.id_prefix+"hierarchycb",d.checked=!0;var h=(0,J.checkbox)("Save layer");h.id=t.id_prefix+"savecb",h.checked=!1;var p=(0,J.checkbox)("Edit layer");p.id=t.id_prefix+"editcb",p.checked=!1,a.onclick=()=>{!function(t){console.log("Using globals: selected/extraselected");var e=t.reductions;if(0!=e.length){selected.forEach(ke),extraselected.forEach((t=>{ke(t,!0)}));var[n,i,o,r]=e.pop(),[s,a,l]=i;l.flat().forEach((t=>{t&&t.classList.remove("hidden")})),o.forEach((t=>{ke(t)})),r.forEach((t=>{ke(t,!0)}))}else console.log("Nothing to unreduce")}(e)},s.onclick=()=>{Kt(e)},i.onclick=()=>{(0,z.Jt)(e,o.checked,r.checked)},l.onclick=()=>{Wt.player.loadSound(function(t=null){t||(t=(0,z.kg)()[0]);var e=(0,z.DR)(),n=(0,z.xM)(!0,t),i=(new XMLSerializer).serializeToString(n);e.loadData(i);const o=e.renderToMIDI();var r=(0,z.Yu)();return e.loadData(r),o}(e),e.id_prefix),Wt.player.play()},c.onclick=()=>{Qt(e,50,d.checked)},u.onclick=()=>{!function(t){var e=t.svg_elem;t.id_prefix,Ke(t)&&(e.getElementsByClassName("definition-scale")[0].setAttribute("viewBox",t.old_viewbox),e.children[0].setAttribute("height",t.old_height))}(e)},n.appendChild(document.createTextNode("")),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(h);var f=document.createElement("label");f.htmlFor=t.id_prefix+"savecb",f.appendChild(document.createTextNode("Save layer")),n.append(f),n.appendChild(p);var g=document.createElement("label");g.htmlFor=t.id_prefix+"editcb",g.appendChild(document.createTextNode("Edit layer")),n.append(g),n.appendChild(document.createElement("br")),""==t.id_prefix?(h.checked=!0,h.disabled=!0,p.checked=!1,p.disabled=!0):(h.checked=!0,p.checked=!0),n.appendChild(a),n.appendChild(document.createElement("br")),n.appendChild(s),n.appendChild(document.createElement("br")),n.appendChild(i),n.appendChild(document.createElement("br")),n.appendChild(o);var m=document.createElement("label");m.htmlFor=t.id_prefix+"slicedcb",m.appendChild(document.createTextNode("Sliced")),n.append(m),n.appendChild(r);var y=document.createElement("label");y.htmlFor=t.id_prefix+"tiedcb",y.appendChild(document.createTextNode("Tied")),n.append(y),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(l),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(c),n.appendChild(document.createElement("br")),n.appendChild(d);var v=document.createElement("label");v.htmlFor=t.id_prefix+"hierarchycb",v.appendChild(document.createTextNode("Draw roots low")),n.append(v),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(u),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br"));var b=document.createElement("textarea");b.id=t.id_prefix+"treeinput",b.width="100px";var _=(0,J.button)("Load tree");_.id=t.id_prefix+"treebutton",_.onclick=()=>{ae(e)};var x=(0,J.button)("Save tree");x.id=t.id_prefix+"treebutton",x.onclick=()=>{!function(t){var e,n,i=le(t);i&&(e=oe(i),(n=(0,z.ro)().parentNode).querySelector("eTree")&&n.removeChild(n.querySelector("eTree")),n.appendChild(e))}(e)};var w=(0,J.button)("Draw tree: ");w.id=t.id_prefix+"treebutton",w.onclick=()=>{ue(e)};var E=(0,J.button)("Align tree to selection");E.id=t.id_prefix+"treebutton",E.onclick=()=>{ce(e)},b.onfocus=Pe,b.onblur=Re,n.appendChild(w),n.appendChild(document.createElement("br")),n.appendChild(b),n.appendChild(document.createElement("br")),n.appendChild(E),n.appendChild(document.createElement("br")),n.appendChild(_),n.appendChild(x),t.view_elem.children[0].appendChild(n)}function Ne(t){"Control"==t.key&&(0,fe.xy)(),"Shift"===t.key&&$("#layers").addClass("shift-pressed")}function De(t){"Control"==t.key&&(0,fe.Kd)(),"Shift"===t.key&&$("#layers").removeClass("shift-pressed")}function Me(t){(0,fe.r4)()}function je(t){if(console.debug("Using globals: text_input, meta_keys, type_keys"),!ve)if("Enter"==t.key);else if(t.key==action_conf.move_relation_to_front){var e=document.elementFromPoint(he,pe);"circle"==e.tagName&&(e=e.closest("g")),(0,J.flip_to_bg)(e),e.onmouseout&&e.onmouseout()}else t.key==action_conf.undo?(0,qt.FB)():t.key==action_conf.redo?(0,qt.VJ)():t.key==action_conf.reduce_relations?Kt(de):t.key==action_conf.show_hide_notation?Le():t.key==action_conf.toggle_type_shades?ze():t.key==action_conf.select_same_notes?(select_samenote(),(0,z.i9)("repeat")):t.key==action_conf.naturalize_note?(0,me.naturalize_notes)():t.key==action_conf.toggle_add_note?(0,fe.M_)():t.key==navigation_conf.zoom_out?qe(de):t.key==navigation_conf.zoom_in?Ue(de):t.key==navigation_conf.jump_to_next_bookmark?tn(-1):t.key==navigation_conf.jump_to_previous_bookmark?tn(1):t.key==navigation_conf.jump_to_context_below?en(1):t.key==navigation_conf.jump_to_context_above?en(-1):t.key==action_conf.deselect_all?Ve():t.key==action_conf.delete_all?(0,ge.x)():t.key==action_conf.add_bookmark?Je():t.key==custom_conf.relation||t.key==custom_conf.meta_relation?(t.preventDefault(),$("#relations_panel").hasClass("collapsed")&&He()):$t.type_keys[t.key]?(0,z.i9)($t.type_keys[t.key]):$t.meta_keys[t.key]?(0,z.qG)($t.meta_keys[t.key]):$t.combo_keys[t.key]?(0,z.lk)($t.combo_keys[t.key]):t.key==navigation_conf.toggle_palette?He():console.log(t)}function Ie(t){console.debug("Using globals: document for changing button texts/visibility"),t?document.getElementById("meta_buttons").classList.remove("none"):document.getElementById("meta_buttons").classList.add("none")}function Le(){var t;console.debug("Using globals: non_notes_hidden"),t=ye=!ye,console.debug("Using globals: document for element selection"),Array.from(document.getElementsByClassName("beam")).forEach((e=>{Array.from(e.children).forEach((e=>{"polygon"==e.tagName&&(t?e.classList.add("hidden"):e.classList.remove("hidden"))}))})),$t.hide_classes.forEach((e=>{Array.from(document.getElementsByClassName(e)).forEach((e=>{t?e.classList.add("hidden"):e.classList.remove("hidden")}))})),ye||nn()}function Be(t){console.debug("Using globals: shades, type_shades, meta_shades, type_synonym"),!be&&t.getAttribute("old_fill")?(t.setAttribute("fill",t.getAttribute("old_fill")),t.removeAttribute("old_fill")):be&&$t.type_shades[t.getAttribute("type")]?(t.setAttribute("old_fill",t.getAttribute("fill")),t.setAttribute("fill",$t.type_shades[t.getAttribute("type")])):be&&$t.meta_shades[t.getAttribute("type")]?(t.setAttribute("old_fill",t.getAttribute("fill")),t.setAttribute("fill",$t.meta_shades[t.getAttribute("type")])):be&&$t.type_synonym[t.getAttribute("type")]&&(t.setAttribute("old_fill",t.getAttribute("fill")),t.setAttribute("fill",$t.type_shades[$t.type_synonym[t.getAttribute("type")]]))}function Oe(t){console.debug("Using globals: shades, button_shades"),t.style.color=be?$t.button_shades[t.getAttribute("id")]:""}function ze(){console.debug("Using globals: shades, document for element selection"),be=!be,Array.from(document.getElementsByClassName("relation")).forEach(Be),Array.from(document.getElementsByClassName("metarelation")).forEach(Be),Array.from(document.getElementsByClassName("relationbutton")).forEach(Oe),Array.from(document.getElementsByClassName("metarelationbutton")).forEach(Oe)}function Pe(){ve=!0}function Re(){ve=!1}function He(){$("#relations_panel").hasClass("collapsed")?($("#relations_panel").removeClass("collapsed"),$("#relations_panel input").removeClass("none")):($("#relations_panel").addClass("collapsed"),$("#relations_panel input").addClass("none"))}function Ue(t){void 0!==t&&(t.zoom=1.1*t.zoom,t.svg_elem.style.transform="scale("+t.zoom+")")}function qe(t){void 0!==t&&(t.zoom=.9090909090909*t.zoom,t.svg_elem.style.transform="scale("+t.zoom+")")}function Ve(){selected.forEach((t=>ke(t))),extraselected.forEach((t=>ke(t,!0)))}function We(){var t=(0,z.ro)(),e=(0,z.kg)();Ve(),$(".relation").remove(),$(".metarelation").remove();var n=Array.from(t.getElementsByTagName("node")),i=n.filter((t=>"relation"==t.getAttribute("type")));n.filter((t=>"metarelation"==t.getAttribute("type"))),e.forEach((e=>{i.forEach((n=>{(0,J.unmark_secondaries)(e,t,n)}))})),e.hullPadding=$("#hull_controller").val(),e.forEach((t=>(0,z.lC)(t))),e.forEach((t=>{t.svg_elem.getRootNode().getElementById("hier"+t.id_prefix)&&Qt(t)}))}function Ye(t){var e=0,n=0,i=0,o=0;function r(r){(r=r||window.event).preventDefault(),e=i-r.clientX,n=o-r.clientY,i=r.clientX,o=r.clientY,i>=0&&o>=0&&(t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-e+"px")}function s(){document.onmouseup=null,document.onmousemove=null,"undefined"!=typeof drag_selector&&drag_selector.start()}t.onmousedown=function(t){"INPUT"!==t.target.tagName&&((t=t||window.event).preventDefault(),i=t.clientX,o=t.clientY,document.onmouseup=s,document.onmousemove=r,"undefined"!=typeof drag_selector&&drag_selector.stop())}}function Fe(t){window.drag_selector=new(a())({selectables:document.getElementsByClassName("relation"),area:$("#layers")[0],draggability:!1,overflowTolerance:{x:1,y:1},autoScrollSpeed:1e-4}),drag_selector.subscribe("dragstart",(({items:t,event:e,isDragging:n})=>{$(".ds-selector-area").show()})),drag_selector.subscribe("dragmove",(({items:t,event:e,isDragging:n})=>{""!=_e||document.getElementById("minimap").classList.contains("dragging")||(($(".ds-selector").height()>10||$(".ds-selector").width()>10&&"hull_controller"!=document.activeElement.id)&&($("#load_save, #metadata_input, #relations_panel, .sidebar, #minimap").fadeOut(300),document.getElementById("layers").style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjJwdCIgaGVpZ2h0PSIyMnB0IiB2aWV3Qm94PSIwIDAgMjIgMjIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjQ0OTIxOSAxNC44MDA3ODEgQyA0LjI2OTUzMSAxNC42MjEwOTQgMy45ODA0NjkgMTQuNjIxMDk0IDMuODAwNzgxIDE0LjgwMDc4MSBDIDMuNjIxMDk0IDE0Ljk4MDQ2OSAzLjYyMTA5NCAxNS4yNjk1MzEgMy44MDA3ODEgMTUuNDQ5MjE5IEMgNS43Njk1MzEgMTcuNDE3OTY5IDUuNzY5NTMxIDE5LjI1IDMuODAwNzgxIDIxLjIxODc1IEMgMy42MjEwOTQgMjEuMzk4NDM4IDMuNjIxMDk0IDIxLjY4NzUgMy44MDA3ODEgMjEuODY3MTg4IEMgMy44OTA2MjUgMjEuOTU3MDMxIDQuMDA3ODEyIDIyIDQuMTI1IDIyIEMgNC4yNDIxODggMjIgNC4zNTkzNzUgMjEuOTU3MDMxIDQuNDQ5MjE5IDIxLjg2NzE4OCBDIDYuNzU3ODEyIDE5LjU1NDY4OCA2Ljc1NzgxMiAxNy4xMTMyODEgNC40NDkyMTkgMTQuODAwNzgxIFogTSA0LjQ0OTIxOSAxNC44MDA3ODEgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjEyNSAxMS45MTc5NjkgQyAzLjExMzI4MSAxMS45MTc5NjkgMi4yOTI5NjkgMTIuNzM4MjgxIDIuMjkyOTY5IDEzLjc1IEMgMi4yOTI5NjkgMTQuNzYxNzE5IDMuMTEzMjgxIDE1LjU4MjAzMSA0LjEyNSAxNS41ODIwMzEgQyA1LjEzNjcxOSAxNS41ODIwMzEgNS45NTcwMzEgMTQuNzYxNzE5IDUuOTU3MDMxIDEzLjc1IEMgNS45NTcwMzEgMTIuNzM4MjgxIDUuMTM2NzE5IDExLjkxNzk2OSA0LjEyNSAxMS45MTc5NjkgWiBNIDQuMTI1IDE0LjY2Nzk2OSBDIDMuNjIxMDk0IDE0LjY2Nzk2OSAzLjIwNzAzMSAxNC4yNTM5MDYgMy4yMDcwMzEgMTMuNzUgQyAzLjIwNzAzMSAxMy4yNDYwOTQgMy42MjEwOTQgMTIuODMyMDMxIDQuMTI1IDEyLjgzMjAzMSBDIDQuNjI4OTA2IDEyLjgzMjAzMSA1LjA0Mjk2OSAxMy4yNDYwOTQgNS4wNDI5NjkgMTMuNzUgQyA1LjA0Mjk2OSAxNC4yNTM5MDYgNC42Mjg5MDYgMTQuNjY3OTY5IDQuMTI1IDE0LjY2Nzk2OSBaIE0gNC4xMjUgMTQuNjY3OTY5ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDAlLDAlLDAlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMjEuNzY1NjI1IDEzLjgwODU5NCBMIDEzLjUxNTYyNSA5LjIyMjY1NiBDIDEzLjM0Mzc1IDkuMTI4OTA2IDEzLjEzNjcxOSA5LjE1MjM0NCAxMi45ODgyODEgOS4yODEyNSBDIDEyLjg0Mzc1IDkuNDEwMTU2IDEyLjc5Mjk2OSA5LjYxMzI4MSAxMi44NjcxODggOS43OTY4NzUgTCAxNi41MzEyNSAxOC45NjA5MzggQyAxNi42MDE1NjIgMTkuMTMyODEyIDE2Ljc2OTUzMSAxOS4yNSAxNi45NTMxMjUgMTkuMjUgQyAxNi45NTMxMjUgMTkuMjUgMTYuOTU3MDMxIDE5LjI1IDE2Ljk1NzAzMSAxOS4yNSBDIDE3LjE0MDYyNSAxOS4yNSAxNy4zMDg1OTQgMTkuMTQwNjI1IDE3LjM3ODkwNiAxOC45NzI2NTYgTCAxOC42ODM1OTQgMTUuOTMzNTk0IEwgMjEuNzIyNjU2IDE0LjYyODkwNiBDIDIxLjg4MjgxMiAxNC41NjI1IDIxLjk4ODI4MSAxNC40MDYyNSAyMiAxNC4yMzA0NjkgQyAyMi4wMDc4MTIgMTQuMDU4NTk0IDIxLjkxNzk2OSAxMy44OTQ1MzEgMjEuNzY1NjI1IDEzLjgwODU5NCBaIE0gMjEuNzY1NjI1IDEzLjgwODU5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYigwJSwwJSwwJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDUuNjY0MDYyIDEyLjc2NTYyNSBDIDUuNTc4MTI1IDEyLjYyODkwNiA1LjQ3MjY1NiAxMi41MDc4MTIgNS4zNTU0NjkgMTIuNDAyMzQ0IEMgNS4zMzk4NDQgMTIuMzg2NzE5IDUuMzI0MjE5IDEyLjM3NSA1LjMwODU5NCAxMi4zNjMyODEgQyA1LjIxMDkzOCAxMi4yNzczNDQgNS4xMDU0NjkgMTIuMjA3MDMxIDQuOTkyMTg4IDEyLjE0NDUzMSBDIDQuOTYwOTM4IDEyLjEyODkwNiA0LjkyOTY4OCAxMi4xMDkzNzUgNC44OTg0MzggMTIuMDkzNzUgQyA0Ljc3MzQzOCAxMi4wMzUxNTYgNC42NDQ1MzEgMTEuOTg4MjgxIDQuNTA3ODEyIDExLjk1NzAzMSBDIDQuNDY4NzUgMTEuOTQ5MjE5IDQuNDI1NzgxIDExLjk0OTIxOSA0LjM4MjgxMiAxMS45NDE0MDYgQyA0LjI2OTUzMSAxMS45MjU3ODEgNC4xNTIzNDQgMTEuOTE3OTY5IDQuMDM5MDYyIDExLjkyNTc4MSBDIDMuNjMyODEyIDExLjk0NTMxMiAzLjI2NTYyNSAxMi4wOTc2NTYgMi45Njg3NSAxMi4zMzU5MzggQyAzLjE5MTQwNiAxMi40OTYwOTQgMy40MTQwNjIgMTIuNjQ4NDM4IDMuNjU2MjUgMTIuNzkyOTY5IEMgMy43NSAxMi44NDc2NTYgMy44NTkzNzUgMTIuODY3MTg4IDMuOTY4NzUgMTIuODUxNTYyIEMgNC4zNDc2NTYgMTIuNzg1MTU2IDQuNzUzOTA2IDEyLjk3NjU2MiA0LjkzNzUgMTMuMzM1OTM4IEMgNC45ODgyODEgMTMuNDMzNTk0IDUuMDcwMzEyIDEzLjUxMTcxOSA1LjE2Nzk2OSAxMy41NTA3ODEgQyA1LjQyMTg3NSAxMy42NTYyNSA1LjY4NzUgMTMuNzM4MjgxIDUuOTQ5MjE5IDEzLjgyODEyNSBDIDUuOTQ5MjE5IDEzLjgwMDc4MSA1Ljk1NzAzMSAxMy43NzczNDQgNS45NTcwMzEgMTMuNzUgQyA1Ljk1NzAzMSAxMy4zODY3MTkgNS44NDc2NTYgMTMuMDUwNzgxIDUuNjY0MDYyIDEyLjc2NTYyNSBaIE0gNS42NjQwNjIgMTIuNzY1NjI1ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDAlLDAlLDAlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMTMuMzgyODEyIDEzLjU1ODU5NCBDIDExLjE5MTQwNiAxMy44OTg0MzggOC44NTkzNzUgMTMuNzUgNi44MDQ2ODggMTMuMTUyMzQ0IEMgNi44NDc2NTYgMTMuMzQzNzUgNi44NzUgMTMuNTQyOTY5IDYuODc1IDEzLjc1IEMgNi44NzUgMTMuODcxMDk0IDYuODU1NDY5IDEzLjk4ODI4MSA2LjgzOTg0NCAxNC4xMDkzNzUgQyA4LjE1NjI1IDE0LjQ2ODc1IDkuNTY2NDA2IDE0LjY2Nzk2OSAxMSAxNC42Njc5NjkgQyAxMS45MjU3ODEgMTQuNjY3OTY5IDEyLjgzOTg0NCAxNC41ODIwMzEgMTMuNzM0Mzc1IDE0LjQyOTY4OCBaIE0gMTMuMzgyODEyIDEzLjU1ODU5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYigwJSwwJSwwJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDExIDAgQyA0LjkzMzU5NCAwIDAgMy4yODkwNjIgMCA3LjMzMjAzMSBDIDAgOC45NDE0MDYgMC44MDQ2ODggMTAuNDkyMTg4IDIuMjM4MjgxIDExLjc1NzgxMiBDIDIuNDY4NzUgMTEuNTM5MDYyIDIuNzM4MjgxIDExLjM1NTQ2OSAzLjAzNTE1NiAxMS4yMjY1NjIgQyAxLjY3OTY4OCAxMC4xMDkzNzUgMC45MTc5NjkgOC43MzgyODEgMC45MTc5NjkgNy4zMzIwMzEgQyAwLjkxNzk2OSAzLjc5Njg3NSA1LjQ0MTQwNiAwLjkxNzk2OSAxMSAwLjkxNzk2OSBDIDE2LjU1ODU5NCAwLjkxNzk2OSAyMS4wODIwMzEgMy43OTY4NzUgMjEuMDgyMDMxIDcuMzMyMDMxIEMgMjEuMDgyMDMxIDguNzUzOTA2IDIwLjM0Mzc1IDEwLjEwMTU2MiAxOC45ODgyODEgMTEuMjE4NzUgTCAxOS44Mzk4NDQgMTEuNjg3NSBDIDIxLjIyNjU2MiAxMC40Mzc1IDIyIDguOTEwMTU2IDIyIDcuMzMyMDMxIEMgMjIgMy4yODkwNjIgMTcuMDY2NDA2IDAgMTEgMCBaIE0gMTEgMCAiLz4KPC9nPgo8L3N2Zz4K), auto"),document.elementsFromPoint(he,pe).map((t=>{switch(t.tagName){case"path":return t;case"use":return t.parentElement.parentElement;case"circle":return t.parentElement;default:return!1}})).filter((t=>{if(void 0===t||void 0===t.classList)return!1;var n=e.shiftKey;return t.classList.contains("relation")&&!t.classList.contains("relation--filtered")&&!t.classList.contains("selectedrelation")&&!t.classList.contains("extraselectedrelation")&&!n||t.classList.contains("note")&&!t.classList.contains("selectednote")&&!t.classList.contains("extraselectednote")||t.classList.contains("metarelation")&&!t.classList.contains("selectedrelation")&&!t.classList.contains("extraselectedrelation")&&!n})).forEach((t=>ke(t))))})),drag_selector.subscribe("callback",(({items:t,event:e,isDragging:n})=>{document.getElementById("layers").style.cursor="default",$(".ds-selector-area").hide(),$("#load_save, #metadata_input, #relations_panel, .sidebar, #minimap").fadeIn(300)}))}function $e(){if(null!=he){var t=[document.elementFromPoint(he,pe)].map((t=>{if(t)switch(t.tagName){case"path":return t;case"use":return t.parentElement.parentElement;case"circle":return t.parentElement;default:return!1}})).filter((t=>void 0!==t&&void 0!==t.classList&&(t.classList.contains("relation")&&!t.classList.contains("relation--filtered")||t.classList.contains("metarelation"))))[0];(t=t?t.getAttribute("type"):"")?($(".jBox-Mouse").show(),Ee.setContent(t)):$(".jBox-Mouse").hide()}}function Xe(){void 0!==Ee&&Ee.destroy(),Ee=new(Ft())("Mouse",{attach:"#layers",trigger:"mouseenter",onPosition:$e})}function Ke(t){var e=t.svg_elem,n=t.id_prefix,i=e.getRootNode().getElementById("hier"+n);return(i||!!(i=e.getRootNode().getElementById("tree"+n)))&&(i.parentNode.removeChild(i),!0)}function Qe(t,e){var n,i,o,r,s=t.svg_elem,a=s.children[0].getAttribute("height"),l=s.getElementsByClassName("definition-scale")[0].getAttribute("viewBox");t.old_viewbox?([n,i,o,r]=t.old_viewbox.split(" "),a=t.old_height):([n,i,o,r]=l.split(" "),t.old_viewbox=l,t.old_height=a),s.getElementsByClassName("definition-scale")[0].setAttribute("viewBox",[n,Number(i)-e,o,Number(r)+e].join(" "));var c=Number(a.split("p")[0]);s.children[0].setAttribute("height",c*((r-(i-e))/(r-i))+"px")}function Ge(){document.getElementById("minimap").width=100,r()(document.querySelector("#minimap"),{viewport:null,styles:{".svg_container":"rgba(0,0,0,0.30)",".layer":"rgba(0,0,0,0.00)"},back:"rgba(0,0,0,0.30)",view:"rgba(0,0,0,0.20)",drag:"rgba(0,0,0,0.30)",interval:null})}window.onmousedown=t=>{var e=document.elementFromPoint(he,pe),n=(0,z.kg)().find((t=>t.view_elem.contains(e)));!navigation_conf.switch_context_on_hover&&n&&cn(n),(0,J.indicate_current_context)()},window.onmousemove=t=>{he=t.clientX,pe=t.clientY;var e=document.elementFromPoint(he,pe),n=(0,z.kg)().find((t=>t.view_elem.contains(e)));navigation_conf.switch_context_on_hover&&n&&cn(n),(0,J.indicate_current_context)(),""!=_e&&(0,fe.TU)()},document.getElementById("equalizebutton").addEventListener("click",Le),document.getElementById("shadesbutton").addEventListener("click",ze),document.getElementById("relations_panel_toggle").addEventListener("click",He);var Ze=[];function Je(){if(!Se)return!1;if(!Se.classList.contains("note"))return!1;var t=Se,e=document.createElementNS("http://www.w3.org/2000/svg","rect"),n=de.id_prefix?de.id_prefix:"0";e.dataset.draw_context=n,e.classList.add("bookmark"),e.setAttribute("fill","red"),e.setAttribute("width","500px"),e.setAttribute("height","1500px"),e.setAttribute("transform","translate(-120 -750)"),e.setAttribute("x",t.children[0].children[0].getAttribute("x")),e.setAttribute("y",t.children[0].children[0].getAttribute("y")),$(de.svg_elem).find(".page-margin")[0].prepend(e),Ze.push(e),Ze.sort((function(t,e){return t.getAttribute("x")-e.getAttribute("x")}))}function tn(t=1){var e=ln();if(e){var n=e.id_prefix?e.id_prefix:"0",i=Ze.filter((t=>t.dataset.draw_context==n)),o=i.map((t=>t.getBoundingClientRect().x)),r=o.findIndex((t=>t>=window.innerWidth)),s=o.filter((t=>t<=0)).length-1;if(1==t&&-1!=r)var a=i[r];else{if(-1!=t||-1==s)return!1;a=i[s]}a.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}}function en(t=1){var e,n=(0,z.kg)().sort(((t,e)=>t.view_elem.getBoundingClientRect().y-e.view_elem.getBoundingClientRect().y)),i=n.map((t=>t.view_elem.getBoundingClientRect().y)),o=n.map((t=>t.view_elem.getBoundingClientRect().bottom));if(1==t)e=o.findIndex((t=>t>window.innerHeight));else{if(-1!=t)return!1;e=i.filter((t=>t<0)).length-1}-1!=e&&n[e].view_elem.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}function nn(){Array.from(document.querySelectorAll("g.note")).forEach((t=>t.classList.remove("hidden")))}document.getElementById("addbookmarkbutton").addEventListener("click",Je),document.getElementById("previousbookmarkbutton").addEventListener("click",(()=>tn(-1))),document.getElementById("nextbookmarkbutton").addEventListener("click",(()=>tn(1))),document.getElementById("previouscontextbutton").addEventListener("click",(()=>en(-1))),document.getElementById("nextcontextbutton").addEventListener("click",(()=>en(1))),document.getElementById("orphannotesbutton").addEventListener("click",(function(){var t,e,n;(Te=!Te)?nn():(t=(0,z.ro)(),e=Array.from(document.getElementsByClassName("note")).map((t=>t.id)),n=Array.from(t.getElementsByTagName("arc")).map((t=>t.getAttribute("to"))),e.forEach((t=>{var e=t.replace(/(^\d+-?)/,"");n.includes(`#gn-${e}`)||document.getElementById(t).classList.add("hidden")})),ye||Le())}));const on=()=>be,rn=()=>Ee,sn=()=>_e,an=t=>_e=t,ln=()=>de,cn=t=>de=t},235:(t,e,n)=>{"use strict";n.d(e,{FB:()=>l,I$:()=>c,VJ:()=>u});var i=n(419),o=n(506),r=n(504),s=n(3),a=n(624);function l(){console.debug("Using globals: undo_actions, selected, extraselected, mei, rerendered_after_action");var t=(0,i.tu)();if(0==t.length)return void console.log("Nothing to undo");if(t.length==(0,i.jA)())return console.log("Cannot undo past a rerender"),void alert("Cannot undo past a rerender.");selected.forEach(s.dB),extraselected.forEach((t=>{(0,s.dB)(t,!0)}));var e=(0,i.kg)(),n=(0,i.LO)();const[o,r,l,c]=t.pop();if("edges"==o||"relation"==o||"metarelation"==o){var u=r;let t,d,h=u.flat().find((t=>"node"==t.tagName&&t.getAttribute("type")==o));if(!h)return void console.log("Could not find graph element of (meta)relation to undo: ",r);if(t=h.getAttribute("xml:id"),h.children.length>0&&(d=h.children[0].getAttribute("type")),"relation"==o)for(const t of e)(0,a.unmark_secondaries)(t,(0,i.ro)(),h);u.flat().forEach((t=>{(0,a.node_referred_to)(t.getAttribute("xml:id"))||t.parentNode.removeChild(t)})),Array.from(document.querySelectorAll('[oldid="'+t+'"]')).forEach((t=>t.parentNode.removeChild(t))),l.forEach((t=>{(0,s.dB)(document.getElementById(t.id))})),c.forEach((t=>{(0,s.dB)(document.getElementById(t.id),!0)})),n.push([o,[d,t],l,c])}else if("delete relation"==o)r.forEach((t=>{t[1].insertBefore(t[0],t[2]);let n=e.find((e=>e.svg_elem.contains(t[0]))),o="relation"==(0,a.get_class_from_classlist)(t[0]);if(n&&o){let e=(0,a.get_id)(t[0]),o=(0,a.get_by_id)(mei,e);(0,a.mark_secondaries)(n,(0,i.ro)(),o)}})),l.forEach((t=>{(0,s.dB)(t)})),c.forEach((t=>{(0,s.dB)(t,!0)})),n.push([o,[],l,c]);else if("change relation type"==o){var h=r;let t=r[0][1];l.concat(c).forEach((t=>{var[e,n]=h.pop(),i=(0,a.id_or_oldid)(t),o=[(0,a.get_by_id)(document,i)].concat((0,a.get_by_oldid)(document,i));o.forEach((t=>t.setAttribute("type",e))),(0,a.get_by_id)(mei,i).getElementsByTagName("label")[0].setAttribute("type",e),o.forEach(s.up)})),l.forEach((t=>{(0,s.dB)(t)})),c.forEach((t=>{(0,s.dB)(t,!0)})),n.push([o,t,l,c])}else if("add note"==o){var[p,f]=r;f.forEach((t=>t.parentNode.removeChild(t)));let t=p[0].getAttribute("pname"),e=p[0].getAttribute("oct"),i=p[0].getAttribute("xml:id"),s=l[0];if(p[0].parentNode.removeChild(p[0]),p.length>1){var g=p[1];g.parentNode.insertBefore(g.children[0],g),g.parentNode.removeChild(g)}n.push([o,[t,e,s,i],l,c])}(0,s.e6)(),d()}function c(){(0,i.Ln)([]),d()}function u(){var t=(0,i.LO)();if(0==t.length)return void console.log("Nothing to redo");selected.forEach(s.dB),extraselected.forEach((t=>{(0,s.dB)(t,!0)}));const[e,n,a,l]=t.pop();let c,u;switch(a.forEach((t=>(0,s.dB)(document.getElementById(t.id)))),l.forEach((t=>{(0,s.dB)(document.getElementById(t.id),!0)})),e){case"relation":[c,u]=n,(0,i.i9)(c,u,!0);break;case"metarelation":[c,u]=n,(0,i.qG)(c,u,!0);break;case"change relation type":c=n,(0,i.i9)(c,"",!0);break;case"delete relation":(0,r.x)(!0);break;case"add note":let[t,e,l,d]=n;(0,o.f5)(t,e,l,d,!0),(0,s.dB)(a[0])}d()}function d(){document.dispatchEvent(new CustomEvent("undoredo",{detail:{redoAbleCount:(0,i.LO)().length,undoAbleCount:(0,i.tu)().length}}))}},624:(t,e,n)=>{"use strict";n.r(e),n.d(e,{roundedHull:()=>h,line:()=>p,circle:()=>f,rect:()=>g,text:()=>m,tspan:()=>y,flip_to_bg:()=>v,add_to_svg_bg:()=>b,g:()=>_,random_id:()=>x,note_coords:()=>w,get_by_oldid:()=>E,get_by_id:()=>S,id_or_oldid:()=>T,get_id:()=>k,id_in_svg:()=>A,node_referred_to:()=>C,node_to_note_id:()=>N,mod:()=>D,average2:()=>M,relation_get_notes:()=>j,relation_get_notes_separated:()=>I,relation_allnodes:()=>L,relation_primaries:()=>B,relation_secondaries:()=>O,relation_type:()=>z,add_mei_node_for:()=>P,hide_note:()=>R,hide_note_hier:()=>H,hide_he:()=>U,hide_he_hier:()=>q,mark_secondaries:()=>V,unmark_secondaries:()=>W,get_class_from_classlist:()=>Y,get_metarelation_target:()=>F,average:()=>X,note_to_text:()=>K,to_text:()=>Q,fix_synonyms:()=>G,note_to_rest:()=>J,note_to_chord:()=>tt,prefix_ids:()=>et,clone_mei:()=>nt,get_id_pairs:()=>it,new_layer_element:()=>ot,new_view_elements:()=>rt,checkbox:()=>st,button:()=>at,indicate_current_context:()=>lt,sanitize_xml:()=>ct,check_for_duplicate_relations:()=>ut,draw_context_of:()=>dt});var i=n(617),o=n(419),r=n(36),s=n(3),a=function(t,e){return[t*e[0],t*e[1]]},l=function(t,e){return[t[0]+e[0],t[1]+e[1]]},c=function(t,e){var n=[t[1]-e[1],e[0]-t[0]],i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);return[n[0]/i,n[1]/i]},u=function(t,e){var n=[t[0][0],t[0][1]-e];return"M "+n+" A "+[e,e,"0,0,0",[t[0][0],parseInt(t[0][1])+parseInt(e)]].join(",")+" A "+[e,e,"0,0,0",n].join(",")},d=function(t,e){var n=a(e,c(t[0],t[1])),i=a(-1,n),o=l(t[0],n),r=l(t[1],n),s=l(t[1],i),u=l(t[0],i);return"M "+o+" L "+r+" A "+[e,e,"0,0,0",s].join(",")+" L "+u+" A "+[e,e,"0,0,0",o].join(",")};function h(t){var e=(0,o.kg)().hullPadding||200,n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("fill",function(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(4+8*Math.random())];return t}()),1==t.length?n.setAttribute("d",u(t,e)):2==t.length?n.setAttribute("d",d(t,e)):n.setAttribute("d",function(t,e){if(!t||t.length<1)return"";if(1===t.length)return u(t,e);if(2===t.length)return d(t,e);for(var n=new Array(t.length),i=0;i<n.length;++i){var o=0===i?t[t.length-1]:t[i-1],r=t[i],s=a(e,c(o,r));n[i]=[l(o,s),l(r,s)]}var h="A "+[e,e,"0,0,0,"].join(",");return(n=n.map((function(t,e){var i="";return 0===e&&(i="M "+n[n.length-1][1]+" "),i+(h+t[0]+" L ")+t[1]}))).join(" ")}((0,i.WFE)(t),e)),n}function p(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1",t[0]),n.setAttribute("y1",t[1]),n.setAttribute("x2",e[0]),n.setAttribute("y2",e[1]),n.style.stroke="#000",n.style.strokeWidth="15px",n}function f(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","circle");return n.setAttribute("cx",t[0]),n.setAttribute("cy",t[1]),n.setAttribute("r",e),n.style.stroke="#000",n.style.strokeWidth="15px",n}function g(t,e,n){var i=document.createElementNS("http://www.w3.org/2000/svg","rect");return i.setAttribute("x",t[0]),i.setAttribute("y",t[1]),i.setAttribute("width",e),i.setAttribute("height",n),i.style.stroke="#000",i.style.fill="white",i.style.strokeWidth="15px",i}function m(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","text");return e&&(n.setAttribute("x",e[0]),n.setAttribute("y",e[1])),n.append(t),n}function y(t,e,n,i=0){var o=document.createElementNS("http://www.w3.org/2000/svg","tspan");return o.setAttribute("x",e[0]),o.setAttribute("dx",i),o.setAttribute("dy",n),o.append(t),o}function v(t){var e=(0,s.gB)(),n=t.parentElement;n.removeChild(t),n.insertBefore(t,n.children[0]),e.close(),e.open()}function b(t,e){var n=t.getElementsByClassName("system")[0];n.parentNode.insertBefore(e,n)}function _(){return document.createElementNS("http://www.w3.org/2000/svg","g")}function x(t=5){return Math.floor(Math.random()*(1<<4*t)).toString(16)}function w(t){return[t.getElementsByTagName("use")[0].x.animVal.value+100,t.getElementsByTagName("use")[0].y.animVal.value]}function E(t,e){"#"==e[0]&&(e=e.slice(1));var n=t.querySelectorAll("[*|oldid='"+e+"']");return n?Array.from(n):Array.from(t.all).find((t=>t.getAttribute("oldid")==e))}function S(t,e){return e?("#"==e[0]&&(e=e.slice(1)),t.querySelector("[*|id='"+e+"']")||Array.from(t.getElementsByTagName("*")).find((t=>t.getAttribute("id")==e||t.getAttribute("xml:id")==e))):null}function T(t){return t.hasAttribute("oldid")?t.getAttribute("oldid"):t.id}function k(t){if(document.contains(t))return t.hasAttribute("oldid")?k(document.getElementById(t.getAttribute("oldid"))):t.id;if(t.hasAttribute("xml:id")){if(t.hasAttribute("sameas"))return k(S(mei,t.getAttribute("sameas")));if(t.hasAttribute("corresp"))return k(S(mei,t.getAttribute("corresp")));if(t.hasAttribute("copyof"))return k(S(mei,t.getAttribute("copyof")));if(t.hasAttribute("xml:id"))return t.getAttribute("xml:id")}}function A(t,e){if(e){"#"==e[0]&&(e=e.slice(1));var n=function(t,e){"#"==e[0]&&(e=e.slice(1));var n=t.id_mapping.find((t=>t[1]==e));return n?n[0]:void 0}(t.layer,e),i=document.getElementById(n);return t.svg_elem.contains(i)?n:n?t.id_prefix+n:void 0}}function C(t){return console.debug("Using global: mei to find element"),Array.from(mei.getElementsByTagName("arc")).filter((e=>e.getAttribute("from")=="#"+t||e.getAttribute("to")=="#"+t)).length>0}function N(t){return t.getElementsByTagName("label")[0].getElementsByTagName("note")[0].getAttribute("sameas").replace("#","")}function D(t,e){return(t%e+e)%e}function M(t,e){return(t+e)/2}function j(t){return L((0,o.ro)(),t=S(mei,k(t))).map(N).map((t=>S(mei,t)))}function I(t){var e=(0,o.ro)();return[B(e,t=S(mei,k(t))).map(N).map((t=>S(mei,t))),O(e,t).map(N).map((t=>S(mei,t)))]}function L(t,e){var n=Array.from(t.getElementsByTagName("arc")),i=[];return n.forEach((n=>{n.getAttribute("from")=="#"+e.getAttribute("xml:id")&&i.push(S(t.getRootNode(),n.getAttribute("to")))})),i}function B(t,e){var n=Array.from(t.getElementsByTagName("arc")),i=[];return n.forEach((n=>{n.getAttribute("from")=="#"+e.getAttribute("xml:id")&&"primary"==n.getAttribute("type")&&i.push(S(t.getRootNode(),n.getAttribute("to")))})),i}function O(t,e){var n=Array.from(t.getElementsByTagName("arc")),i=[];return n.forEach((n=>{n.getAttribute("from")=="#"+e.getAttribute("xml:id")&&"secondary"==n.getAttribute("type")&&i.push(S(t.getRootNode(),n.getAttribute("to")))})),i}function z(t){return 0==t.children.length?"":t.children[0].getAttribute("type")}function P(t,e){var n=k(e),i=k(S(mei,n)),o=S(t.getRootNode(),"gn-"+i);if(null!=o)return o;o=t.getRootNode().createElement("node");var r=t.getRootNode().createElement("label");return(e=t.getRootNode().createElement("note")).setAttribute("sameas","#"+i),o.appendChild(r),r.appendChild(e),o.setAttribute("xml:id","gn-"+i),t.appendChild(o),o}function R(t,e){var n=S(t.svg_elem.getRootNode(),A(t,N(e)));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function H(t,e){var n=S(t.svg_elem.getRootNode(),"hier"+A(t,N(e)));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function U(t,e){var n=S(t.svg_elem.getRootNode(),t.id_prefix+e.getAttribute("xml:id"));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function q(t,e){var n=S(t.svg_elem.getRootNode(),"hier"+t.id_prefix+e.getAttribute("xml:id"));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function V(t,e,n){t.svg_elem,"node"!=n.tagName&&(n=S(e.getRootNode(),n.id)),O(e,n).forEach((e=>{!function(t){if(t)if(t.classList.contains("secondarynote")){var e=getComputedStyle(t).getPropertyValue("--how-secondary");t.style.setProperty("--how-secondary",2*e)}else t.classList.add("secondarynote"),t.style.setProperty("--how-secondary",2);else console.log("Not a note")}(document.getElementById(A(t,N(e))))}))}function W(t,e,n){t.svg_elem,"node"!=n.tagName&&(n=S(e.getRootNode(),n.id)),O(e,n).forEach((e=>{!function(t){if(t){var e=getComputedStyle(t).getPropertyValue("--how-secondary");t.style.setProperty("--how-secondary",e/2),e/2==1&&t.classList.remove("secondarynote")}else console.log("Not a note")}(document.getElementById(A(t,N(e))))}))}function Y(t){if(void 0!==t){var e="";return t.classList.contains("note")?e="note":t.classList.contains("relation")?e="relation":t.classList.contains("metarelation")&&(e="metarelation"),e}return!1}function F(t){if(t.classList.contains("metarelation")){var e=t.getElementsByTagName("circle")[0];return[e.cx.baseVal.value,e.cy.baseVal.value]}return t.classList.contains("relation")?function(t){var e=t.getBBox();return[e.x+e.width/2,e.y+e.height/2]}(t):(console.log("wtf"),console.log(t),[0,0])}function X(t){return t.reduce(((t,e)=>t+e),0)/t.length}function K(t){var e=S(mei,t),n=function(t){if(console.debug("Using globals: document, mei to find element"),document.contains(t)&&(t=S(mei,k(t))),t.hasAttribute("accid.ges"))return t.getAttribute("accid.ges");if(t.hasAttribute("accid"))return t.getAttribute("accid");if(0==t.children.length)return"";var e=t.getElementsByTagName("accid");if(0==e.length)return"";var n=e[0];return n.hasAttribute("accid.ges")?n.getAttribute("accid.ges"):n.hasAttribute("accid")?n.getAttribute("accid"):""}(e);return n=(n=(n=n.replace(/s/g,"#")).replace(/f/g,"b")).replace(/n/g,""),e.getAttribute("pname")+n+e.getAttribute("oct")}function Q(t){return 0==t.length?"":t[0].classList.contains("note")?(t.sort(((t,e)=>{const[n,i]=w(t),[o,r]=w(e);return n-o==0?r-i:n-o})),t.map((t=>K(k(t))))):void 0}function G(t){return Array.from(t.getElementsByTagName("node")).forEach((t=>{"hyperedge"==t.getAttribute("type")&&t.setAttribute("type","relation"),"metaedge"==t.getAttribute("type")&&t.setAttribute("type","metarelation")})),t}var Z=["dur","n","dots","when","layer","staff","tstamp.ges","tstamp.real","tstamp","loc","dur.ges","dots.ges","dur.metrical","dur.ppq","dur.real","dur.recip","beam","fermata","tuplet"];function J(t,e){var n=t.createElementNS("http://www.music-encoding.org/ns/mei","rest");n.setAttribute("xml:id","rest-"+e.getAttribute("xml:id"));for(let t of Z)e.hasAttribute(t)&&n.setAttribute(t,e.getAttribute(t));return n}function tt(t,e){var n=t.createElementNS("http://www.music-encoding.org/ns/mei","chord");n.setAttribute("xml:id","chord-"+e.getAttribute("xml:id"));for(const t of Z)e.hasAttribute(t)&&n.setAttribute(t,e.getAttribute(t));return n}function et(t,e){t.id&&(t.setAttribute("oldid",t.id),t.id=e+t.id),t.getAttribute("xml:id")&&t.setAttribute("xml:id",e+t.getAttribute("xml:id")),t.getAttribute("startid")&&t.setAttribute("startid",e+t.getAttribute("startid")),t.getAttribute("endid")&&t.setAttribute("endid",e+t.getAttribute("endid")),Array.from(t.children).forEach((t=>et(t,e)))}function nt(t){var e=t.implementation.createDocument(t.namespaceURI,null,null),n=e.importNode(t.documentElement,!0);return e.appendChild(n),e}function it(t){var e;return t.id?e=[t.id,k(t)]:t.hasAttribute("xml:id")&&(e=[t.getAttribute("xml:id"),k(t)]),e?[e].concat(Array.from(t.children).flatMap(it)):Array.from(t.children).flatMap(it)}function ot(){var t=document.getElementById("layers"),e=document.createElement("div");return e.id="layer"+t.children.length,e.classList.add("layer"),t.appendChild(e),e}function rt(t){var e=(0,o.kg)(),n=document.createElement("div");n.id="view"+e.length,n.classList.add("view");var i=document.createElement("div");return i.id="svg"+e.length,i.classList.add("svg_container"),n.appendChild(i),t.appendChild(n),[n,i]}function st(t){var e=document.createElement("input");return e.setAttribute("type","checkbox"),e.setAttribute("value",t),e}function at(t){var e=document.createElement("input");return e.setAttribute("type","button"),e.setAttribute("value",t),e}function lt(){var t=(0,s.c)();void 0!==t&&($(".view").removeClass("view--active"),t.view_elem.classList.add("view--active"),$(".sidebar").removeClass("sidebar_active"),t.view_elem.children[0].classList.add("sidebar_active"))}function ct(t){var e=t;return r.strip_xml_tags.forEach((e=>{Array.from(t.getElementsByTagName(e)).forEach((t=>{t.parentNode.removeChild(t)}))})),e}function ut(t,e,n){var i=(0,o.ro)(),r=e.map((t=>t.getAttribute("id").replace(/(^\d+-?)/,"gn-"))).sort(((t,e)=>t<e)),s=n.map((t=>t.getAttribute("id").replace(/(^\d+-?)/,"gn-"))).sort(((t,e)=>t<e));return Array.from(i.querySelectorAll("[type='relation']")).filter((e=>e.children[0].getAttribute("type")==t)).forEach((t=>{var e=I(t),n=e[0],i=e[1];if(n=n.map((t=>t.getAttribute("xml:id"))).sort(((t,e)=>t<e)),i=i.map((t=>t.getAttribute("xml:id"))).sort(((t,e)=>t<e)),JSON.stringify(r)==JSON.stringify(n)&&JSON.stringify(s)==JSON.stringify(i))return alert("Warning: This relation already exists.\nCreating a duplicate anyway."),!1})),!0}function dt(t){var e=(0,o.kg)().filter((e=>e.svg_elem.contains(t)));return 0==e.length?null:e[0]}},617:(t,e,n)=>{"use strict";function i(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var o,r;n.d(e,{WFE:()=>Mn,K2I:()=>On}),1===(o=i).length&&(r=o,o=function(t,e){return i(r(t),e)});var s=Array.prototype;function a(){}function l(t){return null==t?a:function(){return this.querySelector(t)}}function c(){return[]}function u(t){return null==t?c:function(){return this.querySelectorAll(t)}}function d(t){return function(){return this.matches(t)}}function h(t){return new Array(t.length)}function p(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function f(t,e,n,i,o,r){for(var s,a=0,l=e.length,c=r.length;a<c;++a)(s=e[a])?(s.__data__=r[a],i[a]=s):n[a]=new p(t,r[a]);for(;a<l;++a)(s=e[a])&&(o[a]=s)}function g(t,e,n,i,o,r,s){var a,l,c,u={},d=e.length,h=r.length,f=new Array(d);for(a=0;a<d;++a)(l=e[a])&&(f[a]=c="$"+s.call(l,l.__data__,a,e),c in u?o[a]=l:u[c]=l);for(a=0;a<h;++a)(l=u[c="$"+s.call(t,r[a],a,r)])?(i[a]=l,l.__data__=r[a],u[c]=null):n[a]=new p(t,r[a]);for(a=0;a<d;++a)(l=e[a])&&u[f[a]]===l&&(o[a]=l)}function m(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}s.slice,s.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2),Array.prototype.slice,p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var y="http://www.w3.org/1999/xhtml";const v={svg:"http://www.w3.org/2000/svg",xhtml:y,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function b(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),v.hasOwnProperty(e)?{space:v[e],local:t}:t}function _(t){return function(){this.removeAttribute(t)}}function x(t){return function(){this.removeAttributeNS(t.space,t.local)}}function w(t,e){return function(){this.setAttribute(t,e)}}function E(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function S(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function T(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function k(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function A(t){return function(){this.style.removeProperty(t)}}function C(t,e,n){return function(){this.style.setProperty(t,e,n)}}function N(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function D(t,e){return t.style.getPropertyValue(e)||k(t).getComputedStyle(t,null).getPropertyValue(e)}function M(t){return function(){delete this[t]}}function j(t,e){return function(){this[t]=e}}function I(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function L(t){return t.trim().split(/^|\s+/)}function B(t){return t.classList||new O(t)}function O(t){this._node=t,this._names=L(t.getAttribute("class")||"")}function z(t,e){for(var n=B(t),i=-1,o=e.length;++i<o;)n.add(e[i])}function P(t,e){for(var n=B(t),i=-1,o=e.length;++i<o;)n.remove(e[i])}function R(t){return function(){z(this,t)}}function H(t){return function(){P(this,t)}}function U(t,e){return function(){(e.apply(this,arguments)?z:P)(this,t)}}function q(){this.textContent=""}function V(t){return function(){this.textContent=t}}function W(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Y(){this.innerHTML=""}function F(t){return function(){this.innerHTML=t}}function $(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function X(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===y&&e.documentElement.namespaceURI===y?e.createElement(t):e.createElementNS(n,t)}}function G(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Z(t){var e=b(t);return(e.local?G:Q)(e)}function J(){return null}function tt(){var t=this.parentNode;t&&t.removeChild(this)}function et(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function nt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}O.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var it={},ot=null;function rt(t,e,n){return t=st(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function st(t,e,n){return function(i){var o=ot;ot=i;try{t.call(this,this.__data__,e,n)}finally{ot=o}}}function at(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function lt(t){return function(){var e=this.__on;if(e){for(var n,i=0,o=-1,r=e.length;i<r;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?e.length=o:delete this.__on}}}function ct(t,e,n){var i=it.hasOwnProperty(t.type)?rt:st;return function(o,r,s){var a,l=this.__on,c=i(e,r,s);if(l)for(var u=0,d=l.length;u<d;++u)if((a=l[u]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=c,a.capture=n),void(a.value=e);this.addEventListener(t.type,c,n),a={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(a):this.__on=[a]}}function ut(t,e,n){var i=k(t),o=i.CustomEvent;"function"==typeof o?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function dt(t,e){return function(){return ut(this,t,e)}}function ht(t,e){return function(){return ut(this,t,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(it={mouseenter:"mouseover",mouseleave:"mouseout"}));var pt=[null];function ft(t,e){this._groups=t,this._parents=e}function gt(){return new ft([[document.documentElement]],pt)}ft.prototype=gt.prototype={constructor:ft,select:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s,a=e[o],c=a.length,u=i[o]=new Array(c),d=0;d<c;++d)(r=a[d])&&(s=t.call(r,r.__data__,d,a))&&("__data__"in r&&(s.__data__=r.__data__),u[d]=s);return new ft(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,n=e.length,i=[],o=[],r=0;r<n;++r)for(var s,a=e[r],l=a.length,c=0;c<l;++c)(s=a[c])&&(i.push(t.call(s,s.__data__,c,a)),o.push(s));return new ft(i,o)},filter:function(t){"function"!=typeof t&&(t=d(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,l=i[o]=[],c=0;c<a;++c)(r=s[c])&&t.call(r,r.__data__,c,s)&&l.push(r);return new ft(i,this._parents)},data:function(t,e){if(!t)return m=new Array(this.size()),u=-1,this.each((function(t){m[++u]=t})),m;var n,i=e?g:f,o=this._parents,r=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=r.length,a=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=o[u],h=r[u],p=h.length,m=t.call(d,d&&d.__data__,u,o),y=m.length,v=l[u]=new Array(y),b=a[u]=new Array(y);i(d,h,v,b,c[u]=new Array(p),m,e);for(var _,x,w=0,E=0;w<y;++w)if(_=v[w]){for(w>=E&&(E=w+1);!(x=b[E])&&++E<y;);_._next=x||null}}return(a=new ft(a,o))._enter=l,a._exit=c,a},enter:function(){return new ft(this._enter||this._groups.map(h),this._parents)},exit:function(){return new ft(this._exit||this._groups.map(h),this._parents)},join:function(t,e,n){var i=this.enter(),o=this,r=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(o=e(o)),null==n?r.remove():n(r),i&&o?i.merge(o).order():o},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,o=n.length,r=Math.min(i,o),s=new Array(i),a=0;a<r;++a)for(var l,c=e[a],u=n[a],d=c.length,h=s[a]=new Array(d),p=0;p<d;++p)(l=c[p]||u[p])&&(h[p]=l);for(;a<i;++a)s[a]=e[a];return new ft(s,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,o=t[e],r=o.length-1,s=o[r];--r>=0;)(i=o[r])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=m);for(var n=this._groups,i=n.length,o=new Array(i),r=0;r<i;++r){for(var s,a=n[r],l=a.length,c=o[r]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new ft(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],o=0,r=i.length;o<r;++o){var s=i[o];if(s)return s}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o,r=e[n],s=0,a=r.length;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this},attr:function(t,e){var n=b(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?x:_:"function"==typeof e?n.local?T:S:n.local?E:w)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?A:"function"==typeof e?N:C)(t,e,null==n?"":n)):D(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?M:"function"==typeof e?I:j)(t,e)):this.node()[t]},classed:function(t,e){var n=L(t+"");if(arguments.length<2){for(var i=B(this.node()),o=-1,r=n.length;++o<r;)if(!i.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?U:e?R:H)(n,e))},text:function(t){return arguments.length?this.each(null==t?q:("function"==typeof t?W:V)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Y:("function"==typeof t?$:F)(t)):this.node().innerHTML},raise:function(){return this.each(X)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:Z(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Z(t),i=null==e?J:"function"==typeof e?e:l(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(tt)},clone:function(t){return this.select(t?nt:et)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,o,r=at(t+""),s=r.length;if(!(arguments.length<2)){for(a=e?ct:lt,null==n&&(n=!1),i=0;i<s;++i)this.each(a(r[i],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<s;++i)if((o=r[i]).type===l.type&&o.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ht:dt)(t,e))}};const mt=gt;var yt={value:function(){}};function vt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new bt(i)}function bt(t){this._=t}function _t(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function xt(t,e){for(var n,i=0,o=t.length;i<o;++i)if((n=t[i]).name===e)return n.value}function wt(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=yt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}bt.prototype=vt.prototype={constructor:bt,on:function(t,e){var n,i=this._,o=_t(t+"",i),r=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<s;)if(n=(t=o[r]).type)i[n]=wt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=wt(i[n],t.name,null);return this}for(;++r<s;)if((n=(t=o[r]).type)&&(n=xt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new bt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,o=new Array(n),r=0;r<n;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],o=0,r=i.length;o<r;++o)i[o].value.apply(e,n)}};const Et=vt;var St,Tt,kt=0,At=0,Ct=0,Nt=0,Dt=0,Mt=0,jt="object"==typeof performance&&performance.now?performance:Date,It="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Lt(){return Dt||(It(Bt),Dt=jt.now()+Mt)}function Bt(){Dt=0}function Ot(){this._call=this._time=this._next=null}function zt(t,e,n){var i=new Ot;return i.restart(t,e,n),i}function Pt(){Dt=(Nt=jt.now())+Mt,kt=At=0;try{!function(){Lt(),++kt;for(var t,e=St;e;)(t=Dt-e._time)>=0&&e._call.call(null,t),e=e._next;--kt}()}finally{kt=0,function(){for(var t,e,n=St,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:St=e);Tt=t,Ht(i)}(),Dt=0}}function Rt(){var t=jt.now(),e=t-Nt;e>1e3&&(Mt-=e,Nt=t)}function Ht(t){kt||(At&&(At=clearTimeout(At)),t-Dt>24?(t<1/0&&(At=setTimeout(Pt,t-jt.now()-Mt)),Ct&&(Ct=clearInterval(Ct))):(Ct||(Nt=jt.now(),Ct=setInterval(Rt,1e3)),kt=1,It(Pt)))}function Ut(t,e,n){var i=new Ot;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i}Ot.prototype=zt.prototype={constructor:Ot,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Lt():+n)+(null==e?0:+e),this._next||Tt===this||(Tt?Tt._next=this:St=this,Tt=this),this._call=t,this._time=n,Ht()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ht())}};var qt=Et("start","end","cancel","interrupt"),Vt=[];function Wt(t,e,n,i,o,r){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,o=t.__transition;function r(l){var c,u,d,h;if(1!==n.state)return a();for(c in o)if((h=o[c]).name===n.name){if(3===h.state)return Ut(r);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete o[c]):+c<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete o[c])}if(Ut((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=h);i.length=u+1}}function s(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),r=-1,s=i.length;++r<s;)i[r].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=zt((function(t){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:o,on:qt,tween:Vt,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function Yt(t,e){var n=$t(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ft(t,e){var n=$t(t,e);if(n.state>3)throw new Error("too late; already running");return n}function $t(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Xt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Kt,Qt,Gt,Zt,Jt=180/Math.PI,te={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ee(t,e,n,i,o,r){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:o,translateY:r,rotate:Math.atan2(e,t)*Jt,skewX:Math.atan(l)*Jt,scaleX:s,scaleY:a}}function ne(t,e,n,i){function o(t){return t.length?t.pop()+" ":""}return function(r,s){var a=[],l=[];return r=t(r),s=t(s),function(t,i,o,r,s,a){if(t!==o||i!==r){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:Xt(t,o)},{i:l-2,x:Xt(i,r)})}else(o||r)&&s.push("translate("+o+e+r+n)}(r.translateX,r.translateY,s.translateX,s.translateY,a,l),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(o(n)+"rotate(",null,i)-2,x:Xt(t,e)})):e&&n.push(o(n)+"rotate("+e+i)}(r.rotate,s.rotate,a,l),function(t,e,n,r){t!==e?r.push({i:n.push(o(n)+"skewX(",null,i)-2,x:Xt(t,e)}):e&&n.push(o(n)+"skewX("+e+i)}(r.skewX,s.skewX,a,l),function(t,e,n,i,r,s){if(t!==n||e!==i){var a=r.push(o(r)+"scale(",null,",",null,")");s.push({i:a-4,x:Xt(t,n)},{i:a-2,x:Xt(e,i)})}else 1===n&&1===i||r.push(o(r)+"scale("+n+","+i+")")}(r.scaleX,r.scaleY,s.scaleX,s.scaleY,a,l),r=s=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var ie=ne((function(t){return"none"===t?te:(Kt||(Kt=document.createElement("DIV"),Qt=document.documentElement,Gt=document.defaultView),Kt.style.transform=t,t=Gt.getComputedStyle(Qt.appendChild(Kt),null).getPropertyValue("transform"),Qt.removeChild(Kt),ee(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),oe=ne((function(t){return null==t?te:(Zt||(Zt=document.createElementNS("http://www.w3.org/2000/svg","g")),Zt.setAttribute("transform",t),(t=Zt.transform.baseVal.consolidate())?ee((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):te)}),", ",")",")");function re(t,e){var n,i;return function(){var o=Ft(this,t),r=o.tween;if(r!==n)for(var s=0,a=(i=n=r).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}o.tween=i}}function se(t,e,n){var i,o;if("function"!=typeof n)throw new Error;return function(){var r=Ft(this,t),s=r.tween;if(s!==i){o=(i=s).slice();for(var a={name:e,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=a;break}l===c&&o.push(a)}r.tween=o}}function ae(t,e,n){var i=t._id;return t.each((function(){var t=Ft(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return $t(t,i).value[e]}}function le(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ce(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function ue(){}var de=.7,he=1/de,pe="\\s*([+-]?\\d+)\\s*",fe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ge="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",me=/^#([0-9a-f]{3,8})$/,ye=new RegExp("^rgb\\("+[pe,pe,pe]+"\\)$"),ve=new RegExp("^rgb\\("+[ge,ge,ge]+"\\)$"),be=new RegExp("^rgba\\("+[pe,pe,pe,fe]+"\\)$"),_e=new RegExp("^rgba\\("+[ge,ge,ge,fe]+"\\)$"),xe=new RegExp("^hsl\\("+[fe,ge,ge]+"\\)$"),we=new RegExp("^hsla\\("+[fe,ge,ge,fe]+"\\)$"),Ee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Se(){return this.rgb().formatHex()}function Te(){return this.rgb().formatRgb()}function ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=me.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ae(e):3===n?new Me(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ce(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ce(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ye.exec(t))?new Me(e[1],e[2],e[3],1):(e=ve.exec(t))?new Me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=be.exec(t))?Ce(e[1],e[2],e[3],e[4]):(e=_e.exec(t))?Ce(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=xe.exec(t))?Be(e[1],e[2]/100,e[3]/100,1):(e=we.exec(t))?Be(e[1],e[2]/100,e[3]/100,e[4]):Ee.hasOwnProperty(t)?Ae(Ee[t]):"transparent"===t?new Me(NaN,NaN,NaN,0):null}function Ae(t){return new Me(t>>16&255,t>>8&255,255&t,1)}function Ce(t,e,n,i){return i<=0&&(t=e=n=NaN),new Me(t,e,n,i)}function Ne(t){return t instanceof ue||(t=ke(t)),t?new Me((t=t.rgb()).r,t.g,t.b,t.opacity):new Me}function De(t,e,n,i){return 1===arguments.length?Ne(t):new Me(t,e,n,null==i?1:i)}function Me(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function je(){return"#"+Le(this.r)+Le(this.g)+Le(this.b)}function Ie(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Le(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Be(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ze(t,e,n,i)}function Oe(t){if(t instanceof ze)return new ze(t.h,t.s,t.l,t.opacity);if(t instanceof ue||(t=ke(t)),!t)return new ze;if(t instanceof ze)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,o=Math.min(e,n,i),r=Math.max(e,n,i),s=NaN,a=r-o,l=(r+o)/2;return a?(s=e===r?(n-i)/a+6*(n<i):n===r?(i-e)/a+2:(e-n)/a+4,a/=l<.5?r+o:2-r-o,s*=60):a=l>0&&l<1?0:s,new ze(s,a,l,t.opacity)}function ze(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Pe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Re(t,e,n,i,o){var r=t*t,s=r*t;return((1-3*t+3*r-s)*e+(4-6*r+3*s)*n+(1+3*t+3*r-3*s)*i+s*o)/6}function He(t){return function(){return t}}function Ue(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):He(isNaN(t)?e:t)}le(ue,ke,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Se,formatHex:Se,formatHsl:function(){return Oe(this).formatHsl()},formatRgb:Te,toString:Te}),le(Me,De,ce(ue,{brighter:function(t){return t=null==t?he:Math.pow(he,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?de:Math.pow(de,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:je,formatHex:je,formatRgb:Ie,toString:Ie})),le(ze,(function(t,e,n,i){return 1===arguments.length?Oe(t):new ze(t,e,n,null==i?1:i)}),ce(ue,{brighter:function(t){return t=null==t?he:Math.pow(he,t),new ze(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?de:Math.pow(de,t),new ze(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new Me(Pe(t>=240?t-240:t+120,o,i),Pe(t,o,i),Pe(t<120?t+240:t-120,o,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const qe=function t(e){var n=function(t){return 1==(t=+t)?Ue:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):He(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=De(t)).r,(e=De(e)).r),o=n(t.g,e.g),r=n(t.b,e.b),s=Ue(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=o(e),t.b=r(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function Ve(t){return function(e){var n,i,o=e.length,r=new Array(o),s=new Array(o),a=new Array(o);for(n=0;n<o;++n)i=De(e[n]),r[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return r=t(r),s=t(s),a=t(a),i.opacity=1,function(t){return i.r=r(t),i.g=s(t),i.b=a(t),i+""}}}Ve((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],r=t[i+1],s=i>0?t[i-1]:2*o-r,a=i<e-1?t[i+2]:2*r-o;return Re((n-i/e)*e,s,o,r,a)}})),Ve((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=t[(i+e-1)%e],r=t[i%e],s=t[(i+1)%e],a=t[(i+2)%e];return Re((n-i/e)*e,o,r,s,a)}}));var We=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ye=new RegExp(We.source,"g");function Fe(t,e){var n,i,o,r=We.lastIndex=Ye.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=We.exec(t))&&(i=Ye.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:Xt(n,i)})),r=Ye.lastIndex;return r<e.length&&(o=e.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function $e(t,e){var n;return("number"==typeof e?Xt:e instanceof ke?qe:(n=ke(e))?(e=n,qe):Fe)(t,e)}function Xe(t){return function(){this.removeAttribute(t)}}function Ke(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qe(t,e,n){var i,o,r=n+"";return function(){var s=this.getAttribute(t);return s===r?null:s===i?o:o=e(i=s,n)}}function Ge(t,e,n){var i,o,r=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?o:o=e(i=s,n)}}function Ze(t,e,n){var i,o,r;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===i&&a===o?r:(o=a,r=e(i=s,l));this.removeAttribute(t)}}function Je(t,e,n){var i,o,r;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===i&&a===o?r:(o=a,r=e(i=s,l));this.removeAttributeNS(t.space,t.local)}}function tn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function en(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function nn(t,e){var n,i;function o(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&en(t,o)),n}return o._value=e,o}function on(t,e){var n,i;function o(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&tn(t,o)),n}return o._value=e,o}function rn(t,e){return function(){Yt(this,t).delay=+e.apply(this,arguments)}}function sn(t,e){return e=+e,function(){Yt(this,t).delay=e}}function an(t,e){return function(){Ft(this,t).duration=+e.apply(this,arguments)}}function ln(t,e){return e=+e,function(){Ft(this,t).duration=e}}function cn(t,e){if("function"!=typeof e)throw new Error;return function(){Ft(this,t).ease=e}}function un(t,e,n){var i,o,r=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Yt:Ft;return function(){var s=r(this,t),a=s.on;a!==i&&(o=(i=a).copy()).on(e,n),s.on=o}}var dn=mt.prototype.constructor;function hn(t){return function(){this.style.removeProperty(t)}}function pn(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function fn(t,e,n){var i,o;function r(){var r=e.apply(this,arguments);return r!==o&&(i=(o=r)&&pn(t,r,n)),i}return r._value=e,r}function gn(t){return function(e){this.textContent=t.call(this,e)}}function mn(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&gn(i)),e}return i._value=t,i}var yn=0;function vn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function bn(){return++yn}var _n=mt.prototype;vn.prototype=function(t){return mt().transition(t)}.prototype={constructor:vn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=l(t));for(var i=this._groups,o=i.length,r=new Array(o),s=0;s<o;++s)for(var a,c,u=i[s],d=u.length,h=r[s]=new Array(d),p=0;p<d;++p)(a=u[p])&&(c=t.call(a,a.__data__,p,u))&&("__data__"in a&&(c.__data__=a.__data__),h[p]=c,Wt(h[p],e,n,p,h,$t(a,n)));return new vn(r,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=u(t));for(var i=this._groups,o=i.length,r=[],s=[],a=0;a<o;++a)for(var l,c=i[a],d=c.length,h=0;h<d;++h)if(l=c[h]){for(var p,f=t.call(l,l.__data__,h,c),g=$t(l,n),m=0,y=f.length;m<y;++m)(p=f[m])&&Wt(p,e,n,m,f,g);r.push(f),s.push(l)}return new vn(r,s,e,n)},filter:function(t){"function"!=typeof t&&(t=d(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,l=i[o]=[],c=0;c<a;++c)(r=s[c])&&t.call(r,r.__data__,c,s)&&l.push(r);return new vn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,o=n.length,r=Math.min(i,o),s=new Array(i),a=0;a<r;++a)for(var l,c=e[a],u=n[a],d=c.length,h=s[a]=new Array(d),p=0;p<d;++p)(l=c[p]||u[p])&&(h[p]=l);for(;a<i;++a)s[a]=e[a];return new vn(s,this._parents,this._name,this._id)},selection:function(){return new dn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=bn(),i=this._groups,o=i.length,r=0;r<o;++r)for(var s,a=i[r],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=$t(s,e);Wt(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new vn(i,this._parents,t,n)},call:_n.call,nodes:_n.nodes,node:_n.node,size:_n.size,empty:_n.empty,each:_n.each,on:function(t,e){var n=this._id;return arguments.length<2?$t(this.node(),n).on.on(t):this.each(un(n,t,e))},attr:function(t,e){var n=b(t),i="transform"===n?oe:$e;return this.attrTween(t,"function"==typeof e?(n.local?Je:Ze)(n,i,ae(this,"attr."+t,e)):null==e?(n.local?Ke:Xe)(n):(n.local?Ge:Qe)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=b(t);return this.tween(n,(i.local?nn:on)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?ie:$e;return null==e?this.styleTween(t,function(t,e){var n,i,o;return function(){var r=D(this,t),s=(this.style.removeProperty(t),D(this,t));return r===s?null:r===n&&s===i?o:o=e(n=r,i=s)}}(t,i)).on("end.style."+t,hn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,o,r;return function(){var s=D(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=D(this,t)),s===l?null:s===i&&l===o?r:(o=l,r=e(i=s,a))}}(t,i,ae(this,"style."+t,e))).each(function(t,e){var n,i,o,r,s="style."+e,a="end."+s;return function(){var l=Ft(this,t),c=l.on,u=null==l.value[s]?r||(r=hn(e)):void 0;c===n&&o===u||(i=(n=c).copy()).on(a,o=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,o,r=n+"";return function(){var s=D(this,t);return s===r?null:s===i?o:o=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,fn(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ae(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,mn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,o=$t(this.node(),n).tween,r=0,s=o.length;r<s;++r)if((i=o[r]).name===t)return i.value;return null}return this.each((null==e?re:se)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rn:sn)(e,t)):$t(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?an:ln)(e,t)):$t(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(cn(e,t)):$t(this.node(),e).ease},end:function(){var t,e,n=this,i=n._id,o=n.size();return new Promise((function(r,s){var a={value:s},l={value:function(){0==--o&&r()}};n.each((function(){var n=Ft(this,i),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e}))}))}};var xn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function wn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return xn.time=Lt(),xn;return n}function En(t){return{type:t}}mt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,o,r=t.__transition,s=!0;if(r){for(o in e=null==e?null:e+"",r)(n=r[o]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[o]):s=!1;s&&delete t.__transition}}(this,t)}))},mt.prototype.transition=function(t){var e,n;t instanceof vn?(e=t._id,t=t._name):(e=bn(),(n=xn).time=Lt(),t=null==t?null:t+"");for(var i=this._groups,o=i.length,r=0;r<o;++r)for(var s,a=i[r],l=a.length,c=0;c<l;++c)(s=a[c])&&Wt(s,t,e,c,a,n||wn(s,e));return new vn(i,this._parents,t,e)},["w","e"].map(En),["n","s"].map(En),["n","w","e","s","nw","ne","sw","se"].map(En),Math.cos,Math.sin,Math.PI,Math.max,Array.prototype.slice;var Sn="$";function Tn(){}function kn(t,e){var n=new Tn;if(t instanceof Tn)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var i,o=-1,r=t.length;if(null==e)for(;++o<r;)n.set(o,t[o]);else for(;++o<r;)n.set(e(i=t[o],o,t),i)}else if(t)for(var s in t)n.set(s,t[s]);return n}function An(){}Tn.prototype=kn.prototype={constructor:Tn,has:function(t){return Sn+t in this},get:function(t){return this[Sn+t]},set:function(t,e){return this[Sn+t]=e,this},remove:function(t){var e=Sn+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Sn&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Sn&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Sn&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Sn&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Sn&&++t;return t},empty:function(){for(var t in this)if(t[0]===Sn)return!1;return!0},each:function(t){for(var e in this)e[0]===Sn&&t(this[e],e.slice(1),this)}};var Cn=kn.prototype;function Nn(t,e){return t[0]-e[0]||t[1]-e[1]}function Dn(t){for(var e=t.length,n=[0,1],i=2,o=2;o<e;++o){for(;i>1&&(r=t[n[i-2]],s=t[n[i-1]],a=t[o],(s[0]-r[0])*(a[1]-r[1])-(s[1]-r[1])*(a[0]-r[0])<=0);)--i;n[i++]=o}var r,s,a;return n.slice(0,i)}function Mn(t){if((n=t.length)<3)return null;var e,n,i=new Array(n),o=new Array(n);for(e=0;e<n;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(Nn),e=0;e<n;++e)o[e]=[i[e][0],-i[e][1]];var r=Dn(i),s=Dn(o),a=s[0]===r[0],l=s[s.length-1]===r[r.length-1],c=[];for(e=r.length-1;e>=0;--e)c.push(t[i[r[e]][2]]);for(e=+a;e<s.length-l;++e)c.push(t[i[s[e]][2]]);return c}function jn(){return Math.random()}An.prototype=function(t,e){var n=new An;if(t instanceof An)t.each((function(t){n.add(t)}));else if(t){var i=-1,o=t.length;if(null==e)for(;++i<o;)n.add(t[i]);else for(;++i<o;)n.add(e(t[i],i,t))}return n}.prototype={constructor:An,has:Cn.has,add:function(t){return this[Sn+(t+="")]=t,this},remove:Cn.remove,clear:Cn.clear,values:Cn.keys,size:Cn.size,empty:Cn.empty,each:Cn.each},Array.prototype.slice,Math.PI,Math.sqrt(5),function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(jn);const In=function t(e){function n(t,n){var i,o;return t=null==t?0:+t,n=null==n?1:+n,function(){var r;if(null!=i)r=i,i=null;else do{i=2*e()-1,r=2*e()-1,o=i*i+r*r}while(!o||o>1);return t+n*r*Math.sqrt(-2*Math.log(o)/o)}}return n.source=t,n}(jn),Ln=(function t(e){function n(){var t=In.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(jn),function t(e){function n(t){return function(){for(var n=0,i=0;i<t;++i)n+=e();return n}}return n.source=t,n}(jn));(function t(e){function n(t){var n=Ln.source(e)(t);return function(){return n()/t}}return n.source=t,n})(jn),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(jn);var Bn=Array.prototype;Bn.map,Bn.slice;const On=function(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function zn(){this._=null}function Pn(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Rn(t,e){var n=e,i=e.R,o=n.U;o?o.L===n?o.L=i:o.R=i:t._=i,i.U=o,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Hn(t,e){var n=e,i=e.L,o=n.U;o?o.L===n?o.L=i:o.R=i:t._=i,i.U=o,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Un(t){for(;t.L;)t=t.L;return t}zn.prototype={constructor:zn,insert:function(t,e){var n,i,o;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Un(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(o=i.R)&&o.C?(n.C=o.C=!1,i.C=!0,t=i):(t===n.R&&(Rn(this,n),n=(t=n).U),n.C=!1,i.C=!0,Hn(this,i)):(o=i.L)&&o.C?(n.C=o.C=!1,i.C=!0,t=i):(t===n.L&&(Hn(this,n),n=(t=n).U),n.C=!1,i.C=!0,Rn(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,o=t.U,r=t.L,s=t.R;if(n=r?s?Un(s):r:s,o?o.L===t?o.L=n:o.R=n:this._=n,r&&s?(i=n.C,n.C=t.C,n.L=r,r.U=n,n!==s?(o=n.U,n.U=t.U,t=n.R,o.L=t,n.R=s,s.U=n):(n.U=o,o=n,t=n.R)):(i=t.C,t=n),t&&(t.U=o),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===o.L){if((e=o.R).C&&(e.C=!1,o.C=!0,Rn(this,o),e=o.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Hn(this,e),e=o.R),e.C=o.C,o.C=e.R.C=!1,Rn(this,o),t=this._;break}}else if((e=o.L).C&&(e.C=!1,o.C=!0,Hn(this,o),e=o.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Rn(this,e),e=o.L),e.C=o.C,o.C=e.L.C=!1,Hn(this,o),t=this._;break}e.C=!0,t=o,o=o.U}while(!t.C);t&&(t.C=!1)}}};const qn=zn;function Vn(t,e,n,i){var o=[null,null],r=pi.push(o)-1;return o.left=t,o.right=e,n&&Yn(o,t,e,n),i&&Yn(o,e,t,i),di[t.index].halfedges.push(r),di[e.index].halfedges.push(r),o}function Wn(t,e,n){var i=[e,n];return i.left=t,i}function Yn(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Fn(t,e,n,i,o){var r,s=t[0],a=t[1],l=s[0],c=s[1],u=0,d=1,h=a[0]-l,p=a[1]-c;if(r=e-l,h||!(r>0)){if(r/=h,h<0){if(r<u)return;r<d&&(d=r)}else if(h>0){if(r>d)return;r>u&&(u=r)}if(r=i-l,h||!(r<0)){if(r/=h,h<0){if(r>d)return;r>u&&(u=r)}else if(h>0){if(r<u)return;r<d&&(d=r)}if(r=n-c,p||!(r>0)){if(r/=p,p<0){if(r<u)return;r<d&&(d=r)}else if(p>0){if(r>d)return;r>u&&(u=r)}if(r=o-c,p||!(r<0)){if(r/=p,p<0){if(r>d)return;r>u&&(u=r)}else if(p>0){if(r<u)return;r<d&&(d=r)}return!(u>0||d<1)||(u>0&&(t[0]=[l+u*h,c+u*p]),d<1&&(t[1]=[l+d*h,c+d*p]),!0)}}}}}function $n(t,e,n,i,o){var r=t[1];if(r)return!0;var s,a,l=t[0],c=t.left,u=t.right,d=c[0],h=c[1],p=u[0],f=u[1],g=(d+p)/2,m=(h+f)/2;if(f===h){if(g<e||g>=i)return;if(d>p){if(l){if(l[1]>=o)return}else l=[g,n];r=[g,o]}else{if(l){if(l[1]<n)return}else l=[g,o];r=[g,n]}}else if(a=m-(s=(d-p)/(f-h))*g,s<-1||s>1)if(d>p){if(l){if(l[1]>=o)return}else l=[(n-a)/s,n];r=[(o-a)/s,o]}else{if(l){if(l[1]<n)return}else l=[(o-a)/s,o];r=[(n-a)/s,n]}else if(h<f){if(l){if(l[0]>=i)return}else l=[e,s*e+a];r=[i,s*i+a]}else{if(l){if(l[0]<e)return}else l=[i,s*i+a];r=[e,s*e+a]}return t[0]=l,t[1]=r,!0}function Xn(t,e){var n=t.site,i=e.left,o=e.right;return n===o&&(o=i,i=n),o?Math.atan2(o[1]-i[1],o[0]-i[0]):(n===i?(i=e[1],o=e[0]):(i=e[0],o=e[1]),Math.atan2(i[0]-o[0],o[1]-i[1]))}function Kn(t,e){return e[+(e.left!==t.site)]}function Qn(t,e){return e[+(e.left===t.site)]}var Gn,Zn=[];function Jn(){Pn(this),this.x=this.y=this.arc=this.site=this.cy=null}function ti(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,o=t.site,r=n.site;if(i!==r){var s=o[0],a=o[1],l=i[0]-s,c=i[1]-a,u=r[0]-s,d=r[1]-a,h=2*(l*d-c*u);if(!(h>=-gi)){var p=l*l+c*c,f=u*u+d*d,g=(d*p-c*f)/h,m=(l*f-u*p)/h,y=Zn.pop()||new Jn;y.arc=t,y.site=o,y.x=g+s,y.y=(y.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=y;for(var v=null,b=hi._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){v=b.P;break}b=b.L}else{if(!b.R){v=b;break}b=b.R}hi.insert(v,y),v||(Gn=y)}}}}function ei(t){var e=t.circle;e&&(e.P||(Gn=e.N),hi.remove(e),Zn.push(e),Pn(e),t.circle=null)}var ni=[];function ii(){Pn(this),this.edge=this.site=this.circle=null}function oi(t){var e=ni.pop()||new ii;return e.site=t,e}function ri(t){ei(t),ui.remove(t),ni.push(t),Pn(t)}function si(t){var e=t.circle,n=e.x,i=e.cy,o=[n,i],r=t.P,s=t.N,a=[t];ri(t);for(var l=r;l.circle&&Math.abs(n-l.circle.x)<fi&&Math.abs(i-l.circle.cy)<fi;)r=l.P,a.unshift(l),ri(l),l=r;a.unshift(l),ei(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<fi&&Math.abs(i-c.circle.cy)<fi;)s=c.N,a.push(c),ri(c),c=s;a.push(c),ei(c);var u,d=a.length;for(u=1;u<d;++u)c=a[u],l=a[u-1],Yn(c.edge,l.site,c.site,o);l=a[0],(c=a[d-1]).edge=Vn(l.site,c.site,null,o),ti(l),ti(c)}function ai(t){for(var e,n,i,o,r=t[0],s=t[1],a=ui._;a;)if((i=li(a,s)-r)>fi)a=a.L;else{if(!((o=r-ci(a,s))>fi)){i>-fi?(e=a.P,n=a):o>-fi?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){di[t.index]={site:t,halfedges:[]}}(t);var l=oi(t);if(ui.insert(e,l),e||n){if(e===n)return ei(e),n=oi(e.site),ui.insert(l,n),l.edge=n.edge=Vn(e.site,l.site),ti(e),void ti(n);if(n){ei(e),ei(n);var c=e.site,u=c[0],d=c[1],h=t[0]-u,p=t[1]-d,f=n.site,g=f[0]-u,m=f[1]-d,y=2*(h*m-p*g),v=h*h+p*p,b=g*g+m*m,_=[(m*v-p*b)/y+u,(h*b-g*v)/y+d];Yn(n.edge,c,f,_),l.edge=Vn(c,t,null,_),n.edge=Vn(t,f,null,_),ti(e),ti(n)}else l.edge=Vn(e.site,l.site)}}function li(t,e){var n=t.site,i=n[0],o=n[1],r=o-e;if(!r)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],c=l-e;if(!c)return a;var u=a-i,d=1/r-1/c,h=u/c;return d?(-h+Math.sqrt(h*h-2*d*(u*u/(-2*c)-l+c/2+o-r/2)))/d+i:(i+a)/2}function ci(t,e){var n=t.N;if(n)return li(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var ui,di,hi,pi,fi=1e-6,gi=1e-12;function mi(t,e){return e[1]-t[1]||e[0]-t[0]}function yi(t,e){var n,i,o,r=t.sort(mi).pop();for(pi=[],di=new Array(t.length),ui=new qn,hi=new qn;;)if(o=Gn,r&&(!o||r[1]<o.y||r[1]===o.y&&r[0]<o.x))r[0]===n&&r[1]===i||(ai(r),n=r[0],i=r[1]),r=t.pop();else{if(!o)break;si(o.arc)}if(function(){for(var t,e,n,i,o=0,r=di.length;o<r;++o)if((t=di[o])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=Xn(t,pi[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],c=+e[1][1];!function(t,e,n,i){for(var o,r=pi.length;r--;)$n(o=pi[r],t,e,n,i)&&Fn(o,t,e,n,i)&&(Math.abs(o[0][0]-o[1][0])>fi||Math.abs(o[0][1]-o[1][1])>fi)||delete pi[r]}(s,a,l,c),function(t,e,n,i){var o,r,s,a,l,c,u,d,h,p,f,g,m=di.length,y=!0;for(o=0;o<m;++o)if(r=di[o]){for(s=r.site,a=(l=r.halfedges).length;a--;)pi[l[a]]||l.splice(a,1);for(a=0,c=l.length;a<c;)f=(p=Qn(r,pi[l[a]]))[0],g=p[1],d=(u=Kn(r,pi[l[++a%c]]))[0],h=u[1],(Math.abs(f-d)>fi||Math.abs(g-h)>fi)&&(l.splice(a,0,pi.push(Wn(s,p,Math.abs(f-t)<fi&&i-g>fi?[t,Math.abs(d-t)<fi?h:i]:Math.abs(g-i)<fi&&n-f>fi?[Math.abs(h-i)<fi?d:n,i]:Math.abs(f-n)<fi&&g-e>fi?[n,Math.abs(d-n)<fi?h:e]:Math.abs(g-e)<fi&&f-t>fi?[Math.abs(h-e)<fi?d:t,e]:null))-1),++c);c&&(y=!1)}if(y){var v,b,_,x=1/0;for(o=0,y=null;o<m;++o)(r=di[o])&&(_=(v=(s=r.site)[0]-t)*v+(b=s[1]-e)*b)<x&&(x=_,y=r);if(y){var w=[t,e],E=[t,i],S=[n,i],T=[n,e];y.halfedges.push(pi.push(Wn(s=y.site,w,E))-1,pi.push(Wn(s,E,S))-1,pi.push(Wn(s,S,T))-1,pi.push(Wn(s,T,w))-1)}}for(o=0;o<m;++o)(r=di[o])&&(r.halfedges.length||delete di[o])}(s,a,l,c)}this.edges=pi,this.cells=di,ui=hi=pi=di=null}function vi(t,e,n){this.k=t,this.x=e,this.y=n}yi.prototype={constructor:yi,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Kn(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(r=(o=n.halfedges).length)for(var o,r,s,a=n.site,l=-1,c=e[o[r-1]],u=c.left===a?c.right:c.left;++l<r;)s=u,u=(c=e[o[l]]).left===a?c.right:c.left,s&&u&&i<s.index&&i<u.index&&(h=s,p=u,((d=a)[0]-p[0])*(h[1]-d[1])-(d[0]-h[0])*(p[1]-d[1])<0)&&t.push([a.data,s.data,u.data]);var d,h,p})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var i,o,r=this,s=r._found||0,a=r.cells.length;!(o=r.cells[s]);)if(++s>=a)return null;var l=t-o.site[0],c=e-o.site[1],u=l*l+c*c;do{o=r.cells[i=s],s=null,o.halfedges.forEach((function(n){var i=r.edges[n],a=i.left;if(a!==o.site&&a||(a=i.right)){var l=t-a[0],c=e-a[1],d=l*l+c*c;d<u&&(u=d,s=a.index)}}))}while(null!==s);return r._found=i,null==n||u<=n*n?o.site:null}},vi.prototype={constructor:vi,scale:function(t){return 1===t?this:new vi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new vi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new vi(1,0,0),vi.prototype},501:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t,e,n){return c=l()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&a(o,n.prototype),o},c.apply(null,arguments)}function u(t){var e="function"==typeof Map?new Map:void 0;return u=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return c(t,arguments,s(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),a(i,t)},u(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?d(t):e}function p(t){var e=l();return function(){var n,i=s(t);if(e){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return h(this,n)}}function f(t,e,n){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},f(t,e,n||t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var b=function(t,e,n){var i=t.x,o=t.y,r=n.x,s=n.y;return{"+":{x:i+r,y:o+s},"-":{x:i-r,y:o-s},"*":{x:i*r,y:o*s},"/":{x:i/r,y:o/s}}[e]},_=function(t){return{x:t.left,y:t.top}},x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{left:t.x,top:t.y,right:t.x,bottom:t.y,width:e,height:e}},w=function(){var t,e,n,i;return{y:(null===(t=document.body)||void 0===t?void 0:t.scrollTop)||(null===(e=document.documentElement)||void 0===e?void 0:e.scrollTop)||0,x:(null===(n=document.body)||void 0===n?void 0:n.scrollLeft)||(null===(i=document.documentElement)||void 0===i?void 0:i.scrollLeft)||0}},E=function(t){return!t||t instanceof Document?w():{x:t.scrollLeft>=0?t.scrollLeft:w().x,y:t.scrollTop>=0?t.scrollTop:w().y}},S=function(t){var e=t.elementRect,n=t.containerRect,i=t.tolerance,o=void 0===i?{x:0,y:0}:i,r=[];return e.top-o.y<n.top&&r.push("top"),e.left-o.x<n.left&&r.push("left"),e.bottom+o.y>n.bottom&&r.push("bottom"),e.right+o.y>n.right&&r.push("right"),r},T=function(t){var e=t.event;return{x:e.clientX,y:e.clientY}},k=function(t){var e={x:0,y:0},n=window.getComputedStyle(t);if(!n.transform||"none"===n.transform)return e;if(n.transform.indexOf("3d")>=0){var i=n.transform.trim().match(/matrix3d\((.*?)\)/);if(i&&i.length){var o,r=null===(o=i[1])||void 0===o?void 0:o.split(",");e.x=parseInt(r[12])||0,e.y=parseInt(r[13])||0}return e}var s=n.transform.trim().match(/matrix\((.*?)\)/);if(s&&s.length){var a,l=null===(a=s[1])||void 0===a?void 0:a.split(",");e.x=parseInt(l[4])||0,e.y=parseInt(l[5])||0}return e},A=function(t,e){return e?function(t){var e=t.style.transform;if(!e||e.indexOf("translate")<0)return k(t);var n={x:0,y:0},i=e.trim().match(/translate[3dD]*?\(.*?\)/);if(i){var o,r=null===(o=i[0])||void 0===o?void 0:o.split("(");if(r){var s,a=null===(s=r[1])||void 0===s?void 0:s.split(",");n.x=parseInt(a[0])||0,n.y=parseInt(a[1])||0}}return n.x||n.x?n:k(t)}(t):function(t){var e=t.style,n={x:parseInt(e.left)||0,y:parseInt(e.top)||0};if(!n.x&&!n.x){var i=window.getComputedStyle(t);return{x:parseInt(i.left)||0,y:parseInt(i.top)||0}}return n}(t)},C=function(t){var e=t.computedStyle,n=t.node,i=e.position;n instanceof HTMLDocument||"absolute"===i||"relative"===i||"fixed"===i||(n.style.position="relative")},N=function(t,e){return t.left<e.right&&t.right>e.left&&t.top<e.bottom&&t.bottom>e.top},D=function(t){var e=t.element,n=t.posDirection,i=t.containerRect,o=t.useTransform,r=A(e,o),s=b(r,"+",n);M(e,s,o);var a=e.getBoundingClientRect();!function(t){var e=t.element,n=t.edges,i=t.elementRect,o=t.containerRect,r=t.elementPos,s=t.useTransform;n.includes("top")&&M(e,{y:r.y+o.top-i.top,x:r.x},s),n.includes("left")&&M(e,{y:r.y,x:r.x+o.left-i.left},s),n.includes("bottom")&&M(e,{y:r.y+o.bottom-i.bottom,x:r.x},s),n.includes("right")&&M(e,{y:r.y,x:r.x+o.right-i.right},s)}({element:e,edges:S({elementRect:a,containerRect:i}),elementRect:a,containerRect:i,elementPos:s,useTransform:o})},M=function(t,e,n){if(n){var i=t.style.transform;t.style.transform="translate3d(".concat(e.x,"px,").concat(e.y,"px,1px) ").concat(i.replace(/translate.*?\)/g,""))}else t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px");return t},j=function(t){for(var e=t.subscribe,n=t.publish,r=t.Interaction,s=t.SelectedSet,a=function(){var t=g(c[l],2),a=t[0],u=t[1];["pre",!1].forEach((function(t){return e(t?"".concat(a,":").concat(t):a,(function(e){return u.forEach((function(a){return(!a.condition||a.condition(e))&&n(t?"".concat(t).concat(a.name):a.name,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({items:s.elements,isDragging:r.isDragging},e))}))}))}))},l=0,c=Object.entries({"Selected:added":[{name:"elementselect"}],"Selected:removed":[{name:"elementunselect"}],"Area:scroll":[{name:"autoscroll"}],"Interaction:start":[{name:"dragstart"}],"Interaction:update":[{name:"dragmove",condition:function(t){return t.event}}],"Interaction:end":[{name:"callback"}],"Drag:keyboardDrag":[{name:"dragstart"},{name:"dragmove"}]});l<c.length;l++)a()},I=function(t){return t?!Array.isArray(t)&&(t instanceof HTMLElement||t instanceof SVGElement)?[t]:m(t):[]},L=function(t,e){t.style.left="".concat(e.left,"px"),t.style.top="".concat(e.top,"px"),t.style.width="".concat(e.width,"px"),t.style.height="".concat(e.height,"px")},B=function(){function e(n){var o,r,s,a=this,l=n.area,c=n.PS,u=n.zoom;t(this,e),i(this,"_modificationCallback",void 0),i(this,"_modificationObserver",void 0),i(this,"_zoom",void 0),i(this,"_node",void 0),i(this,"_parentNodes",void 0),i(this,"_computedStyle",void 0),i(this,"_computedBorder",void 0),i(this,"_rect",void 0),i(this,"start",(function(){var t,e,n;t=a.parentNodes,e=a._modificationCallback,n=a._modificationObserver,window.addEventListener("resize",e),window.addEventListener("scroll",e),t.forEach((function(t,e){n.observe(t,{childList:0!==e,attributes:!0})}))})),i(this,"reset",(function(){a._computedStyle=void 0,a._rect=void 0,a._computedBorder=void 0,a._parentNodes=void 0})),i(this,"stop",(function(){var t,e;t=a._modificationObserver,e=a._modificationCallback,window.removeEventListener("resize",e),window.removeEventListener("scroll",e),t.disconnect(),a.reset()})),i(this,"scroll",(function(t,e){(function(t,e,n){if(e.length){var i=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,o=t instanceof HTMLDocument?i||document.body:t,r=e.includes("top")&&o.scrollTop>0,s=e.includes("bottom")&&o.scrollTop<o.scrollHeight,a=e.includes("left")&&o.scrollLeft>0,l=e.includes("right")&&o.scrollLeft<o.scrollWidth;r&&(o.scrollTop-=1*n),s&&(o.scrollTop+=1*n),a&&(o.scrollLeft-=1*n),l&&(o.scrollLeft+=1*n)}})(a._node,t,e),a.PubSub.publish("Area:scroll",{scroll_directions:t,scroll_multiplier:e})})),this._node=l,this._zoom=u,this.PubSub=c,C({computedStyle:this.computedStyle,node:this._node}),this._modificationCallback=(o=function(t){a.reset(),a.PubSub.publish("Area:modified",{event:t,item:a})},r=60,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=function(){s=null,o.apply(void 0,e)};clearTimeout(s),s=setTimeout(i,r)}),this._modificationObserver=new MutationObserver(this._modificationCallback),setTimeout((function(){a.reset(),a.PubSub.publish("Area:modified",{event,item:a})})),this.PubSub.subscribe("Interaction:init",this.start),this.PubSub.subscribe("Interaction:end",this.reset)}return n(e,[{key:"HTMLNode",get:function(){return this._node}},{key:"computedBorder",get:function(){return this._computedBorder?this._computedBorder:{top:parseInt(this.computedStyle.borderTopWidth),bottom:parseInt(this.computedStyle.borderBottomWidth),left:parseInt(this.computedStyle.borderLeftWidth),right:parseInt(this.computedStyle.borderRightWidth)}}},{key:"computedStyle",get:function(){return this._computedStyle?this._computedStyle:this.HTMLNode instanceof HTMLDocument?this._computedStyle=window.getComputedStyle(this.HTMLNode.body||this.HTMLNode.documentElement):this._computedStyle=window.getComputedStyle(this.HTMLNode)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=function(t,e){if(t instanceof Document)return{top:0,left:0,bottom:0,right:0,width:window.innerWidth,height:window.innerHeight};var n=t.getBoundingClientRect();return{top:n.top,left:n.left,bottom:n.bottom,right:n.right,width:(t.clientWidth||n.width)*e,height:(t.clientHeight||n.height)*e}}(this.HTMLNode,this._zoom)}},{key:"parentNodes",get:function(){if(this._parentNodes)return this._parentNodes;return this._parentNodes=function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=null===(n=e[i])||void 0===n?void 0:n.parentNode;return o?(e.push(o),t(e,++i)):e}([this.HTMLNode]),this._parentNodes}}]),e}(),O=function(){function e(n){var o=this,r=n.DS,s=n.dragKeys,a=n.draggability,l=n.keyboardDrag,c=n.keyboardDragSpeed,u=n.useTransform,d=n.zoom;t(this,e),i(this,"_useTransform",void 0),i(this,"_prevCursorPos",void 0),i(this,"_prevScrollPos",void 0),i(this,"_elements",[]),i(this,"_draggability",void 0),i(this,"_dragKeys",void 0),i(this,"_dragKeysFlat",void 0),i(this,"_keyboardDrag",void 0),i(this,"_keyboardDragSpeed",void 0),i(this,"_zoom",void 0),i(this,"keyboardDrag",(function(t){var e=t.event,n=t.key;if(o._keyboardDrag&&o._dragKeysFlat.includes(n)&&o.DS.SelectedSet.size&&o._draggability&&!o.DS.continue){o.DS.publish("Interaction:start",{event:e,isDragging:!0,isDraggingKeyboard:!0}),o._elements=o.DS.getSelection(),o.handleZIndex(!0);var i=function(t){var e=t.shiftKey,n=t.keyboardDragSpeed,i=t.zoom,o=t.key,r=t.dragKeys,s=t.scrollDiff,a=t.canScroll,l=t.scrollCallback,c={x:0,y:0},u=e?4*n*i:n*i;return r.left.includes(o)&&(c.x=s.x||-u,e||s.x||!a||l(["left"],n)),r.right.includes(o)&&(c.x=s.x||u,e||s.x||!a||l(["right"],n)),r.up.includes(o)&&(c.y=s.y||-u,e||s.y||!a||l(["top"],n)),r.down.includes(o)&&(c.y=s.y||u,e||s.y||!a||l(["bottom"],n)),c}({shiftKey:o.DS.stores.KeyStore.currentValues.includes("shift"),keyboardDragSpeed:o._keyboardDragSpeed,zoom:o._zoom,key:n,scrollCallback:o.DS.Area.scroll,scrollDiff:o._scrollDiff,canScroll:o.DS.stores.ScrollStore.canScroll,dragKeys:o._dragKeys});o._elements.forEach((function(t){return D({element:t,posDirection:i,containerRect:o.DS.SelectorArea.rect,useTransform:o._useTransform})})),o.DS.publish("Interaction:update",{event:e,isDragging:!0,isDraggingKeyboard:!0})}})),i(this,"keyboardEnd",(function(t){var e=t.event,n=t.key;o._keyboardDrag&&o._dragKeysFlat.includes(n)&&o.DS.SelectedSet.size&&o._draggability&&o.DS.publish("Interaction:end",{event:e,isDragging:o._draggability,isDraggingKeyboard:!0})})),i(this,"start",(function(t){var e=t.isDragging,n=t.isDraggingKeyboard;e&&!n&&(o._prevCursorPos=null,o._prevScrollPos=null,o._elements=o.DS.getSelection(),o.handleZIndex(!0))})),i(this,"stop",(function(t){null!=t&&t.isKeyboard||(o._prevCursorPos=null,o._prevScrollPos=null,o.handleZIndex(!1),o._elements=[])})),i(this,"update",(function(t){var e=t.isDragging,n=t.isDraggingKeyboard;if(e&&o._elements.length&&!n&&!o.DS.continue){var i=b(o._cursorDiff,"+",o._scrollDiff);o._elements.forEach((function(t){return D({element:t,posDirection:i,containerRect:o.DS.SelectorArea.rect,useTransform:o._useTransform})}))}})),i(this,"handleZIndex",(function(t){o._elements.forEach((function(e){return e.style.zIndex="".concat((parseInt(e.style.zIndex)||0)+t?9999:-9998)}))})),this.DS=r,this._useTransform=u,this._keyboardDragSpeed=c,this._keyboardDrag=l,this._zoom=d,this._draggability=a,this._dragKeys={up:s.up.map((function(t){return t.toLowerCase()})),down:s.down.map((function(t){return t.toLowerCase()})),left:s.left.map((function(t){return t.toLowerCase()})),right:s.right.map((function(t){return t.toLowerCase()}))},this._dragKeysFlat=[].concat(m(this._dragKeys.up),m(this._dragKeys.down),m(this._dragKeys.left),m(this._dragKeys.right)),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("KeyStore:down",this.keyboardDrag),this.DS.subscribe("KeyStore:up",this.keyboardEnd)}return n(e,[{key:"_cursorDiff",get:function(){var t=this.DS.stores.PointerStore.currentVal,e=this._prevCursorPos?b(t,"-",this._prevCursorPos):{x:0,y:0};return this._prevCursorPos=t,e}},{key:"_scrollDiff",get:function(){var t=this.DS.stores.ScrollStore.currentVal,e=this._prevScrollPos?b(t,"-",this._prevScrollPos):{x:0,y:0};return this._prevScrollPos=t,e}}]),e}(),z=function(){function e(n){var o=this,r=n.areaElement,s=n.DS,a=n.draggability,l=n.immediateDrag;t(this,e),i(this,"_areaElement",void 0),i(this,"_draggability",void 0),i(this,"_immediateDrag",void 0),i(this,"isInteracting",void 0),i(this,"isDragging",void 0),i(this,"init",(function(){o.stop(),o._areaElement.addEventListener("mousedown",o.start),o._areaElement.addEventListener("touchstart",o.start,{passive:!1}),o.DS.publish("Interaction:init",{})})),i(this,"start",(function(t){"touchstart"===t.type&&t.preventDefault(),o._canInteract(t)&&(o.isInteracting=!0,o.isDragging=o.isDragEvent(t),o.DS.publish("Interaction:start",{event:t,isDragging:o.isDragging}),document.addEventListener("mouseup",o.reset),document.addEventListener("touchend",o.reset))})),i(this,"isDragEvent",(function(t){return!(!o._draggability||o.DS.stores.KeyStore.isMultiSelectKeyPressed(t)||!o.DS.SelectableSet.has(t.target)||(o._immediateDrag&&(o.DS.SelectedSet.size?o.DS.SelectedSet.has(t.target)||(o.DS.SelectedSet.clear(),o.DS.SelectedSet.add(t.target)):o.DS.SelectedSet.add(t.target)),!o.DS.SelectedSet.has(t.target)))})),i(this,"onClick",(function(t){var e=t.event;if(o._canInteract(e)&&!(e.detail>0)){var n=o.DS,i=n.stores,r=i.PointerStore,s=i.KeyStore,a=n.SelectableSet,l=n.SelectedSet,c=n.publish;r.start(e);var u=e.target;a.has(u)&&(s.isMultiSelectKeyPressed(e)||l.clear(),l.toggle(u),c("Interaction:end",{event:e,isDragging:o.isDragging}))}})),i(this,"stop",(function(){o.isInteracting=!1,o.isDragging=!1,o._areaElement.removeEventListener("mousedown",o.start),o._areaElement.removeEventListener("touchstart",o.start,{passive:!1}),document.removeEventListener("mouseup",o.reset),document.removeEventListener("touchend",o.reset)})),i(this,"update",(function(t){var e=t.event,n=t.scroll_directions,i=t.scroll_multiplier;o.isInteracting&&o.DS.publish("Interaction:update",{event:e,scroll_directions:n,scroll_multiplier:i,isDragging:o.isDragging})})),i(this,"reset",(function(t){var e=o.isDragging;o.stop(),o.init(),o.DS.publish("Interaction:end",{event:t,isDragging:e})})),this._areaElement=r,this._draggability=a,this._immediateDrag=l,this.DS=s,this.DS.subscribe("PointerStore:updated",this.update),this.DS.subscribe("Selectable:click",this.onClick),this.DS.subscribe("Selectable:pointer",(function(t){var e=t.event;return o.start(e)})),this.DS.subscribe("Area:scroll",this.update)}return n(e,[{key:"_canInteract",value:function(t){return!(2===t.button||this.isInteracting||t.target&&!this.DS.SelectorArea.isInside(t.target))}}]),e}(),P=function e(){var n=this;t(this,e),i(this,"subscribers",{}),i(this,"subscribe",(function(t,e){return Array.isArray(n.subscribers[t])||(n.subscribers[t]=[]),n.subscribers[t].push(e),n.subscribers[t].length-1})),i(this,"unsubscribe",(function(t,e,i){i>=0?n.subscribers[t].splice(i,1):e&&(n.subscribers[t]=n.subscribers[t].filter((function(t){return t!==e})))})),i(this,"publish",(function(t,e){var i,o;Array.isArray(n.subscribers[t])&&(null===(i=n.subscribers["".concat(t,":pre")])||void 0===i||i.forEach((function(t){return t(e)})),null===(o=n.subscribers[t])||void 0===o||o.forEach((function(t){return t(e)})))}))},R=function(e){r(a,e);var o=p(a);function a(e){var n,r=e.elements,s=e.className,l=e.hoverClassName,c=e.draggability,u=e.useTransform,h=e.DS;return t(this,a),i(d(n=o.call(this)),"_initElements",void 0),i(d(n),"_className",void 0),i(d(n),"_hoverClassName",void 0),i(d(n),"_useTransform",void 0),i(d(n),"_draggability",void 0),i(d(n),"init",(function(){return n._initElements.forEach((function(t){return n.add(t)}))})),i(d(n),"clear",(function(){return n.forEach((function(t){return n.delete(t)}))})),i(d(n),"_onClick",(function(t){return n.DS.publish("Selectable:click",{event:t})})),i(d(n),"_onPointer",(function(t){return n.DS.publish("Selectable:pointer",{event:t})})),i(d(n),"addAll",(function(t){return t.forEach((function(t){return n.add(t)}))})),i(d(n),"deleteAll",(function(t){return t.forEach((function(t){return n.delete(t)}))})),n.DS=h,n._initElements=I(r),n._className=s,n._hoverClassName=l,n._useTransform=u,n._draggability=c,n.DS.subscribe("Interaction:init",n.init),n}return n(a,[{key:"add",value:function(t){return t.classList.add(this._className),t.addEventListener("click",this._onClick),t.addEventListener("mousedown",this._onPointer),t.addEventListener("touchstart",this._onPointer,{passive:!1}),this._draggability&&!this._useTransform&&C({computedStyle:window.getComputedStyle(t),node:t}),f(s(a.prototype),"add",this).call(this,t)}},{key:"delete",value:function(t){return t.classList.remove(this._className),t.classList.remove(this._hoverClassName),t.removeEventListener("click",this._onClick),t.removeEventListener("mousedown",this._onPointer),t.removeEventListener("touchstart",this._onPointer,{passive:!1}),f(s(a.prototype),"delete",this).call(this,t)}},{key:"elements",get:function(){return Array.from(this.values())}}]),a}(u(Set)),H=function(e){r(a,e);var o=p(a);function a(e){var n,r=e.className,s=e.DS;return t(this,a),i(d(n=o.call(this)),"_className",void 0),i(d(n),"clear",(function(){return n.forEach((function(t){return n.delete(t)}))})),i(d(n),"addAll",(function(t){return t.forEach((function(t){return n.add(t)}))})),i(d(n),"deleteAll",(function(t){return t.forEach((function(t){return n.delete(t)}))})),n.DS=s,n._className=r,n}return n(a,[{key:"add",value:function(t){if(!f(s(a.prototype),"has",this).call(this,t))return f(s(a.prototype),"add",this).call(this,t),t.classList.add(this._className),this.DS.publish("Selected:added",{items:this.elements,item:t}),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)+1),this}},{key:"delete",value:function(t){if(f(s(a.prototype),"has",this).call(this,t)){var e=f(s(a.prototype),"delete",this).call(this,t);return t.classList.remove(this._className),this.DS.publish("Selected:removed",{items:this.elements,item:t}),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)-1),e}}},{key:"toggle",value:function(t){return this.has(t)?this.delete(t):this.add(t),t}},{key:"elements",get:function(){return Array.from(this.values())}}]),a}(u(Set)),U=function(){function e(n){var o=this,r=n.DS,s=n.hoverClassName,a=n.multiSelectToggling;t(this,e),i(this,"_prevSelectedSet",void 0),i(this,"_hoverClassName",void 0),i(this,"_multiSelectToggling",void 0),i(this,"start",(function(t){var e=t.event;t.isDragging||(o._storePrevious(e),o._handleInsideSelection(!0,e))})),i(this,"update",(function(t){t.isDragging||o.DS.continue||o._handleInsideSelection()})),i(this,"_handleInsideSelection",(function(t,e){for(var n=o.DS,i=n.SelectableSet,r=n.SelectorArea,s=n.Selector,a=i.elements.map((function(t){return[t,t.getBoundingClientRect()]})),l=[],c=[],u=0,d=a.length;u<d;u++)r.isInside(a[u][0],a[u][1])&&(N(a[u][1],s.rect)?l.push(a[u][0]):c.push(a[u][0]));var h=o.DS.stores.KeyStore.isMultiSelectKeyPressed(e)&&o._multiSelectToggling;l.forEach((function(e){return function(t){var e=t.element,n=t.force,i=t.multiSelectionToggle,o=t.SelectedSet,r=t.hoverClassName;e.classList.contains(r)&&!n||(o.has(e)?i&&o.delete(e):o.add(e),e.classList.add(r))}({element:e,force:t,multiSelectionToggle:h,SelectedSet:o.DS.SelectedSet,hoverClassName:o._hoverClassName})})),c.forEach((function(e){return function(t){var e=t.element,n=t.force,i=t.SelectedSet,o=t.PrevSelectedSet,r=t.hoverClassName;if(!e.classList.contains(r)&&!n)return!1;var s=i.has(e),a=o.has(e);s&&!a?i.delete(e):!s&&a&&i.add(e),e.classList.remove(r)}({element:e,force:t,SelectedSet:o.DS.SelectedSet,hoverClassName:o._hoverClassName,PrevSelectedSet:o._prevSelectedSet})}))})),this._hoverClassName=s,this._multiSelectToggling=a,this.DS=r,this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update)}return n(e,[{key:"_storePrevious",value:function(t){var e=this.DS,n=e.stores.KeyStore,i=e.SelectedSet;n.isMultiSelectKeyPressed(t)?this._prevSelectedSet=new Set(i):this._prevSelectedSet=new Set}}]),e}(),q=function(){function e(n){var o=this,r=n.DS,s=n.selector,a=n.selectorClass,l=n.customStyles;t(this,e),i(this,"_rect",void 0),i(this,"start",(function(t){if(!t.isDragging){var e=o.DS.stores.PointerStore.initialValArea;L(o.HTMLNode,x(e,1)),o.HTMLNode.style.display="block",o._rect=null}})),i(this,"stop",(function(){o.HTMLNode.style.width="0",o.HTMLNode.style.height="0",o.HTMLNode.style.display="none"})),i(this,"update",(function(t){if(!t.isDragging&&!o.DS.continue){var e=o.DS.stores,n=e.ScrollStore,i=e.PointerStore,r=function(t){var e=t.scrollAmount,n=t.initialPointerPos,i=t.pointerPos,o={};return i.x>n.x-e.x?(o.left=n.x-e.x,o.width=i.x-n.x+e.x):(o.left=i.x,o.width=n.x-i.x-e.x),i.y>n.y-e.y?(o.top=n.y-e.y,o.height=i.y-n.y+e.y):(o.top=i.y,o.height=n.y-i.y-e.y),o}({scrollAmount:n.scrollAmount,initialPointerPos:i.initialValArea,pointerPos:i.currentValArea});L(o.HTMLNode,r),o._rect=null}})),this.DS=r,this.HTMLNode=s||function(t){var e=document.createElement("div");return e.style.position="absolute",t||(e.style.background="rgba(0, 0, 255, 0.1)",e.style.border="1px solid rgba(0, 0, 255, 0.45)",e.style.display="none",e.style.pointerEvents="none"),e}(l),this.HTMLNode.classList.add(a),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("Interaction:end",this.stop)}return n(e,[{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),e}(),V=function(){function e(n){var o=this,r=n.DS,s=n.selectorAreaClass,a=n.autoScrollSpeed,l=n.overflowTolerance;t(this,e),i(this,"_autoScrollSpeed",void 0),i(this,"_scrollInterval",void 0),i(this,"_rect",void 0),i(this,"currentEdges",[]),i(this,"_overflowTolerance",void 0),i(this,"start",(function(){return o.applyElements("append")})),i(this,"applyElements",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"append",e=document.body?"body":"documentElement",n="".concat(t,"Child");o.HTMLNode[n](o.DS.Selector.HTMLNode),document[e][n](o.HTMLNode)})),i(this,"updatePos",(function(){o._rect=null;var t=o.DS.Area.rect,e=o.DS.Area.computedBorder,n=o.HTMLNode.style,i="".concat(t.top+e.top,"px"),r="".concat(t.left+e.left,"px"),s="".concat(t.width,"px"),a="".concat(t.height,"px");n.top!==i&&(n.top=i),n.left!==r&&(n.left=r),n.width!==s&&(n.width=s),n.height!==a&&(n.height=a)})),i(this,"stop",(function(t){o.stopAutoScroll(),t&&o.applyElements("remove")})),i(this,"startAutoScroll",(function(){o.currentEdges=[],o._scrollInterval=setInterval((function(){return o.handleAutoScroll()}),16)})),i(this,"handleAutoScroll",(function(){if(!o.DS.continue){var t=o.DS,e=t.stores.PointerStore,n=t.Area;o.currentEdges=S({elementRect:x(e.currentVal),containerRect:o.rect,tolerance:o._overflowTolerance}),o.currentEdges.length&&n.scroll(o.currentEdges,o._autoScrollSpeed)}})),i(this,"stopAutoScroll",(function(){o.currentEdges=[],clearInterval(o._scrollInterval)})),i(this,"isInside",(function(t,e){return!(!o.DS.Area.HTMLNode.contains(t)||!o.DS.stores.ScrollStore.canScroll)||N(o.rect,e||t.getBoundingClientRect())})),this._autoScrollSpeed=a,this._overflowTolerance=l,this.DS=r,this.HTMLNode=function(t){var e=document.createElement("div");return e.style.position="fixed",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.zIndex="999999999999999999",e.classList.add(t),e}(s),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Interaction:init",this.start),this.DS.subscribe("Interaction:start",this.startAutoScroll),this.DS.subscribe("Interaction:end",(function(){o.updatePos(),o.stopAutoScroll()}))}return n(e,[{key:"isClicked",value:function(){var t=this.DS.stores.PointerStore;return N({left:t.initialVal.x,top:t.initialVal.y,right:t.initialVal.x,bottom:t.initialVal.y},this.rect)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),e}(),W=function(){function e(n){var o=this,r=n.DS,s=n.multiSelectKeys,a=n.multiSelectMode;t(this,e),i(this,"_multiSelectMode",void 0),i(this,"_multiSelectKeys",void 0),i(this,"_currentValues",new Set),i(this,"_keyMapping",{control:"ctrlKey",shift:"shiftKey",meta:"metaKey"}),i(this,"init",(function(){document.addEventListener("keydown",o.keydown),document.addEventListener("keyup",o.keyup),window.addEventListener("blur",o.reset)})),i(this,"keydown",(function(t){var e=t.key.toLowerCase();o._currentValues.add(e),o.DS.publish("KeyStore:down",{event:t,key:e})})),i(this,"keyup",(function(t){var e=t.key.toLowerCase();o._currentValues.delete(e),o.DS.publish("KeyStore:up",{event:t,key:e})})),i(this,"stop",(function(){document.removeEventListener("keydown",o.keydown),document.removeEventListener("keyup",o.reset),window.removeEventListener("blur",o.reset),o.reset()})),i(this,"reset",(function(){return o._currentValues.clear()})),this.DS=r,this._multiSelectMode=a,this._multiSelectKeys=s.map((function(t){var e={ctrlKey:"Control",shiftKey:"Shift",metaKey:"Meta"}[t];return e?(console.warn("[DragSelect] ".concat(t,' is deprecated. Use "').concat(e,'" instead. Act Now!. See docs for more info')),e.toLowerCase()):t.toLowerCase()})),this.DS.subscribe("Interaction:init",this.init)}return n(e,[{key:"isMultiSelectKeyPressed",value:function(t){var e=this;return!!this._multiSelectMode||!!this.currentValues.some((function(t){return e._multiSelectKeys.includes(t)}))||!(!t||!this._multiSelectKeys.some((function(n){return t[e._keyMapping[n]]})))}},{key:"currentValues",get:function(){return Array.from(this._currentValues.values())}}]),e}(),Y=function(){function e(n){var o=this,r=n.DS;t(this,e),i(this,"_isMouseInteraction",!1),i(this,"_initialValArea",void 0),i(this,"_currentValArea",void 0),i(this,"_lastValArea",void 0),i(this,"_initialVal",void 0),i(this,"_currentVal",void 0),i(this,"_lastVal",void 0),i(this,"_lastTouch",void 0),i(this,"init",(function(){document.addEventListener("mousemove",o.update),document.addEventListener("touchmove",o.update,{passive:!1})})),i(this,"update",(function(t){t&&(o.currentVal=T({event:o._normalizedEvent(t)}),o._isMouseInteraction&&o.DS.publish("PointerStore:updated",{event:t}))})),i(this,"stop",(function(){document.removeEventListener("mousemove",o.update),document.removeEventListener("touchmove",o.update,{passive:!1}),setTimeout((function(){return o._isMouseInteraction=!1}),100)})),i(this,"reset",(function(t){t&&(o.currentVal=o.lastVal=T({event:o._normalizedEvent(t)}),o.stop(),o.init())})),this.DS=r,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(t){var e=t.event;return o.start(e)})),this.DS.subscribe("Interaction:end",(function(t){var e=t.event;return o.reset(e)}))}return n(e,[{key:"start",value:function(t){t&&(this._isMouseInteraction=!0,this.currentVal=this.initialVal=T({event:this._normalizedEvent(t)}))}},{key:"_normalizedEvent",value:function(t){return"touches"in t&&"touchend"!==t.type&&(this._lastTouch=t),"touches"in t?this._lastTouch.touches[0]:t}},{key:"initialValArea",get:function(){return this._initialValArea?this._initialValArea:{x:0,y:0}}},{key:"currentValArea",get:function(){return this._currentValArea?this._currentValArea:{x:0,y:0}}},{key:"lastValArea",get:function(){return this._lastValArea?this._lastValArea:{x:0,y:0}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}},set:function(t){this._initialVal=t,this._initialValArea=t&&b(t,"-",b(_(this.DS.Area.rect),"+",_(this.DS.Area.computedBorder)))}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}},set:function(t){this._currentVal=t,this._currentValArea=t&&b(t,"-",b(_(this.DS.Area.rect),"+",_(this.DS.Area.computedBorder)))}},{key:"lastVal",get:function(){return this._lastVal?this._lastVal:{x:0,y:0}},set:function(t){this._lastVal=t,this._lastValArea=t&&b(t,"-",b(_(this.DS.Area.rect),"+",_(this.DS.Area.computedBorder)))}}]),e}(),F=function(){function e(n){var o=this,r=n.DS,s=n.areaElement,a=n.zoom;t(this,e),i(this,"_initialVal",void 0),i(this,"_currentVal",void 0),i(this,"_areaElement",void 0),i(this,"_canScroll",void 0),i(this,"init",(function(){return o._areaElement.addEventListener("scroll",o.update)})),i(this,"start",(function(){o._currentVal=o._initialVal=E(o._areaElement),o._areaElement.addEventListener("scroll",o.update)})),i(this,"update",(function(){return o._currentVal=E(o._areaElement)})),i(this,"stop",(function(){o._areaElement.removeEventListener("scroll",o.update),o._initialVal={x:0,y:0},o._canScroll=null})),i(this,"reset",(function(){o.stop(),o.start()})),this._areaElement=s,this.DS=r,this.zoom=a,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(){return o.start()})),this.DS.subscribe("Interaction:end",(function(){return o.reset()}))}return n(e,[{key:"canScroll",get:function(){return"boolean"==typeof this._canScroll?this._canScroll:this._canScroll=(t=this._areaElement,!!((e=E(t)).x||e.y||(t instanceof HTMLDocument?t.body?t.body.scrollTop=1:t.documentElement.scrollTop=1:t.scrollTop=1)));var t,e}},{key:"scrollAmount",get:function(){var t,e=b(this.currentVal,"-",this.initialVal),n={x:t=this.zoom,y:t},i=b(b(e,"*",n),"-",e);return{x:e.x+i.x,y:e.y+i.y}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}}},{key:"currentVal",get:function(){return this._currentVal||(this._currentVal=E(this._areaElement)),this._currentVal}}]),e}(),$=function(){function e(n){var o=this,r=n.area,s=void 0===r?document:r,a=n.selectables,l=void 0===a?[]:a,c=n.autoScrollSpeed,u=void 0===c?5:c,d=n.overflowTolerance,h=void 0===d?{x:25,y:25}:d,p=n.zoom,f=void 0===p?1:p,g=n.customStyles,m=void 0!==g&&g,y=n.multiSelectMode,v=void 0!==y&&y,b=n.multiSelectToggling,_=void 0===b||b,x=n.multiSelectKeys,w=void 0===x?["Control","Shift","Meta"]:x,E=n.selector,S=void 0===E?void 0:E,T=n.draggability,k=void 0===T||T,A=n.immediateDrag,C=void 0===A||A,N=n.keyboardDrag,D=void 0===N||N,M=n.dragKeys,I=n.keyboardDragSpeed,L=void 0===I?10:I,$=n.useTransform,X=void 0===$||$,K=n.hoverClass,Q=void 0===K?"ds-hover":K,G=n.selectableClass,Z=void 0===G?"ds-selectable":G,J=n.selectedClass,tt=void 0===J?"ds-selected":J,et=n.selectorClass,nt=void 0===et?"ds-selector":et,it=n.selectorAreaClass,ot=void 0===it?"ds-selector-area":it,rt=n.callback,st=n.onDragMove,at=n.onDragStartBegin,lt=n.onDragStart,ct=n.onElementSelect,ut=n.onElementUnselect;t(this,e),i(this,"continue",!1),i(this,"start",(function(){return o.Interaction.init()})),i(this,"break",(function(){return o.continue=!0})),i(this,"getSelection",(function(){return o.SelectedSet.elements})),i(this,"getSelectables",(function(){return o.SelectableSet.elements})),i(this,"getInitialCursorPosition",(function(){return o.stores.PointerStore.initialVal})),i(this,"getCurrentCursorPosition",(function(){return o.stores.PointerStore.currentVal})),i(this,"getPreviousCursorPosition",(function(){return o.stores.PointerStore.lastVal})),i(this,"getInitialCursorPositionArea",(function(){return o.stores.PointerStore.initialValArea})),i(this,"getCurrentCursorPositionArea",(function(){return o.stores.PointerStore.currentValArea})),i(this,"getPreviousCursorPositionArea",(function(){return o.stores.PointerStore.lastValArea})),i(this,"isMultiSelect",(function(t){return o.stores.KeyStore.isMultiSelectKeyPressed(t)})),i(this,"isDragging",(function(){return o.Interaction.isDragging})),this.PubSub=new P,this.subscribe=this.PubSub.subscribe,this.unsubscribe=this.PubSub.unsubscribe,this.publish=this.PubSub.publish,this._callbacksTemp({callback:rt,onDragMove:st,onDragStart:lt,onDragStartBegin:at,onElementSelect:ct,onElementUnselect:ut}),this.stores={PointerStore:new Y({DS:this}),ScrollStore:new F({DS:this,areaElement:s,zoom:f}),KeyStore:new W({DS:this,multiSelectKeys:w,multiSelectMode:v})},this.Area=new B({area:s,PS:this.PubSub,zoom:f}),this.Selector=new q({DS:this,selector:S,selectorClass:nt,customStyles:m}),this.SelectorArea=new V({DS:this,selectorAreaClass:ot,autoScrollSpeed:u,overflowTolerance:h}),this.SelectableSet=new R({elements:l,DS:this,className:Z,hoverClassName:Q,useTransform:X,draggability:k}),this.SelectedSet=new H({DS:this,className:tt}),this.Selection=new U({DS:this,hoverClassName:Q,multiSelectToggling:_}),this.Drag=new O({DS:this,draggability:k,useTransform:X,keyboardDrag:D,dragKeys:Object.assign({up:["ArrowUp"],down:["ArrowDown"],left:["ArrowLeft"],right:["ArrowRight"]},M),zoom:f,keyboardDragSpeed:L}),this.Interaction=new z({areaElement:s,DS:this,draggability:k,immediateDrag:C}),j({subscribe:this.subscribe,publish:this.publish,SelectedSet:this.SelectedSet,Interaction:this.Interaction}),this.subscribe("Interaction:end",(function(){return o.continue=!1})),this.start()}return n(e,[{key:"_callbacksTemp",value:function(t){var e=t.callback,n=t.onDragMove,i=t.onDragStart,o=t.onDragStartBegin,r=t.onElementSelect,s=t.onElementUnselect,a=function(t,e){return console.warn("[DragSelect] ".concat(t,' is deprecated. Use DragSelect.subscribe("').concat(e,'", (callbackObject) => {}) instead. Act Now! See docs for more info'))};e&&(a("callback","callback"),this.subscribe("callback",(function(t){var n=t.items,i=(t.item,t.event);return e(n,i)}))),n&&(a("onDragMove","dragmove"),this.subscribe("dragmove",(function(t){t.items,t.item;var e=t.event;return n(e)}))),i&&(a("onDragStart","dragstart"),this.subscribe("dragstart",(function(t){t.items,t.item;var e=t.event;return i(e)}))),o&&(a("onDragStartBegin","dragstart"),this.subscribe("dragstart",(function(t){t.items,t.item;var e=t.event;return o(e)}))),r&&(a("onElementSelect","elementselect"),this.subscribe("elementselect",(function(t){t.items;var e=t.item,n=t.event;return r(e,n)}))),s&&(a("onElementUnselect","elementunselect"),this.subscribe("elementunselect",(function(t){t.items;var e=t.item,n=t.event;return s(e,n)})))}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.publish("callback",{items:this.getSelection()}),this.Interaction.stop(),this.Area.stop(),this.Drag.stop(),this.Selector.stop(),this.SelectorArea.stop(t),this.stores.KeyStore.stop(),this.stores.PointerStore.stop(),this.stores.ScrollStore.stop(),t&&this.SelectableSet.clear(),e&&this.SelectedSet.clear()}},{key:"addSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.SelectedSet.addAll(I(t)),n||this.addSelectables(t),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"removeSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.SelectedSet.deleteAll(I(t)),n&&this.removeSelectables(t),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"toggleSelection",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return I(t).forEach((function(o){return e.SelectedSet.has(o)?e.removeSelection(t,n,i):e.addSelection(t,n,i)})),n&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"setSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.clearSelection(),this.addSelection(t,e,n),this.getSelection()}},{key:"clearSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.SelectedSet.clear(),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"addSelectables",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=I(t);return this.SelectableSet.addAll(n),e&&this.SelectedSet.addAll(n),t}},{key:"setSelectables",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.removeSelectables(t,e),this.addSelectables(t,n)}},{key:"removeSelectables",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.SelectableSet.deleteAll(I(t)),e&&this.removeSelection(t),t}},{key:"getCursorPositionDifference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.warn("[DragSelect] Using .getCursorPositionDifference is deprecated. Calculate yourself instead. i.e. `.getCurrentCursorPosition().x - .getInitialCursorPosition().x`");var n=e?this.getCurrentCursorPositionArea():this.getCurrentCursorPosition(),i=t?e?this.getPreviousCursorPositionArea():this.getPreviousCursorPosition():e?this.getInitialCursorPositionArea():this.getInitialCursorPosition();return b(n,"-",i)}}]),e}();return $}()},865:(t,e,n)=>{var i=n(755),o=n(672);void 0===o.$&&(o.$=i),void 0===o.jQuery&&(o.jQuery=i),t.exports=i},803:(t,e,n)=>{var i=n(36),o=n(672),r=i.action_conf;void 0===o.action_conf&&(o.action_conf=r),t.exports=i},359:(t,e,n)=>{var i=n(36),o=n(672),r=i.combo_conf;void 0===o.combo_conf&&(o.combo_conf=r),t.exports=i},787:(t,e,n)=>{var i=n(36),o=n(672),r=i.custom_conf;void 0===o.custom_conf&&(o.custom_conf=r),t.exports=i},360:(t,e,n)=>{var i=n(36),o=n(672),r=i.meta_conf;void 0===o.meta_conf&&(o.meta_conf=r),t.exports=i},863:(t,e,n)=>{var i=n(36),o=n(672),r=i.meta_full_conf;void 0===o.meta_full_conf&&(o.meta_full_conf=r),t.exports=i},83:(t,e,n)=>{var i=n(36),o=n(672),r=i.navigation_conf;void 0===o.navigation_conf&&(o.navigation_conf=r),t.exports=i},879:(t,e,n)=>{var i=n(624),o=n(672),r=i.relation_get_notes_separated;void 0===o.relation_get_notes_separated&&(o.relation_get_notes_separated=r),t.exports=i},121:(t,e,n)=>{var i=n(624),o=n(672),r=i.relation_get_notes;void 0===o.relation_get_notes&&(o.relation_get_notes=r),t.exports=i},944:(t,e,n)=>{var i=n(36),o=n(672),r=i.type_conf;void 0===o.type_conf&&(o.type_conf=r),t.exports=i},480:(t,e,n)=>{var i=n(36),o=n(672),r=i.type_full_conf;void 0===o.type_full_conf&&(o.type_full_conf=r),t.exports=i},672:(t,e,n)=>{"use strict";t.exports=function(){if("object"==typeof globalThis)return globalThis;var t;try{t=this||new Function("return this")()}catch(t){if("object"==typeof window)return window;if("object"==typeof self)return self;if(void 0!==n.g)return n.g}return t}()},238:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;function jBoxWrapper(t){function e(n,i){return this.options={id:null,width:"auto",height:"auto",minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,responsiveWidth:!0,responsiveHeight:!0,responsiveMinWidth:100,responsiveMinHeight:100,attach:null,trigger:"click",preventDefault:!1,content:null,getContent:null,title:null,getTitle:null,footer:null,isolateScroll:!0,ajax:{url:null,data:"",reload:!1,getURL:"data-url",getData:"data-ajax",setContent:!0,loadingClass:!0,spinner:!0,spinnerDelay:300,spinnerReposition:!0},cancelAjaxOnClose:!0,target:null,position:{x:"center",y:"center"},outside:null,offset:0,attributes:{x:"left",y:"top"},fixed:!1,adjustPosition:!0,adjustTracker:!1,adjustDistance:5,reposition:!0,repositionOnOpen:!0,repositionOnContent:!0,holdPosition:!0,pointer:!1,pointTo:"target",fade:180,animation:null,theme:"Default",addClass:null,overlay:!1,overlayClass:null,zIndex:1e4,delayOpen:0,delayClose:0,closeOnEsc:!1,closeOnClick:!1,closeOnMouseleave:!1,closeButton:!1,appendTo:t("body"),createOnInit:!1,blockScroll:!1,blockScrollAdjust:!0,draggable:!1,dragOver:!0,autoClose:!1,delayOnHover:!1,showCountdown:!1,preloadAudio:!0,audio:null,volume:100,onInit:null,onAttach:null,onPosition:null,onCreated:null,onOpen:null,onOpenComplete:null,onClose:null,onCloseComplete:null,onDragStart:null,onDragEnd:null},this._pluginOptions={Tooltip:{getContent:"title",trigger:"mouseenter",position:{x:"center",y:"top"},outside:"y",pointer:!0},Mouse:{responsiveWidth:!1,responsiveHeight:!1,adjustPosition:"flip",target:"mouse",trigger:"mouseenter",position:{x:"right",y:"bottom"},outside:"xy",offset:5},Modal:{target:t(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomIn"}},this.options=t.extend(!0,this.options,this._pluginOptions[n]||e._pluginOptions[n],i),"string"==t.type(n)&&(this.type=n),this.isTouchDevice=function(){var t,e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||(t=e=["(",e.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(t).matches)}(),this.isTouchDevice&&"mouseenter"===this.options.trigger&&!1===this.options.closeOnClick&&(this.options.closeOnClick="body"),this._fireEvent=function(t,e){this.options["_"+t]&&this.options["_"+t].bind(this)(e),this.options[t]&&this.options[t].bind(this)(e)},null===this.options.id&&(this.options.id="jBox"+e._getUniqueID()),this.id=this.options.id,("center"==this.options.position.x&&"x"==this.options.outside||"center"==this.options.position.y&&"y"==this.options.outside)&&(this.options.outside=null),"target"!=this.options.pointTo||this.options.outside&&"xy"!=this.options.outside||(this.options.pointer=!1),"object"!=t.type(this.options.offset)?this.options.offset={x:this.options.offset,y:this.options.offset}:this.options.offset=t.extend({x:0,y:0},this.options.offset),"object"!=t.type(this.options.adjustDistance)?this.options.adjustDistance={top:this.options.adjustDistance,right:this.options.adjustDistance,bottom:this.options.adjustDistance,left:this.options.adjustDistance}:this.options.adjustDistance=t.extend({top:5,left:5,right:5,bottom:5},this.options.adjustDistance),this.outside=!(!this.options.outside||"xy"==this.options.outside)&&this.options.position[this.options.outside],this.align=this.outside||("center"!=this.options.position.y&&"number"!=t.type(this.options.position.y)?this.options.position.x:"center"!=this.options.position.x&&"number"!=t.type(this.options.position.x)?this.options.position.y:this.options.attributes.x),e.zIndexMax=Math.max(e.zIndexMax||0,"auto"===this.options.zIndex?1e4:this.options.zIndex),"auto"===this.options.zIndex&&(this.adjustZIndexOnOpen=!0,this.options.zIndex=e.zIndexMax+=2,this.trueModal=this.options.overlay),this._getOpp=function(t){return{left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"}[t]},this._getXY=function(t){return{left:"x",right:"x",top:"y",bottom:"y",center:"x"}[t]},this._getTL=function(t){return{left:"left",right:"left",top:"top",bottom:"top",center:"left",x:"left",y:"top"}[t]},this._getInt=function(e,n){return"auto"==e?"auto":e&&"string"==t.type(e)&&"%"==e.slice(-1)?t(window)["height"==n?"innerHeight":"innerWidth"]()*parseInt(e.replace("%",""))/100:e},this._createSVG=function(e,n){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return t.each(n,(function(t,e){i.setAttribute(e[0],e[1]||"")})),i},this._isolateScroll=function(t){t&&t.length&&t.on("DOMMouseScroll.jBoxIsolateScroll mousewheel.jBoxIsolateScroll",(function(e){var n=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail,i=0<=this.scrollTop+t.outerHeight()-this.scrollHeight,o=this.scrollTop<=0;(n<0&&i||0<n&&o)&&e.preventDefault()}))},this._setTitleWidth=function(){if(!this.titleContainer||"auto"==this.content[0].style.width&&!this.content[0].style.maxWidth)return null;var t;"none"==this.wrapper.css("display")?(this.wrapper.css("display","block"),t=this.content.outerWidth(),this.wrapper.css("display","none")):t=this.content.outerWidth(),this.titleContainer.css({maxWidth:Math.max(t,parseInt(this.content[0].style.maxWidth))||null})},this._draggable=function(){if(!this.options.draggable)return!1;var n="title"==this.options.draggable?this.titleContainer:this.options.draggable instanceof t?this.options.draggable:"string"==t.type(this.options.draggable)?t(this.options.draggable):this.wrapper;return!(!(n&&n instanceof t&&n.length)||n.data("jBox-draggable"))&&(n.addClass("jBox-draggable").data("jBox-draggable",!0).on("touchstart mousedown",function(n){var i,o,r,s,a,l;2==n.button||t(n.target).hasClass("jBox-noDrag")||t(n.target).parents(".jBox-noDrag").length?"touchstart"==n.type&&(t(n.target).hasClass("jBox-closeButton")||t(n.target).parents(".jBox-closeButton").length)&&this.close({ignoreDelay:!0}):(o="touchstart"==n.type&&n.touches&&n.touches[0]?(i=n.touches[0].pageX,n.touches[0].pageY):(i=n.pageX,n.pageY),this.draggingStartX=i,this.draggingStartY=o,this.options.dragOver&&!this.trueModal&&parseInt(this.wrapper.css("zIndex"),10)<=e.zIndexMaxDragover&&(e.zIndexMaxDragover+=1,this.wrapper.css("zIndex",e.zIndexMaxDragover)),r=this.wrapper.outerHeight(),s=this.wrapper.outerWidth(),a=this.wrapper.offset().top+r-o,l=this.wrapper.offset().left+s-i,t(document).on("touchmove.jBox-draggable-"+this.id+" mousemove.jBox-draggable-"+this.id,function(t){var e;t="touchmove"==t.type&&t.touches&&t.touches[0]?(e=t.touches[0].pageX,t.touches[0].pageY):(e=t.pageX,t.pageY),this.dragging||this.draggingStartX==e||this.draggingStartY==t||(this._fireEvent("onDragStart"),this.dragging=!0),this.wrapper.offset({top:t+a-r,left:e+l-s})}.bind(this)),n.preventDefault())}.bind(this)).on("touchend mouseup",function(){var e;t(document).off("touchmove.jBox-draggable-"+this.id+" mousemove.jBox-draggable-"+this.id),this.dragging&&this._fireEvent("onDragEnd"),this.dragging=!1,"Modal"!=this.type&&"Confirm"!=this.type||!this.options.holdPosition||(e={x:(e=t("#"+this.id).offset()).left-t(document).scrollLeft(),y:e.top-t(document).scrollTop()},this.position({position:e,offset:{x:0,y:0}}))}.bind(this)),this.trueModal||(e.zIndexMaxDragover=e.zIndexMaxDragover?Math.max(e.zIndexMaxDragover,this.options.zIndex):this.options.zIndex),this)},this._create=function(){var e;this.wrapper||(this.wrapper=t("<div/>",{id:this.id,class:"jBox-wrapper"+(this.type?" jBox-"+this.type:"")+(this.options.theme?" jBox-"+this.options.theme:"")+(this.options.addClass?" "+this.options.addClass:"")}).css({position:this.options.fixed?"fixed":"absolute",display:"none",opacity:0,zIndex:this.options.zIndex}).data("jBox",this),this.options.closeOnMouseleave&&this.wrapper.on("mouseleave",function(e){!this.source||e.relatedTarget!=this.source[0]&&-1===t.inArray(this.source[0],t(e.relatedTarget).parents("*"))&&this.close()}.bind(this)),"box"==this.options.closeOnClick&&this.wrapper.on("click tap",function(){this.close({ignoreDelay:!0})}.bind(this)),this.container=t('<div class="jBox-container"/>').appendTo(this.wrapper),this.content=t('<div class="jBox-content"/>').appendTo(this.container),this.options.footer&&(this.footer=t('<div class="jBox-footer"/>').append(this.options.footer).appendTo(this.container)),this.options.isolateScroll&&this._isolateScroll(this.content),this.options.closeButton&&((e=this._createSVG("svg",[["viewBox","0 0 24 24"]])).appendChild(this._createSVG("path",[["d","M22.2,4c0,0,0.5,0.6,0,1.1l-6.8,6.8l6.9,6.9c0.5,0.5,0,1.1,0,1.1L20,22.3c0,0-0.6,0.5-1.1,0L12,15.4l-6.9,6.9c-0.5,0.5-1.1,0-1.1,0L1.7,20c0,0-0.5-0.6,0-1.1L8.6,12L1.7,5.1C1.2,4.6,1.7,4,1.7,4L4,1.7c0,0,0.6-0.5,1.1,0L12,8.5l6.8-6.8c0.5-0.5,1.1,0,1.1,0L22.2,4z"]])),this.closeButton=t('<div class="jBox-closeButton jBox-noDrag"/>').on("click tap",function(t){this.close({ignoreDelay:!0})}.bind(this)).append(e),"box"!=this.options.closeButton&&(!0!==this.options.closeButton||this.options.overlay||this.options.title||this.options.getTitle)||(this.wrapper.addClass("jBox-closeButton-box"),this.closeButton.appendTo(this.container))),this.wrapper.appendTo(this.options.appendTo),this.wrapper.find(".jBox-closeButton").length&&t.each(["top","right","bottom","left"],function(t,e){this.wrapper.find(".jBox-closeButton").css(e)&&"auto"!=this.wrapper.find(".jBox-closeButton").css(e)&&(this.options.adjustDistance[e]=Math.max(this.options.adjustDistance[e],this.options.adjustDistance[e]+-1*((parseInt(this.wrapper.find(".jBox-closeButton").css(e))||0)+(parseInt(this.container.css("border-"+e+"-width"))||0))))}.bind(this)),this.options.pointer&&(this.pointer={position:"target"!=this.options.pointTo?this.options.pointTo:this._getOpp(this.outside),xy:"target"!=this.options.pointTo?this._getXY(this.options.pointTo):this._getXY(this.outside),align:"center",offset:0},this.pointer.element=t('<div class="jBox-pointer jBox-pointer-'+this.pointer.position+'"/>').appendTo(this.wrapper),this.pointer.dimensions={x:this.pointer.element.outerWidth(),y:this.pointer.element.outerHeight()},"string"==t.type(this.options.pointer)&&((e=this.options.pointer.split(":"))[0]&&(this.pointer.align=e[0]),e[1]&&(this.pointer.offset=parseInt(e[1]))),this.pointer.alignAttribute="x"==this.pointer.xy?"bottom"==this.pointer.align?"bottom":"top":"right"==this.pointer.align?"right":"left",this.wrapper.css("padding-"+this.pointer.position,this.pointer.dimensions[this.pointer.xy]),this.pointer.element.css(this.pointer.alignAttribute,"center"==this.pointer.align?"50%":0).css("margin-"+this.pointer.alignAttribute,this.pointer.offset),this.pointer.margin={},this.pointer.margin["margin-"+this.pointer.alignAttribute]=this.pointer.offset,"center"==this.pointer.align&&this.pointer.element.css("transform","translate("+("y"==this.pointer.xy?-.5*this.pointer.dimensions.x+"px":0)+", "+("x"==this.pointer.xy?-.5*this.pointer.dimensions.y+"px":0)+")"),this.pointer.element.css("x"==this.pointer.xy?"width":"height",parseInt(this.pointer.dimensions[this.pointer.xy])+parseInt(this.container.css("border-"+this.pointer.alignAttribute+"-width"))),this.wrapper.addClass("jBox-pointerPosition-"+this.pointer.position)),this.setContent(this.options.content,!0),this.setTitle(this.options.title,!0),this.options.draggable&&this._draggable(),this._fireEvent("onCreated"))},this.options.createOnInit&&this._create(),this.options.attach&&this.attach(),this._attachEvents=function(){this.options.delayOnHover&&t("#"+this.id).on("mouseenter",function(t){this.isHovered=!0}.bind(this)),this.options.delayOnHover&&t("#"+this.id).on("mouseleave",function(t){this.isHovered=!1}.bind(this)),(this.options.adjustPosition||this.options.reposition)&&!this.fixed&&this.outside&&(this.options.adjustTracker&&t(window).on("scroll.jBox-"+this.id,function(t){this.position()}.bind(this)),(this.options.adjustPosition||this.options.reposition)&&t(window).on("resize.jBox-"+this.id,function(t){this.position()}.bind(this))),"mouse"==this.options.target&&t("body").on("mousemove.jBox-"+this.id,function(t){this.position({mouseTarget:{top:t.pageY,left:t.pageX}})}.bind(this))},this._detachEvents=function(){this.options.closeOnEsc&&t(document).off("keyup.jBox-"+this.id),!0!==this.options.closeOnClick&&"body"!=this.options.closeOnClick||t(document).off("click.jBox-"+this.id+" tap.jBox-"+this.id),this.options.adjustTracker&&t(window).off("scroll.jBox-"+this.id),(this.options.adjustPosition||this.options.reposition)&&t(window).off("resize.jBox-"+this.id),"mouse"==this.options.target&&t("body").off("mousemove.jBox-"+this.id)},this._showOverlay=function(){this.overlay||(this.overlay=t('<div id="'+this.id+'-overlay"/>').addClass("jBox-overlay"+(this.type?" jBox-overlay-"+this.type:"")).css({display:"none",opacity:0,zIndex:this.options.zIndex-1}).appendTo(this.options.appendTo),this.options.overlayClass&&this.overlay.addClass(this.options.overlayClass),"overlay"!=this.options.closeButton&&!0!==this.options.closeButton||this.overlay.append(this.closeButton),"overlay"==this.options.closeOnClick&&this.overlay.on("click tap",function(){this.close({ignoreDelay:!0})}.bind(this)),t("#"+this.id+"-overlay .jBox-closeButton").length&&(this.options.adjustDistance.top=Math.max(t("#"+this.id+"-overlay .jBox-closeButton").outerHeight(),this.options.adjustDistance.top))),!0===this.adjustZIndexOnOpen&&this.overlay.css("zIndex",parseInt(this.wrapper.css("zIndex"),10)-1),"block"!=this.overlay.css("display")&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.overlay.css({display:"block"})}.bind(this)}):this.overlay.css({display:"block",opacity:1}))},this._hideOverlay=function(){this.overlay&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:0},{queue:!1,duration:this.options.fade,complete:function(){this.overlay.css({display:"none"})}.bind(this)}):this.overlay.css({display:"none",opacity:0}))},this._exposeDimensions=function(){this.wrapper.css({top:-1e4,left:-1e4,right:"auto",bottom:"auto"});var t={x:this.wrapper.outerWidth(),y:this.wrapper.outerHeight()};return this.wrapper.css({top:"auto",left:"auto"}),t},this._generateAnimationCSS=function(){if("object"!=t.type(this.options.animation)&&(this.options.animation={pulse:{open:"pulse",close:"zoomOut"},zoomIn:{open:"zoomIn",close:"zoomIn"},zoomOut:{open:"zoomOut",close:"zoomOut"},move:{open:"move",close:"move"},slide:{open:"slide",close:"slide"},flip:{open:"flip",close:"flip"},tada:{open:"tada",close:"zoomOut"}}[this.options.animation]),!this.options.animation)return null;this.options.animation.open&&(this.options.animation.open=this.options.animation.open.split(":")),this.options.animation.close&&(this.options.animation.close=this.options.animation.close.split(":")),this.options.animation.openDirection=this.options.animation.open[1]||null,this.options.animation.closeDirection=this.options.animation.close[1]||null,this.options.animation.open&&(this.options.animation.open=this.options.animation.open[0]),this.options.animation.close&&(this.options.animation.close=this.options.animation.close[0]),this.options.animation.open&&(this.options.animation.open+="Open"),this.options.animation.close&&(this.options.animation.close+="Close");var e={pulse:{duration:350,css:[["0%","scale(1)"],["50%","scale(1.1)"],["100%","scale(1)"]]},zoomInOpen:{duration:this.options.fade||180,css:[["0%","scale(0.9)"],["100%","scale(1)"]]},zoomInClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(0.9)"]]},zoomOutOpen:{duration:this.options.fade||180,css:[["0%","scale(1.1)"],["100%","scale(1)"]]},zoomOutClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(1.1)"]]},moveOpen:{duration:this.options.fade||180,positions:{top:{"0%":-12},right:{"0%":12},bottom:{"0%":12},left:{"0%":-12}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},moveClose:{duration:this.options.fade||180,timing:"ease-in",positions:{top:{"100%":-12},right:{"100%":12},bottom:{"100%":12},left:{"100%":-12}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},slideOpen:{duration:400,positions:{top:{"0%":-400},right:{"0%":400},bottom:{"0%":400},left:{"0%":-400}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},slideClose:{duration:400,timing:"ease-in",positions:{top:{"100%":-400},right:{"100%":400},bottom:{"100%":400},left:{"100%":-400}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},flipOpen:{duration:600,css:[["0%","perspective(400px) rotateX(90deg)"],["40%","perspective(400px) rotateX(-15deg)"],["70%","perspective(400px) rotateX(15deg)"],["100%","perspective(400px) rotateX(0deg)"]]},flipClose:{duration:this.options.fade||300,css:[["0%","perspective(400px) rotateX(0deg)"],["100%","perspective(400px) rotateX(90deg)"]]},tada:{duration:800,css:[["0%","scale(1)"],["10%, 20%","scale(0.9) rotate(-3deg)"],["30%, 50%, 70%, 90%","scale(1.1) rotate(3deg)"],["40%, 60%, 80%","scale(1.1) rotate(-3deg)"],["100%","scale(1) rotate(0)"]]}};t.each(["pulse","tada"],(function(t,n){e[n+"Open"]=e[n+"Close"]=e[n]}));var n=function(n,i){var o="@keyframes jBox-"+this.id+"-animation-"+this.options.animation[n]+"-"+n+(i?"-"+i:"")+" {";return t.each(e[this.options.animation[n]].css,function(t,r){var s=i?r[1].replace("%XY",this._getXY(i).toUpperCase()):r[1];e[this.options.animation[n]].positions&&(s=s.replace("%V",e[this.options.animation[n]].positions[i][r[0]])),o+=r[0]+" {transform:"+s+";}"}.bind(this)),o+="}",o+=".jBox-"+this.id+"-animation-"+this.options.animation[n]+"-"+n+(i?"-"+i:"")+" {",o+="animation-duration: "+e[this.options.animation[n]].duration+"ms;",o+="animation-name: jBox-"+this.id+"-animation-"+this.options.animation[n]+"-"+n+(i?"-"+i:"")+";",o+=e[this.options.animation[n]].timing?"animation-timing-function: "+e[this.options.animation[n]].timing+";":"",o+="}"}.bind(this);this._animationCSS="",t.each(["open","close"],function(i,o){if(!this.options.animation[o]||!e[this.options.animation[o]]||"close"==o&&!this.options.fade)return"";e[this.options.animation[o]].positions?t.each(["top","right","bottom","left"],function(t,e){this._animationCSS+=n(o,e)}.bind(this)):this._animationCSS+=n(o)}.bind(this))},this.options.animation&&this._generateAnimationCSS(),this._blockBodyClick=function(){this.blockBodyClick=!0,setTimeout(function(){this.blockBodyClick=!1}.bind(this),10)},this._animate=function(t){if(t=t||(this.isOpen?"open":"close"),!this.options.fade&&"close"==t)return null;var e=this.options.animation[t+"Direction"]||("center"!=this.align?this.align:this.options.attributes.x);this.flipped&&this._getXY(e)==this._getXY(this.align)&&(e=this._getOpp(e));var n="jBox-"+this.id+"-animation-"+this.options.animation[t]+"-"+t+" jBox-"+this.id+"-animation-"+this.options.animation[t]+"-"+t+"-"+e;this.wrapper.addClass(n),e=1e3*parseFloat(this.wrapper.css("animation-duration")),"close"==t&&(e=Math.min(e,this.options.fade)),setTimeout(function(){this.wrapper&&this.wrapper.removeClass(n)}.bind(this),e)},this._abortAnimation=function(){var t=this.wrapper.attr("class").split(" ").filter(function(t){return 0!==t.lastIndexOf("jBox-"+this.id+"-animation",0)}.bind(this));this.wrapper.attr("class",t.join(" "))},(this.options.responsiveWidth||this.options.responsiveHeight)&&t(window).on("resize.responsivejBox-"+this.id,function(t){this.isOpen&&this.position()}.bind(this)),"string"===t.type(this.options.preloadAudio)&&(this.options.preloadAudio=[this.options.preloadAudio]),"string"===t.type(this.options.audio)&&(this.options.audio={open:this.options.audio}),"number"===t.type(this.options.volume)&&(this.options.volume={open:this.options.volume,close:this.options.volume}),!0===this.options.preloadAudio&&this.options.audio&&(this.options.preloadAudio=[],t.each(this.options.audio,function(t,e){this.options.preloadAudio.push(e+".mp3"),this.options.preloadAudio.push(e+".ogg")}.bind(this))),this.options.preloadAudio.length&&t.each(this.options.preloadAudio,(function(t,e){var n=new Audio;n.src=e,n.preload="auto"})),this._fireEvent("onInit"),this}var n,i;return e.prototype.attach=function(e,n){return e=e||this.options.attach,"string"==t.type(e)&&(e=t(e)),n=n||this.options.trigger,e&&e.length&&t.each(e,function(e,i){(i=t(i)).data("jBox-attached-"+this.id)||("title"==this.options.getContent&&null!=i.attr("title")&&i.data("jBox-getContent",i.attr("title")).removeAttr("title"),this.attachedElements||(this.attachedElements=[]),this.attachedElements.push(i[0]),i.on(n+".jBox-attach-"+this.id,function(t){var e;this.timer&&clearTimeout(this.timer),"mouseenter"==n&&this.isOpen&&this.source[0]==i[0]||(this.isOpen&&this.source&&this.source[0]!=i[0]&&(e=!0),this.source=i,this.options.target||(this.target=i),"click"==n&&this.options.preventDefault&&t.preventDefault(),this["click"!=n||e?"open":"toggle"]())}.bind(this)),"mouseenter"==this.options.trigger&&i.on("mouseleave",function(e){if(!this.wrapper)return null;this.options.closeOnMouseleave&&(e.relatedTarget==this.wrapper[0]||t(e.relatedTarget).parents("#"+this.id).length)||this.close()}.bind(this)),i.data("jBox-attached-"+this.id,n),this._fireEvent("onAttach",i))}.bind(this)),this},e.prototype.detach=function(e){return(e=e||this.attachedElements||[])&&e.length&&t.each(e,function(e,n){(n=t(n)).data("jBox-attached-"+this.id)&&(n.off(n.data("jBox-attached-"+this.id)+".jBox-attach-"+this.id),n.data("jBox-attached-"+this.id,null)),this.attachedElements=t.grep(this.attachedElements,(function(t){return t!=n[0]}))}.bind(this)),this},e.prototype.setTitle=function(e,n){if(null==e||null==e)return this;this.wrapper||this._create();var i=this.wrapper.outerHeight(),o=this.wrapper.outerWidth();return this.title||(this.titleContainer=t('<div class="jBox-title"/>'),this.title=t("<div/>").appendTo(this.titleContainer),"title"!=this.options.closeButton&&(!0!==this.options.closeButton||this.options.overlay)||(this.wrapper.addClass("jBox-closeButton-title"),this.closeButton.appendTo(this.titleContainer)),this.titleContainer.insertBefore(this.content),this._setTitleWidth()),this.wrapper[e?"addClass":"removeClass"]("jBox-hasTitle"),this.title.html(e),o!=this.wrapper.outerWidth()&&this._setTitleWidth(),this.options.draggable&&this._draggable(),n||!this.options.repositionOnContent||i==this.wrapper.outerHeight()&&o==this.wrapper.outerWidth()||this.position(),this},e.prototype.setContent=function(e,n){if(null==e||null==e)return this;this.wrapper||this._create();var i=this.wrapper.outerHeight(),o=this.wrapper.outerWidth();switch(this.content.children("[data-jbox-content-appended]").appendTo("body").css({display:"none"}),t.type(e)){case"string":this.content.html(e);break;case"object":e&&(e instanceof t||e.constructor.prototype.jquery)?(this.content.html(""),e.attr("data-jbox-content-appended",1).appendTo(this.content).css({display:"block"})):this.content.html(JSON.stringify(e))}return o!=this.wrapper.outerWidth()&&this._setTitleWidth(),this.options.draggable&&this._draggable(),n||!this.options.repositionOnContent||i==this.wrapper.outerHeight()&&o==this.wrapper.outerWidth()||this.position(),this},e.prototype.setDimensions=function(t,e,n){this.wrapper||this._create(),this.content.css(t,this._getInt(e=null==e?"auto":e)),"width"==t&&this._setTitleWidth(),this.options[t]=e,null!=n&&!n||this.position()},e.prototype.setWidth=function(t,e){this.setDimensions("width",t,e)},e.prototype.setHeight=function(t,e){this.setDimensions("height",t,e)},e.prototype.position=function(e){if(e=t.extend(!0,this.options,e=e||{}),this.target=e.target||this.target||t(window),this.target instanceof t||"mouse"==this.target||(this.target=t(this.target)),!this.target.length)return this;this.content.css({width:this._getInt(e.width,"width"),height:this._getInt(e.height,"height"),minWidth:this._getInt(e.minWidth,"width"),minHeight:this._getInt(e.minHeight,"height"),maxWidth:this._getInt(e.maxWidth,"width"),maxHeight:this._getInt(e.maxHeight,"height")}),this._setTitleWidth();var n=this._exposeDimensions();"mouse"==this.target||this.target.data("jBox-"+this.id+"-fixed")||this.target.data("jBox-"+this.id+"-fixed",this.target[0]!=t(window)[0]&&("fixed"==this.target.css("position")||0<this.target.parents().filter((function(){return"fixed"==t(this).css("position")})).length)?"fixed":"static");var i={x:t(window).outerWidth(),y:t(window).outerHeight(),top:e.fixed&&this.target.data("jBox-"+this.id+"-fixed")?0:t(window).scrollTop(),left:e.fixed&&this.target.data("jBox-"+this.id+"-fixed")?0:t(window).scrollLeft()};i.bottom=i.top+i.y,i.right=i.left+i.x;try{var o=this.target.offset()}catch(i){o={top:0,left:0}}"mouse"!=this.target&&"fixed"==this.target.data("jBox-"+this.id+"-fixed")&&e.fixed&&(o.top=o.top-t(window).scrollTop(),o.left=o.left-t(window).scrollLeft());var r={x:"mouse"==this.target?12:this.target.outerWidth(),y:"mouse"==this.target?20:this.target.outerHeight(),top:"mouse"==this.target&&e.mouseTarget?e.mouseTarget.top:o?o.top:0,left:"mouse"==this.target&&e.mouseTarget?e.mouseTarget.left:o?o.left:0},s=e.outside&&!("center"==e.position.x&&"center"==e.position.y),a={x:i.x-e.adjustDistance.left-e.adjustDistance.right,y:i.y-e.adjustDistance.top-e.adjustDistance.bottom,left:s?r.left-t(window).scrollLeft()-e.adjustDistance.left:0,right:s?i.x-r.left+t(window).scrollLeft()-r.x-e.adjustDistance.right:0,top:s?r.top-t(window).scrollTop()-this.options.adjustDistance.top:0,bottom:s?i.y-r.top+t(window).scrollTop()-r.y-e.adjustDistance.bottom:0},l={x:"x"!=e.outside&&"xy"!=e.outside||"number"==t.type(e.position.x)?null:e.position.x,y:"y"!=e.outside&&"xy"!=e.outside||"number"==t.type(e.position.y)?null:e.position.y},c={x:!1,y:!1};l.x&&n.x>a[l.x]&&a[this._getOpp(l.x)]>a[l.x]&&(l.x=this._getOpp(l.x))&&(c.x=!0),l.y&&n.y>a[l.y]&&a[this._getOpp(l.y)]>a[l.y]&&(l.y=this._getOpp(l.y))&&(c.y=!0),(e.responsiveWidth||e.responsiveHeight)&&(m=function(){var t;e.responsiveWidth&&n.x>a[l.x||"x"]&&(t=a[l.x||"x"]-(this.pointer&&s&&"x"==e.outside?this.pointer.dimensions.x:0)-parseInt(this.container.css("border-left-width"))-parseInt(this.container.css("border-right-width")),this.content.css({width:t>this.options.responsiveMinWidth?t:null,minWidth:t<parseInt(this.content.css("minWidth"))?0:null}),this._setTitleWidth()),n=this._exposeDimensions()}.bind(this),e.responsiveWidth&&m(),e.responsiveWidth&&!c.y&&l.y&&n.y>a[l.y]&&a[this._getOpp(l.y)]>a[l.y]&&(l.y=this._getOpp(l.y))&&(c.y=!0),y=function(){var t;e.responsiveHeight&&n.y>a[l.y||"y"]&&(t=function(){return this.titleContainer||this.footer?("none"==this.wrapper.css("display")?(this.wrapper.css("display","block"),t=(this.titleContainer?this.titleContainer.outerHeight():0)+(this.footer?this.footer.outerHeight():0),this.wrapper.css("display","none")):t=(this.titleContainer?this.titleContainer.outerHeight():0)+(this.footer?this.footer.outerHeight():0),t||0):0;var t}.bind(this),t=a[l.y||"y"]-(this.pointer&&s&&"y"==e.outside?this.pointer.dimensions.y:0)-t()-parseInt(this.container.css("border-top-width"))-parseInt(this.container.css("border-bottom-width")),this.content.css({height:t>this.options.responsiveMinHeight?t:null}),this._setTitleWidth()),n=this._exposeDimensions()}.bind(this),e.responsiveHeight&&y(),e.responsiveHeight&&!c.x&&l.x&&n.x>a[l.x]&&a[this._getOpp(l.x)]>a[l.x]&&(l.x=this._getOpp(l.x))&&(c.x=!0),e.adjustPosition&&"move"!=e.adjustPosition&&(c.x&&m(),c.y&&y()));var u={},d=function(i){if("number"!=t.type(e.position[i])){var o=e.attributes[i]="x"==i?"left":"top";if(u[o]=r[o],"center"==e.position[i])return u[o]+=Math.ceil((r[i]-n[i])/2),void("mouse"!=this.target&&this.target[0]&&this.target[0]==t(window)[0]&&(u[o]+=.5*(e.adjustDistance[o]-e.adjustDistance[this._getOpp(o)])));o!=e.position[i]&&(u[o]+=r[i]-n[i]),e.outside!=i&&"xy"!=e.outside||(u[o]+=n[i]*(o!=e.position[i]?1:-1))}else u[e.attributes[i]]=e.position[i]}.bind(this);if(d("x"),d("y"),this.pointer&&"target"==e.pointTo&&"number"!=t.type(e.position.x)&&"number"!=t.type(e.position.y)&&(v=0,"center"===this.pointer.align?"center"!=e.position[this._getOpp(e.outside)]&&(v+=n[this._getOpp(e.outside)]/2):"center"===e.position[this._getOpp(e.outside)]?v+=(n[this._getOpp(e.outside)]/2-this.pointer.dimensions[this._getOpp(e.outside)]/2)*(this.pointer.align==this._getTL(this.pointer.align)?1:-1):v+=this.pointer.align!=e.position[this._getOpp(e.outside)]?n[this._getOpp(e.outside)]*(-1!==t.inArray(this.pointer.align,["top","left"])?1:-1)+this.pointer.dimensions[this._getOpp(e.outside)]/2*(-1!==t.inArray(this.pointer.align,["top","left"])?-1:1):this.pointer.dimensions[this._getOpp(e.outside)]/2*(-1!==t.inArray(this.pointer.align,["top","left"])?1:-1),v*=e.position[this._getOpp(e.outside)]==this.pointer.alignAttribute?-1:1,v+=this.pointer.offset*(this.pointer.align==this._getOpp(this._getTL(this.pointer.align))?1:-1),u[this._getTL(this._getOpp(this.pointer.xy))]+=v),u[e.attributes.x]+=e.offset.x,u[e.attributes.y]+=e.offset.y,this.wrapper.css(u),e.adjustPosition){this.positionAdjusted&&(this.pointer&&this.wrapper.css("padding",0).css("padding-"+this._getOpp(this.outside),this.pointer.dimensions[this._getXY(this.outside)]).removeClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).addClass("jBox-pointerPosition-"+this.pointer.position),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this._getOpp(this.outside)).css(this.pointer.margin),this.positionAdjusted=!1,this.flipped=!1);var h=i.top>u.top-(e.adjustDistance.top||0),p=i.right<u.left+n.x+(e.adjustDistance.right||0),f=i.bottom<u.top+n.y+(e.adjustDistance.bottom||0),g=i.left>u.left-(e.adjustDistance.left||0),m=h?"top":f?"bottom":null;if((o=g?"left":p?"right":null)||m){if(("Modal"==this.type||"Confirm"==this.type)&&"number"==t.type(this.options.position.x)&&"number"==t.type(this.options.position.y)){var y=0,v=0;return this.options.holdPosition&&(g?y=i.left-(u.left-(e.adjustDistance.left||0)):p&&(y=i.right-(u.left+n.x+(e.adjustDistance.right||0))),h?v=i.top-(u.top-(e.adjustDistance.top||0)):f&&(v=i.bottom-(u.top+n.y+(e.adjustDistance.bottom||0))),this.options.position.x=Math.max(i.top,this.options.position.x+y),this.options.position.y=Math.max(i.left,this.options.position.y+v),d("x"),d("y"),this.wrapper.css(u)),this._fireEvent("onPosition"),this}!0!==e.adjustPosition&&"flip"!==e.adjustPosition||(b=function(t){this.wrapper.css(this._getTL(t),u[this._getTL(t)]+(n[this._getXY(t)]+e.offset[this._getXY(t)]*("top"==t||"left"==t?-2:2)+r[this._getXY(t)])*("top"==t||"left"==t?1:-1)),this.pointer&&this.wrapper.removeClass("jBox-pointerPosition-"+this.pointer.position).addClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).css("padding",0).css("padding-"+t,this.pointer.dimensions[this._getXY(t)]),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+t),this.positionAdjusted=!0,this.flipped=!0}.bind(this),c.x&&b(this.options.position.x),c.y&&b(this.options.position.y));var b="x"==this._getXY(this.outside)?m:o;this.pointer&&"target"==e.pointTo&&"flip"!=e.adjustPosition&&this._getXY(b)==this._getOpp(this._getXY(this.outside))&&(m="center"==this.pointer.align?n[this._getXY(b)]/2-this.pointer.dimensions[this._getOpp(this.pointer.xy)]/2-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))*(b!=this._getTL(b)?-1:1):b==this.pointer.alignAttribute?parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute)):n[this._getXY(b)]-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-this.pointer.dimensions[this._getXY(b)],o=b==this._getTL(b)?i[this._getTL(b)]-u[this._getTL(b)]+e.adjustDistance[b]:-1*(i[this._getOpp(this._getTL(b))]-u[this._getTL(b)]-e.adjustDistance[b]-n[this._getXY(b)]),b==this._getOpp(this._getTL(b))&&u[this._getTL(b)]-o<i[this._getTL(b)]+e.adjustDistance[this._getTL(b)]&&(o-=i[this._getTL(b)]+e.adjustDistance[this._getTL(b)]-(u[this._getTL(b)]-o)),(o=Math.min(o,m))<=m&&0<o&&(this.pointer.element.css("margin-"+this.pointer.alignAttribute,parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-o*(b!=this.pointer.alignAttribute?-1:1)),this.wrapper.css(this._getTL(b),u[this._getTL(b)]+o*(b!=this._getTL(b)?-1:1)),this.positionAdjusted=!0))}}return this._fireEvent("onPosition"),this},(e.prototype.unscroll=function(t){if(this.set=function(t,e){window.unscrollStore||(window.unscrollStore={}),window.unscrollStore[t]=e},this.get=function(t){return window.unscrollStore?window.unscrollStore[t]:null},this.getScrollbarWidth=function(){if(this.get("scrollbarWidth"))return this.get("scrollbarWidth")+"px";var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-10000",document.body.appendChild(t);var e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),this.set("scrollbarWidth",e),e+"px"},this.getElementsToAdjust=function(t){(t="string"==typeof(t=t||[])?[[t,"padding-right"]]:t).forEach((function(e,n){"string"==typeof e&&(t[n]=[e,"padding-right"])}));for(var e=!1,n=0;n<t.length;n++)-1!==t[n][0].indexOf("body")&&(e=!0);return!1===e&&t.push(["body","padding-right"]),t},this.pageHasScrollbar=function(){return this.getScrollbarWidth()&&document.body.offsetHeight>window.innerHeight},this.pageHasScrollbar()){t=this.getElementsToAdjust(t);for(var e=0;e<t.length;e++)for(var n=document.querySelectorAll(t[e][0]),i=0;i<n.length;i++){if(n[i].getAttribute("data-unscroll"))return;var o=t[e][1],r=window.getComputedStyle(n[i]).getPropertyValue(o);n[i].setAttribute("data-unscroll",o),n[i].style[o]="calc("+(r=r||"0px")+" "+("padding-right"==o||"right"==o?"+":"-")+" "+this.getScrollbarWidth()+")"}}var s,a;document.getElementById("unscroll-class-name")||(s=document.head||document.getElementsByTagName("head")[0],(a=document.createElement("style")).type="text/css",a.setAttribute("id","unscroll-class-name"),a.appendChild(document.createTextNode(".unscrollable { overflow: hidden !important; }")),s.appendChild(a)),document.body.classList.add("unscrollable")}).reset=function(){for(var t=document.querySelectorAll("[data-unscroll]"),e=0;e<t.length;e++){var n=t[e].getAttribute("data-unscroll");t[e].style[n]=null,t[e].removeAttribute("data-unscroll")}document.body.classList.remove("unscrollable")},e.prototype.open=function(n){if(n=n||{},this.isDestroyed)return this;if(this.wrapper||this._create(),this._styles||(this._styles=t("<style/>").append(this._animationCSS).appendTo(t("head"))),this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;this.options.closeOnEsc&&t(document).on("keyup.jBox-"+this.id,function(t){27==t.keyCode&&this.close({ignoreDelay:!0})}.bind(this)),!0!==this.options.closeOnClick&&"body"!==this.options.closeOnClick||(t("body").on("click.jBox-"+this.id+" tap.jBox-"+this.id,function(t){this.blockBodyClick||"body"==this.options.closeOnClick&&(t.target==this.wrapper[0]||this.wrapper.has(t.target).length)||this.close({ignoreDelay:!0})}.bind(this)),this.isTouchDevice&&t("body > *").on("click.jBox-"+this.id+" tap.jBox-"+this.id,(function(){return!0})));var i=function(){!0===this.adjustZIndexOnOpen&&(e.zIndexMax=Math.max(parseInt(this.wrapper.css("zIndex"),10),this.options.zIndex,e.zIndexMax||0,e.zIndexMaxDragover||0)+2,this.wrapper.css("zIndex",e.zIndexMax),this.options.zIndex=e.zIndexMax),this.source&&this.options.getTitle&&this.source.attr(this.options.getTitle)&&this.setTitle(this.source.attr(this.options.getTitle),!0),this.source&&this.options.getContent&&(this.source.data("jBox-getContent")?this.setContent(this.source.data("jBox-getContent"),!0):this.source.attr(this.options.getContent)?this.setContent(this.source.attr(this.options.getContent),!0):"html"==this.options.getContent&&this.setContent(this.source.html(),!0)),this._fireEvent("onOpen"),(this.options.ajax&&(this.options.ajax.url||this.source&&this.source.attr(this.options.ajax.getURL))&&(!this.ajaxLoaded||this.options.ajax.reload)||n.ajax&&(n.ajax.url||n.ajax.data))&&("strict"==this.options.ajax.reload||!this.source||!this.source.data("jBox-ajax-data")||n.ajax&&(n.ajax.url||n.ajax.data)?this.ajax(n.ajax||null,!0):this.setContent(this.source.data("jBox-ajax-data"))),this.positionedOnOpen&&!this.options.repositionOnOpen||!this.position(n)||(this.positionedOnOpen=!0),this.isClosing&&this._abortAnimation(),this.isOpen||(this.isOpen=!0,this.options.autoClose&&(this.options.delayClose=this.options.autoClose)&&this.close(),this._attachEvents(),this.options.blockScroll&&(this.options.blockScrollAdjust?e.blockScrollScopes?e.blockScrollScopes++:(e.blockScrollScopes=1,this.unscroll(Array.isArray(this.options.blockScrollAdjust)||"string"==typeof this.options.blockScrollAdjust?this.options.blockScrollAdjust:null)):t("body").addClass("jBox-blockScroll-"+this.id)),this.options.overlay&&(this._showOverlay(),this.position()),this.options.animation&&!this.isClosing&&this._animate("open"),this.options.audio&&this.options.audio.open&&this.audio(this.options.audio.open,this.options.volume.open),this.options.fade?this.wrapper.stop().animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.isOpening=!0,this.wrapper.css({display:"block"})}.bind(this),complete:function(){this._fireEvent("onOpenComplete")}.bind(this),always:function(){this.isOpening=!1,setTimeout(function(){this.positionOnFadeComplete&&this.position()&&(this.positionOnFadeComplete=!1)}.bind(this),10)}.bind(this)}):(this.wrapper.css({display:"block",opacity:1}),this.positionOnFadeComplete&&this.position()&&(this.positionOnFadeComplete=!1),this._fireEvent("onOpenComplete")))}.bind(this);return!this.options.delayOpen||this.isOpen||this.isClosing||n.ignoreDelay?i():this.timer=setTimeout(i,this.options.delayOpen),this},e.prototype.close=function(n){if(n=n||{},t("body").off("click.jBox-"+this.id+" tap.jBox-"+this.id),this.isTouchDevice&&t("body > *").off("click.jBox-"+this.id+" tap.jBox-"+this.id),this.isDestroyed||this.isClosing)return this;if(this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var i,o,r,s=function(){var n;this._fireEvent("onClose"),this.options.cancelAjaxOnClose&&this.cancelAjax(),this.isOpen&&(this.isOpen=!1,this._detachEvents(),this.options.blockScroll&&(this.options.blockScrollAdjust?(e.blockScrollScopes=e.blockScrollScopes?--e.blockScrollScopes:0)||this.unscroll.reset():t("body").removeClass("jBox-blockScroll-"+this.id)),this.options.overlay&&this._hideOverlay(),this.options.animation&&!this.isOpening&&this._animate("close"),this.options.audio&&this.options.audio.close&&this.audio(this.options.audio.close,this.options.volume.close),(n=this.isTouchDevice&&"mouse"==this.options.target?0:this.options.fade)?this.wrapper.stop().animate({opacity:0},{queue:!1,duration:n,start:function(){this.isClosing=!0}.bind(this),complete:function(){this.wrapper.css({display:"none"}),this._fireEvent("onCloseComplete")}.bind(this),always:function(){this.isClosing=!1}.bind(this)}):(this.wrapper.css({display:"none",opacity:0}),this._fireEvent("onCloseComplete")))}.bind(this);return n.ignoreDelay||this.isTouchDevice&&"mouse"==this.options.target?s():(this.options.delayOnHover||this.options.showCountdown)&&10<this.options.delayClose?(o=(i=this).options.delayClose,r=Date.now(),this.options.showCountdown&&!this.inner&&(n=t('<div class="jBox-countdown" />'),this.inner=t('<div class="jBox-countdown-inner" />'),n.prepend(this.inner),t("#"+this.id).append(n)),this.countdown=function(){var t=Date.now();i.isHovered||(o-=t-r),r=t,0<o?(i.options.showCountdown&&i.inner.css("width",100*o/i.options.delayClose+"%"),window.requestAnimationFrame(i.countdown)):s()},window.requestAnimationFrame(this.countdown)):this.timer=setTimeout(s,Math.max(this.options.delayClose,10)),this},e.prototype.toggle=function(t){return this[this.isOpen?"close":"open"](t),this},e.prototype.disable=function(){return this.isDisabled=!0,this},e.prototype.enable=function(){return this.isDisabled=!1,this},e.prototype.hide=function(){return this.disable(),this.wrapper&&(this.cacheWrapperDisplay=this.wrapper.css("display"),this.wrapper.css({display:"none"})),this.overlay&&(this.cacheOverlayDisplay=this.overlay.css("display"),this.overlay.css({display:"none"})),this},e.prototype.show=function(){return this.enable(),this.wrapper&&this.cacheWrapperDisplay&&(this.wrapper.css({display:this.cacheWrapperDisplay}),this.cacheWrapperDisplay=null),this.overlay&&this.cacheOverlayDisplay&&(this.overlay.css({display:this.cacheOverlayDisplay}),this.cacheOverlayDisplay=null),this},e.prototype.ajax=function(e,n){e=e||{},t.each([["getData","data"],["getURL","url"]],function(t,n){this.options.ajax[n[0]]&&!e[n[1]]&&this.source&&null!=this.source.attr(this.options.ajax[n[0]])&&(e[n[1]]=this.source.attr(this.options.ajax[n[0]])||"")}.bind(this));var i=t.extend(!0,{},this.options.ajax);this.cancelAjax();var o=e.beforeSend||i.beforeSend||function(){},r=e.complete||i.complete||function(){},s=e.success||i.success||function(){},a=e.error||i.error||function(){},l=t.extend(!0,i,e);return l.beforeSend=function(e){l.loadingClass&&this.wrapper.addClass(!0===l.loadingClass?"jBox-loading":l.loadingClass),l.spinner&&(this.spinnerDelay=setTimeout(function(){this.wrapper.addClass("jBox-loading-spinner"),l.spinnerReposition&&(n?this.positionOnFadeComplete=!0:this.position()),this.spinner=t(!0!==l.spinner?l.spinner:'<div class="jBox-spinner"></div>').appendTo(this.container),this.titleContainer&&"absolute"==this.spinner.css("position")&&this.spinner.css({transform:"translateY("+.5*this.titleContainer.outerHeight()+"px)"})}.bind(this),""!=this.content.html()&&l.spinnerDelay||0)),o.bind(this)(e)}.bind(this),l.complete=function(t){this.spinnerDelay&&clearTimeout(this.spinnerDelay),this.wrapper.removeClass("jBox-loading jBox-loading-spinner jBox-loading-spinner-delay"),this.spinner&&this.spinner.length&&this.spinner.remove()&&l.spinnerReposition&&(n?this.positionOnFadeComplete=!0:this.position()),this.ajaxLoaded=!0,r.bind(this)(t)}.bind(this),l.success=function(t){l.setContent&&this.setContent(t,!0)&&(n?this.positionOnFadeComplete=!0:this.position()),l.setContent&&this.source&&this.source.data("jBox-ajax-data",t),s.bind(this)(t)}.bind(this),l.error=function(t){a.bind(this)(t)}.bind(this),this.ajaxRequest=t.ajax(l),this},e.prototype.cancelAjax=function(){this.ajaxRequest&&(this.ajaxRequest.abort(),this.ajaxLoaded=!1)},e.prototype.audio=function(n,i){if(!n)return this;var o;(e._audio=e._audio?e._audio:{})[n]||(o=t("<audio/>"),t("<source/>",{src:n+".mp3"}).appendTo(o),t("<source/>",{src:n+".ogg"}).appendTo(o),e._audio[n]=o[0]),e._audio[n].volume=Math.min((null!=i?i:100)/100,1);try{e._audio[n].pause(),e._audio[n].currentTime=0}catch(n){}return e._audio[n].play(),this},e._animationSpeeds={tada:1e3,tadaSmall:1e3,flash:500,shake:400,pulseUp:250,pulseDown:250,popIn:250,popOut:250,fadeIn:200,fadeOut:200,slideUp:400,slideRight:400,slideLeft:400,slideDown:400},e.prototype.animate=function(t,n){n=n||{},this.animationTimeout||(this.animationTimeout={}),n.element||(n.element=this.wrapper),n.element.data("jBox-animating-id")||n.element.data("jBox-animating-id",e._getUniqueElementID()),n.element.data("jBox-animating")&&(n.element.removeClass(n.element.data("jBox-animating")).data("jBox-animating",null),this.animationTimeout[n.element.data("jBox-animating-id")]&&clearTimeout(this.animationTimeout[n.element.data("jBox-animating-id")])),n.element.addClass("jBox-animated-"+t).data("jBox-animating","jBox-animated-"+t),this.animationTimeout[n.element.data("jBox-animating-id")]=setTimeout((function(){n.element.removeClass(n.element.data("jBox-animating")).data("jBox-animating",null),n.complete&&n.complete()}),e._animationSpeeds[t])},e.prototype.swipeDetector=function(e,n){var i=0,o=0,r=0,s=0,a=0;return n=t.extend({swipeThreshold:70,useOnlyTouch:!1},n),e.on("mousedown touchstart",(function(t){n.useOnlyTouch&&!t.originalEvent.touches||(t.originalEvent.touches&&(t=t.originalEvent.touches[0]),0===i&&(i=1,o=t.clientX,r=t.clientY))})),t("html").on("mouseup touchend",(function(o){2===i&&(i=0,Math.abs(s)>Math.abs(a)&&Math.abs(s)>n.swipeThreshold?s<0?e.trigger(t.Event("swipeLeft.sd")):e.trigger(t.Event("swipeRight.sd")):Math.abs(a)>n.swipeThreshold&&(a<0?e.trigger(t.Event("swipeUp.sd")):e.trigger(t.Event("swipeDown.sd"))))})),t("html").on("mousemove touchmove",(function(t){var e;1===i&&(e=(t=t.originalEvent.touches?t.originalEvent.touches[0]:t).clientX-o,t=t.clientY-r,(Math.abs(e)>n.swipeThreshold||Math.abs(t)>n.swipeThreshold)&&(i=2,s=e,a=t))})),e},e.prototype.destroy=function(){return this.detach(),this.isOpen&&this.close({ignoreDelay:!0}),this.wrapper&&this.wrapper.remove(),this.overlay&&this.overlay.remove(),this._styles&&this._styles.remove(),this.isDestroyed=!0,this},e._getUniqueID=(n=1,function(){return n++}),e._getUniqueElementID=(i=1,function(){return i++}),e._pluginOptions={},e.plugin=function(t,n){e._pluginOptions[t]=n},t.fn.jBox=function(n,i){return new e(n=n||{},t.extend(i=i||{},{attach:this}))},e}function jBoxConfirmWrapper(jBox,jQuery){new jBox.plugin("Confirm",{confirmButton:"Submit",cancelButton:"Cancel",confirm:null,cancel:null,closeOnConfirm:!0,target:window,fixed:!0,attach:"[data-confirm]",getContent:"data-confirm",content:"Do you really want to do this?",minWidth:360,maxWidth:500,blockScroll:!0,closeOnEsc:!0,closeOnClick:!1,closeButton:!1,overlay:!0,animation:"zoomIn",preventDefault:!0,_onAttach:function(t){var e;this.options.confirm||(e=t.attr("onclick")?t.attr("onclick"):t.attr("href")?t.attr("target")?'window.open("'+t.attr("href")+'", "'+t.attr("target")+'");':'window.location.href = "'+t.attr("href")+'";':"",t.prop("onclick",null).data("jBox-Confirm-submit",e))},_onCreated:function(){this.wrapper.addClass("jBox-Modal"),this.footer=jQuery('<div class="jBox-Confirm-footer"/>'),jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-cancel"/>').html(this.options.cancelButton).on("click tap",function(){this.options.cancel&&this.options.cancel(this.source),this.close()}.bind(this)).appendTo(this.footer),this.submitButton=jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-submit"/>').html(this.options.confirmButton).appendTo(this.footer),this.footer.appendTo(this.container)},_onOpen:function(){this.submitButton.off("click.jBox-Confirm"+this.id+" tap.jBox-Confirm"+this.id).on("click.jBox-Confirm"+this.id+" tap.jBox-Confirm"+this.id,function(){this.options.confirm?this.options.confirm(this.source):eval(this.source.data("jBox-Confirm-submit")),this.options.closeOnConfirm&&this.close()}.bind(this))}})}function jBoxImageWrapper(t,e){new t.plugin("Image",{src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:360,imageSize:"contain",imageCounter:!1,imageCounterSeparator:"/",downloadButton:!1,downloadButtonText:null,downloadButtonUrl:null,mobileImageAttr:null,mobileImageBreakpoint:null,preloadFirstImage:!1,target:window,attach:"[data-jbox-image]",fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"button",closeButton:!0,overlay:!0,animation:"zoomIn",preventDefault:!0,width:"100%",height:"100%",adjustDistance:{top:40,right:0,bottom:40,left:0},_onInit:function(){this.images=this.currentImage={},this.imageZIndex=1,this.initImage=function(t){var n,i;(t=e(t)).data("jBox-image-gallery")||(n=t.attr(this.options.src),this.options.mobileImageAttr&&this.options.mobileImageBreakpoint&&t.attr(this.options.mobileImageAttr)&&e(window).width()<=this.options.mobileImageBreakpoint&&(n=t.attr(this.options.mobileImageAttr)),i=t.attr(this.options.gallery)||"default",this.images[i]||(this.images[i]=[]),this.images[i].push({src:n,label:t.attr(this.options.imageLabel)||"",downloadUrl:this.options.downloadButtonUrl&&t.attr(this.options.downloadButtonUrl)?t.attr(this.options.downloadButtonUrl):null}),"title"==this.options.imageLabel&&t.removeAttr("title"),t.data("jBox-image-gallery",i),t.data("jBox-image-id",this.images[i].length-1))}.bind(this),this.attachedElements&&this.attachedElements.length&&e.each(this.attachedElements,function(t,e){this.initImage(e)}.bind(this));var t=function(t,n,i,o){if(!e("#jBox-image-"+t+"-"+n).length){var r=e("<div/>",{id:"jBox-image-"+t+"-"+n,class:"jBox-image-container"+(i?" jBox-image-"+t+"-current":"")}).css({backgroundSize:this.options.imageSize,opacity:o?1:0,zIndex:i?this.imageZIndex++:0}).appendTo(this.content);return this.swipeDetector(r).on("swipeLeft.sd swipeRight.sd",function(t){"swipeLeft"===t.type?this.showImage("next"):"swipeRight"===t.type&&this.showImage("prev")}.bind(this)),e("<div/>",{id:"jBox-image-label-"+t+"-"+n,class:"jBox-image-label"+(i?" active":"")}).html(this.images[t][n].label).on("click tap",(function(){e(this).toggleClass("expanded")})).appendTo(this.imageLabelContainer),i&&r.animate({opacity:1},o?0:this.options.imageFade),r}}.bind(this);this.downloadImage=function(t){var e=document.createElement("a");e.href=t,e.setAttribute("download",t.substring(t.lastIndexOf("/")+1)),document.body.appendChild(e),e.click()};var n=function(n,i,o,r){var s=t(n,i,o,r);s.addClass("jBox-image-loading"),e('<img src="'+this.images[n][i].src+'" />').each(function(){var t=new Image;t.onload=function(){s.removeClass("jBox-image-loading"),s.css({backgroundImage:'url("'+this.images[n][i].src+'")'})}.bind(this),t.onerror=function(){s.removeClass("jBox-image-loading"),s.addClass("jBox-image-not-found")}.bind(this),t.src=this.images[n][i].src}.bind(this))}.bind(this);this.showImage=function(t){var i,o,r;if("open"!=t)i=this.currentImage.gallery,r=(r=this.currentImage.id+(+("prev"==t)?-1:1))>this.images[i].length-1?0:r<0?this.images[i].length-1:r;else{if(this.source)i=this.source.data("jBox-image-gallery"),r=this.source.data("jBox-image-id");else{if(!this.attachedElements||!this.attachedElements.length)return;i=e(this.attachedElements[0]).data("jBox-image-gallery"),r=e(this.attachedElements[0]).data("jBox-image-id")}this.images&&this.images[i]&&e(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:1<this.images[i].length?"block":"none"})}e(".jBox-image-"+i+"-current").length&&e(".jBox-image-"+i+"-current").removeClass("jBox-image-"+i+"-current").animate({opacity:0},"open"==t?0:this.options.imageFade),this.currentImage={gallery:i,id:r},e("#jBox-image-"+i+"-"+r).length?e("#jBox-image-"+i+"-"+r).addClass("jBox-image-"+i+"-current").css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==t?0:this.options.imageFade):n(i,r,!0,"open"===t),o=i,t=r,e(".jBox-image-label.active").removeClass("active expanded"),e("#jBox-image-label-"+o+"-"+t).addClass("active"),this.imageCounter&&(this.images[i]&&1<this.images[i].length?(this.wrapper.addClass("jBox-image-has-counter"),this.imageCounter.find(".jBox-image-counter-all").html(this.images[i].length),this.imageCounter.find(".jBox-image-counter-current").html(r+1)):this.wrapper.removeClass("jBox-image-has-counter")),this.images[i]&&this.images[i].length-1&&(r=(r+=1)>this.images[i].length-1?0:r<0?this.images[i].length-1:r,e("#jBox-image-"+i+"-"+r).length||n(i,r,!1,!1))},this.options.preloadFirstImage&&e(window).on("load",function(){this.showImage("open")}.bind(this))},_onAttach:function(t){this.initImage&&this.initImage(t)},_onCreated:function(){this.imageLabelWrapper=e('<div class="jBox-image-label-wrapper"/>').appendTo(this.wrapper),this.imagePrevButton=e('<div class="jBox-image-pointer-prev"/>').on("click tap",function(){this.showImage("prev")}.bind(this)),this.imageNextButton=e('<div class="jBox-image-pointer-next"/>').on("click tap",function(){this.showImage("next")}.bind(this)),this.imageLabelContainer=e('<div class="jBox-image-label-container"/>'),this.imageLabelWrapper.append(this.imagePrevButton).append(this.imageLabelContainer).append(this.imageNextButton),this.options.downloadButton&&(this.downloadButton=e("<div/>",{class:"jBox-image-download-button-wrapper"}).appendTo(this.wrapper).append(this.options.downloadButtonText?e("<div/>",{class:"jBox-image-download-button-text"}).html(this.options.downloadButtonText):null).append(e("<div/>",{class:"jBox-image-download-button-icon"})).on("click tap",function(){var t;t=this.images[this.currentImage.gallery][this.currentImage.id].downloadUrl||this.wrapper.find(".jBox-image-"+this.currentImage.gallery+"-current")[0].style.backgroundImage.slice(4,-1).replace(/["']/g,""),this.downloadImage(t)}.bind(this))),this.options.imageCounter&&(this.imageCounter=e("<div/>",{class:"jBox-image-counter-container"}).insertAfter(this.imageLabelContainer),this.imageCounter.append(e("<span/>",{class:"jBox-image-counter-current"})).append(e("<span/>").html(this.options.imageCounterSeparator)).append(e("<span/>",{class:"jBox-image-counter-all"})))},_onOpen:function(){e(document).on("keyup.jBox-Image-"+this.id,function(t){37==t.keyCode&&this.showImage("prev"),39==t.keyCode&&this.showImage("next")}.bind(this)),this.showImage("open")},_onClose:function(){e(document).off("keyup.jBox-Image-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}})}function jBoxNoticeWrapper(t,e){new t.plugin("Notice",{color:null,stack:!0,stackSpacing:10,autoClose:6e3,attributes:{x:"right",y:"top"},position:{x:15,y:15},responsivePositions:{500:{x:5,y:5},768:{x:10,y:10}},target:window,fixed:!0,animation:"zoomIn",closeOnClick:"box",zIndex:12e3,_onInit:function(){this.defaultNoticePosition=e.extend({},this.options.position),this._adjustNoticePositon=function(){var t=e(window),n=t.width();t.height(),this.options.position=e.extend({},this.defaultNoticePosition),e.each(this.options.responsivePositions,function(t,e){if(n<=t)return this.options.position=e,!1}.bind(this)),this.options.adjustDistance={top:this.options.position.y,right:this.options.position.x,bottom:this.options.position.y,left:this.options.position.x}},this.options.content instanceof e&&(this.options.content=this.options.content.clone().attr("id","")),e(window).on("resize.responsivejBoxNotice-"+this.id,function(t){this.isOpen&&this._adjustNoticePositon()}.bind(this)),this.open()},_onCreated:function(){this.wrapper.addClass("jBox-Notice-color jBox-Notice-"+(this.options.color||"gray")),this.wrapper.data("jBox-Notice-position",this.options.attributes.x+"-"+this.options.attributes.y)},_onOpen:function(){this.options.stack||(this._adjustNoticePositon(),e.each(e(".jBox-Notice"),function(t,n){(n=e(n)).attr("id")!=this.id&&n.data("jBox-Notice-position")==this.options.attributes.x+"-"+this.options.attributes.y&&(this.options.stack||n.data("jBox").close({ignoreDelay:!0}))}.bind(this)))},_onPosition:function(){var t,n={};for(t in e.each(e(".jBox-Notice"),(function(t,i){var o=(i=e(i)).data("jBox-Notice-position");n[o]||(n[o]=[]),n[o].push(i)})),n){var i=t.split("-")[1];n[t].reverse();var o,r=0;for(o in n[t]){var s=e(n[t][o]);s.css("margin-"+i,r),r+=s.outerHeight()+this.options.stackSpacing}}},_onCloseComplete:function(){this.destroy(),this.options._onPosition.bind(this).call()}})}!function(t,e){__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(755)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(e){return t.jBox=function(t){var e=jBoxWrapper(t);try{void 0!==jBoxConfirmWrapper&&jBoxConfirmWrapper&&jBoxConfirmWrapper(e,t)}catch(t){console.error(t)}try{void 0!==jBoxImageWrapper&&jBoxImageWrapper&&jBoxImageWrapper(e,t)}catch(t){console.error(t)}try{void 0!==jBoxNoticeWrapper&&jBoxNoticeWrapper&&jBoxNoticeWrapper(e,t)}catch(t){console.error(t)}return e}(e)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(this)},755:function(t,e){var n;!function(e,n){"use strict";"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(i,o){"use strict";var r=[],s=Object.getPrototypeOf,a=r.slice,l=r.flat?function(t){return r.flat.call(t)}:function(t){return r.concat.apply([],t)},c=r.push,u=r.indexOf,d={},h=d.toString,p=d.hasOwnProperty,f=p.toString,g=f.call(Object),m={},y=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},v=function(t){return null!=t&&t===t.window},b=i.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function x(t,e,n){var i,o,r=(n=n||b).createElement("script");if(r.text=t,e)for(i in _)(o=e[i]||e.getAttribute&&e.getAttribute(i))&&r.setAttribute(i,o);n.head.appendChild(r).parentNode.removeChild(r)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?d[h.call(t)]||"object":typeof t}var E="3.6.0",S=function(t,e){return new S.fn.init(t,e)};function T(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!y(t)&&!v(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}S.fn=S.prototype={jquery:E,constructor:S,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=S.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return S.each(this,t)},map:function(t){return this.pushStack(S.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(S.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:r.sort,splice:r.splice},S.extend=S.fn.extend=function(){var t,e,n,i,o,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||y(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(c&&i&&(S.isPlainObject(i)||(o=Array.isArray(i)))?(n=s[e],r=o&&!Array.isArray(n)?[]:o||S.isPlainObject(n)?n:{},o=!1,s[e]=S.extend(c,r,i)):void 0!==i&&(s[e]=i));return s},S.extend({expando:"jQuery"+(E+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==h.call(t)||(e=s(t))&&("function"!=typeof(n=p.call(e,"constructor")&&e.constructor)||f.call(n)!==g))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){x(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(T(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?S.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:u.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,o=t.length;i<n;i++)t[o++]=e[i];return t.length=o,t},grep:function(t,e,n){for(var i=[],o=0,r=t.length,s=!n;o<r;o++)!e(t[o],o)!==s&&i.push(t[o]);return i},map:function(t,e,n){var i,o,r=0,s=[];if(T(t))for(i=t.length;r<i;r++)null!=(o=e(t[r],r,n))&&s.push(o);else for(r in t)null!=(o=e(t[r],r,n))&&s.push(o);return l(s)},guid:1,support:m}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=r[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){d["[object "+e+"]"]=e.toLowerCase()}));var k=function(t){var e,n,i,o,r,s,a,l,c,u,d,h,p,f,g,m,y,v,b,_="sizzle"+1*new Date,x=t.document,w=0,E=0,S=lt(),T=lt(),k=lt(),A=lt(),C=function(t,e){return t===e&&(d=!0),0},N={}.hasOwnProperty,D=[],M=D.pop,j=D.push,I=D.push,L=D.slice,B=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",z="[\\x20\\t\\r\\n\\f]",P="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",R="\\[[\\x20\\t\\r\\n\\f]*("+P+")(?:"+z+"*([*^$|!~]?=)"+z+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+P+"))|)"+z+"*\\]",H=":("+P+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|.*)\\)|)",U=new RegExp(z+"+","g"),q=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),Y=new RegExp(z+"|>"),F=new RegExp(H),$=new RegExp("^"+P+"$"),X={ID:new RegExp("^#("+P+")"),CLASS:new RegExp("^\\.("+P+")"),TAG:new RegExp("^("+P+"|[*])"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},K=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ot=function(t,e){return e?"\0"===t?"":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},rt=function(){h()},st=_t((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{I.apply(D=L.call(x.childNodes),x.childNodes),D[x.childNodes.length].nodeType}catch(t){I={apply:D.length?function(t,e){j.apply(t,L.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,o){var r,a,c,u,d,f,y,v=e&&e.ownerDocument,x=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==x&&9!==x&&11!==x)return i;if(!o&&(h(e),e=e||p,g)){if(11!==x&&(d=J.exec(t)))if(r=d[1]){if(9===x){if(!(c=e.getElementById(r)))return i;if(c.id===r)return i.push(c),i}else if(v&&(c=v.getElementById(r))&&b(e,c)&&c.id===r)return i.push(c),i}else{if(d[2])return I.apply(i,e.getElementsByTagName(t)),i;if((r=d[3])&&n.getElementsByClassName&&e.getElementsByClassName)return I.apply(i,e.getElementsByClassName(r)),i}if(n.qsa&&!A[t+" "]&&(!m||!m.test(t))&&(1!==x||"object"!==e.nodeName.toLowerCase())){if(y=t,v=e,1===x&&(Y.test(t)||W.test(t))){for((v=tt.test(t)&&yt(e.parentNode)||e)===e&&n.scope||((u=e.getAttribute("id"))?u=u.replace(it,ot):e.setAttribute("id",u=_)),a=(f=s(t)).length;a--;)f[a]=(u?"#"+u:":scope")+" "+bt(f[a]);y=f.join(",")}try{return I.apply(i,v.querySelectorAll(y)),i}catch(e){A(t,!0)}finally{u===_&&e.removeAttribute("id")}}}return l(t.replace(q,"$1"),e,i,o)}function lt(){var t=[];return function e(n,o){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=o}}function ct(t){return t[_]=!0,t}function ut(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function dt(t,e){for(var n=t.split("|"),o=n.length;o--;)i.attrHandle[n[o]]=e}function ht(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ct((function(e){return e=+e,ct((function(n,i){for(var o,r=t([],n.length,e),s=r.length;s--;)n[o=r[s]]&&(n[o]=!(i[o]=n[o]))}))}))}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},r=at.isXML=function(t){var e=t&&t.namespaceURI,n=t&&(t.ownerDocument||t).documentElement;return!K.test(e||n&&n.nodeName||"HTML")},h=at.setDocument=function(t){var e,o,s=t?t.ownerDocument||t:x;return s!=p&&9===s.nodeType&&s.documentElement?(f=(p=s).documentElement,g=!r(p),x!=p&&(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",rt,!1):o.attachEvent&&o.attachEvent("onunload",rt)),n.scope=ut((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Z.test(p.getElementsByClassName),n.getById=ut((function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,o,r=e.getElementById(t);if(r){if((n=r.getAttributeNode("id"))&&n.value===t)return[r];for(o=e.getElementsByName(t),i=0;r=o[i++];)if((n=r.getAttributeNode("id"))&&n.value===t)return[r]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},y=[],m=[],(n.qsa=Z.test(p.querySelectorAll))&&(ut((function(t){var e;f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+O+")"),t.querySelectorAll("[id~="+_+"-]").length||m.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Z.test(v=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",H)})),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),e=Z.test(f.compareDocumentPosition),b=e||Z.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},C=e?function(t,e){if(t===e)return d=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==p||t.ownerDocument==x&&b(x,t)?-1:e==p||e.ownerDocument==x&&b(x,e)?1:u?B(u,t)-B(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return d=!0,0;var n,i=0,o=t.parentNode,r=e.parentNode,s=[t],a=[e];if(!o||!r)return t==p?-1:e==p?1:o?-1:r?1:u?B(u,t)-B(u,e):0;if(o===r)return ht(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?ht(s[i],a[i]):s[i]==x?-1:a[i]==x?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(h(t),n.matchesSelector&&g&&!A[e+" "]&&(!y||!y.test(e))&&(!m||!m.test(e)))try{var i=v.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){A(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&h(t),b(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&h(t);var o=i.attrHandle[e.toLowerCase()],r=o&&N.call(i.attrHandle,e.toLowerCase())?o(t,e,!g):void 0;return void 0!==r?r:n.attributes||!g?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},at.escape=function(t){return(t+"").replace(it,ot)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],o=0,r=0;if(d=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(C),d){for(;e=t[r++];)e===t[r]&&(o=i.push(r));for(;o--;)t.splice(i[o],1)}return u=null,t},o=at.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=o(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=o(e);return n},i=at.selectors={cacheLength:50,createPseudo:ct,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return X.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&F.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+z+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var o=at.attr(i,t);return null==o?"!="===e:!e||(o+="","="===e?o===n:"!="===e?o!==n:"^="===e?n&&0===o.indexOf(n):"*="===e?n&&o.indexOf(n)>-1:"$="===e?n&&o.slice(-n.length)===n:"~="===e?(" "+o.replace(U," ")+" ").indexOf(n)>-1:"|="===e&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,o){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var c,u,d,h,p,f,g=r!==s?"nextSibling":"previousSibling",m=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!l&&!a,b=!1;if(m){if(r){for(;g;){for(h=e;h=h[g];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&v){for(b=(p=(c=(u=(d=(h=m)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&c[1])&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(b=p=0)||f.pop();)if(1===h.nodeType&&++b&&h===e){u[t]=[w,p,b];break}}else if(v&&(b=p=(c=(u=(d=(h=e)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&c[1]),!1===b)for(;(h=++p&&h&&h[g]||(b=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++b||(v&&((u=(d=h[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]=[w,b]),h!==e)););return(b-=o)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,o=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return o[_]?o(e):o.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,n){for(var i,r=o(t,e),s=r.length;s--;)t[i=B(t,r[s])]=!(n[i]=r[s])})):function(t){return o(t,0,n)}):o}},pseudos:{not:ct((function(t){var e=[],n=[],i=a(t.replace(q,"$1"));return i[_]?ct((function(t,e,n,o){for(var r,s=i(t,null,o,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))})):function(t,o,r){return e[0]=t,i(e,null,r,n),e[0]=null,!n.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||o(e)).indexOf(t)>-1}})),lang:ct((function(t){return $.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return G.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:mt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ft(e);function vt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function _t(t,e,n){var i=e.dir,o=e.next,r=o||i,s=n&&"parentNode"===r,a=E++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,o);return!1}:function(e,n,l){var c,u,d,h=[w,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(u=(d=e[_]||(e[_]={}))[e.uniqueID]||(d[e.uniqueID]={}),o&&o===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=u[r])&&c[0]===w&&c[1]===a)return h[2]=c[2];if(u[r]=h,h[2]=t(e,n,l))return!0}return!1}}function xt(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function wt(t,e,n,i,o){for(var r,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(r=t[a])&&(n&&!n(r,i,o)||(s.push(r),c&&e.push(a)));return s}function Et(t,e,n,i,o,r){return i&&!i[_]&&(i=Et(i)),o&&!o[_]&&(o=Et(o,r)),ct((function(r,s,a,l){var c,u,d,h=[],p=[],f=s.length,g=r||function(t,e,n){for(var i=0,o=e.length;i<o;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!r&&e?g:wt(g,h,t,a,l),y=n?o||(r?t:f||i)?[]:s:m;if(n&&n(m,y,a,l),i)for(c=wt(y,p),i(c,[],a,l),u=c.length;u--;)(d=c[u])&&(y[p[u]]=!(m[p[u]]=d));if(r){if(o||t){if(o){for(c=[],u=y.length;u--;)(d=y[u])&&c.push(m[u]=d);o(null,y=[],c,l)}for(u=y.length;u--;)(d=y[u])&&(c=o?B(r,d):h[u])>-1&&(r[c]=!(s[c]=d))}}else y=wt(y===s?y.splice(f,y.length):y),o?o(null,s,y,l):I.apply(s,y)}))}function St(t){for(var e,n,o,r=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,u=_t((function(t){return t===e}),a,!0),d=_t((function(t){return B(e,t)>-1}),a,!0),h=[function(t,n,i){var o=!s&&(i||n!==c)||((e=n).nodeType?u(t,n,i):d(t,n,i));return e=null,o}];l<r;l++)if(n=i.relative[t[l].type])h=[_t(xt(h),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[_]){for(o=++l;o<r&&!i.relative[t[o].type];o++);return Et(l>1&&xt(h),l>1&&bt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(q,"$1"),n,l<o&&St(t.slice(l,o)),o<r&&St(t=t.slice(o)),o<r&&bt(t))}h.push(n)}return xt(h)}return vt.prototype=i.filters=i.pseudos,i.setFilters=new vt,s=at.tokenize=function(t,e){var n,o,r,s,a,l,c,u=T[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=i.preFilter;a;){for(s in n&&!(o=V.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),n=!1,(o=W.exec(a))&&(n=o.shift(),r.push({value:n,type:o[0].replace(q," ")}),a=a.slice(n.length)),i.filter)!(o=X[s].exec(a))||c[s]&&!(o=c[s](o))||(n=o.shift(),r.push({value:n,type:s,matches:o}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):T(t,l).slice(0)},a=at.compile=function(t,e){var n,o=[],r=[],a=k[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=St(e[n]))[_]?o.push(a):r.push(a);a=k(t,function(t,e){var n=e.length>0,o=t.length>0,r=function(r,s,a,l,u){var d,f,m,y=0,v="0",b=r&&[],_=[],x=c,E=r||o&&i.find.TAG("*",u),S=w+=null==x?1:Math.random()||.1,T=E.length;for(u&&(c=s==p||s||u);v!==T&&null!=(d=E[v]);v++){if(o&&d){for(f=0,s||d.ownerDocument==p||(h(d),a=!g);m=t[f++];)if(m(d,s||p,a)){l.push(d);break}u&&(w=S)}n&&((d=!m&&d)&&y--,r&&b.push(d))}if(y+=v,n&&v!==y){for(f=0;m=e[f++];)m(b,_,s,a);if(r){if(y>0)for(;v--;)b[v]||_[v]||(_[v]=M.call(l));_=wt(_)}I.apply(l,_),u&&!r&&_.length>0&&y+e.length>1&&at.uniqueSort(l)}return u&&(w=S,c=x),b};return n?ct(r):r}(r,o)),a.selector=t}return a},l=at.select=function(t,e,n,o){var r,l,c,u,d,h="function"==typeof t&&t,p=!o&&s(t=h.selector||t);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&g&&i.relative[l[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(r=X.needsContext.test(t)?0:l.length;r--&&(c=l[r],!i.relative[u=c.type]);)if((d=i.find[u])&&(o=d(c.matches[0].replace(et,nt),tt.test(l[0].type)&&yt(e.parentNode)||e))){if(l.splice(r,1),!(t=o.length&&bt(l)))return I.apply(n,o),n;break}}return(h||a(t,p))(o,e,!g,n,!e||tt.test(t)&&yt(e.parentNode)||e),n},n.sortStable=_.split("").sort(C).join("")===_,n.detectDuplicates=!!d,h(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||dt("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||dt("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||dt(O,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(i);S.find=k,S.expr=k.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=k.uniqueSort,S.text=k.getText,S.isXMLDoc=k.isXML,S.contains=k.contains,S.escapeSelector=k.escape;var A=function(t,e,n){for(var i=[],o=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&S(t).is(n))break;i.push(t)}return i},C=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},N=S.expr.match.needsContext;function D(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var M=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(t,e,n){return y(e)?S.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?S.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?S.grep(t,(function(t){return u.call(e,t)>-1!==n})):S.filter(e,t,n)}S.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?S.find.matchesSelector(i,t)?[i]:[]:S.find.matches(t,S.grep(e,(function(t){return 1===t.nodeType})))},S.fn.extend({find:function(t){var e,n,i=this.length,o=this;if("string"!=typeof t)return this.pushStack(S(t).filter((function(){for(e=0;e<i;e++)if(S.contains(o[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)S.find(t,o[e],n);return i>1?S.uniqueSort(n):n},filter:function(t){return this.pushStack(j(this,t||[],!1))},not:function(t){return this.pushStack(j(this,t||[],!0))},is:function(t){return!!j(this,"string"==typeof t&&N.test(t)?S(t):t||[],!1).length}});var I,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(t,e,n){var i,o;if(!t)return this;if(n=n||I,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:L.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof S?e[0]:e,S.merge(this,S.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:b,!0)),M.test(i[1])&&S.isPlainObject(e))for(i in e)y(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(o=b.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==n.ready?n.ready(t):t(S):S.makeArray(t,this)}).prototype=S.fn,I=S(b);var B=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function z(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}S.fn.extend({has:function(t){var e=S(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(S.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,o=this.length,r=[],s="string"!=typeof t&&S(t);if(!N.test(t))for(;i<o;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&S.find.matchesSelector(n,t))){r.push(n);break}return this.pushStack(r.length>1?S.uniqueSort(r):r)},index:function(t){return t?"string"==typeof t?u.call(S(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),S.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return A(t,"parentNode")},parentsUntil:function(t,e,n){return A(t,"parentNode",n)},next:function(t){return z(t,"nextSibling")},prev:function(t){return z(t,"previousSibling")},nextAll:function(t){return A(t,"nextSibling")},prevAll:function(t){return A(t,"previousSibling")},nextUntil:function(t,e,n){return A(t,"nextSibling",n)},prevUntil:function(t,e,n){return A(t,"previousSibling",n)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return null!=t.contentDocument&&s(t.contentDocument)?t.contentDocument:(D(t,"template")&&(t=t.content||t),S.merge([],t.childNodes))}},(function(t,e){S.fn[t]=function(n,i){var o=S.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=S.filter(i,o)),this.length>1&&(O[t]||S.uniqueSort(o),B.test(t)&&o.reverse()),this.pushStack(o)}}));var P=/[^\x20\t\r\n\f]+/g;function R(t){return t}function H(t){throw t}function U(t,e,n,i){var o;try{t&&y(o=t.promise)?o.call(t).done(e).fail(n):t&&y(o=t.then)?o.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}S.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return S.each(t.match(P)||[],(function(t,n){e[n]=!0})),e}(t):S.extend({},t);var e,n,i,o,r=[],s=[],a=-1,l=function(){for(o=o||t.once,i=e=!0;s.length;a=-1)for(n=s.shift();++a<r.length;)!1===r[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=r.length,n=!1);t.memory||(n=!1),e=!1,o&&(r=n?[]:"")},c={add:function(){return r&&(n&&!e&&(a=r.length-1,s.push(n)),function e(n){S.each(n,(function(n,i){y(i)?t.unique&&c.has(i)||r.push(i):i&&i.length&&"string"!==w(i)&&e(i)}))}(arguments),n&&!e&&l()),this},remove:function(){return S.each(arguments,(function(t,e){for(var n;(n=S.inArray(e,r,n))>-1;)r.splice(n,1),n<=a&&a--})),this},has:function(t){return t?S.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=n="",this},disabled:function(){return!r},lock:function(){return o=s=[],n||e||(r=n=""),this},locked:function(){return!!o},fireWith:function(t,n){return o||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},S.extend({Deferred:function(t){var e=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return S.Deferred((function(n){S.each(e,(function(e,i){var o=y(t[i[4]])&&t[i[4]];r[i[1]]((function(){var t=o&&o.apply(this,arguments);t&&y(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,o?[t]:arguments)}))})),t=null})).promise()},then:function(t,n,o){var r=0;function s(t,e,n,o){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<r)){if((i=n.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,y(c)?o?c.call(i,s(r,e,R,o),s(r,e,H,o)):(r++,c.call(i,s(r,e,R,o),s(r,e,H,o),s(r,e,R,e.notifyWith))):(n!==R&&(a=void 0,l=[i]),(o||e.resolveWith)(a,l))}},u=o?c:function(){try{c()}catch(i){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(i,u.stackTrace),t+1>=r&&(n!==H&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(S.Deferred.getStackHook&&(u.stackTrace=S.Deferred.getStackHook()),i.setTimeout(u))}}return S.Deferred((function(i){e[0][3].add(s(0,i,y(o)?o:R,i.notifyWith)),e[1][3].add(s(0,i,y(t)?t:R)),e[2][3].add(s(0,i,y(n)?n:H))})).promise()},promise:function(t){return null!=t?S.extend(t,o):o}},r={};return S.each(e,(function(t,i){var s=i[2],a=i[5];o[i[1]]=s.add,a&&s.add((function(){n=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(i[3].fire),r[i[0]]=function(){return r[i[0]+"With"](this===r?void 0:this,arguments),this},r[i[0]+"With"]=s.fireWith})),o.promise(r),t&&t.call(r,r),r},when:function(t){var e=arguments.length,n=e,i=Array(n),o=a.call(arguments),r=S.Deferred(),s=function(t){return function(n){i[t]=this,o[t]=arguments.length>1?a.call(arguments):n,--e||r.resolveWith(i,o)}};if(e<=1&&(U(t,r.done(s(n)).resolve,r.reject,!e),"pending"===r.state()||y(o[n]&&o[n].then)))return r.then();for(;n--;)U(o[n],s(n),r.reject);return r.promise()}});var q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&q.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},S.readyException=function(t){i.setTimeout((function(){throw t}))};var V=S.Deferred();function W(){b.removeEventListener("DOMContentLoaded",W),i.removeEventListener("load",W),S.ready()}S.fn.ready=function(t){return V.then(t).catch((function(t){S.readyException(t)})),this},S.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--S.readyWait:S.isReady)||(S.isReady=!0,!0!==t&&--S.readyWait>0||V.resolveWith(b,[S]))}}),S.ready.then=V.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?i.setTimeout(S.ready):(b.addEventListener("DOMContentLoaded",W),i.addEventListener("load",W));var Y=function(t,e,n,i,o,r,s){var a=0,l=t.length,c=null==n;if("object"===w(n))for(a in o=!0,n)Y(t,e,a,n[a],!0,r,s);else if(void 0!==i&&(o=!0,y(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(S(t),n)})),e))for(;a<l;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return o?t:c?e.call(t):l?e(t[0],n):r},F=/^-ms-/,$=/-([a-z])/g;function X(t,e){return e.toUpperCase()}function K(t){return t.replace(F,"ms-").replace($,X)}var Q=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Q(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,o=this.cache(t);if("string"==typeof e)o[K(e)]=n;else for(i in e)o[K(i)]=e[i];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][K(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(K):(e=K(e))in i?[e]:e.match(P)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||S.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var Z=new G,J=new G,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(t){}J.set(t,e,n)}else n=void 0;return n}S.extend({hasData:function(t){return J.hasData(t)||Z.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return Z.access(t,e,n)},_removeData:function(t,e){Z.remove(t,e)}}),S.fn.extend({data:function(t,e){var n,i,o,r=this[0],s=r&&r.attributes;if(void 0===t){if(this.length&&(o=J.get(r),1===r.nodeType&&!Z.get(r,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=K(i.slice(5)),nt(r,i,o[i]));Z.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each((function(){J.set(this,t)})):Y(this,(function(e){var n;if(r&&void 0===e)return void 0!==(n=J.get(r,t))||void 0!==(n=nt(r,t))?n:void 0;this.each((function(){J.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){J.remove(this,t)}))}}),S.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Z.get(t,e),n&&(!i||Array.isArray(n)?i=Z.access(t,e,S.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=S.queue(t,e),i=n.length,o=n.shift(),r=S._queueHooks(t,e);"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===e&&n.unshift("inprogress"),delete r.stop,o.call(t,(function(){S.dequeue(t,e)}),r)),!i&&r&&r.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Z.get(t,n)||Z.access(t,n,{empty:S.Callbacks("once memory").add((function(){Z.remove(t,[e+"queue",n])}))})}}),S.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?S.queue(this[0],t):void 0===e?this:this.each((function(){var n=S.queue(this,t,e);S._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&S.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){S.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,o=S.Deferred(),r=this,s=this.length,a=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Z.get(r[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),o.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ot=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),rt=["Top","Right","Bottom","Left"],st=b.documentElement,at=function(t){return S.contains(t.ownerDocument,t)},lt={composed:!0};st.getRootNode&&(at=function(t){return S.contains(t.ownerDocument,t)||t.getRootNode(lt)===t.ownerDocument});var ct=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===S.css(t,"display")};function ut(t,e,n,i){var o,r,s=20,a=i?function(){return i.cur()}:function(){return S.css(t,e,"")},l=a(),c=n&&n[3]||(S.cssNumber[e]?"":"px"),u=t.nodeType&&(S.cssNumber[e]||"px"!==c&&+l)&&ot.exec(S.css(t,e));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)S.style(t,e,u+c),(1-r)*(1-(r=a()/l||.5))<=0&&(s=0),u/=r;u*=2,S.style(t,e,u+c),n=n||[]}return n&&(u=+u||+l||0,o=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=o)),o}var dt={};function ht(t){var e,n=t.ownerDocument,i=t.nodeName,o=dt[i];return o||(e=n.body.appendChild(n.createElement(i)),o=S.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),dt[i]=o,o)}function pt(t,e){for(var n,i,o=[],r=0,s=t.length;r<s;r++)(i=t[r]).style&&(n=i.style.display,e?("none"===n&&(o[r]=Z.get(i,"display")||null,o[r]||(i.style.display="")),""===i.style.display&&ct(i)&&(o[r]=ht(i))):"none"!==n&&(o[r]="none",Z.set(i,"display",n)));for(r=0;r<s;r++)null!=o[r]&&(t[r].style.display=o[r]);return t}S.fn.extend({show:function(){return pt(this,!0)},hide:function(){return pt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ct(this)?S(this).show():S(this).hide()}))}});var ft,gt,mt=/^(?:checkbox|radio)$/i,yt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i;ft=b.createDocumentFragment().appendChild(b.createElement("div")),(gt=b.createElement("input")).setAttribute("type","radio"),gt.setAttribute("checked","checked"),gt.setAttribute("name","t"),ft.appendChild(gt),m.checkClone=ft.cloneNode(!0).cloneNode(!0).lastChild.checked,ft.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!ft.cloneNode(!0).lastChild.defaultValue,ft.innerHTML="<option></option>",m.option=!!ft.lastChild;var bt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _t(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&D(t,e)?S.merge([t],n):n}function xt(t,e){for(var n=0,i=t.length;n<i;n++)Z.set(t[n],"globalEval",!e||Z.get(e[n],"globalEval"))}bt.tbody=bt.tfoot=bt.colgroup=bt.caption=bt.thead,bt.th=bt.td,m.option||(bt.optgroup=bt.option=[1,"<select multiple='multiple'>","</select>"]);var wt=/<|&#?\w+;/;function Et(t,e,n,i,o){for(var r,s,a,l,c,u,d=e.createDocumentFragment(),h=[],p=0,f=t.length;p<f;p++)if((r=t[p])||0===r)if("object"===w(r))S.merge(h,r.nodeType?[r]:r);else if(wt.test(r)){for(s=s||d.appendChild(e.createElement("div")),a=(yt.exec(r)||["",""])[1].toLowerCase(),l=bt[a]||bt._default,s.innerHTML=l[1]+S.htmlPrefilter(r)+l[2],u=l[0];u--;)s=s.lastChild;S.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(e.createTextNode(r));for(d.textContent="",p=0;r=h[p++];)if(i&&S.inArray(r,i)>-1)o&&o.push(r);else if(c=at(r),s=_t(d.appendChild(r),"script"),c&&xt(s),n)for(u=0;r=s[u++];)vt.test(r.type||"")&&n.push(r);return d}var St=/^([^.]*)(?:\.(.+)|)/;function Tt(){return!0}function kt(){return!1}function At(t,e){return t===function(){try{return b.activeElement}catch(t){}}()==("focus"===e)}function Ct(t,e,n,i,o,r){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Ct(t,a,n,i,e[a],r);return t}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),!1===o)o=kt;else if(!o)return t;return 1===r&&(s=o,o=function(t){return S().off(t),s.apply(this,arguments)},o.guid=s.guid||(s.guid=S.guid++)),t.each((function(){S.event.add(this,e,o,i,n)}))}function Nt(t,e,n){n?(Z.set(t,e,!1),S.event.add(t,e,{namespace:!1,handler:function(t){var i,o,r=Z.get(this,e);if(1&t.isTrigger&&this[e]){if(r.length)(S.event.special[e]||{}).delegateType&&t.stopPropagation();else if(r=a.call(arguments),Z.set(this,e,r),i=n(this,e),this[e](),r!==(o=Z.get(this,e))||i?Z.set(this,e,!1):o={},r!==o)return t.stopImmediatePropagation(),t.preventDefault(),o&&o.value}else r.length&&(Z.set(this,e,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Z.get(t,e)&&S.event.add(t,e,Tt)}S.event={global:{},add:function(t,e,n,i,o){var r,s,a,l,c,u,d,h,p,f,g,m=Z.get(t);if(Q(t))for(n.handler&&(n=(r=n).handler,o=r.selector),o&&S.find.matchesSelector(st,o),n.guid||(n.guid=S.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(e){return void 0!==S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(P)||[""]).length;c--;)p=g=(a=St.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(d=S.event.special[p]||{},p=(o?d.delegateType:d.bindType)||p,d=S.event.special[p]||{},u=S.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&S.expr.match.needsContext.test(o),namespace:f.join(".")},r),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,i,f,s)||t.addEventListener&&t.addEventListener(p,s)),d.add&&(d.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,u):h.push(u),S.event.global[p]=!0)},remove:function(t,e,n,i,o){var r,s,a,l,c,u,d,h,p,f,g,m=Z.hasData(t)&&Z.get(t);if(m&&(l=m.events)){for(c=(e=(e||"").match(P)||[""]).length;c--;)if(p=g=(a=St.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=S.event.special[p]||{},h=l[p=(i?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=h.length;r--;)u=h[r],!o&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(h.splice(r,1),u.selector&&h.delegateCount--,d.remove&&d.remove.call(t,u));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(t,f,m.handle)||S.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)S.event.remove(t,p+e[c],n,i,!0);S.isEmptyObject(l)&&Z.remove(t,"handle events")}},dispatch:function(t){var e,n,i,o,r,s,a=new Array(arguments.length),l=S.event.fix(t),c=(Z.get(this,"events")||Object.create(null))[l.type]||[],u=S.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=S.event.handlers.call(this,l,c),e=0;(o=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(i=((S.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,i,o,r,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(r=[],s={},n=0;n<l;n++)void 0===s[o=(i=e[n]).selector+" "]&&(s[o]=i.needsContext?S(o,this).index(c)>-1:S.find(o,this,null,[c]).length),s[o]&&r.push(i);r.length&&a.push({elem:c,handlers:r})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[S.expando]?t:new S.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return mt.test(e.type)&&e.click&&D(e,"input")&&Nt(e,"click",Tt),!1},trigger:function(t){var e=this||t;return mt.test(e.type)&&e.click&&D(e,"input")&&Nt(e,"click"),!0},_default:function(t){var e=t.target;return mt.test(e.type)&&e.click&&D(e,"input")&&Z.get(e,"click")||D(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},S.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},S.Event=function(t,e){if(!(this instanceof S.Event))return new S.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Tt:kt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&S.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:kt,isPropagationStopped:kt,isImmediatePropagationStopped:kt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Tt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Tt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Tt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},(function(t,e){S.event.special[t]={setup:function(){return Nt(this,t,At),!1},trigger:function(){return Nt(this,t),!0},_default:function(){return!0},delegateType:e}})),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){S.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,o=t.relatedTarget,r=t.handleObj;return o&&(o===i||S.contains(i,o))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}})),S.fn.extend({on:function(t,e,n,i){return Ct(this,t,e,n,i)},one:function(t,e,n,i){return Ct(this,t,e,n,i,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,S(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=kt),this.each((function(){S.event.remove(this,t,n,e)}))}});var Dt=/<script|<style|<link/i,Mt=/checked\s*(?:[^=]|=\s*.checked.)/i,jt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function It(t,e){return D(t,"table")&&D(11!==e.nodeType?e:e.firstChild,"tr")&&S(t).children("tbody")[0]||t}function Lt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Bt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ot(t,e){var n,i,o,r,s,a;if(1===e.nodeType){if(Z.hasData(t)&&(a=Z.get(t).events))for(o in Z.remove(e,"handle events"),a)for(n=0,i=a[o].length;n<i;n++)S.event.add(e,o,a[o][n]);J.hasData(t)&&(r=J.access(t),s=S.extend({},r),J.set(e,s))}}function zt(t,e){var n=e.nodeName.toLowerCase();"input"===n&&mt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Pt(t,e,n,i){e=l(e);var o,r,s,a,c,u,d=0,h=t.length,p=h-1,f=e[0],g=y(f);if(g||h>1&&"string"==typeof f&&!m.checkClone&&Mt.test(f))return t.each((function(o){var r=t.eq(o);g&&(e[0]=f.call(this,o,r.html())),Pt(r,e,n,i)}));if(h&&(r=(o=Et(e,t[0].ownerDocument,!1,t,i)).firstChild,1===o.childNodes.length&&(o=r),r||i)){for(a=(s=S.map(_t(o,"script"),Lt)).length;d<h;d++)c=o,d!==p&&(c=S.clone(c,!0,!0),a&&S.merge(s,_t(c,"script"))),n.call(t[d],c,d);if(a)for(u=s[s.length-1].ownerDocument,S.map(s,Bt),d=0;d<a;d++)c=s[d],vt.test(c.type||"")&&!Z.access(c,"globalEval")&&S.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?S._evalUrl&&!c.noModule&&S._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):x(c.textContent.replace(jt,""),c,u))}return t}function Rt(t,e,n){for(var i,o=e?S.filter(e,t):t,r=0;null!=(i=o[r]);r++)n||1!==i.nodeType||S.cleanData(_t(i)),i.parentNode&&(n&&at(i)&&xt(_t(i,"script")),i.parentNode.removeChild(i));return t}S.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,o,r,s,a=t.cloneNode(!0),l=at(t);if(!(m.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||S.isXMLDoc(t)))for(s=_t(a),i=0,o=(r=_t(t)).length;i<o;i++)zt(r[i],s[i]);if(e)if(n)for(r=r||_t(t),s=s||_t(a),i=0,o=r.length;i<o;i++)Ot(r[i],s[i]);else Ot(t,a);return(s=_t(a,"script")).length>0&&xt(s,!l&&_t(t,"script")),a},cleanData:function(t){for(var e,n,i,o=S.event.special,r=0;void 0!==(n=t[r]);r++)if(Q(n)){if(e=n[Z.expando]){if(e.events)for(i in e.events)o[i]?S.event.remove(n,i):S.removeEvent(n,i,e.handle);n[Z.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),S.fn.extend({detach:function(t){return Rt(this,t,!0)},remove:function(t){return Rt(this,t)},text:function(t){return Y(this,(function(t){return void 0===t?S.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Pt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||It(this,t).appendChild(t)}))},prepend:function(){return Pt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=It(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Pt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Pt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(S.cleanData(_t(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return S.clone(this,t,e)}))},html:function(t){return Y(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Dt.test(t)&&!bt[(yt.exec(t)||["",""])[1].toLowerCase()]){t=S.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(S.cleanData(_t(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Pt(this,arguments,(function(e){var n=this.parentNode;S.inArray(this,t)<0&&(S.cleanData(_t(this)),n&&n.replaceChild(e,this))}),t)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){S.fn[t]=function(t){for(var n,i=[],o=S(t),r=o.length-1,s=0;s<=r;s++)n=s===r?this:this.clone(!0),S(o[s])[e](n),c.apply(i,n.get());return this.pushStack(i)}}));var Ht=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),Ut=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},qt=function(t,e,n){var i,o,r={};for(o in e)r[o]=t.style[o],t.style[o]=e[o];for(o in i=n.call(t),e)t.style[o]=r[o];return i},Vt=new RegExp(rt.join("|"),"i");function Wt(t,e,n){var i,o,r,s,a=t.style;return(n=n||Ut(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||at(t)||(s=S.style(t,e)),!m.pixelBoxStyles()&&Ht.test(s)&&Vt.test(e)&&(i=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function Yt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",st.appendChild(c).appendChild(u);var t=i.getComputedStyle(u);n="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",s=36===e(t.right),o=36===e(t.width),u.style.position="absolute",r=12===e(u.offsetWidth/3),st.removeChild(c),u=null}}function e(t){return Math.round(parseFloat(t))}var n,o,r,s,a,l,c=b.createElement("div"),u=b.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===u.style.backgroundClip,S.extend(m,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),r},reliableTrDimensions:function(){var t,e,n,o;return null==a&&(t=b.createElement("table"),e=b.createElement("tr"),n=b.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="border:1px solid",e.style.height="1px",n.style.height="9px",n.style.display="block",st.appendChild(t).appendChild(e).appendChild(n),o=i.getComputedStyle(e),a=parseInt(o.height,10)+parseInt(o.borderTopWidth,10)+parseInt(o.borderBottomWidth,10)===e.offsetHeight,st.removeChild(t)),a}}))}();var Ft=["Webkit","Moz","ms"],$t=b.createElement("div").style,Xt={};function Kt(t){return S.cssProps[t]||Xt[t]||(t in $t?t:Xt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Ft.length;n--;)if((t=Ft[n]+e)in $t)return t}(t)||t)}var Qt=/^(none|table(?!-c[ea]).+)/,Gt=/^--/,Zt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"};function te(t,e,n){var i=ot.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ee(t,e,n,i,o,r){var s="width"===e?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=S.css(t,n+rt[s],!0,o)),i?("content"===n&&(l-=S.css(t,"padding"+rt[s],!0,o)),"margin"!==n&&(l-=S.css(t,"border"+rt[s]+"Width",!0,o))):(l+=S.css(t,"padding"+rt[s],!0,o),"padding"!==n?l+=S.css(t,"border"+rt[s]+"Width",!0,o):a+=S.css(t,"border"+rt[s]+"Width",!0,o));return!i&&r>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-r-l-a-.5))||0),l}function ne(t,e,n){var i=Ut(t),o=(!m.boxSizingReliable()||n)&&"border-box"===S.css(t,"boxSizing",!1,i),r=o,s=Wt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Ht.test(s)){if(!n)return s;s="auto"}return(!m.boxSizingReliable()&&o||!m.reliableTrDimensions()&&D(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===S.css(t,"display",!1,i))&&t.getClientRects().length&&(o="border-box"===S.css(t,"boxSizing",!1,i),(r=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+ee(t,e,n||(o?"border":"content"),r,i,s)+"px"}function ie(t,e,n,i,o){return new ie.prototype.init(t,e,n,i,o)}S.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Wt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,s,a=K(e),l=Gt.test(e),c=t.style;if(l||(e=Kt(a)),s=S.cssHooks[e]||S.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(o=s.get(t,!1,i))?o:c[e];"string"==(r=typeof n)&&(o=ot.exec(n))&&o[1]&&(n=ut(t,e,o),r="number"),null!=n&&n==n&&("number"!==r||l||(n+=o&&o[3]||(S.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,i){var o,r,s,a=K(e);return Gt.test(e)||(e=Kt(a)),(s=S.cssHooks[e]||S.cssHooks[a])&&"get"in s&&(o=s.get(t,!0,n)),void 0===o&&(o=Wt(t,e,i)),"normal"===o&&e in Jt&&(o=Jt[e]),""===n||n?(r=parseFloat(o),!0===n||isFinite(r)?r||0:o):o}}),S.each(["height","width"],(function(t,e){S.cssHooks[e]={get:function(t,n,i){if(n)return!Qt.test(S.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ne(t,e,i):qt(t,Zt,(function(){return ne(t,e,i)}))},set:function(t,n,i){var o,r=Ut(t),s=!m.scrollboxSize()&&"absolute"===r.position,a=(s||i)&&"border-box"===S.css(t,"boxSizing",!1,r),l=i?ee(t,e,i,a,r):0;return a&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(r[e])-ee(t,e,"border",!1,r)-.5)),l&&(o=ot.exec(n))&&"px"!==(o[3]||"px")&&(t.style[e]=n,n=S.css(t,e)),te(0,n,l)}}})),S.cssHooks.marginLeft=Yt(m.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Wt(t,"marginLeft"))||t.getBoundingClientRect().left-qt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),S.each({margin:"",padding:"",border:"Width"},(function(t,e){S.cssHooks[t+e]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];i<4;i++)o[t+rt[i]+e]=r[i]||r[i-2]||r[0];return o}},"margin"!==t&&(S.cssHooks[t+e].set=te)})),S.fn.extend({css:function(t,e){return Y(this,(function(t,e,n){var i,o,r={},s=0;if(Array.isArray(e)){for(i=Ut(t),o=e.length;s<o;s++)r[e[s]]=S.css(t,e[s],!1,i);return r}return void 0!==n?S.style(t,e,n):S.css(t,e)}),t,e,arguments.length>1)}}),S.Tween=ie,ie.prototype={constructor:ie,init:function(t,e,n,i,o,r){this.elem=t,this.prop=n,this.easing=o||S.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=r||(S.cssNumber[n]?"":"px")},cur:function(){var t=ie.propHooks[this.prop];return t&&t.get?t.get(this):ie.propHooks._default.get(this)},run:function(t){var e,n=ie.propHooks[this.prop];return this.options.duration?this.pos=e=S.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ie.propHooks._default.set(this),this}},ie.prototype.init.prototype=ie.prototype,ie.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=S.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){S.fx.step[t.prop]?S.fx.step[t.prop](t):1!==t.elem.nodeType||!S.cssHooks[t.prop]&&null==t.elem.style[Kt(t.prop)]?t.elem[t.prop]=t.now:S.style(t.elem,t.prop,t.now+t.unit)}}},ie.propHooks.scrollTop=ie.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},S.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},S.fx=ie.prototype.init,S.fx.step={};var oe,re,se=/^(?:toggle|show|hide)$/,ae=/queueHooks$/;function le(){re&&(!1===b.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(le):i.setTimeout(le,S.fx.interval),S.fx.tick())}function ce(){return i.setTimeout((function(){oe=void 0})),oe=Date.now()}function ue(t,e){var n,i=0,o={height:t};for(e=e?1:0;i<4;i+=2-e)o["margin"+(n=rt[i])]=o["padding"+n]=t;return e&&(o.opacity=o.width=t),o}function de(t,e,n){for(var i,o=(he.tweeners[e]||[]).concat(he.tweeners["*"]),r=0,s=o.length;r<s;r++)if(i=o[r].call(n,e,t))return i}function he(t,e,n){var i,o,r=0,s=he.prefilters.length,a=S.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var e=oe||ce(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),r=0,s=c.tweens.length;r<s;r++)c.tweens[r].run(i);return a.notifyWith(t,[c,i,n]),i<1&&s?n:(s||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},n),originalProperties:e,originalOptions:n,startTime:oe||ce(),duration:n.duration,tweens:[],createTween:function(e,n){var i=S.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(o)return this;for(o=!0;n<i;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var n,i,o,r,s;for(n in t)if(o=e[i=K(n)],r=t[n],Array.isArray(r)&&(o=r[1],r=t[n]=r[0]),n!==i&&(t[i]=r,delete t[n]),(s=S.cssHooks[i])&&"expand"in s)for(n in r=s.expand(r),delete t[i],r)n in t||(t[n]=r[n],e[n]=o);else e[i]=o}(u,c.opts.specialEasing);r<s;r++)if(i=he.prefilters[r].call(c,t,u,c.opts))return y(i.stop)&&(S._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return S.map(u,de,c),y(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),S.fx.timer(S.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}S.Animation=S.extend(he,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ut(n.elem,t,ot.exec(e),n),n}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(P);for(var n,i=0,o=t.length;i<o;i++)n=t[i],he.tweeners[n]=he.tweeners[n]||[],he.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,o,r,s,a,l,c,u,d="width"in e||"height"in e,h=this,p={},f=t.style,g=t.nodeType&&ct(t),m=Z.get(t,"fxshow");for(i in n.queue||(null==(s=S._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,h.always((function(){h.always((function(){s.unqueued--,S.queue(t,"fx").length||s.empty.fire()}))}))),e)if(o=e[i],se.test(o)){if(delete e[i],r=r||"toggle"===o,o===(g?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||S.style(t,i)}if((l=!S.isEmptyObject(e))||!S.isEmptyObject(p))for(i in d&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=m&&m.display)&&(c=Z.get(t,"display")),"none"===(u=S.css(t,"display"))&&(c?u=c:(pt([t],!0),c=t.style.display||c,u=S.css(t,"display"),pt([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===S.css(t,"float")&&(l||(h.done((function(){f.display=c})),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=Z.access(t,"fxshow",{display:c}),r&&(m.hidden=!g),g&&pt([t],!0),h.done((function(){for(i in g||pt([t]),Z.remove(t,"fxshow"),p)S.style(t,i,p[i])}))),l=de(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?he.prefilters.unshift(t):he.prefilters.push(t)}}),S.speed=function(t,e,n){var i=t&&"object"==typeof t?S.extend({},t):{complete:n||!n&&e||y(t)&&t,duration:t,easing:n&&e||e&&!y(e)&&e};return S.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in S.fx.speeds?i.duration=S.fx.speeds[i.duration]:i.duration=S.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&S.dequeue(this,i.queue)},i},S.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ct).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=S.isEmptyObject(t),r=S.speed(e,n,i),s=function(){var e=he(this,S.extend({},t),r);(o||Z.get(this,"finish"))&&e.stop(!0)};return s.finish=s,o||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,o=null!=t&&t+"queueHooks",r=S.timers,s=Z.get(this);if(o)s[o]&&s[o].stop&&i(s[o]);else for(o in s)s[o]&&s[o].stop&&ae.test(o)&&i(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(n),e=!1,r.splice(o,1));!e&&n||S.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=Z.get(this),i=n[t+"queue"],o=n[t+"queueHooks"],r=S.timers,s=i?i.length:0;for(n.finish=!0,S.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),S.each(["toggle","show","hide"],(function(t,e){var n=S.fn[e];S.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ue(e,!0),t,i,o)}})),S.each({slideDown:ue("show"),slideUp:ue("hide"),slideToggle:ue("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){S.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),S.timers=[],S.fx.tick=function(){var t,e=0,n=S.timers;for(oe=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||S.fx.stop(),oe=void 0},S.fx.timer=function(t){S.timers.push(t),S.fx.start()},S.fx.interval=13,S.fx.start=function(){re||(re=!0,le())},S.fx.stop=function(){re=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(t,e){return t=S.fx&&S.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var o=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(o)}}))},function(){var t=b.createElement("input"),e=b.createElement("select").appendChild(b.createElement("option"));t.type="checkbox",m.checkOn=""!==t.value,m.optSelected=e.selected,(t=b.createElement("input")).value="t",t.type="radio",m.radioValue="t"===t.value}();var pe,fe=S.expr.attrHandle;S.fn.extend({attr:function(t,e){return Y(this,S.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){S.removeAttr(this,t)}))}}),S.extend({attr:function(t,e,n){var i,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===t.getAttribute?S.prop(t,e,n):(1===r&&S.isXMLDoc(t)||(o=S.attrHooks[e.toLowerCase()]||(S.expr.match.bool.test(e)?pe:void 0)),void 0!==n?null===n?void S.removeAttr(t,e):o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:(t.setAttribute(e,n+""),n):o&&"get"in o&&null!==(i=o.get(t,e))?i:null==(i=S.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&D(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,o=e&&e.match(P);if(o&&1===t.nodeType)for(;n=o[i++];)t.removeAttribute(n)}}),pe={set:function(t,e,n){return!1===e?S.removeAttr(t,n):t.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=fe[e]||S.find.attr;fe[e]=function(t,e,i){var o,r,s=e.toLowerCase();return i||(r=fe[s],fe[s]=o,o=null!=n(t,e,i)?s:null,fe[s]=r),o}}));var ge=/^(?:input|select|textarea|button)$/i,me=/^(?:a|area)$/i;function ye(t){return(t.match(P)||[]).join(" ")}function ve(t){return t.getAttribute&&t.getAttribute("class")||""}function be(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(P)||[]}S.fn.extend({prop:function(t,e){return Y(this,S.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[S.propFix[t]||t]}))}}),S.extend({prop:function(t,e,n){var i,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&S.isXMLDoc(t)||(e=S.propFix[e]||e,o=S.propHooks[e]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:t[e]=n:o&&"get"in o&&null!==(i=o.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=S.find.attr(t,"tabindex");return e?parseInt(e,10):ge.test(t.nodeName)||me.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(S.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){S.propFix[this.toLowerCase()]=this})),S.fn.extend({addClass:function(t){var e,n,i,o,r,s,a,l=0;if(y(t))return this.each((function(e){S(this).addClass(t.call(this,e,ve(this)))}));if((e=be(t)).length)for(;n=this[l++];)if(o=ve(n),i=1===n.nodeType&&" "+ye(o)+" "){for(s=0;r=e[s++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");o!==(a=ye(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,o,r,s,a,l=0;if(y(t))return this.each((function(e){S(this).removeClass(t.call(this,e,ve(this)))}));if(!arguments.length)return this.attr("class","");if((e=be(t)).length)for(;n=this[l++];)if(o=ve(n),i=1===n.nodeType&&" "+ye(o)+" "){for(s=0;r=e[s++];)for(;i.indexOf(" "+r+" ")>-1;)i=i.replace(" "+r+" "," ");o!==(a=ye(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):y(t)?this.each((function(n){S(this).toggleClass(t.call(this,n,ve(this),e),e)})):this.each((function(){var e,o,r,s;if(i)for(o=0,r=S(this),s=be(t);e=s[o++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||((e=ve(this))&&Z.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Z.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ye(ve(n))+" ").indexOf(e)>-1)return!0;return!1}});var _e=/\r/g;S.fn.extend({val:function(t){var e,n,i,o=this[0];return arguments.length?(i=y(t),this.each((function(n){var o;1===this.nodeType&&(null==(o=i?t.call(this,n,S(this).val()):t)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=S.map(o,(function(t){return null==t?"":t+""}))),(e=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))}))):o?(e=S.valHooks[o.type]||S.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(_e,""):null==n?"":n:void 0}}),S.extend({valHooks:{option:{get:function(t){var e=S.find.attr(t,"value");return null!=e?e:ye(S.text(t))}},select:{get:function(t){var e,n,i,o=t.options,r=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?r+1:o.length;for(i=r<0?l:s?r:0;i<l;i++)if(((n=o[i]).selected||i===r)&&!n.disabled&&(!n.parentNode.disabled||!D(n.parentNode,"optgroup"))){if(e=S(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,o=t.options,r=S.makeArray(e),s=o.length;s--;)((i=o[s]).selected=S.inArray(S.valHooks.option.get(i),r)>-1)&&(n=!0);return n||(t.selectedIndex=-1),r}}}}),S.each(["radio","checkbox"],(function(){S.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=S.inArray(S(t).val(),e)>-1}},m.checkOn||(S.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),m.focusin="onfocusin"in i;var xe=/^(?:focusinfocus|focusoutblur)$/,we=function(t){t.stopPropagation()};S.extend(S.event,{trigger:function(t,e,n,o){var r,s,a,l,c,u,d,h,f=[n||b],g=p.call(t,"type")?t.type:t,m=p.call(t,"namespace")?t.namespace.split("."):[];if(s=h=a=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!xe.test(g+S.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[S.expando]?t:new S.Event(g,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:S.makeArray(e,[t]),d=S.event.special[g]||{},o||!d.trigger||!1!==d.trigger.apply(n,e))){if(!o&&!d.noBubble&&!v(n)){for(l=d.delegateType||g,xe.test(l+g)||(s=s.parentNode);s;s=s.parentNode)f.push(s),a=s;a===(n.ownerDocument||b)&&f.push(a.defaultView||a.parentWindow||i)}for(r=0;(s=f[r++])&&!t.isPropagationStopped();)h=s,t.type=r>1?l:d.bindType||g,(u=(Z.get(s,"events")||Object.create(null))[t.type]&&Z.get(s,"handle"))&&u.apply(s,e),(u=c&&s[c])&&u.apply&&Q(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=g,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),e)||!Q(n)||c&&y(n[g])&&!v(n)&&((a=n[c])&&(n[c]=null),S.event.triggered=g,t.isPropagationStopped()&&h.addEventListener(g,we),n[g](),t.isPropagationStopped()&&h.removeEventListener(g,we),S.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(t,e,n){var i=S.extend(new S.Event,n,{type:t,isSimulated:!0});S.event.trigger(i,null,e)}}),S.fn.extend({trigger:function(t,e){return this.each((function(){S.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return S.event.trigger(t,e,n,!0)}}),m.focusin||S.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){S.event.simulate(e,t.target,S.event.fix(t))};S.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,o=Z.access(i,e);o||i.addEventListener(t,n,!0),Z.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,o=Z.access(i,e)-1;o?Z.access(i,e,o):(i.removeEventListener(t,n,!0),Z.remove(i,e))}}}));var Ee=i.location,Se={guid:Date.now()},Te=/\?/;S.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){}return n=e&&e.getElementsByTagName("parsererror")[0],e&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var ke=/\[\]$/,Ae=/\r?\n/g,Ce=/^(?:submit|button|image|reset|file)$/i,Ne=/^(?:input|select|textarea|keygen)/i;function De(t,e,n,i){var o;if(Array.isArray(e))S.each(e,(function(e,o){n||ke.test(t)?i(t,o):De(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,n,i)}));else if(n||"object"!==w(e))i(t,e);else for(o in e)De(t+"["+o+"]",e[o],n,i)}S.param=function(t,e){var n,i=[],o=function(t,e){var n=y(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!S.isPlainObject(t))S.each(t,(function(){o(this.name,this.value)}));else for(n in t)De(n,t[n],e,o);return i.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=S.prop(this,"elements");return t?S.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!S(this).is(":disabled")&&Ne.test(this.nodeName)&&!Ce.test(t)&&(this.checked||!mt.test(t))})).map((function(t,e){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,(function(t){return{name:e.name,value:t.replace(Ae,"\r\n")}})):{name:e.name,value:n.replace(Ae,"\r\n")}})).get()}});var Me=/%20/g,je=/#.*$/,Ie=/([?&])_=[^&]*/,Le=/^(.*?):[ \t]*([^\r\n]*)$/gm,Be=/^(?:GET|HEAD)$/,Oe=/^\/\//,ze={},Pe={},Re="*/".concat("*"),He=b.createElement("a");function Ue(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,r=e.toLowerCase().match(P)||[];if(y(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function qe(t,e,n,i){var o={},r=t===Pe;function s(a){var l;return o[a]=!0,S.each(t[a]||[],(function(t,a){var c=a(e,n,i);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)})),l}return s(e.dataTypes[0])||!o["*"]&&s("*")}function Ve(t,e){var n,i,o=S.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((o[n]?t:i||(i={}))[n]=e[n]);return i&&S.extend(!0,t,i),t}He.href=Ee.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ee.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ee.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Re,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ve(Ve(t,S.ajaxSettings),e):Ve(S.ajaxSettings,t)},ajaxPrefilter:Ue(ze),ajaxTransport:Ue(Pe),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,o,r,s,a,l,c,u,d,h,p=S.ajaxSetup({},e),f=p.context||p,g=p.context&&(f.nodeType||f.jquery)?S(f):S.event,m=S.Deferred(),y=S.Callbacks("once memory"),v=p.statusCode||{},_={},x={},w="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Le.exec(r);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?r:null},setRequestHeader:function(t,e){return null==c&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,_[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)E.always(t[E.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||w;return n&&n.abort(e),T(0,e),this}};if(m.promise(E),p.url=((t||p.url||Ee.href)+"").replace(Oe,Ee.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(P)||[""],null==p.crossDomain){l=b.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=He.protocol+"//"+He.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=S.param(p.data,p.traditional)),qe(ze,p,e,E),c)return E;for(d in(u=S.event&&p.global)&&0==S.active++&&S.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Be.test(p.type),o=p.url.replace(je,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Me,"+")):(h=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(Te.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(Ie,"$1"),h=(Te.test(o)?"&":"?")+"_="+Se.guid+++h),p.url=o+h),p.ifModified&&(S.lastModified[o]&&E.setRequestHeader("If-Modified-Since",S.lastModified[o]),S.etag[o]&&E.setRequestHeader("If-None-Match",S.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&E.setRequestHeader("Content-Type",p.contentType),E.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Re+"; q=0.01":""):p.accepts["*"]),p.headers)E.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(f,E,p)||c))return E.abort();if(w="abort",y.add(p.complete),E.done(p.success),E.fail(p.error),n=qe(Pe,p,e,E)){if(E.readyState=1,u&&g.trigger("ajaxSend",[E,p]),c)return E;p.async&&p.timeout>0&&(a=i.setTimeout((function(){E.abort("timeout")}),p.timeout));try{c=!1,n.send(_,T)}catch(t){if(c)throw t;T(-1,t)}}else T(-1,"No Transport");function T(t,e,s,l){var d,h,b,_,x,w=e;c||(c=!0,a&&i.clearTimeout(a),n=void 0,r=l||"",E.readyState=t>0?4:0,d=t>=200&&t<300||304===t,s&&(_=function(t,e,n){for(var i,o,r,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(o in a)if(a[o]&&a[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}if(r)return r!==l[0]&&l.unshift(r),n[r]}(p,E,s)),!d&&S.inArray("script",p.dataTypes)>-1&&S.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),_=function(t,e,n,i){var o,r,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(r=u.shift();r;)if(t.responseFields[r]&&(n[t.responseFields[r]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(o in c)if((a=o.split(" "))[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[o]:!0!==c[o]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}(p,_,E,d),d?(p.ifModified&&((x=E.getResponseHeader("Last-Modified"))&&(S.lastModified[o]=x),(x=E.getResponseHeader("etag"))&&(S.etag[o]=x)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=_.state,h=_.data,d=!(b=_.error))):(b=w,!t&&w||(w="error",t<0&&(t=0))),E.status=t,E.statusText=(e||w)+"",d?m.resolveWith(f,[h,w,E]):m.rejectWith(f,[E,w,b]),E.statusCode(v),v=void 0,u&&g.trigger(d?"ajaxSuccess":"ajaxError",[E,p,d?h:b]),y.fireWith(f,[E,w]),u&&(g.trigger("ajaxComplete",[E,p]),--S.active||S.event.trigger("ajaxStop")))}return E},getJSON:function(t,e,n){return S.get(t,e,n,"json")},getScript:function(t,e){return S.get(t,void 0,e,"script")}}),S.each(["get","post"],(function(t,e){S[e]=function(t,n,i,o){return y(n)&&(o=o||i,i=n,n=void 0),S.ajax(S.extend({url:t,type:e,dataType:o,data:n,success:i},S.isPlainObject(t)&&t))}})),S.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),S._evalUrl=function(t,e,n){return S.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){S.globalEval(t,e,n)}})},S.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=S(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y(t)?this.each((function(e){S(this).wrapInner(t.call(this,e))})):this.each((function(){var e=S(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y(t);return this.each((function(n){S(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){S(this).replaceWith(this.childNodes)})),this}}),S.expr.pseudos.hidden=function(t){return!S.expr.pseudos.visible(t)},S.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var We={0:200,1223:204},Ye=S.ajaxSettings.xhr();m.cors=!!Ye&&"withCredentials"in Ye,m.ajax=Ye=!!Ye,S.ajaxTransport((function(t){var e,n;if(m.cors||Ye&&!t.crossDomain)return{send:function(o,r){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)a.setRequestHeader(s,o[s]);e=function(t){return function(){e&&(e=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(We[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),n=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){e&&n()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),S.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return S.globalEval(t),t}}}),S.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),S.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,o){e=S("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),b.head.appendChild(e[0])},abort:function(){n&&n()}}}));var Fe,$e=[],Xe=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=$e.pop()||S.expando+"_"+Se.guid++;return this[t]=!0,t}}),S.ajaxPrefilter("json jsonp",(function(t,e,n){var o,r,s,a=!1!==t.jsonp&&(Xe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Xe,"$1"+o):!1!==t.jsonp&&(t.url+=(Te.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||S.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=i[o],i[o]=function(){s=arguments},n.always((function(){void 0===r?S(i).removeProp(o):i[o]=r,t[o]&&(t.jsonpCallback=e.jsonpCallback,$e.push(o)),s&&y(r)&&r(s[0]),s=r=void 0})),"script"})),m.createHTMLDocument=((Fe=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Fe.childNodes.length),S.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(m.createHTMLDocument?((i=(e=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,e.head.appendChild(i)):e=b),r=!n&&[],(o=M.exec(t))?[e.createElement(o[1])]:(o=Et([t],e,r),r&&r.length&&S(r).remove(),S.merge([],o.childNodes)));var i,o,r},S.fn.load=function(t,e,n){var i,o,r,s=this,a=t.indexOf(" ");return a>-1&&(i=ye(t.slice(a)),t=t.slice(0,a)),y(e)?(n=e,e=void 0):e&&"object"==typeof e&&(o="POST"),s.length>0&&S.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done((function(t){r=arguments,s.html(i?S("<div>").append(S.parseHTML(t)).find(i):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,r||[t.responseText,e,t])}))}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,(function(e){return t===e.elem})).length},S.offset={setOffset:function(t,e,n){var i,o,r,s,a,l,c=S.css(t,"position"),u=S(t),d={};"static"===c&&(t.style.position="relative"),a=u.offset(),r=S.css(t,"top"),l=S.css(t,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(s=(i=u.position()).top,o=i.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),y(e)&&(e=e.call(t,n,S.extend({},a))),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+o),"using"in e?e.using.call(t,d):u.css(d)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){S.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],o={top:0,left:0};if("fixed"===S.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===S.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((o=S(t).offset()).top+=S.css(t,"borderTopWidth",!0),o.left+=S.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-S.css(i,"marginTop",!0),left:e.left-o.left-S.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===S.css(t,"position");)t=t.offsetParent;return t||st}))}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;S.fn[t]=function(i){return Y(this,(function(t,i,o){var r;if(v(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===o)return r?r[e]:t[i];r?r.scrollTo(n?r.pageXOffset:o,n?o:r.pageYOffset):t[i]=o}),t,i,arguments.length)}})),S.each(["top","left"],(function(t,e){S.cssHooks[e]=Yt(m.pixelPosition,(function(t,n){if(n)return n=Wt(t,e),Ht.test(n)?S(t).position()[e]+"px":n}))})),S.each({Height:"height",Width:"width"},(function(t,e){S.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){S.fn[i]=function(o,r){var s=arguments.length&&(n||"boolean"!=typeof o),a=n||(!0===o||!0===r?"margin":"border");return Y(this,(function(e,n,o){var r;return v(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===o?S.css(e,n,a):S.style(e,n,o,a)}),e,s?o:void 0,s)}}))})),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){S.fn[e]=function(t){return this.on(e,t)}})),S.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){S.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var Ke=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(t,e){var n,i,o;if("string"==typeof e&&(n=t[e],e=t,t=n),y(t))return i=a.call(arguments,2),o=function(){return t.apply(e||this,i.concat(a.call(arguments)))},o.guid=t.guid=t.guid||S.guid++,o},S.holdReady=function(t){t?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=D,S.isFunction=y,S.isWindow=v,S.camelCase=K,S.type=w,S.now=Date.now,S.isNumeric=function(t){var e=S.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},S.trim=function(t){return null==t?"":(t+"").replace(Ke,"")},void 0===(n=function(){return S}.apply(e,[]))||(t.exports=n);var Qe=i.jQuery,Ge=i.$;return S.noConflict=function(t){return i.$===S&&(i.$=Ge),t&&i.jQuery===S&&(i.jQuery=Qe),S},void 0===o&&(i.jQuery=i.$=S),S}))},846:t=>{t.exports=function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};e[s][0].call(c.exports,(function(t){return o(e[s][1][t]||t)}),c,c.exports,t,e,n,i)}return n[s].exports}for(var r=void 0,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return new function(t){if(this._event=t,this._data=t.data,this.receivedTime=t.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&t.data[0],this.channel=15&t.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&t.data[1],this.velocity=127&t.data[2];break;case 144:this.messageType="noteon",this.key=127&t.data[1],this.velocity=127&t.data[2];break;case 160:this.messageType="keypressure",this.key=127&t.data[1],this.pressure=127&t.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&t.data[1],this.controllerValue=127&t.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=t.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&t.data[1];break;case 224:this.messageType="pitchbendchange";var e=127&t.data[2],n=127&t.data[1];this.pitchBend=(e<<8)+n}}(t)},e.exports=n.default},{}]},{},[1])(1)},681:(t,e,n)=>{"use strict";function i(t,e){return Array(e+1).join(t)}function o(t){return"number"==typeof t}function r(t,e){return Math.pow(2,(t-69)/12)*(e||440)}n.r(e),n.d(e,{regex:()=>a,parse:()=>c,build:()=>u,midi:()=>d,freq:()=>h,letter:()=>p,acc:()=>f,pc:()=>g,step:()=>m,alt:()=>y,chroma:()=>v,oct:()=>b});var s=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function a(){return s}var l=[0,2,4,5,7,9,11];function c(t,e,n){if("string"!=typeof t)return null;var i=s.exec(t);if(!i||!e&&i[4])return null;var o={letter:i[1].toUpperCase(),acc:i[2].replace(/x/g,"##")};o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length;var a=l[o.step]+o.alt;return o.chroma=a<0?12+a:a%12,i[3]&&(o.oct=+i[3],o.midi=a+12*(o.oct+1),o.freq=r(o.midi,n)),e&&(o.tonicOf=i[4]),o}function u(t,e,n){return null==t?null:t.step?u(t.step,t.alt,t.oct):t<0||t>6?null:"CDEFGAB".charAt(t)+(o(r=e)?r<0?i("b",-r):i("#",r):"")+function(t){return o(t)?""+t:""}(n);var r}function d(t){if((o(t)||"string"==typeof t)&&t>=0&&t<128)return+t;var e=c(t);return e&&function(t){return void 0!==t}(e.midi)?e.midi:null}function h(t,e){var n=d(t);return null===n?null:r(n,e)}function p(t){return(c(t)||{}).letter}function f(t){return(c(t)||{}).acc}function g(t){return(c(t)||{}).pc}function m(t){return(c(t)||{}).step}function y(t){return(c(t)||{}).alt}function v(t){return(c(t)||{}).chroma}function b(t){return(c(t)||{}).oct}},986:function(t){var e;"undefined"!=typeof self&&self,e=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){(function(e){t.exports=function(t,n){var i,o,r,s,a,l,c,u=e.window,d=u.document,h=d.documentElement,p=d.querySelector("body"),f=t.getContext("2d"),g=function(t){return"rgba(0,0,0,".concat(t/100,")")},m=Object.assign({viewport:null,styles:{"header,footer,section,article":g(8),"h1,a":g(10),"h2,h3,h4":g(8)},back:g(2),view:g(5),drag:g(10),interval:null},n),y=function(t,e,n,i){return n.split(/\s+/).forEach((function(n){return t[e](n,i)}))},v=function(t,e,n){return y(t,"addEventListener",e,n)},b=function(t,e,n){return y(t,"removeEventListener",e,n)},_=function(t,e,n,i){return{x:t,y:e,w:n,h:i}},x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return _(t.x-e.x,t.y-e.y,t.w,t.h)},w=function(t){var e=t.getBoundingClientRect();return{x:e.left+u.pageXOffset,y:e.top+u.pageYOffset}},E=function(t){var e=w(t),n=e.x,i=e.y;return _(n+t.clientLeft,i+t.clientTop,t.clientWidth,t.clientHeight)},S=(i=t.clientWidth,o=t.clientHeight,function(t,e){return Math.min(i/t,o/e)}),T=m.viewport,k=!1,A=function(t,e){e&&(f.beginPath(),f.rect(t.x,t.y,t.w,t.h),f.fillStyle=e,f.fill())},C=function(){var e,n,i,o,l,c,p;r=T?(l=w(o=T),c=l.x,p=l.y,_(c+o.clientLeft-o.scrollLeft,p+o.clientTop-o.scrollTop,o.scrollWidth,o.scrollHeight)):_(0,0,h.scrollWidth,h.scrollHeight),s=T?E(T):_(u.pageXOffset,u.pageYOffset,h.clientWidth,h.clientHeight),a=S(r.w,r.h),e=r.w*a,n=r.h*a,t.width=e,t.height=n,t.style.width="".concat(e,"px"),t.style.height="".concat(n,"px"),f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,t.width,t.height),f.scale(a,a),A(x(r,r),m.back),i=m.styles,Object.keys(i).forEach((function(t){var e=i[t];(function(t){return Array.from((T||d).querySelectorAll(t))})(t).forEach((function(t){A(x(function(t){var e=w(t),n=e.x,i=e.y;return _(n,i,t.offsetWidth,t.offsetHeight)}(t),r),e)}))})),A(x(s,r),k?m.drag:m.view)},N=function(e){e.preventDefault();var n=E(t),i=(e.pageX-n.x)/a-s.w*l,o=(e.pageY-n.y)/a-s.h*c;T?(T.scrollLeft=i,T.scrollTop=o):u.scrollTo(i,o),C()},D=function e(n){k=!1,t.style.cursor="pointer",p.style.cursor="auto",b(u,"mousemove",N),b(u,"mouseup",e),N(n)};return t.style.cursor="pointer",v(t,"mousedown",(function(e){k=!0;var n=E(t),i=x(s,r);l=((e.pageX-n.x)/a-i.x)/i.w,c=((e.pageY-n.y)/a-i.y)/i.h,(l<0||l>1||c<0||c>1)&&(l=.5,c=.5),t.style.cursor="crosshair",p.style.cursor="crosshair",v(u,"mousemove",N),v(u,"mouseup",D),N(e)})),v(T||u,"load resize scroll",C),m.interval>0&&setInterval((function(){return C()}),m.interval),C(),{redraw:C}}}).call(this,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n}])},t.exports=e()},316:t=>{function e(t,e){return function(n,i,o,r){t(n,i,o,r),e(n,i,o,r)}}t.exports=function(t){return t.on=function(n,i){if(1===arguments.length&&"function"==typeof n)return t.on("event",n);var o="on"+n,r=t[o];return t[o]=r?e(r,i):i,t},t}},272:(t,e,n)=>{"use strict";var i=n(451),o=n(316),r=n(861),s=n(41),a=n(549);function l(t,e,n){return a(s(r(o(i(t,e,n)))))}t.exports&&(t.exports=l),"undefined"!=typeof window&&(window.SamplePlayer=l)},549:(t,e,n)=>{var i=n(846);t.exports=function(t){return t.listenToMidi=function(e,n){var o={},r=n||{},s=r.gain||function(t){return t/127};return e.onmidimessage=function(e){var n=e.messageType?e:i(e);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!r.channel||n.channel===r.channel)switch(n.messageType){case"noteon":o[n.key]=t.play(n.key,0,{gain:s(n.velocity)});break;case"noteoff":o[n.key]&&(o[n.key].stop(),delete o[n.key])}},t},t}},861:(t,e,n)=>{"use strict";var i=n(46),o=function(t){return function(t){return null!==t&&t!==[]&&t>=0&&t<129}(t)?+t:i.midi(t)};t.exports=function(t){if(t.buffers){var e=t.opts.map,n="function"==typeof e?e:o,i=function(t){return t?n(t)||t:null};t.buffers=function(t,e){return Object.keys(t).reduce((function(n,i){return n[e(i)]=t[i],n}),{})}(t.buffers,i);var r=t.start;t.start=function(t,e,n){var o=i(t),s=o%1;return s&&(o=Math.floor(o),n=Object.assign(n||{},{cents:Math.floor(100*s)})),r(o,e,n)}}return t}},451:(t,e,n)=>{"use strict";var i=n(729),o={},r={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function s(t){return"number"==typeof t}var a=["attack","decay","sustain","release"];t.exports=function(t,e,n){var l=!1,c=0,u={},d=t.createGain();d.gain.value=1;var h=Object.assign({},r,n),p={context:t,out:d,opts:h};return e instanceof AudioBuffer?p.buffer=e:p.buffers=e,p.start=function(e,n,i){if(p.buffer&&null!==e)return p.start(null,e,n);var r=e?p.buffers[e]:p.buffer;if(r){if(l){var s=i||o;n=Math.max(t.currentTime,n||0),p.emit("start",n,e,s);var a=f(e,r,s);return a.id=function(e,n){return n.id=c++,u[n.id]=n,n.source.onended=function(){var e=t.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),p.emit("ended",e,n.id,n)},n.id}(0,a),a.env.start(n),a.source.start(n),p.emit("started",n,a.id,a),s.duration&&a.stop(n+s.duration),a}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+e+" not found.")},p.play=function(t,e,n){return p.start(t,e,n)},p.stop=function(t,e){var n;return(e=e||Object.keys(u)).map((function(e){return(n=u[e])?(n.stop(t),n.id):null}))},p.connect=function(t){return l=!0,d.connect(t),p},p.emit=function(t,e,n,i){p.onevent&&p.onevent(t,e,n,i);var o=p["on"+t];o&&o(e,n,i)},p;function f(e,n,o){var r,l=t.createGain();return l.gain.value=0,l.connect(d),l.env=function(t,e,n){var o=i(t),r=e.adsr||n.adsr;return a.forEach((function(t,i){o[t]=r?r[i]:e[t]||n[t]})),o.value.value=s(e.gain)?e.gain:s(n.gain)?n.gain:1,o}(t,o,h),l.env.connect(l.gain),l.source=t.createBufferSource(),l.source.buffer=n,l.source.connect(l),l.source.loop=o.loop||h.loop,l.source.playbackRate.value=(r=o.cents||h.cents)?Math.pow(2,r/1200):1,l.source.loopStart=o.loopStart||h.loopStart,l.source.loopEnd=o.loopEnd||h.loopEnd,l.stop=function(n){var i=n||t.currentTime;p.emit("stop",i,e);var o=l.env.stop(i);l.source.stop(o)},l}}},41:t=>{"use strict";var e=Array.isArray,n={};t.exports=function(t){return t.schedule=function(i,o){var r,s,a,l,c=t.context.currentTime,u=i<c?c:i;return t.emit("schedule",u,o),o.map((function(i){return i?(e(i)?(r=i[0],s=i[1]):(r=i.time,s=i),function(t){return t&&"object"==typeof t}(s)?(a=s.name||s.key||s.note||s.midi||null,l=s):(a=s,l=n),t.start(a,u+(r||0),l)):null}))},t}},46:t=>{"use strict";var e=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,n=[0,2,4,5,7,9,11];function i(t,i,r){if("string"!=typeof t)return null;var s=e.exec(t);if(!s||!i&&s[4])return null;var a={letter:s[1].toUpperCase(),acc:s[2].replace(/x/g,"##")};return a.pc=a.letter+a.acc,a.step=(a.letter.charCodeAt(0)+3)%7,a.alt="b"===a.acc[0]?-a.acc.length:a.acc.length,a.chroma=n[a.step]+a.alt,s[3]&&(a.oct=+s[3],a.midi=a.chroma+12*(a.oct+1),a.freq=o(a.midi,r)),i&&(a.tonicOf=s[4]),a}function o(t,e){return Math.pow(2,(t-69)/12)*(e||440)}var r={parse:i,regex:function(){return e},midiToFreq:o};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(t){r[t]=function(e){var n=i(e);return n&&void 0!==n[t]?n[t]:null}})),t.exports=r},346:(t,e,n)=>{"use strict";var i=n(665),o=n(272);function r(t){return/\.js(\?.*)?$/i.test(t)}function s(t,e,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(e="FluidR3_GM"===e?e:"MusyngKite")+"/"+t+"-"+(n="ogg"===n?n:"mp3")+".js"}var a=n(975);a.instrument=function t(e,n,a){if(1===arguments.length)return function(n,i){return t(e,n,i)};var l=a||{},c=l.isSoundfontURL||r,u=l.nameToUrl||s,d=c(n)?n:u(n,l.soundfont,l.format);return i(e,d,{only:l.only||l.notes}).then((function(t){var i=o(e,t,l).connect(l.destination?l.destination:e.destination);return i.url=d,i.name=n,i}))},a.nameToUrl=s,t.exports&&(t.exports=a),"undefined"!=typeof window&&(window.Soundfont=a)},975:(t,e,n)=>{"use strict";var i=n(681);function o(t,e){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof o))return new o(t);this.nameToUrl=e||o.nameToUrl,this.ctx=t,this.instruments={},this.promises=[]}function r(t,e){return e=e||{},function(n,o,r,s){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var a=n>0&&n<129?+n:i.midi(n),l=a?i.midiToFreq(a,440):null;if(l){r=r||.2;var c=(s=s||{}).destination||e.destination||t.destination,u=s.vcoType||e.vcoType||"sine",d=s.gain||e.gain||.4,h=t.createOscillator();h.type=u,h.frequency.value=l;var p=t.createGain();return p.gain.value=d,h.connect(p),p.connect(c),h.start(o),r>0&&h.stop(o+r),h}}}o.prototype.onready=function(t){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(t)},o.prototype.instrument=function(t,e){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((t=t||"default")in this.instruments)return this.instruments[t];var i={name:t,play:r(n,e)};if(this.instruments[t]=i,"default"!==t){var s=o.instrument(n,t,e).then((function(t){return i.play=t.play,i}));this.promises.push(s),i.onready=function(t){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),s.then(t)}}else i.onready=function(t){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),t()};return i},o.loadBuffers=function(t,e,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),o.instrument(t,e,n).then((function(t){return t.buffers}))},o.noteToMidi=i.midi,t.exports=o}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(419)})();
//# sourceMappingURL=app.js.map?id=ee9c236c14068c131daa