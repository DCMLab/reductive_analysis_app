/*! For license information please see app.js.LICENSE.txt */
(()=>{var __webpack_modules__={729:t=>{t.exports=function(t){var o=t.createGain(),r=o._voltage=function(t){var e=t.createBufferSource(),i=t.createBuffer(1,2,t.sampleRate);return i.getChannelData(0).set(n),e.buffer=i,e.loop=!0,e}(t),s=i(r),a=i(r),l=i(r);return o._startAmount=i(a),o._endAmount=i(l),o._multiplier=i(s),o._multiplier.connect(o),o._startAmount.connect(o),o._endAmount.connect(o),o.value=s.gain,o.startValue=a.gain,o.endValue=l.gain,o.startValue.value=0,o.endValue.value=0,Object.defineProperties(o,e),o};var e={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(t){var e=this._multiplier.gain,n=this._startAmount.gain,i=this._endAmount.gain;this._voltage.start(t),this._decayFrom=this._decayFrom=t+this.attack,this._startedAt=t;var r=this.sustain;e.cancelScheduledValues(t),n.cancelScheduledValues(t),i.cancelScheduledValues(t),i.setValueAtTime(0,t),this.attack?(e.setValueAtTime(0,t),e.linearRampToValueAtTime(1,t+this.attack),n.setValueAtTime(1,t),n.linearRampToValueAtTime(0,t+this.attack)):(e.setValueAtTime(1,t),n.setValueAtTime(0,t)),this.decay&&e.setTargetAtTime(r,this._decayFrom,o(this.decay))}},stop:{value:function(t,e){e&&(t-=this.release);var n=t+this.release;if(this.release){var i=this._multiplier.gain,r=this._startAmount.gain,s=this._endAmount.gain;i.cancelScheduledValues(t),r.cancelScheduledValues(t),s.cancelScheduledValues(t);var a=o(this.release);if(this.attack&&t<this._decayFrom){var l=function(t,e,n,i,o){var r=0+(o-n)/(i-n)*1;return r<=0&&(r=0),r>=1&&(r=1),r}(0,0,this._startedAt,this._decayFrom,t);i.linearRampToValueAtTime(l,t),r.linearRampToValueAtTime(1-l,t),r.setTargetAtTime(0,t,a)}s.setTargetAtTime(1,t,a),i.setTargetAtTime(0,t,a)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(t){this._voltage.onended=t}}},n=new Float32Array([1,1]);function i(t){var e=t.context.createGain();return t.connect(e),e}function o(t){return Math.log(t+1)/Math.log(100)}},158:t=>{"use strict";t.exports={decode:function(t,e){for(var n,i,o,r=t.replace(/[^A-Za-z0-9\+\/]/g,""),s=r.length,a=e?Math.ceil((3*s+1>>2)/e)*e:3*s+1>>2,l=new Uint8Array(a),c=0,u=0,d=0;d<s;d++)if(i=3&d,c|=((o=r.charCodeAt(d))>64&&o<91?o-65:o>96&&o<123?o-71:o>47&&o<58?o+4:43===o?62:47===o?63:0)<<18-6*i,3===i||s-d==1){for(n=0;n<3&&u<a;n++,u++)l[u]=c>>>(16>>>n&24)&255;c=0}return l}}},799:t=>{"use strict";t.exports=function(t,e){return new Promise((function(n,i){var o=new XMLHttpRequest;e&&(o.responseType=e),o.open("GET",t),o.onload=function(){200===o.status?n(o.response):i(Error(o.statusText))},o.onerror=function(){i(Error("Network Error"))},o.send()}))}},665:(t,e,n)=>{"use strict";var i=n(158),o=n(799);function r(t){return function(e){return"string"==typeof e&&t.test(e)}}function s(t,e){return"string"==typeof t?t+e:"function"==typeof t?t(e):e}function a(t,e,n,i){var o,r=e instanceof ArrayBuffer?l:c(e)?u:(o=e)&&"function"==typeof o.then?d:h(e)?p:function(t){return t&&"object"==typeof t}(e)?f:g(e)?m:y(e)?v:b(e)?x:null;return r?r(t,e,n||{}):i?Promise.resolve(i):Promise.reject("Source not valid ("+e+")")}function l(t,e,n){return new Promise((function(n,i){t.decodeAudioData(e,(function(t){n(t)}),(function(){i("Can't decode audio data ("+e.slice(0,30)+"...)")}))}))}a.fetch=o;var c=r(/\.(mp3|wav|ogg)(\?.*)?$/i);function u(t,e,n){var i=s(n.from,e);return a(t,a.fetch(i,"arraybuffer"),n)}function d(t,e,n){return e.then((function(e){return a(t,e,n)}))}var h=Array.isArray;function p(t,e,n){return Promise.all(e.map((function(e){return a(t,e,n,e)})))}function f(t,e,n){var i={},o=Object.keys(e).map((function(o){if(n.only&&-1===n.only.indexOf(o))return null;var r=e[o];return a(t,r,n,r).then((function(t){i[o]=t}))}));return Promise.all(o).then((function(){return i}))}var g=r(/\.json(\?.*)?$/i);function m(t,e,n){var i=s(n.from,e);return a(t,a.fetch(i,"text").then(JSON.parse),n)}var y=r(/^data:audio/);function v(t,e,n){var o=e.indexOf(",");return a(t,i.decode(e.slice(o+1)).buffer,n)}var b=r(/\.js(\?.*)?$/i);function x(t,e,n){var i=s(n.from,e);return a(t,a.fetch(i,"text").then(_),n)}function _(t){var e=t.indexOf("MIDI.Soundfont.");if(e<0)throw Error("Invalid MIDI.js Soundfont format");e=t.indexOf("=",e)+2;var n=t.lastIndexOf(",");return JSON.parse(t.slice(e,n)+"}")}t.exports&&(t.exports=a),"undefined"!=typeof window&&(window.loadAudio=a)},627:(t,e,n)=>{"use strict";n.r(e),n.d(e,{naturalize_notes:()=>s});var i=n(343),o=n(819),r=n(10);function s(){if(selected[0].classList.contains("note"))if((0,r.get_by_id)(document,(0,r.draw_context_of)(selected[0]).id_prefix+"editcb").checked){var t=selected.concat(extraselected);t.forEach(a),t.forEach(o.dB)}else console.log("No modifications allowed to non-editable layer.");else console.log("Can only naturalize notes.")}function a(t){let e=t.querySelector(".accid");if(!e)return void console.log("No accidental to remove");!function(t){for(var e=t.parentElement;!e.classList.contains("note");)e=e.parentElement;var n,i=(0,r.get_id)(e);(n=(0,r.get_by_id)(mei,i)).removeAttribute("accid"),Array.from(n.children).filter((t=>"accid"==t.tagName)).forEach((t=>n.removeChild(t)))}(e),e.classList.add("hidden");let n=(0,r.get_id)(e);var o=(0,i.kg)();for(const t of o){let e=t.id_prefix+n,i=document.getElementById(e);i&&i.classList.add("hidden")}}document.getElementById("naturalizebutton").addEventListener("click",s)},343:(t,e,n)=>{"use strict";n.d(e,{Jt:()=>V,lk:()=>L,qG:()=>O,i9:()=>B,lC:()=>R,Yu:()=>X,kg:()=>F,ro:()=>$,p8:()=>Y,LO:()=>G,jA:()=>J,tu:()=>K,DR:()=>Q,zD:()=>H,xM:()=>U,Jm:()=>z,Nd:()=>P,Ln:()=>Z});var i=n(865),o=n.n(i),r=n(322),s=n(166),a=n(766),l=(n(520),n(170),n(401),n(792),n(538),n(869));function c(t,e,n){const i=new Blob([t],{type:n}),o=document.createElement("a");o.style.display="none",o.href=URL.createObjectURL(i),o.download=e,document.body.appendChild(o),o.click(),setTimeout((()=>{URL.revokeObjectURL(o.href),o.remove()}),0)}n(519),n(821);var u=n(10);function d(t,e,n){const i=-1==n.findIndex((t=>t.nodeType==Node.ELEMENT_NODE&&("note"==t.tagName||t.getElementsByTagName("note").length>0)));if(("beam"==e.tagName||"measure"==e.tagName)&&i)return null;if("chord"==e.tagName&&i)return(0,u.chord_to_space)(mei,e);var o=e.cloneNode();return t?o.setAttribute("corresp",e.getAttribute("xml:id")):o.setAttribute("copyof",e.getAttribute("xml:id")),n.forEach((t=>o.appendChild(t))),o}function h(t,e){if(e.nodeType!=Node.ELEMENT_NODE)return[e.cloneNode(),!1];var n=document.getElementById((0,u.id_in_svg)(t,(0,u.get_id)(e)));if("note"==e.tagName&&(!n||n.classList.contains("hidden")))return[(0,u.note_to_space)(mei,e),!0];var i=Array.from(e.childNodes).map((e=>h(t,e))),o=i.map((t=>t[0])).filter((t=>null!=t)),r=o.length!=e.childNodes.length||null!=i.find((t=>t[1]));return[d(r,e,o),r]}function p(t=null){t||(t=F()[0]);var e=t.mei_score,[n,i]=h(t,e),o=e.parentElement.getElementsByTagName("score").length+"-";return(0,u.prefix_ids)(n,o),e.parentNode.insertBefore(n,e.nextSibling),n}function f(t,e){if(!t.contains(e))return console.log("Score element not in MEI, aborting"),null;var n,i=(0,u.clone_mei)(t),o=(n=e.hasAttribute("xml:id")?(0,u.get_by_id)(i,e.getAttribute("xml:id")):i.getElementsByTagName("score")[0]).parentElement;for(let t of Array.from(o.getElementsByTagName("score")))t!==n&&o.removeChild(t);return i}var g=n(698),m=n(819);function y(t,e,n){var i=[],o=t.svg_elem,r=t.id_prefix,s=r+n.getAttribute("xml:id"),a=(0,u.relation_type)(n),c=(0,u.relation_primaries)(e,n).map((e=>document.getElementById((0,u.id_in_svg)(t,(0,u.node_to_note_id)(e))))),d=(0,u.relation_secondaries)(e,n).map((e=>document.getElementById((0,u.id_in_svg)(t,(0,u.node_to_note_id)(e))))),h=c.concat(d);if(h.sort(((t,e)=>{if(!t)return-1;if(!e)return 1;var n=(0,u.note_coords)(t),i=(0,u.note_coords)(e);return n[0]-i[0]?n[0]-i[0]:n[1]-i[1]})),!h[0])return console.log("Note missing, relation not drawn"),null;var p=(0,u.roundedHull)(h.map(u.note_coords));return p.setAttribute("id",s),""!=r&&p.setAttribute("oldid",n.getAttribute("xml:id")),p.classList.add("relation"),p.setAttribute("type",a),(0,m.up)(p),l.Z.ui.scoreSettings.brightShades||(0,m.up)(p),p.addEventListener("wheel",(t=>{t.preventDefault(),(0,u.flip_to_bg)(t.target),t.target.onmouseout()}),g.eN),p.onclick=()=>(0,m.dB)(p),p.onmouseover=function(){c.forEach((t=>t.classList.add("extrahover"))),d.forEach((t=>t.classList.add("selecthover")))},p.onmouseout=function(){c.forEach((t=>t.classList.remove("extrahover"))),d.forEach((t=>t.classList.remove("selecthover")))},(0,u.add_to_svg_bg)(o,p),i.push(p),i}function v(t,e,n){var i=[],o=t.svg_elem,r=t.id_prefix+n.getAttribute("xml:id"),s=(0,u.relation_type)(n),a=(0,u.relation_allnodes)(e,n).map((e=>document.getElementById(t.id_prefix+(0,u.get_id)(e)))),c=(0,u.relation_primaries)(e,n).map((e=>document.getElementById((0,u.id_in_svg)(t,(0,u.node_to_note_id)(e))))),d=(0,u.relation_secondaries)(e,n).map((e=>document.getElementById((0,u.id_in_svg)(t,(0,u.node_to_note_id)(e)))));if(-1!=a.indexOf(null))return console.log("Missing relation, not drawing metarelation"),[];var h=a.map(u.get_metarelation_target),p=(0,u.average)(h.map((t=>t[0]))),f=a.concat([o.getElementsByClassName("system")[0]]).map((t=>t.getBBox().y)).sort(((t,e)=>t>e))[0]-500;return h.push([p,f]),(n=(0,u.g)()).style.setProperty("--shade-alternate","#000"),n.setAttribute("id",r),n.classList.add("metarelation"),n.setAttribute("type",s),n.appendChild((0,u.circle)([p,f],200)),h.forEach((t=>{var e=(0,u.line)([p,f],t);n.appendChild(e)})),(0,m.up)(n),l.Z.ui.scoreSettings.brightShades||(0,m.up)(n),n.addEventListener("wheel",(t=>{t.preventDefault(),(0,u.flip_to_bg)(t.target.closest("g")),t.target.onmouseout()}),g.eN),n.onclick=()=>(0,m.dB)(n),n.onmouseover=function(t){c.forEach((t=>{t.classList.contains("relation")?t.classList.add("extrarelationhover"):t.children[0].classList.add("extrarelationhover")})),d.forEach((t=>{t.classList.contains("relation")?t.classList.add("relationhover"):t.children[0].classList.add("relationhover")}))},n.onmouseout=function(t){c.forEach((t=>{t.classList.contains("relation")?t.classList.remove("extrarelationhover"):t.children[0].classList.remove("extrarelationhover")})),d.forEach((t=>{t.classList.contains("relation")?t.classList.remove("relationhover"):t.children[0].classList.remove("relationhover")}))},(0,u.add_to_svg_bg)(o,n),i.push(n),i}var b,x,_,w,S,E=n(138),T=n(922),A=n(554);window.selected=[],window.extraselected=[],n(627),window.mei=null;var k,C,D=new FileReader,N=[],I=[],j=[],M=[];function B(t,e,n=!1){if(console.debug("Using globals: selected, extraselected, mei, undo_actions"),0!=selected.length||0!=extraselected){var i,o;if(selected.concat(extraselected)[0].classList.contains("relation")){var r=[];selected.concat(extraselected).forEach((e=>{r.push([e.getAttribute("type"),t]);var n=(0,u.id_or_oldid)(e),i=[(0,u.get_by_id)(document,n)].concat((0,u.get_by_oldid)(document,n));i.forEach((e=>e.setAttribute("type",t))),(0,u.get_by_id)(mei,n).getElementsByTagName("label")[0].setAttribute("type",t),i.forEach(m.up)})),N.push(["change relation type",r.reverse(),selected,extraselected])}else if(selected.concat(extraselected)[0].classList.contains("note")){(0,u.check_for_duplicate_relations)(t,extraselected,selected);var s=[],a=extraselected.map((t=>(0,u.add_mei_node_for)(x,t))),l=selected.map((t=>(0,u.add_mei_node_for)(x,t)));s.push(a.concat(l)),[i,o]=function(t,e,n,i,o){var r=[],s=t.getRootNode().createElement("node");s.setAttribute("type","relation");var a,l=t.getRootNode().createElement("label");void 0!==i&&l.setAttribute("type",i),s.appendChild(l),a=void 0===o?"he-"+(0,u.random_id)(5):o,s.setAttribute("xml:id",a),t.appendChild(s),r.push(s);for(var c=0;c<e.length;c++)(d=mei.createElement("arc")).setAttribute("from","#"+a),d.setAttribute("to","#"+e[c].getAttribute("xml:id")),d.setAttribute("type","primary"),t.appendChild(d),r.push(d);for(c=0;c<n.length;c++){var d;(d=mei.createElement("arc")).setAttribute("from","#"+a),d.setAttribute("to","#"+n[c].getAttribute("xml:id")),d.setAttribute("type","secondary"),t.appendChild(d),r.push(d)}return[a,r.reverse()]}(x,a,l,t,e),s.push(o);for(var c=0;c<j.length;c++){let t=y(j[c],x,(0,u.get_by_id)(x.getRootNode(),i));t&&(s.push(t),(0,u.mark_secondaries)(j[c],x,(0,u.get_by_id)(x.getRootNode(),i)))}N.push(["relation",s.reverse(),selected,extraselected]),selected.concat(extraselected).forEach(m.dB)}n||(0,T.I$)(),(0,m.e6)()}}function L(t){var e=selected.concat(extraselected);if(!(e.length<3||extraselected.length>2)){e.sort(((t,e)=>{var[n,i]=(0,u.note_coords)(t),[o,r]=(0,u.note_coords)(e);return n-o}));var n=e.shift(),i=e.pop();selected=selected.filter((t=>t==n||t==i)),B(A.yu.main[t].outer),extraselected=[n,i],selected=e,B(A.yu.main[t].total),(0,m.e6)()}}function O(t,e,n=!1){if(console.debug("Using globals:  mei_graph, selected, extraselected"),0!=selected.length||0!=extraselected){var i=(0,u.get_class_from_classlist)(selected.concat(extraselected)[0]);if("relation"==i||"metarelation"==i){var o,r,s=[],a=extraselected.map((t=>(0,u.get_by_id)(x.getRootNode(),(0,u.id_or_oldid)(t)))),l=selected.map((t=>(0,u.get_by_id)(x.getRootNode(),(0,u.id_or_oldid)(t)))),[o,r]=function(t,e,n,i,o){var r=[],s=t.getRootNode().createElement("node");s.setAttribute("type","metarelation");var a,l=t.getRootNode().createElement("label");void 0!==i&&l.setAttribute("type",i),s.appendChild(l),a=void 0===o?"he-"+Math.floor(Math.random()*(1<<20)).toString(16):o,s.setAttribute("xml:id",a),t.appendChild(s),r.push(s);for(var c=0;c<e.length;c++)(u=t.getRootNode().createElement("arc")).setAttribute("from","#"+a),u.setAttribute("to","#"+e[c].getAttribute("xml:id")),u.setAttribute("type","primary"),t.appendChild(u),r.push(u);for(c=0;c<n.length;c++){var u;(u=t.getRootNode().createElement("arc")).setAttribute("from","#"+a),u.setAttribute("to","#"+n[c].getAttribute("xml:id")),u.setAttribute("type","secondary"),t.appendChild(u),r.push(u)}return[a,r.reverse()]}(x,a,l,t,e);s.push(r);for(var c=0;c<j.length;c++)s.push(v(j[c],x,(0,u.get_by_id)(x.getRootNode(),o)));N.push(["metarelation",s,selected,extraselected]),selected.concat(extraselected).forEach(m.dB),(0,m.e6)(),n||(0,T.I$)()}}}function z(){var t=mei.cloneNode(!0);for(var e of j)if(!(0,u.get_by_id)(document,e.id_prefix+"savecb").checked){console.log("Trying to remove layer",e);var n=(0,u.get_by_id)(t,e.mei_score.getAttribute("xml:id"));n.parentElement.removeChild(n),console.log("Found and tried to remove ",n)}c((new XMLSerializer).serializeToString(t),k+".mei","text/xml")}function P(){c((new XMLSerializer).serializeToString(o()("#svg_output")[0]),k+".svg","text/xml")}function H(t){console.debug("Using globals: selected_extraselected, upload, reader, filenmae");const e=t.target.files;selected=[],extraselected=[],1==e.length&&(D.onload=function(t){S=D.result,function(t){console.debug("Using globals data, parser, mei, jquery document, document, mei_graph, midi, changes, undo_cations, redo_actions, reduce_actions, rerendered_after_action");var e=new DOMParser;try{mei=e.parseFromString(S,"text/xml"),mei.getElementsByTagName("parsererror").length>0&&console.log("This is not a valid XML or MEI file. However it could be ABC or Humdrum, for instance")}catch(t){o()("#score-file-picker").val("")}if(b=new verovio.toolkit,"http://www.music-encoding.org/ns/mei"!=mei.documentElement.namespaceURI){try{b.renderData(S,{pageWidth:2e4,pageHeight:1e4,breaks:"none"})}catch(t){if(!new_svg)return console.log("Verovio could not generate SVG from non-MEI file."),o()("#score-file-picker").val(""),!1}S=b.getMEI(),e=new DOMParser;try{mei=e.parseFromString(S,"text/xml")}catch(t){return alert("Cannot parse this XML file as valid MEI."),o()("#score-file-picker").val(""),!1}}else mei=(0,u.fix_synonyms)(mei);try{x=function(){console.debug("Using globals: mei");var t=mei.getElementsByTagName("graph");if(t.length)return t[0];var e=mei.createElement("graph");return e.setAttribute("type","directed"),mei.getElementsByTagName("body")[0].appendChild(e),e}()}catch(t){return alert("Cannot parse this XML file as valid MEI."),o()("#score-file-picker").val(""),!1}j=[],M=[],document.getElementById("layers").innerHTML="",j.hullPadding=200;var n=Array.from(mei.getElementsByTagName("body")[0].getElementsByTagName("score"));for(let t in n){let e=n[t],o=f(mei,e),[l,d]=W(o);if(!d)return console.log("Verovio could not generate SVG from MEI."),!1;var i=(0,u.new_layer_element)(),[r,s]=(0,u.new_view_elements)(i);s.innerHTML=d;var a={mei:o,layer_elem:i,layer_number:0,score_elem:e,id_mapping:(0,u.get_id_pairs)(e),number_of_views:1};M.push(a);var c={mei_score:e,svg_elem:s,view_elem:r,layer:a,layer_number:0,view_number:0,id_prefix:"",zoom:1,reductions:[]};0==t?(_=b.renderToMIDI(),w=_):c.id_prefix=j.length,q(c)}N=[],I=[],C=0,l.Z.ui.scoreSettings.toggleShades(!0),document.onkeypress=function(t){(0,m.Z6)(t)},document.onkeydown=m.qY,document.onkeyup=m.$Z,document.getElementById("layers").onclick=m.oq,document.dispatchEvent(new Event("scoreload")),(0,m.Pw)()}(),(0,m.bf)(),(0,u.indicate_current_context)()},D.readAsText(e[0]),""==(k=e[0].name.split(".").slice(0,-1).join("."))&&(k=e[0].name))}function R(t){console.debug("Using globals: mei_graph, mei, selected, extraselected, document");var e=Array.from(x.getElementsByTagName("node")),n=e.filter((t=>"relation"==t.getAttribute("type"))),i=e.filter((t=>"metarelation"==t.getAttribute("type")));n.forEach((e=>{y(t,x,e)&&(0,u.mark_secondaries)(t,x,e)})),i.forEach((e=>v(t,x,e)))}function U(t=!1,e=j[0]){e.svg_elem;var n=f(mei,e.layer.score_elem);return Array.from(n.getElementsByTagName("note")).forEach((i=>{let o=document.getElementById((0,u.id_in_svg)(e,(0,u.get_id)(i)));if(!o||o.classList.contains("hidden")){var r=i.parentNode;if(t&&!["chord","bTrem","fTrem"].includes(r.tagName)){var s=(0,u.note_to_rest)(n,i);r.insertBefore(s,i)}r.removeChild(i)}})),Array.from(n.getElementsByTagName("chord")).forEach((t=>{t.parentNode,0==t.getElementsByTagName("note").length&&t.parentNode.removeChild(t)})),n}function V(t,e=!1,n=!1){var i;i=e?function(t,e=!1){var n=t.mei_score,i=function(t,e,n=!1){var i=Q(),o=U(!0,t),r=(new XMLSerializer).serializeToString(o);i.loadData(r),i.renderToMIDI();var s=Array.from(o.getElementsByTagName("note")).map((t=>t.getAttribute("xml:id"))),a={};if(s.forEach((t=>{if(!t)return;let e=i.getTimeForElement(t);a[e]?a[e].push(t):a[e]=[t]})),n){let t=Object.keys(a);a={},t.forEach((t=>a[t]=i.getElementsAtTime(Number(t)+1).notes))}var l=e.getElementsByTagName("scoreDef")[0].cloneNode(!0),c=l.getElementsByTagName("staffDef"),d=mei.createElement("score");d.setAttribute("xml:id",e.getAttribute("xml:id")+"-sliced");var h=mei.createElement("section");h.setAttribute("xml:id",e.getAttribute("xml:id")+"-slicedsection"),d.appendChild(l),d.appendChild(h);var p=Object.keys(a);for(var f in console.log(a),p){let t=p[f],e=a[t],n=mei.createElement("measure");for(var g of(n.setAttribute("xml:id","measure-"+t),h.appendChild(n),c)){let t=mei.createElement("staff");t.setAttribute("n",g.getAttribute("n")),n.appendChild(t)}for(var m of(e.forEach((e=>{let i=(0,u.get_by_id)(mei,e),o=i.cloneNode(!0);o.setAttribute("corresp",e);let r=i.closest("staff").getAttribute("n"),s=i.closest("layer").getAttribute("n"),l=i.closest("chord"),c=n.querySelector('staff[n="'+r+'"]');c||(console.log("Could not find staff"),abort());let d=c.querySelector('layer[n="'+s+'"]');if(d||(d=mei.createElement("layer"),d.setAttribute("n",s),c.appendChild(d)),o.removeAttribute("dots"),o.removeAttribute("dots.ges"),l){let t=l.getAttribute("xml:id"),e=d.querySelector('chord[corresp="'+t+'"]');e||(e=mei.createElement("chord"),e.setAttribute("corresp",t),e.setAttribute("dur",4),e.setAttribute("dur.ges",4),e.setAttribute("dur.ppq",2),d.appendChild(e)),e.appendChild(o)}else o.setAttribute("dur",4),o.setAttribute("dur.ges",4),o.setAttribute("dur.ppq",2),d.appendChild(o);if(f>0&&a[p[f-1]].includes(e)){o.setAttribute("xml:id",t+e);let i=mei.createElement("tie");i.setAttribute("xml:id","tie"+t+e),i.setAttribute("endid",t+e),f>1&&a[p[f-2]].includes(e)?i.setAttribute("startid",p[f-1]+e):i.setAttribute("startid",e),n.appendChild(i)}})),n.querySelectorAll("staff")))if(!m.querySelector("note")){let t=m.querySelector("layer");t||(t=mei.createElement("layer"),m.appendChild(t));let e=mei.createElement("rest");e.setAttribute("dur",4),e.setAttribute("dur.ges",4),e.setAttribute("dur.ppq",2),t.appendChild(e)}}return d}(t,n,e),o=n.parentElement.getElementsByTagName("score").length+"-";return(0,u.prefix_ids)(i,o),n.parentNode.insertBefore(i,n.nextSibling),i}(t,n):p(t);let o=f(mei,i);var[r,s]=W(o);if(!s)return console.log("Verovio could not generate SVG from MEI."),!1;var a=(0,u.new_layer_element)(),[l,c]=(0,u.new_view_elements)(a);c.innerHTML=s;var d={mei:o,layer_elem:a,layer_number:M.length,score_elem:i,id_mapping:(0,u.get_id_pairs)(i),number_of_views:1};M.push(d);var h={mei_score:i,svg_elem:c,view_elem:l,layer:d,layer_number:d.layer_number,view_number:0,id_prefix:"",zoom:1,reductions:[]};h.id_prefix=j.length,q(h)}function q(t){t.measure_map=(0,E.Vk)(t),j.reverse(),j.push(t),j.reverse(),(0,m.N7)(t);for(let e of t.svg_elem.getElementsByClassName("note"))e.onclick=()=>(0,m.dB)(e);for(let e of t.svg_elem.getElementsByClassName("staff")){let[t,n]=(0,E.e6)(e);e.y_to_p=t,e.p_to_y=n}R(t),(0,m.rp)()}function W(t){var e=(new XMLSerializer).serializeToString((0,u.sanitize_xml)(t));return[e,b.renderData(e,{pageWidth:2e4,pageHeight:1e4,breaks:"none"})]}window.addEventListener("beforeunload",(function(t){var e="Leave app? You may lose unsaved changes.";return t.preventDefault(),t.returnValue=e,e})),o()(document).ready((function(){document.getElementsByTagName("html")[0].classList.remove("loader"),(0,m.K5)(document.getElementById("relations_panel")),(0,m.rp)(),[["add_bookmark","addbookmarkbutton"],["jump_to_next_bookmark","previousbookmarkbutton"],["jump_to_previous_bookmark","nextbookmarkbutton"],["jump_to_context_below","previouscontextbutton"],["jump_to_context_above","nextcontextbutton"]].forEach((t=>document.getElementById(t[1]).setAttribute("title",a.custom_conf[t[0]]||s.navigation_conf[t[0]]||r.action_conf[t[0]])))})),window.onerror=function(t,e,n){return document.getElementsByTagName("html")[0].classList.remove("loader"),alert(`An error occured: ${t}\n Please report the relevant console log as a GitHub issue.\n The app will try to continue running nonetheless.`),!1},console.log("Main webapp library is loaded");const F=()=>j,$=()=>x,Y=()=>w,Q=()=>b,X=()=>S,K=()=>N,G=()=>I,Z=t=>I=t,J=()=>C},748:(t,e,n)=>{"use strict";n.r(e),n.d(e,{type_keys:()=>i,type_shades:()=>o,meta_keys:()=>r,meta_shades:()=>s,combo_keys:()=>a,button_shades:()=>l,action_conf:()=>c,navigation_conf:()=>u,custom_conf:()=>d,meta_conf:()=>h,type_conf:()=>p,combo_conf:()=>f,type_synonym:()=>g,type_full_conf:()=>m,meta_full_conf:()=>y,hide_classes:()=>v,strip_mei_tags:()=>b,strip_xml_tags:()=>x,CONFIG_OK:()=>_});const i={},o={},r={},s={},a={},l={},c={undo:"U",redo:"I",deselect_all:"d",delete_all:"D",add_bookmark:"^",move_relation_to_front:"z",reduce_relations:"r",select_same_notes:"+",naturalize_note:"Z",copy:"C",paste:"V"},u={pan_left:"[",pan_right:"]",jump_to_next_bookmark:"{",jump_to_previous_bookmark:"}",jump_to_context_below:",",jump_to_context_above:".",toggle_palette:"-",switch_context_on_hover:!1},d={relation:"R",meta_relation:"M"},h={context:{key:"c",colour:0},layer:{key:"l",colour:6},phrase:{key:"r",colour:2},section:{key:"t",colour:3}},p={repeat:{key:"e",colour:0},passing:{key:"p",colour:6},neighbour:{key:"n",colour:2},harmonic:{key:"i",colour:3},arpeggio:{key:"a",colour:4},urlinie:{key:"u",colour:5},bassbrechung:{key:"b",colour:5}},f={passing_comb:{key:"P",total:"passing",outer:"arpeggio"},neighbour_comb:{key:"N",total:"neighbour",outer:"repeat"}},g={prolongation:"passing",arp:"arpeggio",bassbrech:"bassbrechung"},m=["neighbour","repetition","arpeggiation","passing","back_relating_dominant","displacement","register_transfer","56_shift","added_root","initial_ascent","arpeggiated_ascent","urlinie","urlinie_transference","bassbrechung_component","coupling","voice_exchange_component","voice_exchange_component_chromaticized","mixture","phrygian_ii"],y=["auxiliary_cadence","superposition","reaching_over","urlinie_meta","ursatz","bassbrechung","bassbrechung_transference","ursatz_transference","unfolding","motion_into_the_inner_voice","motion_from_the_inner_voice","linear_intervallic_progression","linear_intervallic_progression_module","interruption","interruption_branch_1","interruption_branch_2","voice_exchange","motivic_parallelism","motive","contradiction","indeterminacy","parallel_fifths","parallel_octaves"],v=["barLineAttr","fermata","rest","stem","flag","tie","artic","slur","dynam","tempo","tupletNum","dir","verse"],b=["label","labelAbbr","tempo"],x=[],_=!0},138:(t,e,n)=>{"use strict";n.d(e,{Vk:()=>l,e6:()=>u,f5:()=>f,r4:()=>g,xy:()=>m,Kd:()=>y,M_:()=>v,TU:()=>b});var i=n(343),o=n(819),r=n(922),s=n(10),a="cdefgab";function l(t){let e=t.svg_elem;var n=Array.from(e.getElementsByClassName("measure")),i=(n.length&&Array.from(n[0].getElementsByClassName("staff")),Array.from(e.getElementsByClassName("note")),n.map((t=>[t.getBBox().x+t.getBBox().width,t])));return i.sort(((t,e)=>t[0]-e[0])),i}function c(t){let e=t.children[2].getBBox();return e.y+e.height/2}function u(t){const e=c(t),n=-Math.abs(function(t){let e=t.children[2].getBBox(),n=t.children[1].getBBox();return Math.abs(e.y-n.y)}(t)),i=n/2,o=t.getElementsByClassName("note");var r,l;if(o.length>0)r=o[0];else{const n=t.closest(".system"),i=Array.from(n.getElementsByClassName("staff")).find((t=>c(t)==e&&t.getElementsByClassName("note").length>0));i&&(r=i.getElementsByClassName("note")[0])}if(console.log(r),r)l=function(t){var e=(0,s.get_by_id)(mei,(0,s.get_id)(t)),n=e.getAttribute("pname");return 7*e.getAttribute("oct")+a.indexOf(n)}(r)-Math.floor(((0,s.note_coords)(r)[1]-e)/i);else{const n=t.closest(".system"),o=Array.from(n.getElementsByClassName("staff")).find((t=>c(t)==e&&t.getElementsByClassName("clef").length>0)).getElementsByClassName("clef")[0],r=o.children[0].getAttribute("y");let s;switch(o.children[0].getAttribute("xlink:href")){case"E062":s=24;break;case"E052":s=25;break;case"E050":s=32}l=s-Math.floor((r-e)/i)}return[t=>{var n=Math.floor((t+i/2-e)/i)+l,o=Math.floor(n/7);return[a[(0,s.mod)(n,7)],o]},(t,n)=>{var o=7*n+a.indexOf(t);return e+(o-l)*i}]}function d(){var t=(0,o.c)();const e=function(){var t=(0,o.c)(),e=t.svg_elem.children[0],n=t.svg_elem.getElementsByClassName("system")[0],i=e.createSVGPoint();return i.x=(0,o.jM)(),i.y=(0,o.hT)(),i.matrixTransform(n.parentElement.getScreenCTM().inverse())}(),n=function(t,e){let n=t.measure_map.find((t=>t[0]>e.x));return n?n[1]:void 0}(t,e);if(!n)return console.log("Pointer outside measures"),[null,null,null];const i=function(t,e,n){var i=Array.from(n.getElementsByClassName("staff")).map((t=>[c(t),t]));i.sort(((t,e)=>t[0]-e[0]));var o=i.findIndex((t=>e.y<t[0]));if(0==o)return i[0][1];if(-1==o)return i[i.length-1][1];const r=(0,s.average2)(i[o-1][0],i[o][0]);return e.y<r?i[o-1][1]:i[o][1]}(0,e,n),[r,a]=function(t,e,n){return n.getElementsByClassName("note")[0],n.y_to_p(e.y)}(0,e,i),l=function(t,e,n){var i=Array.from(n.getElementsByClassName("note")).map((t=>[(0,s.note_coords)(t)[0],t]));if(0==i.length)return null;i.sort(((t,e)=>t[0]-e[0]));var o=i.findIndex((t=>e.x<t[0]));if(0==o)return i[0][1];if(-1==o)return i[i.length-1][1];const r=(0,s.average2)(i[o-1][0],i[o][0]);return e.x<r?i[o-1][1]:i[o][1]}(0,e,i);return l?[r,a,l]:[null,null,null]}function h(t,e,n){var i=n.closest(".staff");return i.getElementsByClassName("note")[0],[(0,s.note_coords)(n)[0],i.p_to_y(t,e)]}function p(t,e,n,i=!0,r=""){(0,o.c)();var a=document.getElementById(r);if(a&&a.parentElement.removeChild(a),i){let[i,o]=h(t,e,n),[a,c]=(0,s.note_coords)(n);var l=document.createElementNS("http://www.w3.org/2000/svg","use");l.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+n.id),l.setAttribute("x",i-a),l.setAttribute("y",o-c),l.id=r,n.parentElement.appendChild(l)}}function f(t,e,n,a,l,c=!1){var u="new-"+(0,s.random_id)();let d=n;void 0!==l&&(u=l);var p=[];console.log(n),p.push(function(t,e,n,i=!0,r=""){(0,o.c)();var s=document.getElementById(r),a=[];if(s&&s.parentElement.removeChild(s),i){let[i,s]=h(t,e,n);var l=document.createElementNS("http://www.w3.org/2000/svg","g"),c=document.createElementNS("http://www.w3.org/2000/svg","g"),u=document.createElementNS("http://www.w3.org/2000/svg","use");u.setAttributeNS("http://www.w3.org/1999/xlink","href",n.getElementsByTagName("use")[0].getAttributeNS("http://www.w3.org/1999/xlink","href")),u.setAttribute("x",i-100),u.setAttribute("y",s),u.setAttribute("height","720px"),u.setAttribute("width","720px"),l.id=r,l.classList.add("note"),c.classList.add("notehead"),c.appendChild(u),l.appendChild(c),n.parentElement.appendChild(l),l.onclick=()=>(0,o.dB)(l),a.push(l)}return a.reverse()}(t,e,n,a,u));var f=(0,o.c)();p.push(function(t,e,n,i,o=!0,r=""){var a=(0,s.get_by_id)(mei,(0,s.get_id)(i));if(!t.score_elem.contains(a))return console.log("Note not in layer?"),!1;var l=mei.createElement("note"),c=[];if(l.setAttribute("xml:id",r),!o)return console.log("Not implemented"),!1;{let i;a.closest("chord")?i=a.closest("chord"):(i=(0,s.note_to_chord)(mei,a),a.parentElement.insertBefore(i,a),a.parentElement.removeChild(a),i.appendChild(a),c.push(i)),l.setAttribute("pname",e),l.setAttribute("oct",n),i.appendChild(l),c.push(l),t.id_mapping.push([r,r])}return c.reverse()}(f.layer,t,e,n,a,u)),v(),c||(0,r.I$)(),(0,i.tu)().push(["add note",p.reverse(),[d],[]])}function g(){var t=(0,o.c)();if(""!=(0,o.h4)()&&(0,s.get_by_id)(document,t.id_prefix+"editcb").checked){let[t,e,n]=d();if(!t)return;f(t,e,n,!0)}}function m(){var t=(0,o.c)(),e=(0,o.h4)();if(void 0!==t){if(!(0,s.get_by_id)(document,t.id_prefix+"editcb").checked)return;let[n,i,r]=d();e="temp"+(0,s.random_id)(),(0,o.vI)(e),document.getElementById("layers").style.cursor="crosshair",n&&p(n,i,r,!0,e)}}function y(){var t=(0,o.h4)();let e=document.getElementById(t);e&&e.parentElement.removeChild(e),t="",(0,o.vI)(t),document.getElementById("layers").style.cursor="default"}function v(){var t=(0,o.c)(),e=(0,o.h4)();if((0,s.get_by_id)(document,t.id_prefix+"editcb").checked)return e?(y(),!1):(m(),!0)}function b(){var t=(0,o.c)();if(!(0,s.get_by_id)(document,t.id_prefix+"editcb").checked)return;let[e,n,i]=d();e&&p(e,n,i,!0,(0,o.h4)())}},854:(t,e,n)=>{"use strict";n.d(e,{x:()=>l});var i=n(343),o=n(819),r=n(922),s=n(10);function a(t){console.debug("Using globals: mei for element selection");var e=(0,s.get_id)(t),n=(0,s.get_by_id)(mei,e),r=[],a="metarelation"==(0,s.get_class_from_classlist)(t),l=(0,i.ro)(),c=(0,i.kg)();for(const t of c){let i=(0,s.get_by_id)(document,t.id_prefix+e);i&&(r.push(i),a||(0,s.unmark_secondaries)(t,l,n))}var u=Array.from(mei.getElementsByTagName("arc")).filter((e=>e.getAttribute("to")=="#"+t.id||e.getAttribute("from")=="#"+t.id)).concat(r);u.push(n);var d=u.map((t=>{var e=[t,t.parentElement,t.nextSibling];try{$(`g #${t.getAttribute("to").substring(4)}`).removeClass().addClass("note")}catch(t){}return t.parentElement.removeChild(t),e}));return(0,o.e6)(),d}function l(t=!1){console.debug("Using globals: selected for element selection, undo_actions for storing the action");var e=selected.concat(extraselected);if(0==e.length||"relation"!=(0,s.get_class_from_classlist)(e[0])&&"metarelation"!=(0,s.get_class_from_classlist)(e[0]))console.log("No (meta)relation selected!");else{var n=e.flatMap(a);(0,i.tu)().push(["delete relation",n.reverse(),selected,extraselected]),e.forEach(o.dB),t||(0,r.I$)()}}},869:(t,e,n)=>{"use strict";n.d(e,{Z:()=>Ut});var i=n(115),o=n(689);const r=Object.freeze({shift:16,control:17,escape:27,left:37,right:39,a:65,h:72,s:83,x:88,z:90}),s=({keyCode:t},e)=>t===r[e];function a(t,e=null){const n=l(t);return e?(i=n,o=[e].flat(),null!==(r=null==o?void 0:o.every((t=>null==i?void 0:i.includes(t))))&&void 0!==r&&r):!!n.length;var i,o,r}function l({metaKey:t,shiftKey:e,ctrlKey:n,altKey:i}){const o={meta:t,shift:e,ctrl:n,alt:i};return Object.keys(o).filter((t=>o[t]))}const c=/Macintosh/.test(navigator.userAgent)?"meta":"ctrl";var u=n(698);let d=null;const h={x:0,y:0},p=new class{tick({x:t,y:e},n){d||window.requestAnimationFrame((n=>{this.update(t,e);const i=d;d=null,i(h)})),d=n}update(t,e){h.x=t,h.y=e}};let f=null;class g{constructor(t){this.app=t,this.init()}init(){window.addEventListener("resize",this.onResize.bind(this)),document.addEventListener("click",this.onTap.bind(this),u.eN),document.addEventListener("mousedown",this.onTapStart.bind(this),u.eN),document.addEventListener("mousemove",this.onMouseMove.bind(this),u.eN),document.addEventListener("mouseup",this.onTapEnd.bind(this),u.eN),document.addEventListener("touchstart",this.onTapStart.bind(this),u.eN),document.addEventListener("touchmove",this.onTouchMove.bind(this),u.eN),document.addEventListener("touchend",this.onTapEnd.bind(this),u.eN),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),document.addEventListener("change",this.onChange.bind(this),u.eN),document.addEventListener("input",this.onInput.bind(this),u.eN),document.addEventListener("submit",this.onSubmit.bind(this),u.eN),document.addEventListener("undoredo",this.onUndoRedo.bind(this)),document.addEventListener("scoreload",this.onScoreLoad.bind(this)),document.addEventListener("scoreselection",this.onScoreSelection.bind(this))}onResize(){!function(t,e=100){clearTimeout(f),i.JU.classList.add("resizing"),f=setTimeout((()=>{i.JU.classList.remove("resizing"),t()}),e)}((()=>{var t,e;null===(t=this.app.viewport)||void 0===t||t.onResize(),null===(e=this.app.ui)||void 0===e||e.onResize()}))}onTap(t){var e,n,i;null===(e=this.app.player)||void 0===e||e.onTap(t),null===(n=this.app.ui)||void 0===n||n.onTap(t),null===(i=this.app.history)||void 0===i||i.onTap(t)}onTapStart(t){var e;null===(e=this.app.ui)||void 0===e||e.onTapStart(t)}onTapEnd(){var t;null===(t=this.app.ui)||void 0===t||t.onTapEnd()}onMouseMove(t){p.tick(t,(({x:t,y:e})=>{var n;null===(n=this.app.ui)||void 0===n||n.onTapMove(t,e)}))}onTouchMove(t){const e={x:Math.round(t.touches[0].clientX),y:Math.round(t.touches[0].clientY)};p.tick(e,(({x:t,y:e})=>{var n;null===(n=this.app.ui)||void 0===n||n.onTapMove(t,e)}))}onChange(t){var e,n,i,o,r,s,a,l,c,u;null===(e=this.app.player)||void 0===e||e.onChange(t),null===(n=this.app.ui)||void 0===n||null===(i=n.filters)||void 0===i||i.onChange(t),null===(o=this.app.ui)||void 0===o||null===(r=o.mainMenu)||void 0===r||r.onChange(t),null===(s=this.app.ui)||void 0===s||null===(a=s.startScreen)||void 0===a||a.onChange(t),null===(l=this.app.ui)||void 0===l||null===(c=l.selection)||void 0===c||null===(u=c.mode)||void 0===u||u.onChange(t)}onInput(t){var e,n;null===(e=this.app.ui)||void 0===e||null===(n=e.relationWidth)||void 0===n||n.onInput(t)}onSubmit(t){var e,n;null===(e=this.app.ui)||void 0===e||null===(n=e.relations)||void 0===n||n.onSubmit(t)}onUndoRedo(t){var e;null===(e=this.app.history)||void 0===e||e.onUndoRedo(t)}onScoreLoad(t){var e,n,i;null===(e=this.app.score)||void 0===e||e.onScoreLoad(t),null===(n=this.app.ui)||void 0===n||n.onScoreLoad(t),null===(i=this.app.player)||void 0===i||i.reset(),this.app.ui.startScreen&&(this.app.ui.startScreen.destroy(),delete this.app.ui.startScreen)}onScoreSelection(t){var e,n;null===(e=this.app.score)||void 0===e||e.onScoreSelection(t),null===(n=this.app.ui)||void 0===n||n.onScoreSelection(t)}onKeyDown(t){if(!(0,o.t)()){if(s(t,"z")){if(a(t,[c,"shift"]))return this.app.history.redo();if(a(t,c))return this.app.history.undo()}if(s(t,"a")&&a(t,c))return this.app.ui.selection.selectAll();if(s(t,"control")&&1===l(t).length)return this.app.ui.newNote.enable();if(s(t,"shift")&&1===l(t).length)return this.app.ui.selection.mode.set("primary");if(!a(t))return s(t,"h")?this.app.ui.scoreSettings.toggleShades():s(t,"s")?this.app.ui.scoreSettings.toggleStems():s(t,"x")?this.app.ui.newNote.toggle():void 0}}onKeyUp(t){return s(t,"control")?this.app.ui.newNote.disable():s(t,"shift")?this.app.ui.selection.mode.set("secondary"):void(a(t)||s(t,"escape")&&(0,o.t)()&&document.activeElement.blur())}}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function b(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t}for(var x={VERSION:"2.0.16",NOTES:[],HEADER_CHUNK_LENGTH:14,CIRCLE_OF_FOURTHS:["C","F","Bb","Eb","Ab","Db","Gb","Cb","Fb","Bbb","Ebb","Abb"],CIRCLE_OF_FIFTHS:["C","G","D","A","E","B","F#","C#","G#","D#","A#","E#"]},_=[["C"],["C#","Db"],["D"],["D#","Eb"],["E"],["F"],["F#","Gb"],["G"],["G#","Ab"],["A"],["A#","Bb"],["B"]],w=0,S=function(t){_.forEach((function(e){e.forEach((function(e){return x.NOTES[w]=e+t})),w++}))},E=-1;E<=9;E++)S(E);var T=function(){function t(){y(this,t)}return b(t,null,[{key:"byteToHex",value:function(t){return("0"+t.toString(16)).slice(-2)}},{key:"bytesToHex",value:function(e){var n=[];return e.forEach((function(e){return n.push(t.byteToHex(e))})),n.join("")}},{key:"hexToNumber",value:function(t){return parseInt(t,16)}},{key:"bytesToNumber",value:function(e){return t.hexToNumber(t.bytesToHex(e))}},{key:"bytesToLetters",value:function(t){var e=[];return t.forEach((function(t){return e.push(String.fromCharCode(t))})),e.join("")}},{key:"decToBinary",value:function(t){return(t>>>0).toString(2)}},{key:"getVarIntLength",value:function(t){for(var e=t[0],n=1;e>=128;)e=t[n],n++;return n}},{key:"readVarInt",value:function(t){var e=0;return t.forEach((function(t){128&t?(e+=127&t,e<<=7):e+=t})),e}},{key:"atob",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return"function"==typeof atob?atob(t):Buffer.from(t,"base64").toString("binary")}))}]),t}(),A=function(){function t(e,n){y(this,t),this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.index=e,this.data=n,this.delta=0,this.runningDelta=0,this.events=[];var i=this.data.subarray(this.data.length-3,this.data.length);if(255!==i[0]||47!==i[1]||0!==i[2])throw"Invalid MIDI file; Last three bytes of track "+this.index+"must be FF 2F 00 to mark end of track"}return b(t,[{key:"reset",value:function(){return this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.delta=0,this.runningDelta=0,this}},{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"setEventIndexByTick",value:function(t){for(var e in t=t||0,this.events)if(this.events[e].tick>=t)return this.eventIndex=e,this}},{key:"getCurrentByte",value:function(){return this.data[this.pointer]}},{key:"getDeltaByteCount",value:function(){return T.getVarIntLength(this.data.subarray(this.pointer))}},{key:"getDelta",value:function(){return T.readVarInt(this.data.subarray(this.pointer,this.pointer+this.getDeltaByteCount()))}},{key:"handleEvent",value:function(t,e){if(e=e||!1){var n=t-this.lastTick>=this.getDelta();if(this.pointer<this.data.length&&(e||n)){var i=this.parseEvent();if(this.enabled)return i}}else if(this.events[this.eventIndex]&&this.events[this.eventIndex].tick<=t&&(this.eventIndex++,this.enabled))return this.events[this.eventIndex-1];return null}},{key:"getStringData",value:function(t){var e=T.getVarIntLength(this.data.subarray(t+2)),n=T.readVarInt(this.data.subarray(t+2,t+2+e));return T.bytesToLetters(this.data.subarray(t+2+e,t+2+e+n))}},{key:"parseEvent",value:function(){var t=this.pointer+this.getDeltaByteCount(),e={},n=this.getDeltaByteCount();if(e.track=this.index+1,e.delta=this.getDelta(),this.lastTick=this.lastTick+e.delta,this.runningDelta+=e.delta,e.tick=this.runningDelta,e.byteIndex=this.pointer,255==this.data[t]){switch(this.data[t+1]){case 0:e.name="Sequence Number";break;case 1:e.name="Text Event",e.string=this.getStringData(t);break;case 2:e.name="Copyright Notice";break;case 3:e.name="Sequence/Track Name",e.string=this.getStringData(t);break;case 4:e.name="Instrument Name",e.string=this.getStringData(t);break;case 5:e.name="Lyric",e.string=this.getStringData(t);break;case 6:e.name="Marker";break;case 7:e.name="Cue Point",e.string=this.getStringData(t);break;case 9:e.name="Device Name",e.string=this.getStringData(t);break;case 32:e.name="MIDI Channel Prefix";break;case 33:e.name="MIDI Port",e.data=T.bytesToNumber([this.data[t+3]]);break;case 47:e.name="End of Track";break;case 81:e.name="Set Tempo",e.data=Math.round(6e7/T.bytesToNumber(this.data.subarray(t+3,t+6))),this.tempo=e.data;break;case 84:e.name="SMTPE Offset";break;case 88:e.name="Time Signature",e.data=this.data.subarray(t+3,t+7),e.timeSignature=e.data[0]+"/"+Math.pow(2,e.data[1]);break;case 89:e.name="Key Signature",e.data=this.data.subarray(t+3,t+5),e.data[0]>=0?e.keySignature=x.CIRCLE_OF_FIFTHS[e.data[0]]:e.data[0]<0&&(e.keySignature=x.CIRCLE_OF_FOURTHS[Math.abs(e.data[0])]),0==e.data[1]?e.keySignature+=" Major":1==e.data[1]&&(e.keySignature+=" Minor");break;case 127:e.name="Sequencer-Specific Meta-event";break;default:e.name="Unknown: "+this.data[t+1].toString(16)}var i=T.getVarIntLength(this.data.subarray(t+2)),o=T.readVarInt(this.data.subarray(t+2,t+2+i));this.pointer+=n+3+o}else if(240===this.data[t]){e.name="Sysex";var r=T.getVarIntLength(this.data.subarray(t+1)),s=T.readVarInt(this.data.subarray(t+1,t+1+r));e.data=this.data.subarray(t+1+r,t+1+r+s),this.pointer+=n+1+r+s}else if(247===this.data[t]){e.name="Sysex (escape)";var a=T.getVarIntLength(this.data.subarray(t+1)),l=T.readVarInt(this.data.subarray(t+1,t+1+a));e.data=this.data.subarray(t+1+a,t+1+a+l),this.pointer+=n+1+a+l}else if(this.data[t]<128)if(e.running=!0,e.noteNumber=this.data[t],e.noteName=x.NOTES[this.data[t]],e.velocity=this.data[t+1],this.lastStatus<=143)e.name="Note off",e.channel=this.lastStatus-128+1,this.pointer+=n+2;else if(this.lastStatus<=159)e.name="Note on",e.channel=this.lastStatus-144+1,this.pointer+=n+2;else if(this.lastStatus<=175)e.name="Polyphonic Key Pressure",e.channel=this.lastStatus-160+1,e.note=x.NOTES[this.data[t+1]],e.pressure=event[1],this.pointer+=n+2;else if(this.lastStatus<=191)e.name="Controller Change",e.channel=this.lastStatus-176+1,e.number=this.data[t+1],e.value=this.data[t+2],this.pointer+=n+2;else if(this.lastStatus<=207)e.name="Program Change",e.channel=this.lastStatus-192+1,e.value=this.data[t+1],this.pointer+=n+1;else if(this.lastStatus<=223)e.name="Channel Key Pressure",e.channel=this.lastStatus-208+1,this.pointer+=n+1;else{if(!(this.lastStatus<=239))throw"Unknown event (running): ".concat(this.lastStatus);e.name="Pitch Bend",e.channel=this.lastStatus-224+1,e.value=this.data[t+2],this.pointer+=n+2}else if(this.lastStatus=this.data[t],this.data[t]<=143)e.name="Note off",e.channel=this.lastStatus-128+1,e.noteNumber=this.data[t+1],e.noteName=x.NOTES[this.data[t+1]],e.velocity=Math.round(this.data[t+2]/127*100),this.pointer+=n+3;else if(this.data[t]<=159)e.name="Note on",e.channel=this.lastStatus-144+1,e.noteNumber=this.data[t+1],e.noteName=x.NOTES[this.data[t+1]],e.velocity=Math.round(this.data[t+2]/127*100),this.pointer+=n+3;else if(this.data[t]<=175)e.name="Polyphonic Key Pressure",e.channel=this.lastStatus-160+1,e.note=x.NOTES[this.data[t+1]],e.pressure=event[2],this.pointer+=n+3;else if(this.data[t]<=191)e.name="Controller Change",e.channel=this.lastStatus-176+1,e.number=this.data[t+1],e.value=this.data[t+2],this.pointer+=n+3;else if(this.data[t]<=207)e.name="Program Change",e.channel=this.lastStatus-192+1,e.value=this.data[t+1],this.pointer+=n+2;else if(this.data[t]<=223)e.name="Channel Key Pressure",e.channel=this.lastStatus-208+1,this.pointer+=n+2;else{if(!(this.data[t]<=239))throw"Unknown event: ".concat(this.data[t]);e.name="Pitch Bend",e.channel=this.lastStatus-224+1,this.pointer+=n+3}return this.delta+=e.delta,this.events.push(e),e}},{key:"endOfTrack",value:function(){return 255==this.data[this.pointer+1]&&47==this.data[this.pointer+2]&&0==this.data[this.pointer+3]}}]),t}();Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach});var k=function(){function t(e,n){y(this,t),this.sampleRate=5,this.startTime=0,this.buffer=n||null,this.midiChunksByteLength=null,this.division,this.format,this.setIntervalId=!1,this.tracks=[],this.instruments=[],this.defaultTempo=120,this.tempo=null,this.startTick=0,this.tick=0,this.lastTick=null,this.inLoop=!1,this.totalTicks=0,this.events=[],this.totalEvents=0,this.eventListeners={},"function"==typeof e&&this.on("midiEvent",e)}return b(t,[{key:"loadFile",value:function(t){throw"loadFile is only supported on Node.js"}},{key:"loadArrayBuffer",value:function(t){return this.buffer=new Uint8Array(t),this.fileLoaded()}},{key:"loadDataUri",value:function(t){for(var e=T.atob(t.split(",")[1]),n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return this.buffer=n,this.fileLoaded()}},{key:"getFilesize",value:function(){return this.buffer?this.buffer.length:0}},{key:"fileLoaded",value:function(){if(!this.validate())throw"Invalid MIDI file; should start with MThd";return this.setTempo(this.defaultTempo).getDivision().getFormat().getTracks().dryRun()}},{key:"validate",value:function(){return"MThd"===T.bytesToLetters(this.buffer.subarray(0,4))}},{key:"getFormat",value:function(){return this.format=T.bytesToNumber(this.buffer.subarray(8,10)),this}},{key:"getTracks",value:function(){this.tracks=[];for(var t=0;t<this.buffer.length;){if("MTrk"==T.bytesToLetters(this.buffer.subarray(t,t+4))){var e=T.bytesToNumber(this.buffer.subarray(t+4,t+8));this.tracks.push(new A(this.tracks.length,this.buffer.subarray(t+8,t+8+e)))}t+=T.bytesToNumber(this.buffer.subarray(t+4,t+8))+8}var n=0;return this.tracks.forEach((function(t){n+=8+t.data.length})),this.midiChunksByteLength=x.HEADER_CHUNK_LENGTH+n,this}},{key:"enableTrack",value:function(t){return this.tracks[t-1].enable(),this}},{key:"disableTrack",value:function(t){return this.tracks[t-1].disable(),this}},{key:"getDivision",value:function(){return this.division=T.bytesToNumber(this.buffer.subarray(12,x.HEADER_CHUNK_LENGTH)),this}},{key:"playLoop",value:function(t){this.inLoop||(this.inLoop=!0,this.tick=this.getCurrentTick(),this.tracks.forEach((function(e,n){if(!t&&this.endOfFile())this.triggerPlayerEvent("endOfFile"),this.stop();else{var i=e.handleEvent(this.tick,t);t&&i?(i.hasOwnProperty("name")&&"Set Tempo"===i.name&&(this.defaultTempo=i.data,this.setTempo(i.data)),i.hasOwnProperty("name")&&"Program Change"===i.name&&(this.instruments.includes(i.value)||this.instruments.push(i.value))):i&&(i.hasOwnProperty("name")&&"Set Tempo"===i.name&&(this.setTempo(i.data),this.isPlaying()&&this.pause().play()),this.emitEvent(i))}}),this),t||this.triggerPlayerEvent("playing",{tick:this.tick}),this.inLoop=!1)}},{key:"setTempo",value:function(t){return this.tempo=t,this}},{key:"setStartTime",value:function(t){return this.startTime=t,this}},{key:"play",value:function(){if(this.isPlaying())throw"Already playing...";return this.startTime||(this.startTime=(new Date).getTime()),this.setIntervalId=setInterval(this.playLoop.bind(this),this.sampleRate),this}},{key:"loop",value:function(){setTimeout(function(){this.playLoop(),this.loop()}.bind(this),this.sampleRate)}},{key:"pause",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=this.tick,this.startTime=0,this}},{key:"stop",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=0,this.startTime=0,this.resetTracks(),this}},{key:"skipToTick",value:function(t){return this.stop(),this.startTick=t,this.tracks.forEach((function(e){e.setEventIndexByTick(t)})),this}},{key:"skipToPercent",value:function(t){if(t<0||t>100)throw"Percent must be number between 1 and 100.";return this.skipToTick(Math.round(t/100*this.totalTicks)),this}},{key:"skipToSeconds",value:function(t){var e=this.getSongTime();if(t<0||t>e)throw t+" seconds not within song time of "+e;return this.skipToPercent(t/e*100),this}},{key:"isPlaying",value:function(){return this.setIntervalId>0||"object"===m(this.setIntervalId)}},{key:"dryRun",value:function(){for(this.resetTracks();!this.endOfFile();)this.playLoop(!0);return this.events=this.getEvents(),this.totalEvents=this.getTotalEvents(),this.totalTicks=this.getTotalTicks(),this.startTick=0,this.startTime=0,this.resetTracks(),this.triggerPlayerEvent("fileLoaded",this),this}},{key:"resetTracks",value:function(){return this.tracks.forEach((function(t){return t.reset()})),this}},{key:"getEvents",value:function(){return this.tracks.map((function(t){return t.events}))}},{key:"getTotalTicks",value:function(){return Math.max.apply(null,this.tracks.map((function(t){return t.delta})))}},{key:"getTotalEvents",value:function(){return this.tracks.reduce((function(t,e){return{events:{length:t.events.length+e.events.length}}}),{events:{length:0}}).events.length}},{key:"getSongTime",value:function(){return this.totalTicks/this.division/this.tempo*60}},{key:"getSongTimeRemaining",value:function(){return Math.round((this.totalTicks-this.getCurrentTick())/this.division/this.tempo*60)}},{key:"getSongPercentRemaining",value:function(){return Math.round(this.getSongTimeRemaining()/this.getSongTime()*100)}},{key:"bytesProcessed",value:function(){return x.HEADER_CHUNK_LENGTH+8*this.tracks.length+this.tracks.reduce((function(t,e){return{pointer:t.pointer+e.pointer}}),{pointer:0}).pointer}},{key:"eventsPlayed",value:function(){return this.tracks.reduce((function(t,e){return{eventIndex:t.eventIndex+e.eventIndex}}),{eventIndex:0}).eventIndex}},{key:"endOfFile",value:function(){return this.isPlaying()?this.totalTicks-this.tick<=0:this.bytesProcessed()>=this.midiChunksByteLength}},{key:"getCurrentTick",value:function(){return this.startTime?Math.round(((new Date).getTime()-this.startTime)/1e3*(this.division*(this.tempo/60)))+this.startTick:this.startTick}},{key:"emitEvent",value:function(t){return this.triggerPlayerEvent("midiEvent",t),this}},{key:"on",value:function(t,e){return this.eventListeners.hasOwnProperty(t)||(this.eventListeners[t]=[]),this.eventListeners[t].push(e),this}},{key:"triggerPlayerEvent",value:function(t,e){return this.eventListeners.hasOwnProperty(t)&&this.eventListeners[t].forEach((function(t){return t(e||{})})),this}}]),t}(),C={Player:k,Utils:T,Constants:x},D=n(346),N=n.n(D),I=n(343);function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const M=(t,e=null)=>{const n={},i=t.getBoundingClientRect();for(const t in i)e&&!e.includes(t)||(n[t]=i[t]);return n};class B{}j(B,"isElement",(t=>1==t.nodeType));const L=(t,e,n)=>Math.max(e,Math.min(n,t)),O=(t,e=0)=>(e=10**e,Math.round(t*e)/e);class z{constructor(t=""){this.ctn=document.getElementById(`${t}-progress-ctn`),this.el=document.getElementById(`${t}-progress`),this.doneEl=document.getElementById(`${t}-progress-done`),this.maxEl=document.getElementById(`${t}-progress-max`),this.reset()}update(t=this.done,e=this.max){if(e<=0)return this.reset();this.done=t,this.max=e,this.el.max=e,this.el.value=t,this.el.innerHTML=`${t} / ${e}`;const n=O(this.el.position,3);this.setBar(n),this.updateLabel()}setBar(t){this.ctn.style.setProperty("--progress",L(0,t,1))}updateLabel(){this.doneEl.innerHTML=this.formatTime(this.done),this.maxEl.innerHTML=this.formatTime(this.max)}formatTime(t){t=O(t);const e=Math.floor(t/60);return t%=60,`${P(e)}:${P(t)}`}reset(){this.el.innerHTML="",this.el.removeAttribute("value"),this.el.removeAttribute("max"),this.setBar(0),this.done=0,this.max=0}}const P=(t,e=2)=>t.toString().padStart(e,"0"),H=new AudioContext;let R;const U=new class{constructor(){this.midiId=null,this.playhead=0,this.instrument,this.status="paused",this.activeNotes={},this.ctn=document.getElementById("player"),this.playPauseBtn=document.getElementById("player-play-pause"),this.stopBtn=document.getElementById("player-stop"),this.timelineRange=document.getElementById("player-timeline-input"),this.init()}loadSound(t,e=""){this.midiId!=e&&(this.stop(),this.midiId=e),R.loadDataUri(`data:audio/midi;base64,${t}`)}onTap({target:t}){if(t==this.playPauseBtn){if(R.isPlaying())return this.pause();const t=(0,I.p8)();return"original"!=this.midiId&&this.loadSound(t,"original"),this.play()}t==this.stopBtn&&"stopped"!=this.status&&this.stop()}onChange({target:t}){t==this.timelineRange&&R.skipToSeconds(t.value).play()}updateProgress(){let t=R.getSongTime(),e=R.getSongTimeRemaining();(isNaN(t)||isNaN(e))&&(t=0,e=0),e=L(e,0,t);const n=O(t-e,2);this.progressBar.update(n,t),this.timelineRange.setAttribute("max",t),this.timelineRange.setAttribute("value",n)}play(){this.playhead&&R.skipToTick(this.playhead),R.play(),this.updateControls("playing")}stop(){R.stop(),this.instrument.stop(),this.updateProgress(),this.playhead=0,this.updateControls("stopped")}pause(){this.playhead=R.getCurrentTick(),this.instrument.stop(),R.pause(),this.updateControls("paused")}updateControls(t){this.status=t;let e="playing"==t?"Pause":"Play";var n,i;e=this.playPauseBtn.dataset[`label${e}`],n=this.playPauseBtn,i={title:e,ariaLabel:e},Object.entries(i).forEach((([t,e])=>{if(null==e)return n.removeAttribute(t);n.setAttribute(t,e)})),["stopped","playing","paused"].forEach((e=>this.ctn.classList.toggle(`player--${e}`,t==e)))}init(){N().instrument(H,"/instruments/acoustic-grand-piano-mp3.js").then((t=>{this.instrument=t,R=new C.Player((e=>{const n=e.noteName+e.track;if("Note on"==e.name&&e.velocity>0)this.activeNotes[n]=t.play(e.noteNumber,H.currentTime,{gain:e.velocity/127});else if("Note off"==e.name||"Note on"==e.name&&0==e.velocity){var i;null===(i=this.activeNotes[n])||void 0===i||i.stop()}this.updateProgress()})),R.on("endOfFile",(()=>this.stop()))})),this.updateControls("stopped"),this.progressBar=new z("player")}reset(){this.stop(),this.midiId=null,this.activeNotes={}}},V=new class{constructor(){this.ctn=document.getElementById("start-screen"),this.filePicker=document.getElementById("start-screen-score-file-picker"),this.init()}init(){document.getElementById("start-screen-loading-spinner").remove()}onChange(t){t.composedPath().includes(this.filePicker)&&(0,I.zD)(t)}destroy(){this.ctn.addEventListener("transitionend",this.ctn.remove,{once:!0}),this.ctn.classList.add("start-screen--out")}},q=new class{constructor(){this.visible=!1,this.ctn=document.getElementById("main-menu"),this.toggleBtn=document.getElementById("main-menu-toggle"),this.filePicker=document.getElementById("score-file-picker"),this.saveFile=document.getElementById("save-file"),this.saveAsSvg=document.getElementById("save-file-svg")}onTap({target:t}){return t==this.toggleBtn?this.toggle():t==this.saveFile?(0,I.Jm)():void(t==this.saveAsSvg&&(0,I.Nd)())}onChange(t){t.composedPath().includes(this.filePicker)&&((0,I.zD)(t),this.toggle(!1))}toggle(t=!this.visible){this.visible=t,this.ctn.classList.toggle("fly-out--expanded",t),this.ctn.classList.toggle("fly-out--collapsed",!t)}},W=t=>t[0].toUpperCase()+t.slice(1);class F{constructor(t,e){j(this,"createFilterElement",(({type:t,checked:e})=>`\n    <li>\n        <label class="checkable color-relation-${t}" for="${this.namespace}-filter-${t}">\n            ${W(t)}\n            <input class="checkable__input" type="checkbox" id="${this.namespace}-filter-${t}" data-type="${t}" ${e?"checked":""}>\n            <span class="checkbox checkbox--colored">\n                <svg class="checkable__icon btn__icon" width="12" height="10">\n                    <use xlink:href="#check-path"/>\n                </svg>\n            </span>\n        </label>\n    </li>\n  `)),this.namespace=t,this.ctn=document.getElementById(e.filterCtnId),this.paths=e.svgCtn.getElementsByClassName(t),this.fields=[]}onChange(t){t.composedPath().includes(this.ctn)&&this.toggleRelationsPaths(t.target.dataset.type,t.target.checked)}toggleRelationsPaths(t,e){Array.from(this.paths).filter((e=>e.getAttribute("type")==t)).forEach((t=>t.classList.toggle("relation--filtered",!e)))}getRelations(){const t=new Set(Array.from(this.paths,(t=>t.getAttribute("type"))));this.fields=Array.from(t,(t=>({type:t,checked:!0,el:null})))}hasRelationType(t){return this.fields.some((e=>e.type==t))}wasLastOfType(t){return!Array.from(this.paths).some((e=>e.getAttribute("type")==t))}render(){let t=this.fields.map((t=>this.createFilterElement(t))).join(" ");this.ctn.innerHTML=t}}const $=new class{constructor(){j(this,"createFiltersGroups",(()=>[new F("relation",{filterCtnId:"relations-filters",svgCtn:this.svgCtn}),new F("metarelation",{filterCtnId:"meta-relations-filters",svgCtn:this.svgCtn})])),j(this,"createMutationObserver",(()=>new MutationObserver((t=>{if(t.filter((t=>"attributes"==t.type&&"type"==t.attributeName)).filter((t=>t.target.getAttribute("type")!=t.oldValue)).length>0)return this.update();const e=1==t.length&&t.filter((t=>{var e;return"childList"==t.type&&1==(null===(e=t.addedNodes)||void 0===e?void 0:e.length)})).map((t=>{var e;return null===(e=t.addedNodes)||void 0===e?void 0:e.item(0)})).find(B.isElement);if(e){const t=e.getAttribute("type");if(!this.groups.some((e=>e.hasRelationType(t))))return this.update()}const n=1==t.length&&t.filter((t=>{var e;return"childList"==t.type&&1==(null===(e=t.removedNodes)||void 0===e?void 0:e.length)})).map((t=>{var e;return null===(e=t.removedNodes)||void 0===e?void 0:e.item(0)})).find(B.isElement);if(n){const t=n.getAttribute("type");if(this.groups.some((e=>e.wasLastOfType(t))))return this.update()}})))),this.visible=!1,this.ctn=document.getElementById("filters"),this.toggleBtn=document.getElementById("filters-toggle"),this.svgCtn=document.getElementById("layers"),this.observer=this.createMutationObserver(),this.groups=this.createFiltersGroups()}onTap({target:t}){t==this.toggleBtn&&this.toggle()}onChange(t){this.groups.forEach((e=>e.onChange(t)))}onScoreLoad(){this.toggle(!1),this.observer.disconnect(),this.update(),this.observe()}observe(){this.observer.observe(document.querySelector("#layers .svg_container > svg .page-margin"),{subtree:!0,childList:!0,attributeOldValue:!0,attributeFilter:["type"]})}toggle(t=!this.visible){this.visible=t,this.ctn.classList.toggle("fly-out--expanded",t),this.ctn.classList.toggle("fly-out--collapsed",!t)}update(){this.groups.forEach((t=>t.getRelations())),this.groups.forEach((t=>t.render()))}};var Y=n(10);function Q(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Q(t,e,"set"),n),n}function K(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Q(t,e,"get"))}class G extends Map{constructor(...t){super(...t),j(this,"add",((t,e)=>this.has(t)?this:this.set(t,e))),j(this,"remember",((t,e)=>("function"==typeof e&&(e=this.has(t)?this.get(t):e()),this.add(t,e),e)))}}function Z(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}const J=["note","relation","metarelation"];var tt=new WeakMap,et=new WeakMap;const nt=new class{constructor(){Z(this,tt,{writable:!0,value:void 0}),Z(this,et,{writable:!0,value:new G}),this.loaded=!1,this.mei=null}get selection(){return K(this,tt)}set selection(t){K(this,et).clear(),X(this,tt,t)}get flatSelection(){return K(this,et).remember("flatSelection",(()=>Object.values(this.selection).flat()))}get hasSelection(){return K(this,et).remember("hasSelection",(()=>this.flatSelection.length>0))}get selectionType(){return K(this,et).remember("selectionType",(()=>{var t;return null!==(t=J.find((t=>{var e;return null===(e=this.flatSelection[0])||void 0===e?void 0:e.classList.contains(t)})))&&void 0!==t?t:null}))}get selectedRelationTypes(){return K(this,et).remember("selectedRelationTypes",(()=>this.hasSelection&&"note"!=this.selectionType?new Set(this.flatSelection.map((t=>t.getAttribute("type"))).filter((t=>t))):null))}onScoreLoad(){this.loaded=!0,this.mei=window.mei,K(this,et).clear()}onScoreSelection({detail:t}){this.selection=t}},it={title:{label:"Title",saveBtn:"Update title",placeholder:"The name ♪ of the song ♫"},roles:{composer:{label:"Composer",saveBtn:"Update composer",placeholder:"Wolfgang Amadeus Mozart"},analyst:{label:"Analyst",saveBtn:"Assign responsibility",placeholder:"Maybe… you?"},annotator:{label:"Annotator",saveBtn:"Assign responsibility",placeholder:"Maybe… you?"}}},ot=(t,{label:e,placeholder:n=""},i="")=>`\n  <label class="fillable fly-out__title" for="metadata-${t}">\n      ${e}\n      <input\n          class="fillable__input"\n          id="metadata-${t}"\n          type="text"\n          placeholder="${n}"\n          value="${i}"\n      >\n  </label>\n`,rt=(t,{saveBtn:e})=>`\n  <button\n      class="btn btn--plain btn--small"\n      id="metadata-${t}-assign"\n      type="button"\n      data-role="${t}"\n  >${e}</button>\n`,st=new DOMParser,at=new RegExp(/^metadata-(\w+)-assign$/),lt=new class{constructor(){this.visible=!1,this.ctn=document.getElementById("metadata"),this.toggleBtn=document.getElementById("metadata-toggle"),this.persRoles=Object.keys(it.roles),this.formDOM={ctn:document.getElementById("metadata-form")},this.formDOM.inputs=this.formDOM.ctn.getElementsByClassName("fillable__input"),this.scoreHead={titleStmt:null,title:null,respStmt:null,respPersName:[]}}onTap({target:t}){var e;if(t==this.toggleBtn)return this.toggle();let n=null===(e=t.id.match(at))||void 0===e?void 0:e[1];n&&this.updateScoreMetadata(n)}onScoreLoad(){this.initScore(),this.initFields()}toggle(t=!this.visible){this.visible=t,this.ctn.classList.toggle("fly-out--expanded",t),this.ctn.classList.toggle("fly-out--collapsed",!t)}updateScoreMetadata(t){const e=[...this.formDOM.inputs].find((({id:e})=>`metadata-${t}`));if(!e)return;const n=e.value;if("title"==t)return void(this.scoreHead.title[0].innerHTML=n);const i=this.persNames.find((e=>e.role==t));i.value=n,i.el.innerHTML=n,"composer"!=t&&nt.flatSelection.forEach((e=>{const n=(0,Y.get_id)(e),i=(0,Y.get_by_id)(nt.mei,n);("note"==i.tagName?i:i.firstChild).setAttribute("resp",t)}))}initScore(){this.scoreHead.titleStmt=nt.mei.querySelector("meiHead fileDesc titleStmt"),this.scoreHead.titleStmt&&(this.initStmtEl("title"),this.initStmtEl("respStmt"),this.initRoles())}initStmtEl(t){if(this.scoreHead[t]=this.scoreHead.titleStmt.getElementsByTagName(t),!this.scoreHead[t].length){const e=nt.mei.createElement(t);this.scoreHead.titleStmt.appendChild(e)}}initRoles(){this.scoreHead.respPersName=this.scoreHead.respStmt[0].getElementsByTagName("persName"),this.persNames=Array.from(this.scoreHead.respPersName).filter((t=>this.persRoles.includes(t.getAttribute("role")))).map((t=>({el:t,role:t.getAttribute("role"),value:t.innerHTML,config:it.roles[t.getAttribute("role")]}))),this.persRoles.filter((t=>!this.persNames.find((e=>e.role==t)))).forEach((t=>this.initRole(t)))}initRole(t){const e=st.parseFromString(`<persName role="${t}" xml:id="${t}" />`,"text/xml").firstChild;this.scoreHead.respStmt[0].appendChild(e),this.persNames.push({el:e,role:t,value:"",config:it.roles[t]})}initFields(){this.formDOM.ctn.innerHTML=ot("title",it.title,this.scoreHead.title[0].innerHTML)+rt("title",it.title)+this.persNames.map((({role:t,config:e,value:n})=>`\n    <hr class="fly-out__hr">\n    ${ot(t,e,n)}\n    ${rt(t,e)}\n  `)).join("")}},ct=lt,ut=new class{constructor(){this.update()}onResize(){this.update()}update(){this.w=window.innerWidth,this.h=window.innerHeight}},dt=new class{constructor(){this.toLeftBtn=document.getElementById("to-left"),this.toRightBtn=document.getElementById("to-right")}onTap(t){return t.target==this.toLeftBtn?this.toLeft():t.target==this.toRightBtn?this.toRight():void 0}toLeft(){this.goTo(-(ut.w-200))}toRight(){this.goTo(ut.w-200)}goTo(t){i.JU.scrollBy(t,0)}};var ht=n(854),pt=n(554);class ft{constructor(t){j(this,"hide",(()=>this.toggleVisibility(!1))),this.ctn={el:document.getElementById(t)},this.closeBtn=this.ctn.el.querySelector(".fly-out__closeBtn"),this.visible=!1}onTap(t){if(t.composedPath().includes(this.ctn.el))return t.target==this.closeBtn?this.toggleVisibility(!1):void 0}toggleVisibility(t=!this.visible){this.ctn.el.classList.toggle("fly-out--visible",t),this.visible=t}}const gt=t=>t/10+"rem";var mt=new WeakMap;class yt extends ft{constructor(t){var e,n,i;super(t),i={writable:!0,value:!1},function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,n=mt),n.set(e,i),this.dragHandle={el:this.ctn.el.querySelector(".fly-out__drag")},this.visible=!1,this.x=0,this.y=0,this.computeValues()}onTapStart(t){t.target==this.dragHandle.el&&function(t,e=null){t.preventDefault(),e&&e.call()}(t,(()=>this.toggleDragging(!0)))}onTapMove(t,e){this.visible&&K(this,mt)&&this.updatePosition(t,e)}onTapEnd(){this.visible&&K(this,mt)&&(this.toggleDragging(!1),this.computeValues())}onResize(){this.visible&&this.computeValues()}updatePosition(t=this.x,e=this.y){this.x=t-this.ctn.handleDeltaX,this.y=e-this.ctn.handleDeltaY,this.ctn.el.style.setProperty("--fly-out-x",gt(this.x)),this.ctn.el.style.setProperty("--fly-out-y",gt(this.y))}toggleDragging(t=!K(this,mt)){X(this,mt,t),this.ctn.el.classList.toggle("fly-out--grabbing",t),i.JU.classList.toggle("dragging-fly-out",t)}snapInViewport(){const t=L(this.x,10,ut.w-this.ctn.width-10),e=L(this.y,10,ut.h-this.ctn.height-10);t==this.x&&e==this.y||(this.ctn.el.classList.add("fly-out--snapping"),this.ctn.el.addEventListener("transitionend",this.onSnapTransitionEnd.bind(this)),this.updatePosition(t+this.ctn.handleDeltaX,e+this.ctn.handleDeltaY))}onSnapTransitionEnd({propertyName:t}){"transform"==t&&(this.ctn.el.classList.remove("fly-out--snapping"),this.ctn.el.removeEventListener("transitionend",this.onSnapTransitionEnd.bind(this)))}computeValues(){const t=["x","y","width","height"];Object.assign(this.ctn,M(this.ctn.el,t)),Object.assign(this.dragHandle,M(this.dragHandle.el,t)),this.ctn.handleDeltaX=this.dragHandle.x-this.ctn.x+this.dragHandle.width/2,this.ctn.handleDeltaY=this.dragHandle.y-this.ctn.y+this.dragHandle.height/2,this.snapInViewport()}}const vt="hide-when-compact",bt=t=>t.map(xt).join(""),xt=t=>`<option value="${t}">`;var _t=new WeakMap;class wt{constructor(t,e,n={}){var i,o,r;r={writable:!0,value:!1},function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(i=this,o=_t),o.set(i,r),this.type=t,this.name=e.name,this.eventCallbacks=n,this.initHtml(e)}get isVisible(){return K(this,_t)}show(){this.toggleVisibility(!0)}hide(){this.toggleVisibility(!1)}toggleVisibility(t=!K(this,_t)){X(this,_t,t),this.ctn.classList.toggle("fly-out__relationsBtnsCtn--visible",t)}select(t){if(this.unselect(),!t)return;const e=Array.from(this.btns).filter((e=>t.has(e.dataset.relationName)));if(e.forEach((t=>t.classList.add("btn--selected"))),t.size<=e.length)return;const n=e.map((t=>t.dataset.relationName)),i=[...t].filter((t=>!n.includes(t)));this.freeFieldCtn.classList.add("fly-out__relationsField--selected"),1==i.length&&(this.freeField.value=i[0])}unselect(){Array.from(this.selectedBtns).forEach((t=>t.classList.remove("btn--selected"))),this.freeFieldCtn.classList.remove("fly-out__relationsField--selected"),this.freeField.value=""}initHtml(t){var e;const n=(i=t.name,`\n  <div class="fly-out__headerRow">\n      <div class="fly-out__title fly-out__title--big">\n          ${W(i)}s\n      </div>\n  </div>\n`);var i;let o=Object.keys(t.main).map(((t,e)=>((t,e,n)=>`\n  <button\n      type="button"\n      class="\n        btn btn--hollow btn--relation color-relation-${t}\n        ${n>2?vt:""}\n      "\n      data-relation-name="${t}"\n      data-relation-type="${e}"\n  >\n      ${W(t)}\n  </button>\n`)(t,this.type,e))).join("");(t.main.length>3||"additional"in t)&&(o+=`\n  <button\n      type="button"\n      class="fly-out__showMore hide-when-not-compact | btn btn--hollow"\n  >\n      <span class="visually-hidden">View more ${this.type}</span>\n      &hellip;\n  </button>\n`),o=`<div class="btn-group">${o}</div>`;const r="additional"in t?((t,e)=>{return`\n  <form\n      class="btn-group btn-group--free-field hide-when-compact"\n      id="free-field-${e}-form"\n  >\n      ${((t,{label:e,placeholder:n=""})=>`\n  <label\n      class="fillable fly-out__relationsField hide-when-compact"\n      for="free-field-${t}"\n  >\n      <span class="fillable__label">\n          <span class="fillable__label__text">${e}</span>\n          <svg class="fillable__label__triangle | btn__icon" width="10" height="8">\n              <use xlink:href="#triangle-path"/>\n          </svg>\n      </span>\n\n      <input\n          class="fillable__input"\n          id="free-field-${t}"\n          type="text"\n          list="datalist-${t}"\n          placeholder="${e}"\n          data-relation-type="${t}"\n      >\n  </label>\n`)(e,{label:"Or type a "+t.name})}\n      ${n=t.additional,i=e,`\n  <datalist id="datalist-${i}">${bt(n)}</datalist>\n`}\n\n      <button class="btn btn--plain btn--small">\n          Assign <span class="visually-hidden>${e}</span>\n      </button>\n  </form>\n`;var n,i})(t,this.type):"";this.ctn=document.getElementById(`${this.type}-btns`),this.ctn.innerHTML=n+o+r,this.btns=this.ctn.getElementsByClassName("btn--relation"),this.selectedBtns=this.ctn.getElementsByClassName("btn--selected"),this.freeField=this.ctn.querySelector(`#free-field-${this.type}`),this.freeFieldCtn=null===(e=this.freeField)||void 0===e?void 0:e.parentElement}}const St=new RegExp(/^free-field-(\w+)-form$/),Et=new class extends yt{constructor(){super("relations-menu"),this.innerCtn=document.getElementById("relations-btns-ctn"),this.deleteBtn=this.ctn.el.querySelector(".fly-out__deleteBtn"),this.init()}get visibleGroups(){return[this.relations,this.metarelations,this.comborelations].filter((({isVisible:t})=>t))}onTap(t){if(super.onTap(t),t.target==this.deleteBtn)return(0,ht.x)();const{dataset:e,classList:n}=t.target,i=n.contains("fly-out__compact"),o=n.contains("fly-out__showMore");if(i||o)return this.compact(i),this.computeValues();null!=e&&e.hasOwnProperty("relationType")&&n.contains("btn--relation")&&this[e.relationType].eventCallbacks.tap(e.relationName)}onSubmit(t){var e,n;const i=null===(e=t.target.id.match(St))||void 0===e?void 0:e[1];if(!i)return;t.preventDefault();const{value:o}=null===(n=this[i])||void 0===n?void 0:n.freeField;o&&this[i].eventCallbacks.tap(o)}onScoreSelection(){const{hasSelection:t,selectionType:e,selectedRelationTypes:n}=nt;this.relations.select("relation"==e?n:new Set),this.metarelations.select("metarelation"==e?n:new Set),this.toggleVisibility(t),this.reorder(),this.relations.show(),this.metarelations.toggleVisibility("note"!=e),this.compact(),this.deleteBtn.disabled=!t||"note"==e,1==nt.flatSelection.length&&this.computeValues()}reorder(){if(1!==nt.flatSelection.length)return;const t=(0,pt.Ti)(nt.selectionType);for(let e=t.length-1;e>0;e--)this.innerCtn.insertBefore(this[t[e-1]].ctn,this[t[e]].ctn)}compact(t=null){if(!nt.flatSelection.length)return;null!=t&&(this.ctn.el.classList.toggle("fly-out--relations-compact",t),this.ctn.el.classList.toggle("fly-out--big",!t));const e="note"==nt.selectionType&&nt.flatSelection.length>2&&nt.selection.extraselected.length<3;this.comborelations.toggleVisibility(e)}init(){this.relations=new wt("relations",pt.W3,{tap:I.i9}),this.metarelations=new wt("metarelations",pt.pX,{tap:I.qG}),this.comborelations=new wt("comborelations",pt.yu,{tap:I.lk}),this.title=this.ctn.el.querySelector(".fly-out__title")}},Tt=Et;var At=n(819);const kt=t=>`<li class="selection__listItem">${t.toUpperCase()}</li>`,Ct=t=>`<li class="selection__listItem">${t.getAttribute("type")}</li>`;class Dt extends ft{constructor(){super("selection-legend"),this.title=document.getElementById("selection-type"),this.primary=document.getElementById("selection-primary"),this.primaryList=document.getElementById("selection-list-primary"),this.secondary=document.getElementById("selection-secondary"),this.secondaryList=document.getElementById("selection-list-secondary"),this.hide()}update({selected:t,extraselected:e}){this.toggleVisibility(nt.hasSelection),this.visible&&(this.updateTitle(),this.updateRow("primary",e),this.updateRow("secondary",t))}updateTitle(){this.title.innerHTML=nt.selectionType?`Selected ${nt.selectionType}s`:"Selection is empty"}updateRow(t,e){this[t].classList.toggle("none",!e.length),this[`${t}List`].innerHTML=(t=>{console.log(t);const e=nt.selectionType;return t.length?("note"==e?(0,Y.to_text)(t).map(kt):t.map(Ct)).join(""):"-"})(e)}}class Nt{constructor(){this.primary=document.getElementById("selection-mode-primary"),this.secondary=document.getElementById("selection-mode-secondary")}set(t){this.mode=t,this.updateBtns()}updateBtns(){this[this.mode].checked=!0}onChange({target:t}){"selection-mode"==t.name&&this.set(t.value)}}const It=new class{constructor(){this.selectBtn=document.getElementById("select-all"),this.unselectBtn=document.getElementById("unselect-all"),this.legend=new Dt,this.mode=new Nt}selectAll(){const t=(0,At.c)();t&&(0,At.Au)(t)}selectNone(){(0,At.Nv)()}onTap({target:t}){return t==this.selectBtn?this.selectAll():t==this.unselectBtn?this.selectNone():void 0}onScoreSelection(t){this.legend.update(t)}},jt=new class{constructor(){this.zoomInBtn=document.getElementById("zoom-in"),this.zoomOutBtn=document.getElementById("zoom-out"),this.resetBtn=document.getElementById("zoom-reset"),this.levelEl=document.getElementById("zoom-level")}onTap({target:t}){return t==this.zoomInBtn?this.in():t==this.zoomOutBtn?this.out():t==this.resetBtn?this.reset():void 0}in(){this.by(1.1)}out(){this.by(.9090909090909091)}reset(){this.by(1)}by(t=1){const e=(0,At.c)();e&&(e.zoom=1==t?1:e.zoom*t,e.svg_elem.style.transform=`scale(${e.zoom})`,this.levelEl.innerHTML=this.format(e.zoom))}format(t){return`${Math.round(100*t)}%`}};var Mt=n(138);const Bt=new class{constructor(){this.btn=document.getElementById("new-note"),this.isActive=!1}toggle(){var t;this.isActive=null!==(t=(0,Mt.M_)())&&void 0!==t&&t,this.btn.classList.toggle("btn--something-active-for-new-note",this.isActive)}enable(){(0,Mt.xy)(),this.btn.classList.add("btn--something-active-for-new-note"),this.isActive=!0}disable(){(0,Mt.Kd)(),this.btn.classList.remove("btn--something-active-for-new-note"),this.isActive=!1}onTap({target:t}){t==this.btn&&this.toggle()}};class Lt{constructor(t="",e){this.ctn=document.getElementById(`${t}-progress-ctn`),this.setMinMax(e),this.update(e.value)}setMinMax({min:t,max:e}){this.min=parseInt(t),this.max=parseInt(e)}update(t=this.value){let e=((t=parseFloat(t))-this.min)/(this.max-this.min);e=O(e,3),this.setBar(e)}setBar(t){this.ctn.style.setProperty("--progress",L(0,t,1))}}const Ot=new class{constructor(){this.input=document.getElementById("relation-width");const{min:t,max:e,value:n}=this.input;this.progressBar=new Lt("relation-width",{min:t,max:e,value:n}),this.throttling=!1}onInput({target:t}){t!=this.input||this.throttling||(this.throttling=!0,requestAnimationFrame((()=>{const e=parseInt(t.value);this.progressBar.update(e),(0,At.PB)(e),this.throttling=!1})))}},zt=new class{constructor(){this.ctn=document.getElementById("player-and-score-settings"),this.toggleVisibilityBtn=document.getElementById("score-settings-toggle"),this.toggleShadesBtn=document.getElementById("settings-shades"),this.toggleStemsBtn=document.getElementById("settings-stems"),this.toggleTonesBtn=document.getElementById("settings-non-related-tones"),this.expanded=!1,this.autoCloseTimer=null,this.brightShades=!0}get interacting(){const t=this.hasInteractionWith(this.ctn),e=this.hasInteractionWith(document.activeElement);return t||e}hasInteractionWith(t){return"1"==getComputedStyle(t).getPropertyValue("--in-player-and-score-settings").trim()}startAutoCloseTimer(){clearTimeout(this.autoCloseTimer),this.autoCloseTimer=setTimeout((()=>{if(this.interacting)return this.startAutoCloseTimer();this.toggleVisibility(!1)}),1e4)}onTap(t){return t.composedPath().includes(this.ctn)?(this.startAutoCloseTimer(),t.target==this.toggleVisibilityBtn?this.toggleVisibility(!0):t.target==this.toggleShadesBtn?this.toggleShades():t.target==this.toggleStemsBtn?this.toggleStems():t.target==this.toggleTonesBtn?(0,At.qt)():void 0):this.toggleVisibility(!1)}toggleVisibility(t=!this.expanded){this.expanded=t,i.JU.classList.toggle("ui-score-settings-visible",t)}toggleShades(t=!this.brightShades){this.brightShades=t,i.JU.classList.toggle("shades-alternate",!t)}toggleStems(){(0,At.mI)()}},Pt=new class{constructor(){this.ctn=document.getElementById("ui"),this.init()}onTap(t){var e,n,i,o,r,s,a,l,c;null===(e=this.relations)||void 0===e||e.onTap(t),null===(n=this.scoreSettings)||void 0===n||n.onTap(t),t.composedPath().includes(this.ctn)&&(null===(i=this.mainMenu)||void 0===i||i.onTap(t),null===(o=this.zoom)||void 0===o||o.onTap(t),null===(r=this.selection)||void 0===r||r.onTap(t),null===(s=this.metadata)||void 0===s||s.onTap(t),null===(a=this.navigation)||void 0===a||a.onTap(t),null===(l=this.filters)||void 0===l||l.onTap(t),null===(c=this.newNote)||void 0===c||c.onTap(t))}onTapStart(t){var e;null===(e=this.relations)||void 0===e||e.onTapStart(t)}onTapMove(t,e){var n;null===(n=this.relations)||void 0===n||n.onTapMove(t,e)}onTapEnd(){var t;null===(t=this.relations)||void 0===t||t.onTapEnd()}onResize(){var t;null===(t=this.relations)||void 0===t||t.onResize()}onScoreLoad(t){var e,n;null===(e=this.filters)||void 0===e||e.onScoreLoad(t),null===(n=this.metadata)||void 0===n||n.onScoreLoad(t)}onScoreSelection({detail:t}){var e,n;null===(e=this.selection)||void 0===e||e.onScoreSelection(t),null===(n=this.relations)||void 0===n||n.onScoreSelection()}init(){this.startScreen=V,this.mainMenu=q,this.zoom=jt,this.selection=It,this.navigation=dt,this.metadata=ct,this.filters=$,this.relations=Tt,this.newNote=Bt,this.relationWidth=Ot,this.scoreSettings=zt}};var Ht=n(922);const Rt=new class{constructor(){this.undoBtn=document.getElementById("undo"),this.redoBtn=document.getElementById("redo"),this.updateBtns(0,0)}onTap({target:t}){return t==this.undoBtn?this.undo():t==this.redoBtn?this.redo():void 0}undo(){(0,Ht.FB)()}redo(){(0,Ht.VJ)()}updateBtns(t=0,e=0){this.undoBtn.toggleAttribute("disabled",0==t),this.redoBtn.toggleAttribute("disabled",0==e)}onUndoRedo({detail:t}){this.updateBtns(t.undoAbleCount,t.redoAbleCount)}},Ut=new class{constructor(){this.init()}init(){i.JU.classList.replace("loading","ready"),this.viewport=ut,(t=>{new g(this)})(),this.ui=Pt,this.score=nt,this.player=U,this.history=Rt}}},698:(t,e,n)=>{"use strict";function i(t){let e=!1,n=Object.defineProperty({},t,{get:()=>{e=!0}});try{window.addEventListener("test",n,n),window.removeEventListener("test",n,n)}catch(t){e=!1}return e}n.d(e,{eN:()=>s});i("passive");const o=i("capture"),r=function({capture:t=!1,passive:e=!0,once:n=!1}={}){return o?{capture:t,passive:e,once:n}:t},s=(r(),r({passive:!1}),r({capture:!0,passive:!1}));r({once:!0}),r({capture:!0,passive:!1,once:!0})},554:(t,e,n)=>{"use strict";n.d(e,{W3:()=>o,pX:()=>r,yu:()=>s,Ti:()=>a});const i={note:["relations","metarelations","comborelations"],relation:["metarelations","relations","comborelations"],metarelation:["metarelations","comborelations","relations"]},o={name:"relation",main:{repeat:{key:"e",color:1,shadeColor:0},passing:{key:"p",color:2,shadeColor:6},neighbour:{key:"n",color:3,shadeColor:2},harmonic:{key:"i",color:4,shadeColor:3},arpeggio:{key:"a",color:5,shadeColor:4},urlinie:{key:"u",color:6,shadeColor:5},bassbrechung:{key:"b",color:7,shadeColor:5},untyped:{color:5}},additional:["repetition","arpeggiation","back_relating_dominant","displacement","register_transfer","56_shift","added_root","initial_ascent","arpeggiated_ascent","urlinie_transference","bassbrechung_component","coupling","voice_exchange_component","voice_exchange_component_chromaticized","mixture","phrygian_ii"]},r={name:"metarelation",main:{context:{key:"c",color:1,shadeColor:0},layer:{key:"l",color:2,shadeColor:6},phrase:{key:"r",color:3,shadeColor:2},section:{key:"t",color:5,shadeColor:3}},additional:["auxiliary_cadence","superposition","reaching_over","urlinie_meta","ursatz","bassbrechung","bassbrechung_transference","ursatz_transference","unfolding","motion_into_the_inner_voice","motion_from_the_inner_voice","linear_intervallic_progression","linear_intervallic_progression_module","interruption","interruption_branch_1","interruption_branch_2","voice_exchange","motivic_parallelism","motive","contradiction","indeterminacy","parallel_fifths","parallel_octaves"]},s={name:"comborelation",main:{"passing comborelation":{key:"P",total:"passing",outer:"arpeggio"},"neighbour comborelation":{key:"N",total:"neighbour",outer:"repeat"}}},a=t=>i[t]},115:(t,e,n)=>{"use strict";n.d(e,{JU:()=>i,vx:()=>o});const i=document.documentElement,o=(document.body,getComputedStyle(i))},689:(t,e,n)=>{"use strict";n.d(e,{t:()=>i});const i=()=>["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)},819:(t,e,n)=>{"use strict";n.d(e,{N7:()=>J,Sr:()=>ft,hv:()=>pt,Nv:()=>at,Pw:()=>ut,c:()=>Tt,jM:()=>F,hT:()=>Y,h4:()=>St,gB:()=>wt,oq:()=>nt,PB:()=>lt,qY:()=>tt,Z6:()=>it,$Z:()=>et,K5:()=>ct,rp:()=>gt,bf:()=>ht,Au:()=>Z,vI:()=>Et,mI:()=>ot,qt:()=>_t,dB:()=>G,up:()=>rt,e6:()=>dt});var o=n(986),r=n.n(o),s=n(501),a=n.n(s),l=n(869),c=n(238),u=n.n(c),d=n(748),h=n(343),p=n(10);function f(t,e,n){var i=e.map((e=>(0,p.relation_primaries)(t,e))).flat();e=e.filter((t=>!n.includes(t))),i=i.concat(e.map((e=>(0,p.relation_secondaries)(t,e))).flat());do{var o=n.filter((e=>(0,p.relation_secondaries)(t,e).findIndex((t=>i.includes(t)))>-1));e=e.concat(o),n=n.filter((t=>!o.includes(t))),i=i.concat(o.map((e=>(0,p.relation_secondaries)(t,e))).flat())}while(o.length>0);return[n,[...new Set(n.flatMap((e=>(0,p.relation_secondaries)(t,e))))]]}function g(t){!function(t,e,n,i){var o=n.concat(i).map((t=>(0,p.get_by_id)(e.getRootNode(),(0,p.get_id)(t)))),r=Array.from(e.getElementsByTagName("node")).filter((t=>"relation"==t.getAttribute("type"))).filter((e=>{var n=(0,p.get_by_id)(document,t.id_prefix+e.getAttribute("xml:id"));return null!=n&&!n.classList.contains("hidden")}));0==o.length&&(o=r);var[s,a]=f(e,r,o),l=[];l.push(s.map((e=>(0,p.hide_he)(t,e)))),l.push(a.map((e=>(0,p.hide_note)(t,e)))),l.push(s.map((e=>(0,p.hide_he_hier)(t,e)))),l.push(a.map((e=>(0,p.hide_note_hier)(t,e))));var c=[s,a,l];t.reductions.push(["reduce",c,n,i])}(t,(0,h.ro)(),selected,extraselected)}var m=n(698);function y(t,e=200,n=!0){var i=t.svg_elem,o=t.id_prefix,r=(pt(t),(0,p.g)());r.id="hier"+o;var s=Array.from(i.getElementsByClassName("note")).map(p.get_id).map((t=>(0,p.get_by_id)(mei,t))).map(p.get_id).map((t=>(0,p.get_by_id)(mei,"gn-"+t))).filter((t=>null!=t)),a=Array.from(i.getElementsByClassName("relation")).map(p.get_id).map((t=>(0,p.get_by_id)(mei,t))),c=function(t,e,n=!0){var i=(0,h.ro)(),o=[],r=e,s=t.filter((t=>null!=t));do{let t=[];n&&(t=s.filter((t=>!r.find((e=>(0,p.relation_allnodes)(i,e).includes(t))))));var[a,l]=f(i,r,r);t=t.concat(l.filter((t=>s.includes(t)))),o.push(t),s=s.filter((e=>!t.includes(e))),r=r.filter((t=>!a.includes(t)))}while(l.length+a.length>0);return o.push(s),o}(s,a,n),u=c.flatMap(((e,n)=>e.map((e=>{let i=document.getElementById((0,p.id_in_svg)(t,(0,p.node_to_note_id)(e))),[o,r]=(0,p.note_coords)(i);return[e,[o,0-500*n]]})))),d={};u.forEach((([t,n])=>{let i,s=e<100?50:e/2,a=s<100?200:s>200?400:2*s,l=(0,p.node_to_note_id)(t),c=d[n],u=[n[0]+s+10,n[1]+s+25-a];if(c)i=c.getElementsByTagName("text")[0];else{c=(0,p.g)();let t=(0,p.circle)(n,s);c.appendChild(t),c.id="hier"+o+l,i=(0,p.text)("",u),i.style.fontFamiy="sans-serif",i.style.fontSize=a+"px",i.classList.add("nodetext"),c.appendChild(i),r.appendChild(c),d[n]=c}let h=(0,p.tspan)((0,p.note_to_text)(l),u,a);i.appendChild(h)})),a.forEach((t=>{let n=o+t.getAttribute("xml:id"),i=(0,p.relation_type)(t),s=document.getElementById(n),a=(0,p.relation_allnodes)((0,h.ro)(),t).map((t=>u.find((e=>e[0]==t))[1])),c=(0,p.roundedHull)(a,e);c.setAttribute("id","hier"+n),""!=o&&c.setAttribute("oldid",r.getAttribute("xml:id")),c.classList.add("relation"),c.setAttribute("type",i),rt(c),l.Z.ui.scoreSettings.brightShades||rt(c),c.onclick=t=>G(s),c.onmouseover=function(){s.classList.add("relationhover"),s.onmouseover()},c.onmouseout=function(){s.classList.remove("relationhover"),s.onmouseout()},c.addEventListener("wheel",(t=>{t.preventDefault(),(0,p.flip_to_bg)(t.target),t.target.onmouseout()}),m.eN),r.appendChild(c)})),(0,p.add_to_svg_bg)(i,r),ft(t,500*c.length)}function v(t,e,n){0!=t.children.length?(t.children.forEach((t=>v(t,e,n))),t.y=n+t.children.map((t=>t.y)).reduce(((t,e)=>t>e?t:e))):t.y=e}function b(t,e,n){0!=t.children.length&&(Math.abs(e-t.y)>n&&(t.y+=(e-n-t.y)/2),t.children.forEach((e=>b(e,t.y,n))))}function x(t){return 0==t.children.length?[t]:t.children.flatMap(x)}function _(t){t.children.forEach(_),0!=t.children.length&&null==t.x&&(t.x=(0,p.average)(t.children.map((t=>t.x))))}function w(t,e=0,n=-500){_(t),v(t,e,n),b(t,t.y,n)}function S(t,e=100){var n=(0,p.g)(),i=(0,p.text)(t.label,[t.x,t.y+(0==t.children.length?e:0)]);i.style.fontFamiy="sans-serif",i.style.fontSize=e+"px",i.style.textAnchor="middle",i.classList.add("nodetext");var o=t.children.map((e=>(0,p.line)([t.x,t.y],[e.x,e.y]))),r=t.children.flatMap((t=>S(t,e)));return o.forEach((t=>n.appendChild(t))),r.forEach((t=>n.appendChild(t))),n.appendChild(i),n}function E(t,e=25){var n=t.getBBox(),i=(0,p.rect)([n.x-e,n.y-e],n.width+e,n.height+e);t.parentNode.insertBefore(i,t)}function T(t){var e,n,i=mei.createElement("label");if(i.append(t.label),console.log(t.note_id),t.note_id){var o=mei.createElement("note");o.setAttribute("sameas","#"+t.note_id),i.appendChild(o)}return 0==t.children.length?e=mei.createElement("eLeaf"):(e=mei.createElement("eTree"),n=t.children.map(T)),e.appendChild(i),n&&n.forEach((t=>e.appendChild(t))),e}function A(t){var e=t.children[0],n={label:e.textContent};0!=e.children.length&&(n.note_id=e.querySelector("note").getAttribute("sameas").replace("#",""));var i=Array.from(t.children);return i.shift(),n.children=i.map(A),n}function k(t,e){e.note_id&&(e.x=(0,p.note_coords)((0,p.get_by_id)(document,(0,p.id_in_svg)(t,e.note_id)))[0]),e.children.forEach((e=>k(t,e)))}function C(t){var e=mei.querySelector("eTree");if(e){var n=function(t){return A(t)}(e),i=JSON.stringify(n);document.getElementById(t.id_prefix+"treeinput").value=i}else console.log("No tree to load")}function D(t){var e=document.getElementById(t.id_prefix+"treeinput");if(""!=e.value){var n=e.value,i=JSON.parse(n);if(i)return i;console.log("Failed to parse tree.")}else console.log("No tree to be parsed")}function N(t){var e=D(t);if(e){var n=document.getElementById(t.id_prefix+"treeinput"),o=selected.concat(extraselected);0==selected.length?o=Array.from(t.svg_elem.getElementsByClassName("note")):1==selected.length?selected[0].classList.contains("relation")&&(o=relation_get_notes(selected[0]).map((e=>(0,p.get_by_id)(document,(0,p.id_in_svg)(t,e.getAttribute("xml:id")))))):selected[0].classList.contains("metarelation")||selected.length;var r=o.map((t=>[(0,p.note_coords)(t)[0],t]));r.sort(((t,e)=>t[0]-e[0]));var s=x(e);if(s.length==r.length){for(i in s)s[i].x=r[i][0],s[i].note_id=r[i][1].id;var a=JSON.stringify(e);n.value=a,t.svg_elem.getRootNode().getElementById("tree"+t.id_prefix)&&I(t)}else console.log("Wrong length of list, expected "+s.length+" got "+r.length)}}function I(t,e=0,n=-1e3){var i=t.svg_elem,o=t.id_prefix,r=(pt(t),D(t));if((r||(console.log("No tree in input, attempting to load from XML"),C(t),r=D(t)))&&(function(t){return x(t)[0].hasOwnProperty("note_id")}(r)||(console.log("Tree not aligned, attempting to align to selection"),N(t),r=D(t)))){(function(t){return x(t)[0].hasOwnProperty("x")})(r)||k(t,r),w(r,e,n);var s=S(r);s.id="tree"+o,(0,p.add_to_svg_bg)(i,s),Array.from(s.getElementsByTagName("text")).forEach(E),adjust_top(t,-r.y)}}var j,M,B,L={},O=n(138),z=n(854),P=n(922),H=n(627),R=n(689),U=n(115),V=n(554),q=!1,W="";const F=()=>M,Y=()=>B;var Q,X=null,K=!0;function G(t,e=null){const n=(0,p.get_class_from_classlist)(t);if(!["relation","metarelation","note"].includes(n))return;const i=selected.concat(extraselected);if(i.length>0){const e=(0,p.get_class_from_classlist)(i[0]),o=i[0].closest(".svg_container"),r=t.closest(".svg_container");if(n!=e||r!=o)return}const o=i.find((e=>e==t));o&&(t.classList.remove("selectednote","extraselectednote","selectedrelation","extraselectedrelation"),selected=selected.filter((e=>e!==t)),extraselected=extraselected.filter((e=>e!==t))),null===e&&(e="primary"==l.Z.ui.selection.mode.mode),"note"!=n||o||(e?(t.classList.add("extraselectednote"),extraselected.push(t)):(t.classList.add("selectednote"),selected.push(t)),X=t),"relation"!=n&&"metarelation"!=n||(o||(e?(t.classList.add("extraselectedrelation"),extraselected.push(t)):(t.classList.add("selectedrelation"),selected.push(t)),X=t),0==selected.concat(extraselected).length&&(X=null)),document.dispatchEvent(new CustomEvent("scoreselection",{detail:{selected,extraselected}}))}function Z(t){var e=Array.from(t.svg_elem.getElementsByClassName("relation")).filter((t=>!t.classList.contains("relation--filtered")));if(e.length>0){(0,p.get_class_from_classlist)(e[0]);var n=e[0].closest("div");if(selected.length>0||extraselected.length>0){var i=(0,p.get_class_from_classlist)(selected.concat(extraselected)[0]),o=selected.concat(extraselected)[0].closest("div");"relation"!=i&&at(),n!=o&&at()}e.forEach((t=>{t.classList.contains("selectedrelation")||G(t)}))}}function J(t){!function(t){var e=document.createElement("div");e.id=t.id_prefix+"sidebardiv",e.classList.add("sidebar"),t.view_elem.prepend(e);var n=document.createElement("div");n.id=t.id_prefix+"filterdiv",n.classList.add("filterdiv"),n.innerHTML=`&#9776;&nbsp;L${t.layer_number}&nbsp;V${t.view_number}<br/></br>`,e.prepend(n)}(t);var e=t,n=document.createElement("div");n.classList.add("view_buttons"),n.id=t.id_prefix+"view_buttons";var i=(0,p.button)("Create new layer");i.classList.add("newlayerbutton"),i.id=t.id_prefix+"newlayerbutton";var o=(0,p.checkbox)("Sliced");o.id=t.id_prefix+"slicedcb",o.checked=!1;var r=(0,p.checkbox)("Tied");r.id=t.id_prefix+"tiedcb",r.checked=!1;var s=(0,p.button)("Reduce");s.classList.add("reducebutton"),s.id=t.id_prefix+"reducebutton";var a=(0,p.button)("Unreduce");a.classList.add("unreducebutton"),a.id=t.id_prefix+"unreducebutton";var c=(0,p.button)("Play reduction");c.classList.add("midireducebutton"),c.id=t.id_prefix+"midireducebutton";var u=(0,p.button)("Show/update hierarchy");u.classList.add("hierarchybutton"),u.id=t.id_prefix+"hierarchybutton";var d=(0,p.button)("Hide tree/hierarchy");d.classList.add("hidetopbutton"),d.id=t.id_prefix+"hidetopbutton";var f=(0,p.checkbox)("Roots low");f.id=t.id_prefix+"hierarchycb",f.checked=!0;var m=(0,p.checkbox)("Save layer");m.id=t.id_prefix+"savecb",m.checked=!1;var v=(0,p.checkbox)("Edit layer");v.id=t.id_prefix+"editcb",v.checked=!1,a.onclick=()=>{!function(t){console.log("Using globals: selected/extraselected");var e=t.reductions;if(0!=e.length){selected.forEach((t=>G(t,!1))),extraselected.forEach((t=>G(t,!0)));var[n,i,o,r]=e.pop(),[s,a,l]=i;l.flat().forEach((t=>{t&&t.classList.remove("hidden")})),o.forEach((t=>G(t,!1))),r.forEach((t=>G(t,!0)))}else console.log("Nothing to unreduce")}(e)},s.onclick=()=>{g(e)},i.onclick=()=>{(0,h.Jt)(e,o.checked,r.checked)},c.onclick=()=>{l.Z.player.loadSound(function(t=null){t||(t=(0,h.kg)()[0]);var e=(0,h.DR)(),n=(0,h.xM)(!0,t),i=(new XMLSerializer).serializeToString(n);e.loadData(i);const o=e.renderToMIDI();var r=(0,h.Yu)();return e.loadData(r),o}(e),e.id_prefix),l.Z.player.play()},u.onclick=()=>{y(e,50,f.checked)},d.onclick=()=>{!function(t){var e=t.svg_elem;t.id_prefix,pt(t)&&(e.getElementsByClassName("definition-scale")[0].setAttribute("viewBox",t.old_viewbox),e.children[0].setAttribute("height",t.old_height))}(e)},n.appendChild(document.createTextNode("▼")),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(m);var b=document.createElement("label");b.htmlFor=t.id_prefix+"savecb",b.appendChild(document.createTextNode("Save layer")),n.append(b),n.appendChild(v);var x=document.createElement("label");x.htmlFor=t.id_prefix+"editcb",x.appendChild(document.createTextNode("Edit layer")),n.append(x),n.appendChild(document.createElement("br")),""==t.id_prefix?(m.checked=!0,m.disabled=!0,v.checked=!1,v.disabled=!0):(m.checked=!0,v.checked=!0),n.appendChild(a),n.appendChild(document.createElement("br")),n.appendChild(s),n.appendChild(document.createElement("br")),n.appendChild(i),n.appendChild(document.createElement("br")),n.appendChild(o);var _=document.createElement("label");_.htmlFor=t.id_prefix+"slicedcb",_.appendChild(document.createTextNode("Sliced")),n.append(_),n.appendChild(r);var w=document.createElement("label");w.htmlFor=t.id_prefix+"tiedcb",w.appendChild(document.createTextNode("Tied")),n.append(w),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(c),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(u),n.appendChild(document.createElement("br")),n.appendChild(f);var S=document.createElement("label");S.htmlFor=t.id_prefix+"hierarchycb",S.appendChild(document.createTextNode("Draw roots low")),n.append(S),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(d),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br"));var E=document.createElement("textarea");E.id=t.id_prefix+"treeinput",E.width="100px";var A=(0,p.button)("Load tree");A.id=t.id_prefix+"treebutton",A.onclick=()=>{C(e)};var k=(0,p.button)("Save tree");k.id=t.id_prefix+"treebutton",k.onclick=()=>{!function(t){var e,n,i=D(t);i&&(e=T(i),(n=(0,h.ro)().parentNode).querySelector("eTree")&&n.removeChild(n.querySelector("eTree")),n.appendChild(e))}(e)};var j=(0,p.button)("Draw tree: ");j.id=t.id_prefix+"treebutton",j.onclick=()=>{I(e)};var M=(0,p.button)("Align tree to selection");M.id=t.id_prefix+"treebutton",M.onclick=()=>{N(e)},n.appendChild(j),n.appendChild(document.createElement("br")),n.appendChild(E),n.appendChild(document.createElement("br")),n.appendChild(M),n.appendChild(document.createElement("br")),n.appendChild(A),n.appendChild(k),t.view_elem.children[0].appendChild(n)}function tt(t){"Shift"===t.key&&$("#layers").addClass("shift-pressed")}function et(t){"Shift"===t.key&&$("#layers").removeClass("shift-pressed")}function nt(t){(0,O.r4)()}function it(t){if(console.debug("Using globals: meta_keys, type_keys"),!(0,R.t)())if("Enter"==t.key);else if(t.key==action_conf.move_relation_to_front){var e=document.elementFromPoint(M,B);"circle"==e.tagName&&(e=e.closest("g")),(0,p.flip_to_bg)(e),e.onmouseout&&e.onmouseout()}else t.key==action_conf.undo?(0,P.FB)():t.key==action_conf.redo?(0,P.VJ)():t.key==action_conf.copy?function(){let t=selected.concat(extraselected);if(0==t.length||!t[0].classList.contains("relation"))return void console.log("No relation selected");let e=t.flatMap((t=>(0,p.relation_get_notes)((0,p.get_by_id)(mei,(0,p.get_id)(t))))),n=(0,p.notes_template)(e);L={template:n,rels:t}}():t.key==action_conf.paste?function(){if(!L)return void console.log("No copy to paste");let t=selected.concat(extraselected);if(1!=t.length||!t[0].classList.contains("note"))return void console.log("Pasting requires selecting a single note, for now.");let e=(0,p.get_by_id)(mei,(0,p.get_id)(t[0])),n=L.template.map((t=>t.p_off));n=n.sort(((t,e)=>t-e));let i=(0,p.notes_in_range)(e,n[0],n[n.length-1],L.template[L.template.length-1].t_off);for(var o of(L.template.forEach((t=>t.n_to=void 0)),i)){let t=(0,p.time_offset)(o,e),n=(0,p.pitch_offset)(o,e);for(var r of L.template)if(t==r.t_off&&n==r.p_off){if(null!=r.n_to)return void console.log("Template mismatch: Found two matching notes: ",r,o);r.n_to=o}}for(var s of L.template)if(null==s.n_to)return void console.log("Template mismatch: No matching note found: ",s);let a=(0,p.draw_context_of)(t[0]);for(var l of(G(t[0]),L.rels)){let t=(0,p.get_by_id)(mei,(0,p.get_id)(l)),[e,n]=(0,p.relation_get_notes_separated)(t);for(let t of e){let e=L.template.find((e=>e.n_from==t));G((0,p.get_by_id)(document,(0,p.id_in_svg)(a,(0,p.get_id)(e.n_to))),!0)}for(let t of n){let e=L.template.find((e=>e.n_from==t));G((0,p.get_by_id)(document,(0,p.id_in_svg)(a,(0,p.get_id)(e.n_to))))}(0,h.i9)(l.getAttribute("type"))}}():t.key==action_conf.reduce_relations?g(j):t.key==action_conf.select_same_notes?((0,p.select_samenote)(),(0,h.i9)("repeat")):t.key==action_conf.naturalize_note?(0,H.naturalize_notes)():t.key==navigation_conf.jump_to_next_bookmark?vt(-1):t.key==navigation_conf.jump_to_previous_bookmark?vt(1):t.key==navigation_conf.jump_to_context_below?bt(1):t.key==navigation_conf.jump_to_context_above?bt(-1):t.key==action_conf.deselect_all?at():t.key==action_conf.delete_all?(0,z.x)():t.key==action_conf.add_bookmark?yt():t.key==custom_conf.relation||t.key==custom_conf.meta_relation?(t.preventDefault(),$("#relations_panel").hasClass("collapsed")&&st()):d.type_keys[t.key]?(0,h.i9)(d.type_keys[t.key]):d.meta_keys[t.key]?(0,h.qG)(d.meta_keys[t.key]):d.combo_keys[t.key]?(0,h.lk)(d.combo_keys[t.key]):t.key==navigation_conf.toggle_palette?st():console.log(t)}function ot(){var t;console.debug("Using globals: non_notes_hidden"),t=q=!q,console.debug("Using globals: document for element selection"),Array.from(document.getElementsByClassName("beam")).forEach((e=>Array.from(e.children).filter((t=>"polygon"==t.tagName)).forEach((e=>e.classList.toggle("hidden",t))))),d.hide_classes.forEach((e=>Array.from(document.getElementsByClassName(e)).forEach((e=>e.classList.toggle("hidden",t))))),q||xt()}function rt(t){var e,n;const i=t.getAttribute("type"),o=null!==(e=null===(n=(t.classList.contains("relation")?V.W3:V.pX).main[i])||void 0===n?void 0:n.color)&&void 0!==e?e:0,r=U.vx.getPropertyValue(`--relation-${o}`);t.setAttribute("color",r)}function st(){$("#relations_panel").hasClass("collapsed")?($("#relations_panel").removeClass("collapsed"),$("#relations_panel input").removeClass("none")):($("#relations_panel").addClass("collapsed"),$("#relations_panel input").addClass("none"))}function at(){selected.forEach((t=>G(t,!1))),extraselected.forEach((t=>G(t,!0)))}function lt(t){var e=(0,h.ro)(),n=(0,h.kg)();at(),$(".relation").remove(),$(".metarelation").remove();var i=Array.from(e.getElementsByTagName("node")),o=i.filter((t=>"relation"==t.getAttribute("type")));i.filter((t=>"metarelation"==t.getAttribute("type"))),n.forEach((t=>{o.forEach((n=>(0,p.unmark_secondaries)(t,e,n)))})),n.hullPadding=t,n.forEach(h.lC),n.forEach((t=>{t.svg_elem.getRootNode().getElementById("hier"+t.id_prefix)&&y(t)}))}function ct(t){var e=0,n=0,i=0,o=0;function r(r){(r=r||window.event).preventDefault(),e=i-r.clientX,n=o-r.clientY,i=r.clientX,o=r.clientY,i>=0&&o>=0&&(t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-e+"px")}function s(){document.onmouseup=null,document.onmousemove=null,"undefined"!=typeof drag_selector&&drag_selector.start()}t.onmousedown=function(t){"INPUT"!==t.target.tagName&&((t=t||window.event).preventDefault(),i=t.clientX,o=t.clientY,document.onmouseup=s,document.onmousemove=r,"undefined"!=typeof drag_selector&&drag_selector.stop())}}function ut(t){window.drag_selector=new(a())({selectables:document.getElementsByClassName("relation"),area:$("#layers")[0],draggability:!1,overflowTolerance:{x:1,y:1},autoScrollSpeed:1e-4}),drag_selector.subscribe("dragstart",(({items:t,event:e,isDragging:n})=>{$(".ds-selector-area").show()})),drag_selector.subscribe("dragmove",(({items:t,event:e,isDragging:n})=>{""!=W||document.getElementById("minimap").classList.contains("dragging")||(($(".ds-selector").height()>10||$(".ds-selector").width()>10)&&($("#metadata_input, #relations_panel, .sidebar, #minimap").fadeOut(300),document.getElementById("layers").style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjJwdCIgaGVpZ2h0PSIyMnB0IiB2aWV3Qm94PSIwIDAgMjIgMjIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjQ0OTIxOSAxNC44MDA3ODEgQyA0LjI2OTUzMSAxNC42MjEwOTQgMy45ODA0NjkgMTQuNjIxMDk0IDMuODAwNzgxIDE0LjgwMDc4MSBDIDMuNjIxMDk0IDE0Ljk4MDQ2OSAzLjYyMTA5NCAxNS4yNjk1MzEgMy44MDA3ODEgMTUuNDQ5MjE5IEMgNS43Njk1MzEgMTcuNDE3OTY5IDUuNzY5NTMxIDE5LjI1IDMuODAwNzgxIDIxLjIxODc1IEMgMy42MjEwOTQgMjEuMzk4NDM4IDMuNjIxMDk0IDIxLjY4NzUgMy44MDA3ODEgMjEuODY3MTg4IEMgMy44OTA2MjUgMjEuOTU3MDMxIDQuMDA3ODEyIDIyIDQuMTI1IDIyIEMgNC4yNDIxODggMjIgNC4zNTkzNzUgMjEuOTU3MDMxIDQuNDQ5MjE5IDIxLjg2NzE4OCBDIDYuNzU3ODEyIDE5LjU1NDY4OCA2Ljc1NzgxMiAxNy4xMTMyODEgNC40NDkyMTkgMTQuODAwNzgxIFogTSA0LjQ0OTIxOSAxNC44MDA3ODEgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjEyNSAxMS45MTc5NjkgQyAzLjExMzI4MSAxMS45MTc5NjkgMi4yOTI5NjkgMTIuNzM4MjgxIDIuMjkyOTY5IDEzLjc1IEMgMi4yOTI5NjkgMTQuNzYxNzE5IDMuMTEzMjgxIDE1LjU4MjAzMSA0LjEyNSAxNS41ODIwMzEgQyA1LjEzNjcxOSAxNS41ODIwMzEgNS45NTcwMzEgMTQuNzYxNzE5IDUuOTU3MDMxIDEzLjc1IEMgNS45NTcwMzEgMTIuNzM4MjgxIDUuMTM2NzE5IDExLjkxNzk2OSA0LjEyNSAxMS45MTc5NjkgWiBNIDQuMTI1IDE0LjY2Nzk2OSBDIDMuNjIxMDk0IDE0LjY2Nzk2OSAzLjIwNzAzMSAxNC4yNTM5MDYgMy4yMDcwMzEgMTMuNzUgQyAzLjIwNzAzMSAxMy4yNDYwOTQgMy42MjEwOTQgMTIuODMyMDMxIDQuMTI1IDEyLjgzMjAzMSBDIDQuNjI4OTA2IDEyLjgzMjAzMSA1LjA0Mjk2OSAxMy4yNDYwOTQgNS4wNDI5NjkgMTMuNzUgQyA1LjA0Mjk2OSAxNC4yNTM5MDYgNC42Mjg5MDYgMTQuNjY3OTY5IDQuMTI1IDE0LjY2Nzk2OSBaIE0gNC4xMjUgMTQuNjY3OTY5ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDAlLDAlLDAlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMjEuNzY1NjI1IDEzLjgwODU5NCBMIDEzLjUxNTYyNSA5LjIyMjY1NiBDIDEzLjM0Mzc1IDkuMTI4OTA2IDEzLjEzNjcxOSA5LjE1MjM0NCAxMi45ODgyODEgOS4yODEyNSBDIDEyLjg0Mzc1IDkuNDEwMTU2IDEyLjc5Mjk2OSA5LjYxMzI4MSAxMi44NjcxODggOS43OTY4NzUgTCAxNi41MzEyNSAxOC45NjA5MzggQyAxNi42MDE1NjIgMTkuMTMyODEyIDE2Ljc2OTUzMSAxOS4yNSAxNi45NTMxMjUgMTkuMjUgQyAxNi45NTMxMjUgMTkuMjUgMTYuOTU3MDMxIDE5LjI1IDE2Ljk1NzAzMSAxOS4yNSBDIDE3LjE0MDYyNSAxOS4yNSAxNy4zMDg1OTQgMTkuMTQwNjI1IDE3LjM3ODkwNiAxOC45NzI2NTYgTCAxOC42ODM1OTQgMTUuOTMzNTk0IEwgMjEuNzIyNjU2IDE0LjYyODkwNiBDIDIxLjg4MjgxMiAxNC41NjI1IDIxLjk4ODI4MSAxNC40MDYyNSAyMiAxNC4yMzA0NjkgQyAyMi4wMDc4MTIgMTQuMDU4NTk0IDIxLjkxNzk2OSAxMy44OTQ1MzEgMjEuNzY1NjI1IDEzLjgwODU5NCBaIE0gMjEuNzY1NjI1IDEzLjgwODU5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYigwJSwwJSwwJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDUuNjY0MDYyIDEyLjc2NTYyNSBDIDUuNTc4MTI1IDEyLjYyODkwNiA1LjQ3MjY1NiAxMi41MDc4MTIgNS4zNTU0NjkgMTIuNDAyMzQ0IEMgNS4zMzk4NDQgMTIuMzg2NzE5IDUuMzI0MjE5IDEyLjM3NSA1LjMwODU5NCAxMi4zNjMyODEgQyA1LjIxMDkzOCAxMi4yNzczNDQgNS4xMDU0NjkgMTIuMjA3MDMxIDQuOTkyMTg4IDEyLjE0NDUzMSBDIDQuOTYwOTM4IDEyLjEyODkwNiA0LjkyOTY4OCAxMi4xMDkzNzUgNC44OTg0MzggMTIuMDkzNzUgQyA0Ljc3MzQzOCAxMi4wMzUxNTYgNC42NDQ1MzEgMTEuOTg4MjgxIDQuNTA3ODEyIDExLjk1NzAzMSBDIDQuNDY4NzUgMTEuOTQ5MjE5IDQuNDI1NzgxIDExLjk0OTIxOSA0LjM4MjgxMiAxMS45NDE0MDYgQyA0LjI2OTUzMSAxMS45MjU3ODEgNC4xNTIzNDQgMTEuOTE3OTY5IDQuMDM5MDYyIDExLjkyNTc4MSBDIDMuNjMyODEyIDExLjk0NTMxMiAzLjI2NTYyNSAxMi4wOTc2NTYgMi45Njg3NSAxMi4zMzU5MzggQyAzLjE5MTQwNiAxMi40OTYwOTQgMy40MTQwNjIgMTIuNjQ4NDM4IDMuNjU2MjUgMTIuNzkyOTY5IEMgMy43NSAxMi44NDc2NTYgMy44NTkzNzUgMTIuODY3MTg4IDMuOTY4NzUgMTIuODUxNTYyIEMgNC4zNDc2NTYgMTIuNzg1MTU2IDQuNzUzOTA2IDEyLjk3NjU2MiA0LjkzNzUgMTMuMzM1OTM4IEMgNC45ODgyODEgMTMuNDMzNTk0IDUuMDcwMzEyIDEzLjUxMTcxOSA1LjE2Nzk2OSAxMy41NTA3ODEgQyA1LjQyMTg3NSAxMy42NTYyNSA1LjY4NzUgMTMuNzM4MjgxIDUuOTQ5MjE5IDEzLjgyODEyNSBDIDUuOTQ5MjE5IDEzLjgwMDc4MSA1Ljk1NzAzMSAxMy43NzczNDQgNS45NTcwMzEgMTMuNzUgQyA1Ljk1NzAzMSAxMy4zODY3MTkgNS44NDc2NTYgMTMuMDUwNzgxIDUuNjY0MDYyIDEyLjc2NTYyNSBaIE0gNS42NjQwNjIgMTIuNzY1NjI1ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDAlLDAlLDAlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMTMuMzgyODEyIDEzLjU1ODU5NCBDIDExLjE5MTQwNiAxMy44OTg0MzggOC44NTkzNzUgMTMuNzUgNi44MDQ2ODggMTMuMTUyMzQ0IEMgNi44NDc2NTYgMTMuMzQzNzUgNi44NzUgMTMuNTQyOTY5IDYuODc1IDEzLjc1IEMgNi44NzUgMTMuODcxMDk0IDYuODU1NDY5IDEzLjk4ODI4MSA2LjgzOTg0NCAxNC4xMDkzNzUgQyA4LjE1NjI1IDE0LjQ2ODc1IDkuNTY2NDA2IDE0LjY2Nzk2OSAxMSAxNC42Njc5NjkgQyAxMS45MjU3ODEgMTQuNjY3OTY5IDEyLjgzOTg0NCAxNC41ODIwMzEgMTMuNzM0Mzc1IDE0LjQyOTY4OCBaIE0gMTMuMzgyODEyIDEzLjU1ODU5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYigwJSwwJSwwJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDExIDAgQyA0LjkzMzU5NCAwIDAgMy4yODkwNjIgMCA3LjMzMjAzMSBDIDAgOC45NDE0MDYgMC44MDQ2ODggMTAuNDkyMTg4IDIuMjM4MjgxIDExLjc1NzgxMiBDIDIuNDY4NzUgMTEuNTM5MDYyIDIuNzM4MjgxIDExLjM1NTQ2OSAzLjAzNTE1NiAxMS4yMjY1NjIgQyAxLjY3OTY4OCAxMC4xMDkzNzUgMC45MTc5NjkgOC43MzgyODEgMC45MTc5NjkgNy4zMzIwMzEgQyAwLjkxNzk2OSAzLjc5Njg3NSA1LjQ0MTQwNiAwLjkxNzk2OSAxMSAwLjkxNzk2OSBDIDE2LjU1ODU5NCAwLjkxNzk2OSAyMS4wODIwMzEgMy43OTY4NzUgMjEuMDgyMDMxIDcuMzMyMDMxIEMgMjEuMDgyMDMxIDguNzUzOTA2IDIwLjM0Mzc1IDEwLjEwMTU2MiAxOC45ODgyODEgMTEuMjE4NzUgTCAxOS44Mzk4NDQgMTEuNjg3NSBDIDIxLjIyNjU2MiAxMC40Mzc1IDIyIDguOTEwMTU2IDIyIDcuMzMyMDMxIEMgMjIgMy4yODkwNjIgMTcuMDY2NDA2IDAgMTEgMCBaIE0gMTEgMCAiLz4KPC9nPgo8L3N2Zz4K), auto"),document.elementsFromPoint(M,B).map((t=>{switch(t.tagName){case"path":return t;case"use":return t.parentElement.parentElement;case"circle":return t.parentElement;default:return!1}})).filter((t=>{if(void 0===t||void 0===t.classList)return!1;var n=e.shiftKey;return t.classList.contains("relation")&&!t.classList.contains("relation--filtered")&&!t.classList.contains("selectedrelation")&&!t.classList.contains("extraselectedrelation")&&!n||t.classList.contains("note")&&!t.classList.contains("selectednote")&&!t.classList.contains("extraselectednote")||t.classList.contains("metarelation")&&!t.classList.contains("selectedrelation")&&!t.classList.contains("extraselectedrelation")&&!n})).forEach(G))})),drag_selector.subscribe("callback",(({items:t,event:e,isDragging:n})=>{document.getElementById("layers").style.cursor="default",$(".ds-selector-area").hide(),$("#metadata_input, #relations_panel, .sidebar, #minimap").fadeIn(300)}))}function dt(){if(null!=M){var t=[document.elementFromPoint(M,B)].map((t=>{if(t)switch(t.tagName){case"path":return t;case"use":return t.parentElement.parentElement;case"circle":return t.parentElement;default:return!1}})).filter((t=>void 0!==t&&void 0!==t.classList&&(t.classList.contains("relation")&&!t.classList.contains("relation--filtered")||t.classList.contains("metarelation"))))[0];(t=t?t.getAttribute("type"):"")?($(".jBox-Mouse").show(),Q.setContent(t)):$(".jBox-Mouse").hide()}}function ht(){void 0!==Q&&Q.destroy(),Q=new(u())("Mouse",{attach:"#layers",trigger:"mouseenter",onPosition:dt})}function pt(t){var e=t.svg_elem,n=t.id_prefix,i=e.getRootNode().getElementById("hier"+n);return(i||!!(i=e.getRootNode().getElementById("tree"+n)))&&(i.parentNode.removeChild(i),!0)}function ft(t,e){var n,i,o,r,s=t.svg_elem,a=s.children[0].getAttribute("height"),l=s.getElementsByClassName("definition-scale")[0].getAttribute("viewBox");t.old_viewbox?([n,i,o,r]=t.old_viewbox.split(" "),a=t.old_height):([n,i,o,r]=l.split(" "),t.old_viewbox=l,t.old_height=a),s.getElementsByClassName("definition-scale")[0].setAttribute("viewBox",[n,Number(i)-e,o,Number(r)+e].join(" "));var c=Number(a.split("p")[0]);s.children[0].setAttribute("height",c*((r-(i-e))/(r-i))+"px")}function gt(){document.getElementById("minimap").width=100,r()(document.querySelector("#minimap"),{viewport:null,styles:{".svg_container":"rgba(0,0,0,0.30)",".layer":"rgba(0,0,0,0.00)"},back:"rgba(0,0,0,0.30)",view:"rgba(0,0,0,0.20)",drag:"rgba(0,0,0,0.30)",interval:null})}window.onmousedown=t=>{var e=document.elementFromPoint(M,B),n=(0,h.kg)().find((t=>t.view_elem.contains(e)));!navigation_conf.switch_context_on_hover&&n&&At(n),(0,p.indicate_current_context)()},window.onmousemove=t=>{M=t.clientX,B=t.clientY;var e=document.elementFromPoint(M,B),n=(0,h.kg)().find((t=>t.view_elem.contains(e)));navigation_conf.switch_context_on_hover&&n&&At(n),(0,p.indicate_current_context)(),""!=W&&(0,O.TU)()},document.getElementById("relations_panel_toggle").addEventListener("click",st);var mt=[];function yt(){if(!X)return!1;if(!X.classList.contains("note"))return!1;var t=X,e=document.createElementNS("http://www.w3.org/2000/svg","rect"),n=j.id_prefix?j.id_prefix:"0";e.dataset.draw_context=n,e.classList.add("bookmark"),e.setAttribute("fill","red"),e.setAttribute("width","500px"),e.setAttribute("height","1500px"),e.setAttribute("transform","translate(-120 -750)"),e.setAttribute("x",t.children[0].children[0].getAttribute("x")),e.setAttribute("y",t.children[0].children[0].getAttribute("y")),$(j.svg_elem).find(".page-margin")[0].prepend(e),mt.push(e),mt.sort((function(t,e){return t.getAttribute("x")-e.getAttribute("x")}))}function vt(t=1){var e=Tt();if(e){var n=e.id_prefix?e.id_prefix:"0",i=mt.filter((t=>t.dataset.draw_context==n)),o=i.map((t=>t.getBoundingClientRect().x)),r=o.findIndex((t=>t>=window.innerWidth)),s=o.filter((t=>t<=0)).length-1;if(1==t&&-1!=r)var a=i[r];else{if(-1!=t||-1==s)return!1;a=i[s]}a.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}}function bt(t=1){var e,n=(0,h.kg)().sort(((t,e)=>t.view_elem.getBoundingClientRect().y-e.view_elem.getBoundingClientRect().y)),i=n.map((t=>t.view_elem.getBoundingClientRect().y)),o=n.map((t=>t.view_elem.getBoundingClientRect().bottom));if(1==t)e=o.findIndex((t=>t>window.innerHeight));else{if(-1!=t)return!1;e=i.filter((t=>t<0)).length-1}-1!=e&&n[e].view_elem.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}function xt(){Array.from(document.querySelectorAll("g.note")).forEach((t=>t.classList.remove("hidden")))}function _t(){var t,e,n;(K=!K)?xt():(t=(0,h.ro)(),e=Array.from(document.getElementsByClassName("note")).map((t=>t.id)),n=Array.from(t.getElementsByTagName("arc")).map((t=>t.getAttribute("to"))),e.forEach((t=>{var e=t.replace(/(^\d+-?)/,"");n.includes(`#gn-${e}`)||document.getElementById(t).classList.add("hidden")})))}document.getElementById("addbookmarkbutton").addEventListener("click",yt),document.getElementById("previousbookmarkbutton").addEventListener("click",(()=>vt(-1))),document.getElementById("nextbookmarkbutton").addEventListener("click",(()=>vt(1))),document.getElementById("previouscontextbutton").addEventListener("click",(()=>bt(-1))),document.getElementById("nextcontextbutton").addEventListener("click",(()=>bt(1)));const wt=()=>Q,St=()=>W,Et=t=>W=t,Tt=()=>j,At=t=>j=t},922:(t,e,n)=>{"use strict";n.d(e,{FB:()=>l,I$:()=>c,VJ:()=>u});var i=n(343),o=n(138),r=n(854),s=n(819),a=n(10);function l(){console.debug("Using globals: undo_actions, selected, extraselected, mei, rerendered_after_action");var t=(0,i.tu)();if(0==t.length)return void console.log("Nothing to undo");if(t.length==(0,i.jA)())return console.log("Cannot undo past a rerender"),void alert("Cannot undo past a rerender.");selected.forEach((t=>(0,s.dB)(t,!1))),extraselected.forEach((t=>(0,s.dB)(t,!0)));var e=(0,i.kg)(),n=(0,i.LO)();const[o,r,l,c]=t.pop();if("edges"==o||"relation"==o||"metarelation"==o){var u=r;let t,d,h=u.flat().find((t=>"node"==t.tagName&&t.getAttribute("type")==o));if(!h)return void console.log("Could not find graph element of (meta)relation to undo: ",r);if(t=h.getAttribute("xml:id"),h.children.length>0&&(d=h.children[0].getAttribute("type")),"relation"==o)for(const t of e)(0,a.unmark_secondaries)(t,(0,i.ro)(),h);u.flat().forEach((t=>{(0,a.node_referred_to)(t.getAttribute("xml:id"))||t.parentNode.removeChild(t)})),Array.from(document.querySelectorAll('[oldid="'+t+'"]')).forEach((t=>t.parentNode.removeChild(t))),l.forEach((t=>(0,s.dB)(document.getElementById(t.id),!1))),c.forEach((t=>(0,s.dB)(document.getElementById(t.id),!0))),n.push([o,[d,t],l,c])}else if("delete relation"==o)r.forEach((t=>{t[1].insertBefore(t[0],t[2]);let n=e.find((e=>e.svg_elem.contains(t[0]))),o="relation"==(0,a.get_class_from_classlist)(t[0]);if(n&&o){let e=(0,a.get_id)(t[0]),o=(0,a.get_by_id)(mei,e);(0,a.mark_secondaries)(n,(0,i.ro)(),o)}})),l.forEach((t=>(0,s.dB)(t,!1))),c.forEach((t=>(0,s.dB)(t,!0))),n.push([o,[],l,c]);else if("change relation type"==o){var h=r;let t=r[0][1];l.concat(c).forEach((t=>{var[e,n]=h.pop(),i=(0,a.id_or_oldid)(t),o=[(0,a.get_by_id)(document,i)].concat((0,a.get_by_oldid)(document,i));o.forEach((t=>t.setAttribute("type",e))),(0,a.get_by_id)(mei,i).getElementsByTagName("label")[0].setAttribute("type",e),o.forEach(s.up)})),l.forEach((t=>(0,s.dB)(t,!1))),c.forEach((t=>(0,s.dB)(t,!0))),n.push([o,t,l,c])}else if("add note"==o){var[p,f]=r;f.forEach((t=>t.parentNode.removeChild(t)));let t=p[0].getAttribute("pname"),e=p[0].getAttribute("oct"),i=p[0].getAttribute("xml:id"),s=l[0];if(p[0].parentNode.removeChild(p[0]),p.length>1){var g=p[1];g.parentNode.insertBefore(g.children[0],g),g.parentNode.removeChild(g)}n.push([o,[t,e,s,i],l,c])}(0,s.e6)(),d()}function c(){(0,i.Ln)([]),d()}function u(){var t=(0,i.LO)();if(0==t.length)return void console.log("Nothing to redo");selected.forEach((t=>(0,s.dB)(t,!1))),extraselected.forEach((t=>(0,s.dB)(t,!0)));const[e,n,a,l]=t.pop();let c,u;switch(a.forEach((t=>(0,s.dB)(document.getElementById(t.id),!1))),l.forEach((t=>(0,s.dB)(document.getElementById(t.id),!0))),e){case"relation":[c,u]=n,(0,i.i9)(c,u,!0);break;case"metarelation":[c,u]=n,(0,i.qG)(c,u,!0);break;case"change relation type":c=n,(0,i.i9)(c,"",!0);break;case"delete relation":(0,r.x)(!0);break;case"add note":let[t,e,l,d]=n;(0,o.f5)(t,e,l,d,!0),(0,s.dB)(a[0])}d()}function d(){document.dispatchEvent(new CustomEvent("undoredo",{detail:{redoAbleCount:(0,i.LO)().length,undoAbleCount:(0,i.tu)().length}}))}},10:(t,e,n)=>{"use strict";function i(t,e){return t[0]-e[0]||t[1]-e[1]}function o(t){const e=t.length,n=[0,1];let i,o=2;for(i=2;i<e;++i){for(;o>1&&(r=t[n[o-2]],s=t[n[o-1]],a=t[i],(s[0]-r[0])*(a[1]-r[1])-(s[1]-r[1])*(a[0]-r[0])<=0);)--o;n[o++]=i}var r,s,a;return n.slice(0,o)}n.r(e),n.d(e,{add_mei_node_for:()=>W,add_to_svg_bg:()=>x,average:()=>nt,average2:()=>z,button:()=>yt,check_for_duplicate_relations:()=>xt,checkbox:()=>mt,chord_to_space:()=>ut,circle:()=>g,clone_mei:()=>ht,draw_context_of:()=>_t,fix_synonyms:()=>rt,flip_to_bg:()=>b,g:()=>_,get_by_id:()=>N,get_by_oldid:()=>D,get_class_from_classlist:()=>tt,get_id:()=>j,get_id_pairs:()=>pt,get_metarelation_target:()=>et,hide_he:()=>Q,hide_he_hier:()=>X,hide_note:()=>F,hide_note_hier:()=>Y,id_in_svg:()=>M,id_or_oldid:()=>I,indicate_current_context:()=>vt,line:()=>f,mark_secondaries:()=>K,mod:()=>O,new_layer_element:()=>ft,new_view_elements:()=>gt,next_measure:()=>k,node_referred_to:()=>B,node_to_note_id:()=>L,note_coords:()=>C,note_to_chord:()=>ct,note_to_rest:()=>at,note_to_space:()=>lt,note_to_text:()=>it,notes_in_range:()=>A,notes_template:()=>T,pitch_offset:()=>S,prefix_ids:()=>dt,random_id:()=>w,rect:()=>m,relation_allnodes:()=>R,relation_get_notes:()=>P,relation_get_notes_separated:()=>H,relation_primaries:()=>U,relation_secondaries:()=>V,relation_type:()=>q,roundedHull:()=>p,sanitize_xml:()=>bt,select_samenote:()=>J,text:()=>y,time_offset:()=>E,to_text:()=>ot,tspan:()=>v,unmark_secondaries:()=>G});var r=n(343),s=n(748),a=n(819),l=function(t,e){return[t*e[0],t*e[1]]},c=function(t,e){return[t[0]+e[0],t[1]+e[1]]},u=function(t,e){var n=[t[1]-e[1],e[0]-t[0]],i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);return[n[0]/i,n[1]/i]},d=function(t,e){const n=[t[0][0],t[0][1]-e];return`M ${n} A `+[e,e,"0,0,0",[t[0][0],parseInt(t[0][1])+parseInt(e)]].join(",")+" A "+[e,e,"0,0,0",n].join(",")},h=function(t,e){var n=l(e,u(t[0],t[1])),i=l(-1,n),o=c(t[0],n),r=c(t[1],n),s=c(t[1],i),a=c(t[0],i);return`M ${o} L ${r} A `+[e,e,"0,0,0",s].join(",")+` L ${a} A `+[e,e,"0,0,0",o].join(",")};function p(t){var e=(0,r.kg)().hullPadding||200,n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.style.setProperty("--shade-alternate",function(){const t="456789AB";let e="#";for(let n=0;n<6;n++)e+=t[Math.floor(Math.random()*t.length)];return e}()),1==t.length?n.setAttribute("d",d(t,e)):2==t.length?n.setAttribute("d",h(t,e)):n.setAttribute("d",function(t,e){if(!t||t.length<1)return"";if(1===t.length)return d(t,e);if(2===t.length)return h(t,e);for(var n=new Array(t.length),i=0;i<n.length;++i){var o=0===i?t[t.length-1]:t[i-1],r=t[i],s=l(e,u(o,r));n[i]=[c(o,s),c(r,s)]}var a="A "+[e,e,"0,0,0,"].join(",");return(n=n.map((function(t,e){var i="";return 0===e&&(i="M "+n[n.length-1][1]+" "),i+(a+t[0]+" L ")+t[1]}))).join(" ")}(function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),s=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(i),e=0;e<n;++e)s[e]=[r[e][0],-r[e][1]];var a=o(r),l=o(s),c=l[0]===a[0],u=l[l.length-1]===a[a.length-1],d=[];for(e=a.length-1;e>=0;--e)d.push(t[r[a[e]][2]]);for(e=+c;e<l.length-u;++e)d.push(t[r[l[e]][2]]);return d}(t),e)),n}function f(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1",t[0]),n.setAttribute("y1",t[1]),n.setAttribute("x2",e[0]),n.setAttribute("y2",e[1]),n.style.stroke="#000",n.style.strokeWidth="15px",n}function g(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","circle");return n.setAttribute("cx",t[0]),n.setAttribute("cy",t[1]),n.setAttribute("r",e),n.style.stroke="#000",n.style.strokeWidth="15px",n}function m(t,e,n){var i=document.createElementNS("http://www.w3.org/2000/svg","rect");return i.setAttribute("x",t[0]),i.setAttribute("y",t[1]),i.setAttribute("width",e),i.setAttribute("height",n),i.style.stroke="#000",i.style.fill="white",i.style.strokeWidth="15px",i}function y(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","text");return e&&(n.setAttribute("x",e[0]),n.setAttribute("y",e[1])),n.append(t),n}function v(t,e,n,i=0){var o=document.createElementNS("http://www.w3.org/2000/svg","tspan");return o.setAttribute("x",e[0]),o.setAttribute("dx",i),o.setAttribute("dy",n),o.append(t),o}function b(t){var e=(0,a.gB)();t.parentElement.prepend(t),e.close(),e.open()}function x(t,e){var n=t.getElementsByClassName("system")[0];n.parentNode.insertBefore(e,n)}function _(){return document.createElementNS("http://www.w3.org/2000/svg","g")}function w(t=5){return Math.floor(Math.random()*(1<<4*t)).toString(16)}function S(t,e){var n=(0,r.DR)();return n.getMIDIValuesForElement(j(t)).pitch-n.getMIDIValuesForElement(j(e)).pitch}function E(t,e){var n=(0,r.DR)();return n.getMIDIValuesForElement(j(t)).time-n.getMIDIValuesForElement(j(e)).time}function T(t){var e=t;return(e=(e=e.sort(S)).sort(E)).map((t=>({p_off:S(t,e[0]),t_off:E(t,e[0]),n_from:t})))}function A(t,e,n,i){for(var o=t.closest("measure"),r=[];o;){let s=!0,a=o.querySelectorAll("note");for(let o of a){let a=E(o,t);if(a>=0&&a<=i){console.log("in time");let i=S(o,t);i>=e&&i<=n&&(console.log("in pitch"),s=!1,r.push(o))}}o=s?null:k(o)}return r}function k(t){return t.nextElementSibling&&"measure"==t.nextElementSibling.tagName?t.nextElementSibling:t.nextElementSibling?k(t.nextElementSibling):null}function C(t){return[t.getElementsByTagName("use")[0].x.animVal.value+100,t.getElementsByTagName("use")[0].y.animVal.value]}function D(t,e){"#"==e[0]&&(e=e.slice(1));var n=t.querySelectorAll("[*|oldid='"+e+"']");return n?Array.from(n):Array.from(t.all).find((t=>t.getAttribute("oldid")==e))}function N(t,e){return e?("#"==e[0]&&(e=e.slice(1)),t.querySelector("[*|id='"+e+"']")||Array.from(t.getElementsByTagName("*")).find((t=>t.getAttribute("id")==e||t.getAttribute("xml:id")==e))):null}const I=t=>{var e;return null!==(e=t.getAttribute("oldid"))&&void 0!==e?e:t.id};function j(t){if(document.contains(t))return t.hasAttribute("oldid")?j(document.getElementById(t.getAttribute("oldid"))):t.id;if(t.hasAttribute("xml:id")){if(t.hasAttribute("sameas"))return j(N(mei,t.getAttribute("sameas")));if(t.hasAttribute("corresp"))return j(N(mei,t.getAttribute("corresp")));if(t.hasAttribute("copyof"))return j(N(mei,t.getAttribute("copyof")));if(t.hasAttribute("xml:id"))return t.getAttribute("xml:id")}}function M(t,e){if(e){"#"==e[0]&&(e=e.slice(1));var n=function(t,e){"#"==e[0]&&(e=e.slice(1));var n=t.id_mapping.find((t=>t[1]==e));return n?n[0]:e}(t.layer,e),i=document.getElementById(n);return t.svg_elem.contains(i)?n:n?t.id_prefix+n:void 0}}function B(t){return console.debug("Using global: mei to find element"),Array.from(mei.getElementsByTagName("arc")).filter((e=>e.getAttribute("from")=="#"+t||e.getAttribute("to")=="#"+t)).length>0}function L(t){return 0==t.getElementsByTagName("label")[0].children.length?t.getAttribute("xml:id"):t.getElementsByTagName("label")[0].getElementsByTagName("note")[0].getAttribute("sameas").replace("#","")}function O(t,e){return(t%e+e)%e}function z(t,e){return(t+e)/2}function P(t){return R((0,r.ro)(),t=N(mei,j(t))).map(L).map((t=>N(mei,t)))}function H(t){var e=(0,r.ro)();return[U(e,t=N(mei,j(t))).map(L).map((t=>N(mei,t))),V(e,t).map(L).map((t=>N(mei,t)))]}function R(t,e){var n=Array.from(t.getElementsByTagName("arc")),i=[];return n.forEach((n=>{n.getAttribute("from")=="#"+e.getAttribute("xml:id")&&i.push(N(t.getRootNode(),n.getAttribute("to")))})),i}function U(t,e){var n=Array.from(t.getElementsByTagName("arc")),i=[];return n.forEach((n=>{n.getAttribute("from")=="#"+e.getAttribute("xml:id")&&"primary"==n.getAttribute("type")&&i.push(N(t.getRootNode(),n.getAttribute("to")))})),i}function V(t,e){var n=Array.from(t.getElementsByTagName("arc")),i=[];return n.forEach((n=>{n.getAttribute("from")=="#"+e.getAttribute("xml:id")&&"secondary"==n.getAttribute("type")&&i.push(N(t.getRootNode(),n.getAttribute("to")))})),i}function q(t){return 0==t.children.length?"":t.children[0].getAttribute("type")}function W(t,e){var n=j(e),i=j(N(mei,n)),o=N(t.getRootNode(),"gn-"+i);if(null!=o)return o;o=t.getRootNode().createElement("node");var r=t.getRootNode().createElement("label");return(e=t.getRootNode().createElement("note")).setAttribute("sameas","#"+i),o.appendChild(r),r.appendChild(e),o.setAttribute("xml:id","gn-"+i),t.appendChild(o),o}function F(t,e){var n=N(t.svg_elem.getRootNode(),M(t,L(e)));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function Y(t,e){var n=N(t.svg_elem.getRootNode(),"hier"+M(t,L(e)));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function Q(t,e){var n=N(t.svg_elem.getRootNode(),t.id_prefix+e.getAttribute("xml:id"));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function X(t,e){var n=N(t.svg_elem.getRootNode(),"hier"+t.id_prefix+e.getAttribute("xml:id"));return n&&t.svg_elem.contains(n)&&n.classList.add("hidden"),n}function K(t,e,n){t.svg_elem,"node"!=n.tagName&&(n=N(e.getRootNode(),n.id)),V(e,n).forEach((e=>{!function(t){if(t)if(t.classList.contains("secondarynote")){var e=getComputedStyle(t).getPropertyValue("--how-secondary");t.style.setProperty("--how-secondary",2*e)}else t.classList.add("secondarynote"),t.style.setProperty("--how-secondary",2);else console.log("Not a note")}(document.getElementById(M(t,L(e))))}))}function G(t,e,n){t.svg_elem,"node"!=n.tagName&&(n=N(e.getRootNode(),n.id)),V(e,n).forEach((e=>{!function(t){if(t){var e=getComputedStyle(t).getPropertyValue("--how-secondary");t.style.setProperty("--how-secondary",e/2),e/2==1&&t.classList.remove("secondarynote")}else console.log("Not a note")}(document.getElementById(M(t,L(e))))}))}function Z(t){return"measure"==t.tagName?t:Z(t.parentElement)}function J(){if(console.debug("Using globals: document, mei to find elems"),!(1!=selected.length&&1!=extraselected.length||1==selected.length&&1==extraselected.length)){var t;t=1==selected.length?selected[0]:extraselected[0];var e=N(mei,t.getAttribute("id")),n=Z(e);Array.from(n.getElementsByTagName("note")).forEach((t=>{t.getAttribute("oct")==e.getAttribute("oct")&&t.getAttribute("pname")==e.getAttribute("pname")&&(0,a.dB)(N(document,t.getAttribute("xml:id")))})),(0,a.dB)(t,!0)}}function tt(t){return void 0!==t&&(t.classList.contains("note")?"note":t.classList.contains("relation")?"relation":t.classList.contains("metarelation")?"metarelation":"")}function et(t){if(t.classList.contains("metarelation")){var e=t.getElementsByTagName("circle")[0];return[e.cx.baseVal.value,e.cy.baseVal.value]}return t.classList.contains("relation")?function(t){var e=t.getBBox();return[e.x+e.width/2,e.y+e.height/2]}(t):(console.log("wtf"),console.log(t),[0,0])}function nt(t){return t.reduce(((t,e)=>t+e),0)/t.length}function it(t){var e=N(mei,t);if("node"==e.tagName)return e.children[0].getAttribute("type");var n=function(t){if(console.debug("Using globals: document, mei to find element"),document.contains(t)&&(t=N(mei,j(t))),t.hasAttribute("accid.ges"))return t.getAttribute("accid.ges");if(t.hasAttribute("accid"))return t.getAttribute("accid");if(0==t.children.length)return"";var e=t.getElementsByTagName("accid");if(0==e.length)return"";var n=e[0];return n.hasAttribute("accid.ges")?n.getAttribute("accid.ges"):n.hasAttribute("accid")?n.getAttribute("accid"):""}(e);return n=(n=(n=n.replace(/s/g,"#")).replace(/f/g,"b")).replace(/n/g,""),e.getAttribute("pname")+n+e.getAttribute("oct")}function ot(t){return 0==t.length?"":t[0].classList.contains("note")?(t.sort(((t,e)=>{const[n,i]=C(t),[o,r]=C(e);return n-o==0?r-i:n-o})),t.map((t=>it(j(t))))):void 0}function rt(t){return Array.from(t.getElementsByTagName("node")).forEach((t=>{"hyperedge"==t.getAttribute("type")&&t.setAttribute("type","relation"),"metaedge"==t.getAttribute("type")&&t.setAttribute("type","metarelation")})),t}var st=["dur","n","dots","when","layer","staff","tstamp.ges","tstamp.real","tstamp","loc","dur.ges","dots.ges","dur.metrical","dur.ppq","dur.real","dur.recip","beam","fermata","tuplet"];function at(t,e){var n=t.createElementNS("http://www.music-encoding.org/ns/mei","rest");n.setAttribute("xml:id","rest-"+e.getAttribute("xml:id"));for(let t of st)e.hasAttribute(t)&&n.setAttribute(t,e.getAttribute(t));return n}function lt(t,e){var n=t.createElementNS("http://www.music-encoding.org/ns/mei","space");n.setAttribute("xml:id","space-"+e.getAttribute("xml:id"));for(let t of st)e.hasAttribute(t)&&n.setAttribute(t,e.getAttribute(t));return n}function ct(t,e){var n=t.createElementNS("http://www.music-encoding.org/ns/mei","chord");n.setAttribute("xml:id","chord-"+e.getAttribute("xml:id"));for(const t of st)e.hasAttribute(t)&&n.setAttribute(t,e.getAttribute(t));return n}function ut(t,e){var n=t.createElementNS("http://www.music-encoding.org/ns/mei","space");n.setAttribute("xml:id","space-"+e.getAttribute("xml:id"));for(let t of st)e.hasAttribute(t)&&n.setAttribute(t,e.getAttribute(t));return n}function dt(t,e){t.id&&(t.setAttribute("oldid",t.id),t.id=e+t.id),t.getAttribute("xml:id")&&t.setAttribute("xml:id",e+t.getAttribute("xml:id")),t.getAttribute("startid")&&t.setAttribute("startid",e+t.getAttribute("startid")),t.getAttribute("endid")&&t.setAttribute("endid",e+t.getAttribute("endid")),Array.from(t.children).forEach((t=>dt(t,e)))}function ht(t){var e=t.implementation.createDocument(t.namespaceURI,null,null),n=e.importNode(t.documentElement,!0);return e.appendChild(n),e}function pt(t){var e;return t.id?e=[t.id,j(t)]:t.hasAttribute("xml:id")&&(e=[t.getAttribute("xml:id"),j(t)]),e?[e].concat(Array.from(t.children).flatMap(pt)):Array.from(t.children).flatMap(pt)}function ft(){var t=document.getElementById("layers"),e=document.createElement("div");return e.id="layer"+t.children.length,e.classList.add("layer"),t.appendChild(e),e}function gt(t){var e=(0,r.kg)(),n=document.createElement("div");n.id="view"+e.length,n.classList.add("view");var i=document.createElement("div");return i.id="svg"+e.length,i.classList.add("svg_container"),n.appendChild(i),t.appendChild(n),[n,i]}function mt(t){var e=document.createElement("input");return e.setAttribute("type","checkbox"),e.setAttribute("value",t),e}function yt(t){var e=document.createElement("input");return e.setAttribute("type","button"),e.setAttribute("value",t),e}function vt(){var t=(0,a.c)();void 0!==t&&($(".view").removeClass("view--active"),t.view_elem.classList.add("view--active"),$(".sidebar").removeClass("sidebar_active"),t.view_elem.children[0].classList.add("sidebar_active"))}function bt(t){var e=t;return s.strip_xml_tags.forEach((e=>{Array.from(t.getElementsByTagName(e)).forEach((t=>{t.parentNode.removeChild(t)}))})),e}function xt(t,e,n){var i=(0,r.ro)(),o=e.map((t=>t.getAttribute("id").replace(/(^\d+-?)/,"gn-"))).sort(((t,e)=>t<e)),s=n.map((t=>t.getAttribute("id").replace(/(^\d+-?)/,"gn-"))).sort(((t,e)=>t<e));return Array.from(i.querySelectorAll("[type='relation']")).filter((e=>e.children[0].getAttribute("type")==t)).forEach((t=>{var e=H(t),n=e[0],i=e[1];if(n=n.map((t=>t.getAttribute("xml:id"))).sort(((t,e)=>t<e)),i=i.map((t=>t.getAttribute("xml:id"))).sort(((t,e)=>t<e)),JSON.stringify(o)==JSON.stringify(n)&&JSON.stringify(s)==JSON.stringify(i))return alert("Warning: This relation already exists.\nCreating a duplicate anyway."),!1})),!0}function _t(t){var e=(0,r.kg)().filter((e=>e.svg_elem.contains(t)));return 0==e.length?null:e[0]}},501:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t,e,n){return c=l()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&a(o,n.prototype),o},c.apply(null,arguments)}function u(t){var e="function"==typeof Map?new Map:void 0;return u=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return c(t,arguments,s(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),a(i,t)},u(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?d(t):e}function p(t){var e=l();return function(){var n,i=s(t);if(e){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return h(this,n)}}function f(t,e,n){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},f(t,e,n||t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var b=function(t,e,n){var i=t.x,o=t.y,r=n.x,s=n.y;return{"+":{x:i+r,y:o+s},"-":{x:i-r,y:o-s},"*":{x:i*r,y:o*s},"/":{x:i/r,y:o/s}}[e]},x=function(t){return{x:t.left,y:t.top}},_=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{left:t.x,top:t.y,right:t.x,bottom:t.y,width:e,height:e}},w=function(){var t,e,n,i;return{y:(null===(t=document.body)||void 0===t?void 0:t.scrollTop)||(null===(e=document.documentElement)||void 0===e?void 0:e.scrollTop)||0,x:(null===(n=document.body)||void 0===n?void 0:n.scrollLeft)||(null===(i=document.documentElement)||void 0===i?void 0:i.scrollLeft)||0}},S=function(t){return!t||t instanceof Document?w():{x:t.scrollLeft>=0?t.scrollLeft:w().x,y:t.scrollTop>=0?t.scrollTop:w().y}},E=function(t){var e=t.elementRect,n=t.containerRect,i=t.tolerance,o=void 0===i?{x:0,y:0}:i,r=[];return e.top-o.y<n.top&&r.push("top"),e.left-o.x<n.left&&r.push("left"),e.bottom+o.y>n.bottom&&r.push("bottom"),e.right+o.y>n.right&&r.push("right"),r},T=function(t){var e=t.event;return{x:e.clientX,y:e.clientY}},A=function(t){var e={x:0,y:0},n=window.getComputedStyle(t);if(!n.transform||"none"===n.transform)return e;if(n.transform.indexOf("3d")>=0){var i=n.transform.trim().match(/matrix3d\((.*?)\)/);if(i&&i.length){var o,r=null===(o=i[1])||void 0===o?void 0:o.split(",");e.x=parseInt(r[12])||0,e.y=parseInt(r[13])||0}return e}var s=n.transform.trim().match(/matrix\((.*?)\)/);if(s&&s.length){var a,l=null===(a=s[1])||void 0===a?void 0:a.split(",");e.x=parseInt(l[4])||0,e.y=parseInt(l[5])||0}return e},k=function(t,e){return e?function(t){var e=t.style.transform;if(!e||e.indexOf("translate")<0)return A(t);var n={x:0,y:0},i=e.trim().match(/translate[3dD]*?\(.*?\)/);if(i){var o,r=null===(o=i[0])||void 0===o?void 0:o.split("(");if(r){var s,a=null===(s=r[1])||void 0===s?void 0:s.split(",");n.x=parseInt(a[0])||0,n.y=parseInt(a[1])||0}}return n.x||n.x?n:A(t)}(t):function(t){var e=t.style,n={x:parseInt(e.left)||0,y:parseInt(e.top)||0};if(!n.x&&!n.x){var i=window.getComputedStyle(t);return{x:parseInt(i.left)||0,y:parseInt(i.top)||0}}return n}(t)},C=function(t){var e=t.computedStyle,n=t.node,i=e.position;n instanceof HTMLDocument||"absolute"===i||"relative"===i||"fixed"===i||(n.style.position="relative")},D=function(t,e){return t.left<e.right&&t.right>e.left&&t.top<e.bottom&&t.bottom>e.top},N=function(t){var e=t.element,n=t.posDirection,i=t.containerRect,o=t.useTransform,r=k(e,o),s=b(r,"+",n);I(e,s,o);var a=e.getBoundingClientRect();!function(t){var e=t.element,n=t.edges,i=t.elementRect,o=t.containerRect,r=t.elementPos,s=t.useTransform;n.includes("top")&&I(e,{y:r.y+o.top-i.top,x:r.x},s),n.includes("left")&&I(e,{y:r.y,x:r.x+o.left-i.left},s),n.includes("bottom")&&I(e,{y:r.y+o.bottom-i.bottom,x:r.x},s),n.includes("right")&&I(e,{y:r.y,x:r.x+o.right-i.right},s)}({element:e,edges:E({elementRect:a,containerRect:i}),elementRect:a,containerRect:i,elementPos:s,useTransform:o})},I=function(t,e,n){if(n){var i=t.style.transform;t.style.transform="translate3d(".concat(e.x,"px,").concat(e.y,"px,1px) ").concat(i.replace(/translate.*?\)/g,""))}else t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px");return t},j=function(t){for(var e=t.subscribe,n=t.publish,r=t.Interaction,s=t.SelectedSet,a=function(){var t=g(c[l],2),a=t[0],u=t[1];["pre",!1].forEach((function(t){return e(t?"".concat(a,":").concat(t):a,(function(e){return u.forEach((function(a){return(!a.condition||a.condition(e))&&n(t?"".concat(t).concat(a.name):a.name,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({items:s.elements,isDragging:r.isDragging},e))}))}))}))},l=0,c=Object.entries({"Selected:added":[{name:"elementselect"}],"Selected:removed":[{name:"elementunselect"}],"Area:scroll":[{name:"autoscroll"}],"Interaction:start":[{name:"dragstart"}],"Interaction:update":[{name:"dragmove",condition:function(t){return t.event}}],"Interaction:end":[{name:"callback"}],"Drag:keyboardDrag":[{name:"dragstart"},{name:"dragmove"}]});l<c.length;l++)a()},M=function(t){return t?!Array.isArray(t)&&(t instanceof HTMLElement||t instanceof SVGElement)?[t]:m(t):[]},B=function(t,e){t.style.left="".concat(e.left,"px"),t.style.top="".concat(e.top,"px"),t.style.width="".concat(e.width,"px"),t.style.height="".concat(e.height,"px")},L=function(){function e(n){var o,r,s,a=this,l=n.area,c=n.PS,u=n.zoom;t(this,e),i(this,"_modificationCallback",void 0),i(this,"_modificationObserver",void 0),i(this,"_zoom",void 0),i(this,"_node",void 0),i(this,"_parentNodes",void 0),i(this,"_computedStyle",void 0),i(this,"_computedBorder",void 0),i(this,"_rect",void 0),i(this,"start",(function(){var t,e,n;t=a.parentNodes,e=a._modificationCallback,n=a._modificationObserver,window.addEventListener("resize",e),window.addEventListener("scroll",e),t.forEach((function(t,e){n.observe(t,{childList:0!==e,attributes:!0})}))})),i(this,"reset",(function(){a._computedStyle=void 0,a._rect=void 0,a._computedBorder=void 0,a._parentNodes=void 0})),i(this,"stop",(function(){var t,e;t=a._modificationObserver,e=a._modificationCallback,window.removeEventListener("resize",e),window.removeEventListener("scroll",e),t.disconnect(),a.reset()})),i(this,"scroll",(function(t,e){(function(t,e,n){if(e.length){var i=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,o=t instanceof HTMLDocument?i||document.body:t,r=e.includes("top")&&o.scrollTop>0,s=e.includes("bottom")&&o.scrollTop<o.scrollHeight,a=e.includes("left")&&o.scrollLeft>0,l=e.includes("right")&&o.scrollLeft<o.scrollWidth;r&&(o.scrollTop-=1*n),s&&(o.scrollTop+=1*n),a&&(o.scrollLeft-=1*n),l&&(o.scrollLeft+=1*n)}})(a._node,t,e),a.PubSub.publish("Area:scroll",{scroll_directions:t,scroll_multiplier:e})})),this._node=l,this._zoom=u,this.PubSub=c,C({computedStyle:this.computedStyle,node:this._node}),this._modificationCallback=(o=function(t){a.reset(),a.PubSub.publish("Area:modified",{event:t,item:a})},r=60,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=function(){s=null,o.apply(void 0,e)};clearTimeout(s),s=setTimeout(i,r)}),this._modificationObserver=new MutationObserver(this._modificationCallback),setTimeout((function(){a.reset(),a.PubSub.publish("Area:modified",{event,item:a})})),this.PubSub.subscribe("Interaction:init",this.start),this.PubSub.subscribe("Interaction:end",this.reset)}return n(e,[{key:"HTMLNode",get:function(){return this._node}},{key:"computedBorder",get:function(){return this._computedBorder?this._computedBorder:{top:parseInt(this.computedStyle.borderTopWidth),bottom:parseInt(this.computedStyle.borderBottomWidth),left:parseInt(this.computedStyle.borderLeftWidth),right:parseInt(this.computedStyle.borderRightWidth)}}},{key:"computedStyle",get:function(){return this._computedStyle?this._computedStyle:this.HTMLNode instanceof HTMLDocument?this._computedStyle=window.getComputedStyle(this.HTMLNode.body||this.HTMLNode.documentElement):this._computedStyle=window.getComputedStyle(this.HTMLNode)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=function(t,e){if(t instanceof Document)return{top:0,left:0,bottom:0,right:0,width:window.innerWidth,height:window.innerHeight};var n=t.getBoundingClientRect();return{top:n.top,left:n.left,bottom:n.bottom,right:n.right,width:(t.clientWidth||n.width)*e,height:(t.clientHeight||n.height)*e}}(this.HTMLNode,this._zoom)}},{key:"parentNodes",get:function(){if(this._parentNodes)return this._parentNodes;return this._parentNodes=function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=null===(n=e[i])||void 0===n?void 0:n.parentNode;return o?(e.push(o),t(e,++i)):e}([this.HTMLNode]),this._parentNodes}}]),e}(),O=function(){function e(n){var o=this,r=n.DS,s=n.dragKeys,a=n.draggability,l=n.keyboardDrag,c=n.keyboardDragSpeed,u=n.useTransform,d=n.zoom;t(this,e),i(this,"_useTransform",void 0),i(this,"_prevCursorPos",void 0),i(this,"_prevScrollPos",void 0),i(this,"_elements",[]),i(this,"_draggability",void 0),i(this,"_dragKeys",void 0),i(this,"_dragKeysFlat",void 0),i(this,"_keyboardDrag",void 0),i(this,"_keyboardDragSpeed",void 0),i(this,"_zoom",void 0),i(this,"keyboardDrag",(function(t){var e=t.event,n=t.key;if(o._keyboardDrag&&o._dragKeysFlat.includes(n)&&o.DS.SelectedSet.size&&o._draggability&&!o.DS.continue){o.DS.publish("Interaction:start",{event:e,isDragging:!0,isDraggingKeyboard:!0}),o._elements=o.DS.getSelection(),o.handleZIndex(!0);var i=function(t){var e=t.shiftKey,n=t.keyboardDragSpeed,i=t.zoom,o=t.key,r=t.dragKeys,s=t.scrollDiff,a=t.canScroll,l=t.scrollCallback,c={x:0,y:0},u=e?4*n*i:n*i;return r.left.includes(o)&&(c.x=s.x||-u,e||s.x||!a||l(["left"],n)),r.right.includes(o)&&(c.x=s.x||u,e||s.x||!a||l(["right"],n)),r.up.includes(o)&&(c.y=s.y||-u,e||s.y||!a||l(["top"],n)),r.down.includes(o)&&(c.y=s.y||u,e||s.y||!a||l(["bottom"],n)),c}({shiftKey:o.DS.stores.KeyStore.currentValues.includes("shift"),keyboardDragSpeed:o._keyboardDragSpeed,zoom:o._zoom,key:n,scrollCallback:o.DS.Area.scroll,scrollDiff:o._scrollDiff,canScroll:o.DS.stores.ScrollStore.canScroll,dragKeys:o._dragKeys});o._elements.forEach((function(t){return N({element:t,posDirection:i,containerRect:o.DS.SelectorArea.rect,useTransform:o._useTransform})})),o.DS.publish("Interaction:update",{event:e,isDragging:!0,isDraggingKeyboard:!0})}})),i(this,"keyboardEnd",(function(t){var e=t.event,n=t.key;o._keyboardDrag&&o._dragKeysFlat.includes(n)&&o.DS.SelectedSet.size&&o._draggability&&o.DS.publish("Interaction:end",{event:e,isDragging:o._draggability,isDraggingKeyboard:!0})})),i(this,"start",(function(t){var e=t.isDragging,n=t.isDraggingKeyboard;e&&!n&&(o._prevCursorPos=null,o._prevScrollPos=null,o._elements=o.DS.getSelection(),o.handleZIndex(!0))})),i(this,"stop",(function(t){null!=t&&t.isKeyboard||(o._prevCursorPos=null,o._prevScrollPos=null,o.handleZIndex(!1),o._elements=[])})),i(this,"update",(function(t){var e=t.isDragging,n=t.isDraggingKeyboard;if(e&&o._elements.length&&!n&&!o.DS.continue){var i=b(o._cursorDiff,"+",o._scrollDiff);o._elements.forEach((function(t){return N({element:t,posDirection:i,containerRect:o.DS.SelectorArea.rect,useTransform:o._useTransform})}))}})),i(this,"handleZIndex",(function(t){o._elements.forEach((function(e){return e.style.zIndex="".concat((parseInt(e.style.zIndex)||0)+t?9999:-9998)}))})),this.DS=r,this._useTransform=u,this._keyboardDragSpeed=c,this._keyboardDrag=l,this._zoom=d,this._draggability=a,this._dragKeys={up:s.up.map((function(t){return t.toLowerCase()})),down:s.down.map((function(t){return t.toLowerCase()})),left:s.left.map((function(t){return t.toLowerCase()})),right:s.right.map((function(t){return t.toLowerCase()}))},this._dragKeysFlat=[].concat(m(this._dragKeys.up),m(this._dragKeys.down),m(this._dragKeys.left),m(this._dragKeys.right)),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("KeyStore:down",this.keyboardDrag),this.DS.subscribe("KeyStore:up",this.keyboardEnd)}return n(e,[{key:"_cursorDiff",get:function(){var t=this.DS.stores.PointerStore.currentVal,e=this._prevCursorPos?b(t,"-",this._prevCursorPos):{x:0,y:0};return this._prevCursorPos=t,e}},{key:"_scrollDiff",get:function(){var t=this.DS.stores.ScrollStore.currentVal,e=this._prevScrollPos?b(t,"-",this._prevScrollPos):{x:0,y:0};return this._prevScrollPos=t,e}}]),e}(),z=function(){function e(n){var o=this,r=n.areaElement,s=n.DS,a=n.draggability,l=n.immediateDrag;t(this,e),i(this,"_areaElement",void 0),i(this,"_draggability",void 0),i(this,"_immediateDrag",void 0),i(this,"isInteracting",void 0),i(this,"isDragging",void 0),i(this,"init",(function(){o.stop(),o._areaElement.addEventListener("mousedown",o.start),o._areaElement.addEventListener("touchstart",o.start,{passive:!1}),o.DS.publish("Interaction:init",{})})),i(this,"start",(function(t){"touchstart"===t.type&&t.preventDefault(),o._canInteract(t)&&(o.isInteracting=!0,o.isDragging=o.isDragEvent(t),o.DS.publish("Interaction:start",{event:t,isDragging:o.isDragging}),document.addEventListener("mouseup",o.reset),document.addEventListener("touchend",o.reset))})),i(this,"isDragEvent",(function(t){return!(!o._draggability||o.DS.stores.KeyStore.isMultiSelectKeyPressed(t)||!o.DS.SelectableSet.has(t.target)||(o._immediateDrag&&(o.DS.SelectedSet.size?o.DS.SelectedSet.has(t.target)||(o.DS.SelectedSet.clear(),o.DS.SelectedSet.add(t.target)):o.DS.SelectedSet.add(t.target)),!o.DS.SelectedSet.has(t.target)))})),i(this,"onClick",(function(t){var e=t.event;if(o._canInteract(e)&&!(e.detail>0)){var n=o.DS,i=n.stores,r=i.PointerStore,s=i.KeyStore,a=n.SelectableSet,l=n.SelectedSet,c=n.publish;r.start(e);var u=e.target;a.has(u)&&(s.isMultiSelectKeyPressed(e)||l.clear(),l.toggle(u),c("Interaction:end",{event:e,isDragging:o.isDragging}))}})),i(this,"stop",(function(){o.isInteracting=!1,o.isDragging=!1,o._areaElement.removeEventListener("mousedown",o.start),o._areaElement.removeEventListener("touchstart",o.start,{passive:!1}),document.removeEventListener("mouseup",o.reset),document.removeEventListener("touchend",o.reset)})),i(this,"update",(function(t){var e=t.event,n=t.scroll_directions,i=t.scroll_multiplier;o.isInteracting&&o.DS.publish("Interaction:update",{event:e,scroll_directions:n,scroll_multiplier:i,isDragging:o.isDragging})})),i(this,"reset",(function(t){var e=o.isDragging;o.stop(),o.init(),o.DS.publish("Interaction:end",{event:t,isDragging:e})})),this._areaElement=r,this._draggability=a,this._immediateDrag=l,this.DS=s,this.DS.subscribe("PointerStore:updated",this.update),this.DS.subscribe("Selectable:click",this.onClick),this.DS.subscribe("Selectable:pointer",(function(t){var e=t.event;return o.start(e)})),this.DS.subscribe("Area:scroll",this.update)}return n(e,[{key:"_canInteract",value:function(t){return!(2===t.button||this.isInteracting||t.target&&!this.DS.SelectorArea.isInside(t.target))}}]),e}(),P=function e(){var n=this;t(this,e),i(this,"subscribers",{}),i(this,"subscribe",(function(t,e){return Array.isArray(n.subscribers[t])||(n.subscribers[t]=[]),n.subscribers[t].push(e),n.subscribers[t].length-1})),i(this,"unsubscribe",(function(t,e,i){i>=0?n.subscribers[t].splice(i,1):e&&(n.subscribers[t]=n.subscribers[t].filter((function(t){return t!==e})))})),i(this,"publish",(function(t,e){var i,o;Array.isArray(n.subscribers[t])&&(null===(i=n.subscribers["".concat(t,":pre")])||void 0===i||i.forEach((function(t){return t(e)})),null===(o=n.subscribers[t])||void 0===o||o.forEach((function(t){return t(e)})))}))},H=function(e){r(a,e);var o=p(a);function a(e){var n,r=e.elements,s=e.className,l=e.hoverClassName,c=e.draggability,u=e.useTransform,h=e.DS;return t(this,a),i(d(n=o.call(this)),"_initElements",void 0),i(d(n),"_className",void 0),i(d(n),"_hoverClassName",void 0),i(d(n),"_useTransform",void 0),i(d(n),"_draggability",void 0),i(d(n),"init",(function(){return n._initElements.forEach((function(t){return n.add(t)}))})),i(d(n),"clear",(function(){return n.forEach((function(t){return n.delete(t)}))})),i(d(n),"_onClick",(function(t){return n.DS.publish("Selectable:click",{event:t})})),i(d(n),"_onPointer",(function(t){return n.DS.publish("Selectable:pointer",{event:t})})),i(d(n),"addAll",(function(t){return t.forEach((function(t){return n.add(t)}))})),i(d(n),"deleteAll",(function(t){return t.forEach((function(t){return n.delete(t)}))})),n.DS=h,n._initElements=M(r),n._className=s,n._hoverClassName=l,n._useTransform=u,n._draggability=c,n.DS.subscribe("Interaction:init",n.init),n}return n(a,[{key:"add",value:function(t){return t.classList.add(this._className),t.addEventListener("click",this._onClick),t.addEventListener("mousedown",this._onPointer),t.addEventListener("touchstart",this._onPointer,{passive:!1}),this._draggability&&!this._useTransform&&C({computedStyle:window.getComputedStyle(t),node:t}),f(s(a.prototype),"add",this).call(this,t)}},{key:"delete",value:function(t){return t.classList.remove(this._className),t.classList.remove(this._hoverClassName),t.removeEventListener("click",this._onClick),t.removeEventListener("mousedown",this._onPointer),t.removeEventListener("touchstart",this._onPointer,{passive:!1}),f(s(a.prototype),"delete",this).call(this,t)}},{key:"elements",get:function(){return Array.from(this.values())}}]),a}(u(Set)),R=function(e){r(a,e);var o=p(a);function a(e){var n,r=e.className,s=e.DS;return t(this,a),i(d(n=o.call(this)),"_className",void 0),i(d(n),"clear",(function(){return n.forEach((function(t){return n.delete(t)}))})),i(d(n),"addAll",(function(t){return t.forEach((function(t){return n.add(t)}))})),i(d(n),"deleteAll",(function(t){return t.forEach((function(t){return n.delete(t)}))})),n.DS=s,n._className=r,n}return n(a,[{key:"add",value:function(t){if(!f(s(a.prototype),"has",this).call(this,t))return f(s(a.prototype),"add",this).call(this,t),t.classList.add(this._className),this.DS.publish("Selected:added",{items:this.elements,item:t}),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)+1),this}},{key:"delete",value:function(t){if(f(s(a.prototype),"has",this).call(this,t)){var e=f(s(a.prototype),"delete",this).call(this,t);return t.classList.remove(this._className),this.DS.publish("Selected:removed",{items:this.elements,item:t}),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)-1),e}}},{key:"toggle",value:function(t){return this.has(t)?this.delete(t):this.add(t),t}},{key:"elements",get:function(){return Array.from(this.values())}}]),a}(u(Set)),U=function(){function e(n){var o=this,r=n.DS,s=n.hoverClassName,a=n.multiSelectToggling;t(this,e),i(this,"_prevSelectedSet",void 0),i(this,"_hoverClassName",void 0),i(this,"_multiSelectToggling",void 0),i(this,"start",(function(t){var e=t.event;t.isDragging||(o._storePrevious(e),o._handleInsideSelection(!0,e))})),i(this,"update",(function(t){t.isDragging||o.DS.continue||o._handleInsideSelection()})),i(this,"_handleInsideSelection",(function(t,e){for(var n=o.DS,i=n.SelectableSet,r=n.SelectorArea,s=n.Selector,a=i.elements.map((function(t){return[t,t.getBoundingClientRect()]})),l=[],c=[],u=0,d=a.length;u<d;u++)r.isInside(a[u][0],a[u][1])&&(D(a[u][1],s.rect)?l.push(a[u][0]):c.push(a[u][0]));var h=o.DS.stores.KeyStore.isMultiSelectKeyPressed(e)&&o._multiSelectToggling;l.forEach((function(e){return function(t){var e=t.element,n=t.force,i=t.multiSelectionToggle,o=t.SelectedSet,r=t.hoverClassName;e.classList.contains(r)&&!n||(o.has(e)?i&&o.delete(e):o.add(e),e.classList.add(r))}({element:e,force:t,multiSelectionToggle:h,SelectedSet:o.DS.SelectedSet,hoverClassName:o._hoverClassName})})),c.forEach((function(e){return function(t){var e=t.element,n=t.force,i=t.SelectedSet,o=t.PrevSelectedSet,r=t.hoverClassName;if(!e.classList.contains(r)&&!n)return!1;var s=i.has(e),a=o.has(e);s&&!a?i.delete(e):!s&&a&&i.add(e),e.classList.remove(r)}({element:e,force:t,SelectedSet:o.DS.SelectedSet,hoverClassName:o._hoverClassName,PrevSelectedSet:o._prevSelectedSet})}))})),this._hoverClassName=s,this._multiSelectToggling=a,this.DS=r,this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update)}return n(e,[{key:"_storePrevious",value:function(t){var e=this.DS,n=e.stores.KeyStore,i=e.SelectedSet;n.isMultiSelectKeyPressed(t)?this._prevSelectedSet=new Set(i):this._prevSelectedSet=new Set}}]),e}(),V=function(){function e(n){var o=this,r=n.DS,s=n.selector,a=n.selectorClass,l=n.customStyles;t(this,e),i(this,"_rect",void 0),i(this,"start",(function(t){if(!t.isDragging){var e=o.DS.stores.PointerStore.initialValArea;B(o.HTMLNode,_(e,1)),o.HTMLNode.style.display="block",o._rect=null}})),i(this,"stop",(function(){o.HTMLNode.style.width="0",o.HTMLNode.style.height="0",o.HTMLNode.style.display="none"})),i(this,"update",(function(t){if(!t.isDragging&&!o.DS.continue){var e=o.DS.stores,n=e.ScrollStore,i=e.PointerStore,r=function(t){var e=t.scrollAmount,n=t.initialPointerPos,i=t.pointerPos,o={};return i.x>n.x-e.x?(o.left=n.x-e.x,o.width=i.x-n.x+e.x):(o.left=i.x,o.width=n.x-i.x-e.x),i.y>n.y-e.y?(o.top=n.y-e.y,o.height=i.y-n.y+e.y):(o.top=i.y,o.height=n.y-i.y-e.y),o}({scrollAmount:n.scrollAmount,initialPointerPos:i.initialValArea,pointerPos:i.currentValArea});B(o.HTMLNode,r),o._rect=null}})),this.DS=r,this.HTMLNode=s||function(t){var e=document.createElement("div");return e.style.position="absolute",t||(e.style.background="rgba(0, 0, 255, 0.1)",e.style.border="1px solid rgba(0, 0, 255, 0.45)",e.style.display="none",e.style.pointerEvents="none"),e}(l),this.HTMLNode.classList.add(a),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("Interaction:end",this.stop)}return n(e,[{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),e}(),q=function(){function e(n){var o=this,r=n.DS,s=n.selectorAreaClass,a=n.autoScrollSpeed,l=n.overflowTolerance;t(this,e),i(this,"_autoScrollSpeed",void 0),i(this,"_scrollInterval",void 0),i(this,"_rect",void 0),i(this,"currentEdges",[]),i(this,"_overflowTolerance",void 0),i(this,"start",(function(){return o.applyElements("append")})),i(this,"applyElements",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"append",e=document.body?"body":"documentElement",n="".concat(t,"Child");o.HTMLNode[n](o.DS.Selector.HTMLNode),document[e][n](o.HTMLNode)})),i(this,"updatePos",(function(){o._rect=null;var t=o.DS.Area.rect,e=o.DS.Area.computedBorder,n=o.HTMLNode.style,i="".concat(t.top+e.top,"px"),r="".concat(t.left+e.left,"px"),s="".concat(t.width,"px"),a="".concat(t.height,"px");n.top!==i&&(n.top=i),n.left!==r&&(n.left=r),n.width!==s&&(n.width=s),n.height!==a&&(n.height=a)})),i(this,"stop",(function(t){o.stopAutoScroll(),t&&o.applyElements("remove")})),i(this,"startAutoScroll",(function(){o.currentEdges=[],o._scrollInterval=setInterval((function(){return o.handleAutoScroll()}),16)})),i(this,"handleAutoScroll",(function(){if(!o.DS.continue){var t=o.DS,e=t.stores.PointerStore,n=t.Area;o.currentEdges=E({elementRect:_(e.currentVal),containerRect:o.rect,tolerance:o._overflowTolerance}),o.currentEdges.length&&n.scroll(o.currentEdges,o._autoScrollSpeed)}})),i(this,"stopAutoScroll",(function(){o.currentEdges=[],clearInterval(o._scrollInterval)})),i(this,"isInside",(function(t,e){return!(!o.DS.Area.HTMLNode.contains(t)||!o.DS.stores.ScrollStore.canScroll)||D(o.rect,e||t.getBoundingClientRect())})),this._autoScrollSpeed=a,this._overflowTolerance=l,this.DS=r,this.HTMLNode=function(t){var e=document.createElement("div");return e.style.position="fixed",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.zIndex="999999999999999999",e.classList.add(t),e}(s),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Interaction:init",this.start),this.DS.subscribe("Interaction:start",this.startAutoScroll),this.DS.subscribe("Interaction:end",(function(){o.updatePos(),o.stopAutoScroll()}))}return n(e,[{key:"isClicked",value:function(){var t=this.DS.stores.PointerStore;return D({left:t.initialVal.x,top:t.initialVal.y,right:t.initialVal.x,bottom:t.initialVal.y},this.rect)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),e}(),W=function(){function e(n){var o=this,r=n.DS,s=n.multiSelectKeys,a=n.multiSelectMode;t(this,e),i(this,"_multiSelectMode",void 0),i(this,"_multiSelectKeys",void 0),i(this,"_currentValues",new Set),i(this,"_keyMapping",{control:"ctrlKey",shift:"shiftKey",meta:"metaKey"}),i(this,"init",(function(){document.addEventListener("keydown",o.keydown),document.addEventListener("keyup",o.keyup),window.addEventListener("blur",o.reset)})),i(this,"keydown",(function(t){var e=t.key.toLowerCase();o._currentValues.add(e),o.DS.publish("KeyStore:down",{event:t,key:e})})),i(this,"keyup",(function(t){var e=t.key.toLowerCase();o._currentValues.delete(e),o.DS.publish("KeyStore:up",{event:t,key:e})})),i(this,"stop",(function(){document.removeEventListener("keydown",o.keydown),document.removeEventListener("keyup",o.reset),window.removeEventListener("blur",o.reset),o.reset()})),i(this,"reset",(function(){return o._currentValues.clear()})),this.DS=r,this._multiSelectMode=a,this._multiSelectKeys=s.map((function(t){var e={ctrlKey:"Control",shiftKey:"Shift",metaKey:"Meta"}[t];return e?(console.warn("[DragSelect] ".concat(t,' is deprecated. Use "').concat(e,'" instead. Act Now!. See docs for more info')),e.toLowerCase()):t.toLowerCase()})),this.DS.subscribe("Interaction:init",this.init)}return n(e,[{key:"isMultiSelectKeyPressed",value:function(t){var e=this;return!!this._multiSelectMode||!!this.currentValues.some((function(t){return e._multiSelectKeys.includes(t)}))||!(!t||!this._multiSelectKeys.some((function(n){return t[e._keyMapping[n]]})))}},{key:"currentValues",get:function(){return Array.from(this._currentValues.values())}}]),e}(),F=function(){function e(n){var o=this,r=n.DS;t(this,e),i(this,"_isMouseInteraction",!1),i(this,"_initialValArea",void 0),i(this,"_currentValArea",void 0),i(this,"_lastValArea",void 0),i(this,"_initialVal",void 0),i(this,"_currentVal",void 0),i(this,"_lastVal",void 0),i(this,"_lastTouch",void 0),i(this,"init",(function(){document.addEventListener("mousemove",o.update),document.addEventListener("touchmove",o.update,{passive:!1})})),i(this,"update",(function(t){t&&(o.currentVal=T({event:o._normalizedEvent(t)}),o._isMouseInteraction&&o.DS.publish("PointerStore:updated",{event:t}))})),i(this,"stop",(function(){document.removeEventListener("mousemove",o.update),document.removeEventListener("touchmove",o.update,{passive:!1}),setTimeout((function(){return o._isMouseInteraction=!1}),100)})),i(this,"reset",(function(t){t&&(o.currentVal=o.lastVal=T({event:o._normalizedEvent(t)}),o.stop(),o.init())})),this.DS=r,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(t){var e=t.event;return o.start(e)})),this.DS.subscribe("Interaction:end",(function(t){var e=t.event;return o.reset(e)}))}return n(e,[{key:"start",value:function(t){t&&(this._isMouseInteraction=!0,this.currentVal=this.initialVal=T({event:this._normalizedEvent(t)}))}},{key:"_normalizedEvent",value:function(t){return"touches"in t&&"touchend"!==t.type&&(this._lastTouch=t),"touches"in t?this._lastTouch.touches[0]:t}},{key:"initialValArea",get:function(){return this._initialValArea?this._initialValArea:{x:0,y:0}}},{key:"currentValArea",get:function(){return this._currentValArea?this._currentValArea:{x:0,y:0}}},{key:"lastValArea",get:function(){return this._lastValArea?this._lastValArea:{x:0,y:0}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}},set:function(t){this._initialVal=t,this._initialValArea=t&&b(t,"-",b(x(this.DS.Area.rect),"+",x(this.DS.Area.computedBorder)))}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}},set:function(t){this._currentVal=t,this._currentValArea=t&&b(t,"-",b(x(this.DS.Area.rect),"+",x(this.DS.Area.computedBorder)))}},{key:"lastVal",get:function(){return this._lastVal?this._lastVal:{x:0,y:0}},set:function(t){this._lastVal=t,this._lastValArea=t&&b(t,"-",b(x(this.DS.Area.rect),"+",x(this.DS.Area.computedBorder)))}}]),e}(),$=function(){function e(n){var o=this,r=n.DS,s=n.areaElement,a=n.zoom;t(this,e),i(this,"_initialVal",void 0),i(this,"_currentVal",void 0),i(this,"_areaElement",void 0),i(this,"_canScroll",void 0),i(this,"init",(function(){return o._areaElement.addEventListener("scroll",o.update)})),i(this,"start",(function(){o._currentVal=o._initialVal=S(o._areaElement),o._areaElement.addEventListener("scroll",o.update)})),i(this,"update",(function(){return o._currentVal=S(o._areaElement)})),i(this,"stop",(function(){o._areaElement.removeEventListener("scroll",o.update),o._initialVal={x:0,y:0},o._canScroll=null})),i(this,"reset",(function(){o.stop(),o.start()})),this._areaElement=s,this.DS=r,this.zoom=a,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(){return o.start()})),this.DS.subscribe("Interaction:end",(function(){return o.reset()}))}return n(e,[{key:"canScroll",get:function(){return"boolean"==typeof this._canScroll?this._canScroll:this._canScroll=(t=this._areaElement,!!((e=S(t)).x||e.y||(t instanceof HTMLDocument?t.body?t.body.scrollTop=1:t.documentElement.scrollTop=1:t.scrollTop=1)));var t,e}},{key:"scrollAmount",get:function(){var t,e=b(this.currentVal,"-",this.initialVal),n={x:t=this.zoom,y:t},i=b(b(e,"*",n),"-",e);return{x:e.x+i.x,y:e.y+i.y}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}}},{key:"currentVal",get:function(){return this._currentVal||(this._currentVal=S(this._areaElement)),this._currentVal}}]),e}(),Y=function(){function e(n){var o=this,r=n.area,s=void 0===r?document:r,a=n.selectables,l=void 0===a?[]:a,c=n.autoScrollSpeed,u=void 0===c?5:c,d=n.overflowTolerance,h=void 0===d?{x:25,y:25}:d,p=n.zoom,f=void 0===p?1:p,g=n.customStyles,m=void 0!==g&&g,y=n.multiSelectMode,v=void 0!==y&&y,b=n.multiSelectToggling,x=void 0===b||b,_=n.multiSelectKeys,w=void 0===_?["Control","Shift","Meta"]:_,S=n.selector,E=void 0===S?void 0:S,T=n.draggability,A=void 0===T||T,k=n.immediateDrag,C=void 0===k||k,D=n.keyboardDrag,N=void 0===D||D,I=n.dragKeys,M=n.keyboardDragSpeed,B=void 0===M?10:M,Y=n.useTransform,Q=void 0===Y||Y,X=n.hoverClass,K=void 0===X?"ds-hover":X,G=n.selectableClass,Z=void 0===G?"ds-selectable":G,J=n.selectedClass,tt=void 0===J?"ds-selected":J,et=n.selectorClass,nt=void 0===et?"ds-selector":et,it=n.selectorAreaClass,ot=void 0===it?"ds-selector-area":it,rt=n.callback,st=n.onDragMove,at=n.onDragStartBegin,lt=n.onDragStart,ct=n.onElementSelect,ut=n.onElementUnselect;t(this,e),i(this,"continue",!1),i(this,"start",(function(){return o.Interaction.init()})),i(this,"break",(function(){return o.continue=!0})),i(this,"getSelection",(function(){return o.SelectedSet.elements})),i(this,"getSelectables",(function(){return o.SelectableSet.elements})),i(this,"getInitialCursorPosition",(function(){return o.stores.PointerStore.initialVal})),i(this,"getCurrentCursorPosition",(function(){return o.stores.PointerStore.currentVal})),i(this,"getPreviousCursorPosition",(function(){return o.stores.PointerStore.lastVal})),i(this,"getInitialCursorPositionArea",(function(){return o.stores.PointerStore.initialValArea})),i(this,"getCurrentCursorPositionArea",(function(){return o.stores.PointerStore.currentValArea})),i(this,"getPreviousCursorPositionArea",(function(){return o.stores.PointerStore.lastValArea})),i(this,"isMultiSelect",(function(t){return o.stores.KeyStore.isMultiSelectKeyPressed(t)})),i(this,"isDragging",(function(){return o.Interaction.isDragging})),this.PubSub=new P,this.subscribe=this.PubSub.subscribe,this.unsubscribe=this.PubSub.unsubscribe,this.publish=this.PubSub.publish,this._callbacksTemp({callback:rt,onDragMove:st,onDragStart:lt,onDragStartBegin:at,onElementSelect:ct,onElementUnselect:ut}),this.stores={PointerStore:new F({DS:this}),ScrollStore:new $({DS:this,areaElement:s,zoom:f}),KeyStore:new W({DS:this,multiSelectKeys:w,multiSelectMode:v})},this.Area=new L({area:s,PS:this.PubSub,zoom:f}),this.Selector=new V({DS:this,selector:E,selectorClass:nt,customStyles:m}),this.SelectorArea=new q({DS:this,selectorAreaClass:ot,autoScrollSpeed:u,overflowTolerance:h}),this.SelectableSet=new H({elements:l,DS:this,className:Z,hoverClassName:K,useTransform:Q,draggability:A}),this.SelectedSet=new R({DS:this,className:tt}),this.Selection=new U({DS:this,hoverClassName:K,multiSelectToggling:x}),this.Drag=new O({DS:this,draggability:A,useTransform:Q,keyboardDrag:N,dragKeys:Object.assign({up:["ArrowUp"],down:["ArrowDown"],left:["ArrowLeft"],right:["ArrowRight"]},I),zoom:f,keyboardDragSpeed:B}),this.Interaction=new z({areaElement:s,DS:this,draggability:A,immediateDrag:C}),j({subscribe:this.subscribe,publish:this.publish,SelectedSet:this.SelectedSet,Interaction:this.Interaction}),this.subscribe("Interaction:end",(function(){return o.continue=!1})),this.start()}return n(e,[{key:"_callbacksTemp",value:function(t){var e=t.callback,n=t.onDragMove,i=t.onDragStart,o=t.onDragStartBegin,r=t.onElementSelect,s=t.onElementUnselect,a=function(t,e){return console.warn("[DragSelect] ".concat(t,' is deprecated. Use DragSelect.subscribe("').concat(e,'", (callbackObject) => {}) instead. Act Now! See docs for more info'))};e&&(a("callback","callback"),this.subscribe("callback",(function(t){var n=t.items,i=(t.item,t.event);return e(n,i)}))),n&&(a("onDragMove","dragmove"),this.subscribe("dragmove",(function(t){t.items,t.item;var e=t.event;return n(e)}))),i&&(a("onDragStart","dragstart"),this.subscribe("dragstart",(function(t){t.items,t.item;var e=t.event;return i(e)}))),o&&(a("onDragStartBegin","dragstart"),this.subscribe("dragstart",(function(t){t.items,t.item;var e=t.event;return o(e)}))),r&&(a("onElementSelect","elementselect"),this.subscribe("elementselect",(function(t){t.items;var e=t.item,n=t.event;return r(e,n)}))),s&&(a("onElementUnselect","elementunselect"),this.subscribe("elementunselect",(function(t){t.items;var e=t.item,n=t.event;return s(e,n)})))}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.publish("callback",{items:this.getSelection()}),this.Interaction.stop(),this.Area.stop(),this.Drag.stop(),this.Selector.stop(),this.SelectorArea.stop(t),this.stores.KeyStore.stop(),this.stores.PointerStore.stop(),this.stores.ScrollStore.stop(),t&&this.SelectableSet.clear(),e&&this.SelectedSet.clear()}},{key:"addSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.SelectedSet.addAll(M(t)),n||this.addSelectables(t),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"removeSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.SelectedSet.deleteAll(M(t)),n&&this.removeSelectables(t),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"toggleSelection",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return M(t).forEach((function(o){return e.SelectedSet.has(o)?e.removeSelection(t,n,i):e.addSelection(t,n,i)})),n&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"setSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.clearSelection(),this.addSelection(t,e,n),this.getSelection()}},{key:"clearSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.SelectedSet.clear(),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"addSelectables",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=M(t);return this.SelectableSet.addAll(n),e&&this.SelectedSet.addAll(n),t}},{key:"setSelectables",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.removeSelectables(t,e),this.addSelectables(t,n)}},{key:"removeSelectables",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.SelectableSet.deleteAll(M(t)),e&&this.removeSelection(t),t}},{key:"getCursorPositionDifference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.warn("[DragSelect] Using .getCursorPositionDifference is deprecated. Calculate yourself instead. i.e. `.getCurrentCursorPosition().x - .getInitialCursorPosition().x`");var n=e?this.getCurrentCursorPositionArea():this.getCurrentCursorPosition(),i=t?e?this.getPreviousCursorPositionArea():this.getPreviousCursorPosition():e?this.getInitialCursorPositionArea():this.getInitialCursorPosition();return b(n,"-",i)}}]),e}();return Y}()},865:(t,e,n)=>{var i=n(755),o=n(672);void 0===o.$&&(o.$=i),void 0===o.jQuery&&(o.jQuery=i),t.exports=i},322:(t,e,n)=>{var i=n(748),o=n(672),r=i.action_conf;void 0===o.action_conf&&(o.action_conf=r),t.exports=i},401:(t,e,n)=>{var i=n(748),o=n(672),r=i.combo_conf;void 0===o.combo_conf&&(o.combo_conf=r),t.exports=i},766:(t,e,n)=>{var i=n(748),o=n(672),r=i.custom_conf;void 0===o.custom_conf&&(o.custom_conf=r),t.exports=i},520:(t,e,n)=>{var i=n(748),o=n(672),r=i.meta_conf;void 0===o.meta_conf&&(o.meta_conf=r),t.exports=i},538:(t,e,n)=>{var i=n(748),o=n(672),r=i.meta_full_conf;void 0===o.meta_full_conf&&(o.meta_full_conf=r),t.exports=i},166:(t,e,n)=>{var i=n(748),o=n(672),r=i.navigation_conf;void 0===o.navigation_conf&&(o.navigation_conf=r),t.exports=i},821:(t,e,n)=>{var i=n(10),o=n(672),r=i.relation_get_notes_separated;void 0===o.relation_get_notes_separated&&(o.relation_get_notes_separated=r),t.exports=i},519:(t,e,n)=>{var i=n(10),o=n(672),r=i.relation_get_notes;void 0===o.relation_get_notes&&(o.relation_get_notes=r),t.exports=i},170:(t,e,n)=>{var i=n(748),o=n(672),r=i.type_conf;void 0===o.type_conf&&(o.type_conf=r),t.exports=i},792:(t,e,n)=>{var i=n(748),o=n(672),r=i.type_full_conf;void 0===o.type_full_conf&&(o.type_full_conf=r),t.exports=i},672:(t,e,n)=>{"use strict";t.exports=function(){if("object"==typeof globalThis)return globalThis;var t;try{t=this||new Function("return this")()}catch(t){if("object"==typeof window)return window;if("object"==typeof self)return self;if(void 0!==n.g)return n.g}return t}()},238:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;function jBoxWrapper(t){function e(n,i){return this.options={id:null,width:"auto",height:"auto",minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,responsiveWidth:!0,responsiveHeight:!0,responsiveMinWidth:100,responsiveMinHeight:100,attach:null,trigger:"click",preventDefault:!1,content:null,getContent:null,title:null,getTitle:null,footer:null,isolateScroll:!0,ajax:{url:null,data:"",reload:!1,getURL:"data-url",getData:"data-ajax",setContent:!0,loadingClass:!0,spinner:!0,spinnerDelay:300,spinnerReposition:!0},cancelAjaxOnClose:!0,target:null,position:{x:"center",y:"center"},outside:null,offset:0,attributes:{x:"left",y:"top"},fixed:!1,adjustPosition:!0,adjustTracker:!1,adjustDistance:5,reposition:!0,repositionOnOpen:!0,repositionOnContent:!0,holdPosition:!0,pointer:!1,pointTo:"target",fade:180,animation:null,theme:"Default",addClass:null,overlay:!1,overlayClass:null,zIndex:1e4,delayOpen:0,delayClose:0,closeOnEsc:!1,closeOnClick:!1,closeOnMouseleave:!1,closeButton:!1,appendTo:t("body"),createOnInit:!1,blockScroll:!1,blockScrollAdjust:!0,draggable:!1,dragOver:!0,autoClose:!1,delayOnHover:!1,showCountdown:!1,preloadAudio:!0,audio:null,volume:100,onInit:null,onAttach:null,onPosition:null,onCreated:null,onOpen:null,onOpenComplete:null,onClose:null,onCloseComplete:null,onDragStart:null,onDragEnd:null},this._pluginOptions={Tooltip:{getContent:"title",trigger:"mouseenter",position:{x:"center",y:"top"},outside:"y",pointer:!0},Mouse:{responsiveWidth:!1,responsiveHeight:!1,adjustPosition:"flip",target:"mouse",trigger:"mouseenter",position:{x:"right",y:"bottom"},outside:"xy",offset:5},Modal:{target:t(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomIn"}},this.options=t.extend(!0,this.options,this._pluginOptions[n]||e._pluginOptions[n],i),"string"==t.type(n)&&(this.type=n),this.isTouchDevice=function(){var t,e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||(t=e=["(",e.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(t).matches)}(),this.isTouchDevice&&"mouseenter"===this.options.trigger&&!1===this.options.closeOnClick&&(this.options.closeOnClick="body"),this._fireEvent=function(t,e){this.options["_"+t]&&this.options["_"+t].bind(this)(e),this.options[t]&&this.options[t].bind(this)(e)},null===this.options.id&&(this.options.id="jBox"+e._getUniqueID()),this.id=this.options.id,("center"==this.options.position.x&&"x"==this.options.outside||"center"==this.options.position.y&&"y"==this.options.outside)&&(this.options.outside=null),"target"!=this.options.pointTo||this.options.outside&&"xy"!=this.options.outside||(this.options.pointer=!1),"object"!=t.type(this.options.offset)?this.options.offset={x:this.options.offset,y:this.options.offset}:this.options.offset=t.extend({x:0,y:0},this.options.offset),"object"!=t.type(this.options.adjustDistance)?this.options.adjustDistance={top:this.options.adjustDistance,right:this.options.adjustDistance,bottom:this.options.adjustDistance,left:this.options.adjustDistance}:this.options.adjustDistance=t.extend({top:5,left:5,right:5,bottom:5},this.options.adjustDistance),this.outside=!(!this.options.outside||"xy"==this.options.outside)&&this.options.position[this.options.outside],this.align=this.outside||("center"!=this.options.position.y&&"number"!=t.type(this.options.position.y)?this.options.position.x:"center"!=this.options.position.x&&"number"!=t.type(this.options.position.x)?this.options.position.y:this.options.attributes.x),e.zIndexMax=Math.max(e.zIndexMax||0,"auto"===this.options.zIndex?1e4:this.options.zIndex),"auto"===this.options.zIndex&&(this.adjustZIndexOnOpen=!0,this.options.zIndex=e.zIndexMax+=2,this.trueModal=this.options.overlay),this._getOpp=function(t){return{left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"}[t]},this._getXY=function(t){return{left:"x",right:"x",top:"y",bottom:"y",center:"x"}[t]},this._getTL=function(t){return{left:"left",right:"left",top:"top",bottom:"top",center:"left",x:"left",y:"top"}[t]},this._getInt=function(e,n){return"auto"==e?"auto":e&&"string"==t.type(e)&&"%"==e.slice(-1)?t(window)["height"==n?"innerHeight":"innerWidth"]()*parseInt(e.replace("%",""))/100:e},this._createSVG=function(e,n){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return t.each(n,(function(t,e){i.setAttribute(e[0],e[1]||"")})),i},this._isolateScroll=function(t){t&&t.length&&t.on("DOMMouseScroll.jBoxIsolateScroll mousewheel.jBoxIsolateScroll",(function(e){var n=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail,i=0<=this.scrollTop+t.outerHeight()-this.scrollHeight,o=this.scrollTop<=0;(n<0&&i||0<n&&o)&&e.preventDefault()}))},this._setTitleWidth=function(){if(!this.titleContainer||"auto"==this.content[0].style.width&&!this.content[0].style.maxWidth)return null;var t;"none"==this.wrapper.css("display")?(this.wrapper.css("display","block"),t=this.content.outerWidth(),this.wrapper.css("display","none")):t=this.content.outerWidth(),this.titleContainer.css({maxWidth:Math.max(t,parseInt(this.content[0].style.maxWidth))||null})},this._draggable=function(){if(!this.options.draggable)return!1;var n="title"==this.options.draggable?this.titleContainer:this.options.draggable instanceof t?this.options.draggable:"string"==t.type(this.options.draggable)?t(this.options.draggable):this.wrapper;return!(!(n&&n instanceof t&&n.length)||n.data("jBox-draggable"))&&(n.addClass("jBox-draggable").data("jBox-draggable",!0).on("touchstart mousedown",function(n){var i,o,r,s,a,l;2==n.button||t(n.target).hasClass("jBox-noDrag")||t(n.target).parents(".jBox-noDrag").length?"touchstart"==n.type&&(t(n.target).hasClass("jBox-closeButton")||t(n.target).parents(".jBox-closeButton").length)&&this.close({ignoreDelay:!0}):(o="touchstart"==n.type&&n.touches&&n.touches[0]?(i=n.touches[0].pageX,n.touches[0].pageY):(i=n.pageX,n.pageY),this.draggingStartX=i,this.draggingStartY=o,this.options.dragOver&&!this.trueModal&&parseInt(this.wrapper.css("zIndex"),10)<=e.zIndexMaxDragover&&(e.zIndexMaxDragover+=1,this.wrapper.css("zIndex",e.zIndexMaxDragover)),r=this.wrapper.outerHeight(),s=this.wrapper.outerWidth(),a=this.wrapper.offset().top+r-o,l=this.wrapper.offset().left+s-i,t(document).on("touchmove.jBox-draggable-"+this.id+" mousemove.jBox-draggable-"+this.id,function(t){var e;t="touchmove"==t.type&&t.touches&&t.touches[0]?(e=t.touches[0].pageX,t.touches[0].pageY):(e=t.pageX,t.pageY),this.dragging||this.draggingStartX==e||this.draggingStartY==t||(this._fireEvent("onDragStart"),this.dragging=!0),this.wrapper.offset({top:t+a-r,left:e+l-s})}.bind(this)),n.preventDefault())}.bind(this)).on("touchend mouseup",function(){var e;t(document).off("touchmove.jBox-draggable-"+this.id+" mousemove.jBox-draggable-"+this.id),this.dragging&&this._fireEvent("onDragEnd"),this.dragging=!1,"Modal"!=this.type&&"Confirm"!=this.type||!this.options.holdPosition||(e={x:(e=t("#"+this.id).offset()).left-t(document).scrollLeft(),y:e.top-t(document).scrollTop()},this.position({position:e,offset:{x:0,y:0}}))}.bind(this)),this.trueModal||(e.zIndexMaxDragover=e.zIndexMaxDragover?Math.max(e.zIndexMaxDragover,this.options.zIndex):this.options.zIndex),this)},this._create=function(){var e;this.wrapper||(this.wrapper=t("<div/>",{id:this.id,class:"jBox-wrapper"+(this.type?" jBox-"+this.type:"")+(this.options.theme?" jBox-"+this.options.theme:"")+(this.options.addClass?" "+this.options.addClass:"")}).css({position:this.options.fixed?"fixed":"absolute",display:"none",opacity:0,zIndex:this.options.zIndex}).data("jBox",this),this.options.closeOnMouseleave&&this.wrapper.on("mouseleave",function(e){!this.source||e.relatedTarget!=this.source[0]&&-1===t.inArray(this.source[0],t(e.relatedTarget).parents("*"))&&this.close()}.bind(this)),"box"==this.options.closeOnClick&&this.wrapper.on("click tap",function(){this.close({ignoreDelay:!0})}.bind(this)),this.container=t('<div class="jBox-container"/>').appendTo(this.wrapper),this.content=t('<div class="jBox-content"/>').appendTo(this.container),this.options.footer&&(this.footer=t('<div class="jBox-footer"/>').append(this.options.footer).appendTo(this.container)),this.options.isolateScroll&&this._isolateScroll(this.content),this.options.closeButton&&((e=this._createSVG("svg",[["viewBox","0 0 24 24"]])).appendChild(this._createSVG("path",[["d","M22.2,4c0,0,0.5,0.6,0,1.1l-6.8,6.8l6.9,6.9c0.5,0.5,0,1.1,0,1.1L20,22.3c0,0-0.6,0.5-1.1,0L12,15.4l-6.9,6.9c-0.5,0.5-1.1,0-1.1,0L1.7,20c0,0-0.5-0.6,0-1.1L8.6,12L1.7,5.1C1.2,4.6,1.7,4,1.7,4L4,1.7c0,0,0.6-0.5,1.1,0L12,8.5l6.8-6.8c0.5-0.5,1.1,0,1.1,0L22.2,4z"]])),this.closeButton=t('<div class="jBox-closeButton jBox-noDrag"/>').on("click tap",function(t){this.close({ignoreDelay:!0})}.bind(this)).append(e),"box"!=this.options.closeButton&&(!0!==this.options.closeButton||this.options.overlay||this.options.title||this.options.getTitle)||(this.wrapper.addClass("jBox-closeButton-box"),this.closeButton.appendTo(this.container))),this.wrapper.appendTo(this.options.appendTo),this.wrapper.find(".jBox-closeButton").length&&t.each(["top","right","bottom","left"],function(t,e){this.wrapper.find(".jBox-closeButton").css(e)&&"auto"!=this.wrapper.find(".jBox-closeButton").css(e)&&(this.options.adjustDistance[e]=Math.max(this.options.adjustDistance[e],this.options.adjustDistance[e]+-1*((parseInt(this.wrapper.find(".jBox-closeButton").css(e))||0)+(parseInt(this.container.css("border-"+e+"-width"))||0))))}.bind(this)),this.options.pointer&&(this.pointer={position:"target"!=this.options.pointTo?this.options.pointTo:this._getOpp(this.outside),xy:"target"!=this.options.pointTo?this._getXY(this.options.pointTo):this._getXY(this.outside),align:"center",offset:0},this.pointer.element=t('<div class="jBox-pointer jBox-pointer-'+this.pointer.position+'"/>').appendTo(this.wrapper),this.pointer.dimensions={x:this.pointer.element.outerWidth(),y:this.pointer.element.outerHeight()},"string"==t.type(this.options.pointer)&&((e=this.options.pointer.split(":"))[0]&&(this.pointer.align=e[0]),e[1]&&(this.pointer.offset=parseInt(e[1]))),this.pointer.alignAttribute="x"==this.pointer.xy?"bottom"==this.pointer.align?"bottom":"top":"right"==this.pointer.align?"right":"left",this.wrapper.css("padding-"+this.pointer.position,this.pointer.dimensions[this.pointer.xy]),this.pointer.element.css(this.pointer.alignAttribute,"center"==this.pointer.align?"50%":0).css("margin-"+this.pointer.alignAttribute,this.pointer.offset),this.pointer.margin={},this.pointer.margin["margin-"+this.pointer.alignAttribute]=this.pointer.offset,"center"==this.pointer.align&&this.pointer.element.css("transform","translate("+("y"==this.pointer.xy?-.5*this.pointer.dimensions.x+"px":0)+", "+("x"==this.pointer.xy?-.5*this.pointer.dimensions.y+"px":0)+")"),this.pointer.element.css("x"==this.pointer.xy?"width":"height",parseInt(this.pointer.dimensions[this.pointer.xy])+parseInt(this.container.css("border-"+this.pointer.alignAttribute+"-width"))),this.wrapper.addClass("jBox-pointerPosition-"+this.pointer.position)),this.setContent(this.options.content,!0),this.setTitle(this.options.title,!0),this.options.draggable&&this._draggable(),this._fireEvent("onCreated"))},this.options.createOnInit&&this._create(),this.options.attach&&this.attach(),this._attachEvents=function(){this.options.delayOnHover&&t("#"+this.id).on("mouseenter",function(t){this.isHovered=!0}.bind(this)),this.options.delayOnHover&&t("#"+this.id).on("mouseleave",function(t){this.isHovered=!1}.bind(this)),(this.options.adjustPosition||this.options.reposition)&&!this.fixed&&this.outside&&(this.options.adjustTracker&&t(window).on("scroll.jBox-"+this.id,function(t){this.position()}.bind(this)),(this.options.adjustPosition||this.options.reposition)&&t(window).on("resize.jBox-"+this.id,function(t){this.position()}.bind(this))),"mouse"==this.options.target&&t("body").on("mousemove.jBox-"+this.id,function(t){this.position({mouseTarget:{top:t.pageY,left:t.pageX}})}.bind(this))},this._detachEvents=function(){this.options.closeOnEsc&&t(document).off("keyup.jBox-"+this.id),!0!==this.options.closeOnClick&&"body"!=this.options.closeOnClick||t(document).off("click.jBox-"+this.id+" tap.jBox-"+this.id),this.options.adjustTracker&&t(window).off("scroll.jBox-"+this.id),(this.options.adjustPosition||this.options.reposition)&&t(window).off("resize.jBox-"+this.id),"mouse"==this.options.target&&t("body").off("mousemove.jBox-"+this.id)},this._showOverlay=function(){this.overlay||(this.overlay=t('<div id="'+this.id+'-overlay"/>').addClass("jBox-overlay"+(this.type?" jBox-overlay-"+this.type:"")).css({display:"none",opacity:0,zIndex:this.options.zIndex-1}).appendTo(this.options.appendTo),this.options.overlayClass&&this.overlay.addClass(this.options.overlayClass),"overlay"!=this.options.closeButton&&!0!==this.options.closeButton||this.overlay.append(this.closeButton),"overlay"==this.options.closeOnClick&&this.overlay.on("click tap",function(){this.close({ignoreDelay:!0})}.bind(this)),t("#"+this.id+"-overlay .jBox-closeButton").length&&(this.options.adjustDistance.top=Math.max(t("#"+this.id+"-overlay .jBox-closeButton").outerHeight(),this.options.adjustDistance.top))),!0===this.adjustZIndexOnOpen&&this.overlay.css("zIndex",parseInt(this.wrapper.css("zIndex"),10)-1),"block"!=this.overlay.css("display")&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.overlay.css({display:"block"})}.bind(this)}):this.overlay.css({display:"block",opacity:1}))},this._hideOverlay=function(){this.overlay&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:0},{queue:!1,duration:this.options.fade,complete:function(){this.overlay.css({display:"none"})}.bind(this)}):this.overlay.css({display:"none",opacity:0}))},this._exposeDimensions=function(){this.wrapper.css({top:-1e4,left:-1e4,right:"auto",bottom:"auto"});var t={x:this.wrapper.outerWidth(),y:this.wrapper.outerHeight()};return this.wrapper.css({top:"auto",left:"auto"}),t},this._generateAnimationCSS=function(){if("object"!=t.type(this.options.animation)&&(this.options.animation={pulse:{open:"pulse",close:"zoomOut"},zoomIn:{open:"zoomIn",close:"zoomIn"},zoomOut:{open:"zoomOut",close:"zoomOut"},move:{open:"move",close:"move"},slide:{open:"slide",close:"slide"},flip:{open:"flip",close:"flip"},tada:{open:"tada",close:"zoomOut"}}[this.options.animation]),!this.options.animation)return null;this.options.animation.open&&(this.options.animation.open=this.options.animation.open.split(":")),this.options.animation.close&&(this.options.animation.close=this.options.animation.close.split(":")),this.options.animation.openDirection=this.options.animation.open[1]||null,this.options.animation.closeDirection=this.options.animation.close[1]||null,this.options.animation.open&&(this.options.animation.open=this.options.animation.open[0]),this.options.animation.close&&(this.options.animation.close=this.options.animation.close[0]),this.options.animation.open&&(this.options.animation.open+="Open"),this.options.animation.close&&(this.options.animation.close+="Close");var e={pulse:{duration:350,css:[["0%","scale(1)"],["50%","scale(1.1)"],["100%","scale(1)"]]},zoomInOpen:{duration:this.options.fade||180,css:[["0%","scale(0.9)"],["100%","scale(1)"]]},zoomInClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(0.9)"]]},zoomOutOpen:{duration:this.options.fade||180,css:[["0%","scale(1.1)"],["100%","scale(1)"]]},zoomOutClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(1.1)"]]},moveOpen:{duration:this.options.fade||180,positions:{top:{"0%":-12},right:{"0%":12},bottom:{"0%":12},left:{"0%":-12}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},moveClose:{duration:this.options.fade||180,timing:"ease-in",positions:{top:{"100%":-12},right:{"100%":12},bottom:{"100%":12},left:{"100%":-12}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},slideOpen:{duration:400,positions:{top:{"0%":-400},right:{"0%":400},bottom:{"0%":400},left:{"0%":-400}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},slideClose:{duration:400,timing:"ease-in",positions:{top:{"100%":-400},right:{"100%":400},bottom:{"100%":400},left:{"100%":-400}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},flipOpen:{duration:600,css:[["0%","perspective(400px) rotateX(90deg)"],["40%","perspective(400px) rotateX(-15deg)"],["70%","perspective(400px) rotateX(15deg)"],["100%","perspective(400px) rotateX(0deg)"]]},flipClose:{duration:this.options.fade||300,css:[["0%","perspective(400px) rotateX(0deg)"],["100%","perspective(400px) rotateX(90deg)"]]},tada:{duration:800,css:[["0%","scale(1)"],["10%, 20%","scale(0.9) rotate(-3deg)"],["30%, 50%, 70%, 90%","scale(1.1) rotate(3deg)"],["40%, 60%, 80%","scale(1.1) rotate(-3deg)"],["100%","scale(1) rotate(0)"]]}};t.each(["pulse","tada"],(function(t,n){e[n+"Open"]=e[n+"Close"]=e[n]}));var n=function(n,i){var o="@keyframes jBox-"+this.id+"-animation-"+this.options.animation[n]+"-"+n+(i?"-"+i:"")+" {";return t.each(e[this.options.animation[n]].css,function(t,r){var s=i?r[1].replace("%XY",this._getXY(i).toUpperCase()):r[1];e[this.options.animation[n]].positions&&(s=s.replace("%V",e[this.options.animation[n]].positions[i][r[0]])),o+=r[0]+" {transform:"+s+";}"}.bind(this)),o+="}",o+=".jBox-"+this.id+"-animation-"+this.options.animation[n]+"-"+n+(i?"-"+i:"")+" {",o+="animation-duration: "+e[this.options.animation[n]].duration+"ms;",o+="animation-name: jBox-"+this.id+"-animation-"+this.options.animation[n]+"-"+n+(i?"-"+i:"")+";",o+=e[this.options.animation[n]].timing?"animation-timing-function: "+e[this.options.animation[n]].timing+";":"",o+="}"}.bind(this);this._animationCSS="",t.each(["open","close"],function(i,o){if(!this.options.animation[o]||!e[this.options.animation[o]]||"close"==o&&!this.options.fade)return"";e[this.options.animation[o]].positions?t.each(["top","right","bottom","left"],function(t,e){this._animationCSS+=n(o,e)}.bind(this)):this._animationCSS+=n(o)}.bind(this))},this.options.animation&&this._generateAnimationCSS(),this._blockBodyClick=function(){this.blockBodyClick=!0,setTimeout(function(){this.blockBodyClick=!1}.bind(this),10)},this._animate=function(t){if(t=t||(this.isOpen?"open":"close"),!this.options.fade&&"close"==t)return null;var e=this.options.animation[t+"Direction"]||("center"!=this.align?this.align:this.options.attributes.x);this.flipped&&this._getXY(e)==this._getXY(this.align)&&(e=this._getOpp(e));var n="jBox-"+this.id+"-animation-"+this.options.animation[t]+"-"+t+" jBox-"+this.id+"-animation-"+this.options.animation[t]+"-"+t+"-"+e;this.wrapper.addClass(n),e=1e3*parseFloat(this.wrapper.css("animation-duration")),"close"==t&&(e=Math.min(e,this.options.fade)),setTimeout(function(){this.wrapper&&this.wrapper.removeClass(n)}.bind(this),e)},this._abortAnimation=function(){var t=this.wrapper.attr("class").split(" ").filter(function(t){return 0!==t.lastIndexOf("jBox-"+this.id+"-animation",0)}.bind(this));this.wrapper.attr("class",t.join(" "))},(this.options.responsiveWidth||this.options.responsiveHeight)&&t(window).on("resize.responsivejBox-"+this.id,function(t){this.isOpen&&this.position()}.bind(this)),"string"===t.type(this.options.preloadAudio)&&(this.options.preloadAudio=[this.options.preloadAudio]),"string"===t.type(this.options.audio)&&(this.options.audio={open:this.options.audio}),"number"===t.type(this.options.volume)&&(this.options.volume={open:this.options.volume,close:this.options.volume}),!0===this.options.preloadAudio&&this.options.audio&&(this.options.preloadAudio=[],t.each(this.options.audio,function(t,e){this.options.preloadAudio.push(e+".mp3"),this.options.preloadAudio.push(e+".ogg")}.bind(this))),this.options.preloadAudio.length&&t.each(this.options.preloadAudio,(function(t,e){var n=new Audio;n.src=e,n.preload="auto"})),this._fireEvent("onInit"),this}var n,i;return e.prototype.attach=function(e,n){return e=e||this.options.attach,"string"==t.type(e)&&(e=t(e)),n=n||this.options.trigger,e&&e.length&&t.each(e,function(e,i){(i=t(i)).data("jBox-attached-"+this.id)||("title"==this.options.getContent&&null!=i.attr("title")&&i.data("jBox-getContent",i.attr("title")).removeAttr("title"),this.attachedElements||(this.attachedElements=[]),this.attachedElements.push(i[0]),i.on(n+".jBox-attach-"+this.id,function(t){var e;this.timer&&clearTimeout(this.timer),"mouseenter"==n&&this.isOpen&&this.source[0]==i[0]||(this.isOpen&&this.source&&this.source[0]!=i[0]&&(e=!0),this.source=i,this.options.target||(this.target=i),"click"==n&&this.options.preventDefault&&t.preventDefault(),this["click"!=n||e?"open":"toggle"]())}.bind(this)),"mouseenter"==this.options.trigger&&i.on("mouseleave",function(e){if(!this.wrapper)return null;this.options.closeOnMouseleave&&(e.relatedTarget==this.wrapper[0]||t(e.relatedTarget).parents("#"+this.id).length)||this.close()}.bind(this)),i.data("jBox-attached-"+this.id,n),this._fireEvent("onAttach",i))}.bind(this)),this},e.prototype.detach=function(e){return(e=e||this.attachedElements||[])&&e.length&&t.each(e,function(e,n){(n=t(n)).data("jBox-attached-"+this.id)&&(n.off(n.data("jBox-attached-"+this.id)+".jBox-attach-"+this.id),n.data("jBox-attached-"+this.id,null)),this.attachedElements=t.grep(this.attachedElements,(function(t){return t!=n[0]}))}.bind(this)),this},e.prototype.setTitle=function(e,n){if(null==e||null==e)return this;this.wrapper||this._create();var i=this.wrapper.outerHeight(),o=this.wrapper.outerWidth();return this.title||(this.titleContainer=t('<div class="jBox-title"/>'),this.title=t("<div/>").appendTo(this.titleContainer),"title"!=this.options.closeButton&&(!0!==this.options.closeButton||this.options.overlay)||(this.wrapper.addClass("jBox-closeButton-title"),this.closeButton.appendTo(this.titleContainer)),this.titleContainer.insertBefore(this.content),this._setTitleWidth()),this.wrapper[e?"addClass":"removeClass"]("jBox-hasTitle"),this.title.html(e),o!=this.wrapper.outerWidth()&&this._setTitleWidth(),this.options.draggable&&this._draggable(),n||!this.options.repositionOnContent||i==this.wrapper.outerHeight()&&o==this.wrapper.outerWidth()||this.position(),this},e.prototype.setContent=function(e,n){if(null==e||null==e)return this;this.wrapper||this._create();var i=this.wrapper.outerHeight(),o=this.wrapper.outerWidth();switch(this.content.children("[data-jbox-content-appended]").appendTo("body").css({display:"none"}),t.type(e)){case"string":this.content.html(e);break;case"object":e&&(e instanceof t||e.constructor.prototype.jquery)?(this.content.html(""),e.attr("data-jbox-content-appended",1).appendTo(this.content).css({display:"block"})):this.content.html(JSON.stringify(e))}return o!=this.wrapper.outerWidth()&&this._setTitleWidth(),this.options.draggable&&this._draggable(),n||!this.options.repositionOnContent||i==this.wrapper.outerHeight()&&o==this.wrapper.outerWidth()||this.position(),this},e.prototype.setDimensions=function(t,e,n){this.wrapper||this._create(),this.content.css(t,this._getInt(e=null==e?"auto":e)),"width"==t&&this._setTitleWidth(),this.options[t]=e,null!=n&&!n||this.position()},e.prototype.setWidth=function(t,e){this.setDimensions("width",t,e)},e.prototype.setHeight=function(t,e){this.setDimensions("height",t,e)},e.prototype.position=function(e){if(e=t.extend(!0,this.options,e=e||{}),this.target=e.target||this.target||t(window),this.target instanceof t||"mouse"==this.target||(this.target=t(this.target)),!this.target.length)return this;this.content.css({width:this._getInt(e.width,"width"),height:this._getInt(e.height,"height"),minWidth:this._getInt(e.minWidth,"width"),minHeight:this._getInt(e.minHeight,"height"),maxWidth:this._getInt(e.maxWidth,"width"),maxHeight:this._getInt(e.maxHeight,"height")}),this._setTitleWidth();var n=this._exposeDimensions();"mouse"==this.target||this.target.data("jBox-"+this.id+"-fixed")||this.target.data("jBox-"+this.id+"-fixed",this.target[0]!=t(window)[0]&&("fixed"==this.target.css("position")||0<this.target.parents().filter((function(){return"fixed"==t(this).css("position")})).length)?"fixed":"static");var i={x:t(window).outerWidth(),y:t(window).outerHeight(),top:e.fixed&&this.target.data("jBox-"+this.id+"-fixed")?0:t(window).scrollTop(),left:e.fixed&&this.target.data("jBox-"+this.id+"-fixed")?0:t(window).scrollLeft()};i.bottom=i.top+i.y,i.right=i.left+i.x;try{var o=this.target.offset()}catch(i){o={top:0,left:0}}"mouse"!=this.target&&"fixed"==this.target.data("jBox-"+this.id+"-fixed")&&e.fixed&&(o.top=o.top-t(window).scrollTop(),o.left=o.left-t(window).scrollLeft());var r={x:"mouse"==this.target?12:this.target.outerWidth(),y:"mouse"==this.target?20:this.target.outerHeight(),top:"mouse"==this.target&&e.mouseTarget?e.mouseTarget.top:o?o.top:0,left:"mouse"==this.target&&e.mouseTarget?e.mouseTarget.left:o?o.left:0},s=e.outside&&!("center"==e.position.x&&"center"==e.position.y),a={x:i.x-e.adjustDistance.left-e.adjustDistance.right,y:i.y-e.adjustDistance.top-e.adjustDistance.bottom,left:s?r.left-t(window).scrollLeft()-e.adjustDistance.left:0,right:s?i.x-r.left+t(window).scrollLeft()-r.x-e.adjustDistance.right:0,top:s?r.top-t(window).scrollTop()-this.options.adjustDistance.top:0,bottom:s?i.y-r.top+t(window).scrollTop()-r.y-e.adjustDistance.bottom:0},l={x:"x"!=e.outside&&"xy"!=e.outside||"number"==t.type(e.position.x)?null:e.position.x,y:"y"!=e.outside&&"xy"!=e.outside||"number"==t.type(e.position.y)?null:e.position.y},c={x:!1,y:!1};l.x&&n.x>a[l.x]&&a[this._getOpp(l.x)]>a[l.x]&&(l.x=this._getOpp(l.x))&&(c.x=!0),l.y&&n.y>a[l.y]&&a[this._getOpp(l.y)]>a[l.y]&&(l.y=this._getOpp(l.y))&&(c.y=!0),(e.responsiveWidth||e.responsiveHeight)&&(m=function(){var t;e.responsiveWidth&&n.x>a[l.x||"x"]&&(t=a[l.x||"x"]-(this.pointer&&s&&"x"==e.outside?this.pointer.dimensions.x:0)-parseInt(this.container.css("border-left-width"))-parseInt(this.container.css("border-right-width")),this.content.css({width:t>this.options.responsiveMinWidth?t:null,minWidth:t<parseInt(this.content.css("minWidth"))?0:null}),this._setTitleWidth()),n=this._exposeDimensions()}.bind(this),e.responsiveWidth&&m(),e.responsiveWidth&&!c.y&&l.y&&n.y>a[l.y]&&a[this._getOpp(l.y)]>a[l.y]&&(l.y=this._getOpp(l.y))&&(c.y=!0),y=function(){var t;e.responsiveHeight&&n.y>a[l.y||"y"]&&(t=function(){return this.titleContainer||this.footer?("none"==this.wrapper.css("display")?(this.wrapper.css("display","block"),t=(this.titleContainer?this.titleContainer.outerHeight():0)+(this.footer?this.footer.outerHeight():0),this.wrapper.css("display","none")):t=(this.titleContainer?this.titleContainer.outerHeight():0)+(this.footer?this.footer.outerHeight():0),t||0):0;var t}.bind(this),t=a[l.y||"y"]-(this.pointer&&s&&"y"==e.outside?this.pointer.dimensions.y:0)-t()-parseInt(this.container.css("border-top-width"))-parseInt(this.container.css("border-bottom-width")),this.content.css({height:t>this.options.responsiveMinHeight?t:null}),this._setTitleWidth()),n=this._exposeDimensions()}.bind(this),e.responsiveHeight&&y(),e.responsiveHeight&&!c.x&&l.x&&n.x>a[l.x]&&a[this._getOpp(l.x)]>a[l.x]&&(l.x=this._getOpp(l.x))&&(c.x=!0),e.adjustPosition&&"move"!=e.adjustPosition&&(c.x&&m(),c.y&&y()));var u={},d=function(i){if("number"!=t.type(e.position[i])){var o=e.attributes[i]="x"==i?"left":"top";if(u[o]=r[o],"center"==e.position[i])return u[o]+=Math.ceil((r[i]-n[i])/2),void("mouse"!=this.target&&this.target[0]&&this.target[0]==t(window)[0]&&(u[o]+=.5*(e.adjustDistance[o]-e.adjustDistance[this._getOpp(o)])));o!=e.position[i]&&(u[o]+=r[i]-n[i]),e.outside!=i&&"xy"!=e.outside||(u[o]+=n[i]*(o!=e.position[i]?1:-1))}else u[e.attributes[i]]=e.position[i]}.bind(this);if(d("x"),d("y"),this.pointer&&"target"==e.pointTo&&"number"!=t.type(e.position.x)&&"number"!=t.type(e.position.y)&&(v=0,"center"===this.pointer.align?"center"!=e.position[this._getOpp(e.outside)]&&(v+=n[this._getOpp(e.outside)]/2):"center"===e.position[this._getOpp(e.outside)]?v+=(n[this._getOpp(e.outside)]/2-this.pointer.dimensions[this._getOpp(e.outside)]/2)*(this.pointer.align==this._getTL(this.pointer.align)?1:-1):v+=this.pointer.align!=e.position[this._getOpp(e.outside)]?n[this._getOpp(e.outside)]*(-1!==t.inArray(this.pointer.align,["top","left"])?1:-1)+this.pointer.dimensions[this._getOpp(e.outside)]/2*(-1!==t.inArray(this.pointer.align,["top","left"])?-1:1):this.pointer.dimensions[this._getOpp(e.outside)]/2*(-1!==t.inArray(this.pointer.align,["top","left"])?1:-1),v*=e.position[this._getOpp(e.outside)]==this.pointer.alignAttribute?-1:1,v+=this.pointer.offset*(this.pointer.align==this._getOpp(this._getTL(this.pointer.align))?1:-1),u[this._getTL(this._getOpp(this.pointer.xy))]+=v),u[e.attributes.x]+=e.offset.x,u[e.attributes.y]+=e.offset.y,this.wrapper.css(u),e.adjustPosition){this.positionAdjusted&&(this.pointer&&this.wrapper.css("padding",0).css("padding-"+this._getOpp(this.outside),this.pointer.dimensions[this._getXY(this.outside)]).removeClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).addClass("jBox-pointerPosition-"+this.pointer.position),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this._getOpp(this.outside)).css(this.pointer.margin),this.positionAdjusted=!1,this.flipped=!1);var h=i.top>u.top-(e.adjustDistance.top||0),p=i.right<u.left+n.x+(e.adjustDistance.right||0),f=i.bottom<u.top+n.y+(e.adjustDistance.bottom||0),g=i.left>u.left-(e.adjustDistance.left||0),m=h?"top":f?"bottom":null;if((o=g?"left":p?"right":null)||m){if(("Modal"==this.type||"Confirm"==this.type)&&"number"==t.type(this.options.position.x)&&"number"==t.type(this.options.position.y)){var y=0,v=0;return this.options.holdPosition&&(g?y=i.left-(u.left-(e.adjustDistance.left||0)):p&&(y=i.right-(u.left+n.x+(e.adjustDistance.right||0))),h?v=i.top-(u.top-(e.adjustDistance.top||0)):f&&(v=i.bottom-(u.top+n.y+(e.adjustDistance.bottom||0))),this.options.position.x=Math.max(i.top,this.options.position.x+y),this.options.position.y=Math.max(i.left,this.options.position.y+v),d("x"),d("y"),this.wrapper.css(u)),this._fireEvent("onPosition"),this}!0!==e.adjustPosition&&"flip"!==e.adjustPosition||(b=function(t){this.wrapper.css(this._getTL(t),u[this._getTL(t)]+(n[this._getXY(t)]+e.offset[this._getXY(t)]*("top"==t||"left"==t?-2:2)+r[this._getXY(t)])*("top"==t||"left"==t?1:-1)),this.pointer&&this.wrapper.removeClass("jBox-pointerPosition-"+this.pointer.position).addClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).css("padding",0).css("padding-"+t,this.pointer.dimensions[this._getXY(t)]),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+t),this.positionAdjusted=!0,this.flipped=!0}.bind(this),c.x&&b(this.options.position.x),c.y&&b(this.options.position.y));var b="x"==this._getXY(this.outside)?m:o;this.pointer&&"target"==e.pointTo&&"flip"!=e.adjustPosition&&this._getXY(b)==this._getOpp(this._getXY(this.outside))&&(m="center"==this.pointer.align?n[this._getXY(b)]/2-this.pointer.dimensions[this._getOpp(this.pointer.xy)]/2-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))*(b!=this._getTL(b)?-1:1):b==this.pointer.alignAttribute?parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute)):n[this._getXY(b)]-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-this.pointer.dimensions[this._getXY(b)],o=b==this._getTL(b)?i[this._getTL(b)]-u[this._getTL(b)]+e.adjustDistance[b]:-1*(i[this._getOpp(this._getTL(b))]-u[this._getTL(b)]-e.adjustDistance[b]-n[this._getXY(b)]),b==this._getOpp(this._getTL(b))&&u[this._getTL(b)]-o<i[this._getTL(b)]+e.adjustDistance[this._getTL(b)]&&(o-=i[this._getTL(b)]+e.adjustDistance[this._getTL(b)]-(u[this._getTL(b)]-o)),(o=Math.min(o,m))<=m&&0<o&&(this.pointer.element.css("margin-"+this.pointer.alignAttribute,parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-o*(b!=this.pointer.alignAttribute?-1:1)),this.wrapper.css(this._getTL(b),u[this._getTL(b)]+o*(b!=this._getTL(b)?-1:1)),this.positionAdjusted=!0))}}return this._fireEvent("onPosition"),this},(e.prototype.unscroll=function(t){if(this.set=function(t,e){window.unscrollStore||(window.unscrollStore={}),window.unscrollStore[t]=e},this.get=function(t){return window.unscrollStore?window.unscrollStore[t]:null},this.getScrollbarWidth=function(){if(this.get("scrollbarWidth"))return this.get("scrollbarWidth")+"px";var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-10000",document.body.appendChild(t);var e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),this.set("scrollbarWidth",e),e+"px"},this.getElementsToAdjust=function(t){(t="string"==typeof(t=t||[])?[[t,"padding-right"]]:t).forEach((function(e,n){"string"==typeof e&&(t[n]=[e,"padding-right"])}));for(var e=!1,n=0;n<t.length;n++)-1!==t[n][0].indexOf("body")&&(e=!0);return!1===e&&t.push(["body","padding-right"]),t},this.pageHasScrollbar=function(){return this.getScrollbarWidth()&&document.body.offsetHeight>window.innerHeight},this.pageHasScrollbar()){t=this.getElementsToAdjust(t);for(var e=0;e<t.length;e++)for(var n=document.querySelectorAll(t[e][0]),i=0;i<n.length;i++){if(n[i].getAttribute("data-unscroll"))return;var o=t[e][1],r=window.getComputedStyle(n[i]).getPropertyValue(o);n[i].setAttribute("data-unscroll",o),n[i].style[o]="calc("+(r=r||"0px")+" "+("padding-right"==o||"right"==o?"+":"-")+" "+this.getScrollbarWidth()+")"}}var s,a;document.getElementById("unscroll-class-name")||(s=document.head||document.getElementsByTagName("head")[0],(a=document.createElement("style")).type="text/css",a.setAttribute("id","unscroll-class-name"),a.appendChild(document.createTextNode(".unscrollable { overflow: hidden !important; }")),s.appendChild(a)),document.body.classList.add("unscrollable")}).reset=function(){for(var t=document.querySelectorAll("[data-unscroll]"),e=0;e<t.length;e++){var n=t[e].getAttribute("data-unscroll");t[e].style[n]=null,t[e].removeAttribute("data-unscroll")}document.body.classList.remove("unscrollable")},e.prototype.open=function(n){if(n=n||{},this.isDestroyed)return this;if(this.wrapper||this._create(),this._styles||(this._styles=t("<style/>").append(this._animationCSS).appendTo(t("head"))),this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;this.options.closeOnEsc&&t(document).on("keyup.jBox-"+this.id,function(t){27==t.keyCode&&this.close({ignoreDelay:!0})}.bind(this)),!0!==this.options.closeOnClick&&"body"!==this.options.closeOnClick||(t("body").on("click.jBox-"+this.id+" tap.jBox-"+this.id,function(t){this.blockBodyClick||"body"==this.options.closeOnClick&&(t.target==this.wrapper[0]||this.wrapper.has(t.target).length)||this.close({ignoreDelay:!0})}.bind(this)),this.isTouchDevice&&t("body > *").on("click.jBox-"+this.id+" tap.jBox-"+this.id,(function(){return!0})));var i=function(){!0===this.adjustZIndexOnOpen&&(e.zIndexMax=Math.max(parseInt(this.wrapper.css("zIndex"),10),this.options.zIndex,e.zIndexMax||0,e.zIndexMaxDragover||0)+2,this.wrapper.css("zIndex",e.zIndexMax),this.options.zIndex=e.zIndexMax),this.source&&this.options.getTitle&&this.source.attr(this.options.getTitle)&&this.setTitle(this.source.attr(this.options.getTitle),!0),this.source&&this.options.getContent&&(this.source.data("jBox-getContent")?this.setContent(this.source.data("jBox-getContent"),!0):this.source.attr(this.options.getContent)?this.setContent(this.source.attr(this.options.getContent),!0):"html"==this.options.getContent&&this.setContent(this.source.html(),!0)),this._fireEvent("onOpen"),(this.options.ajax&&(this.options.ajax.url||this.source&&this.source.attr(this.options.ajax.getURL))&&(!this.ajaxLoaded||this.options.ajax.reload)||n.ajax&&(n.ajax.url||n.ajax.data))&&("strict"==this.options.ajax.reload||!this.source||!this.source.data("jBox-ajax-data")||n.ajax&&(n.ajax.url||n.ajax.data)?this.ajax(n.ajax||null,!0):this.setContent(this.source.data("jBox-ajax-data"))),this.positionedOnOpen&&!this.options.repositionOnOpen||!this.position(n)||(this.positionedOnOpen=!0),this.isClosing&&this._abortAnimation(),this.isOpen||(this.isOpen=!0,this.options.autoClose&&(this.options.delayClose=this.options.autoClose)&&this.close(),this._attachEvents(),this.options.blockScroll&&(this.options.blockScrollAdjust?e.blockScrollScopes?e.blockScrollScopes++:(e.blockScrollScopes=1,this.unscroll(Array.isArray(this.options.blockScrollAdjust)||"string"==typeof this.options.blockScrollAdjust?this.options.blockScrollAdjust:null)):t("body").addClass("jBox-blockScroll-"+this.id)),this.options.overlay&&(this._showOverlay(),this.position()),this.options.animation&&!this.isClosing&&this._animate("open"),this.options.audio&&this.options.audio.open&&this.audio(this.options.audio.open,this.options.volume.open),this.options.fade?this.wrapper.stop().animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.isOpening=!0,this.wrapper.css({display:"block"})}.bind(this),complete:function(){this._fireEvent("onOpenComplete")}.bind(this),always:function(){this.isOpening=!1,setTimeout(function(){this.positionOnFadeComplete&&this.position()&&(this.positionOnFadeComplete=!1)}.bind(this),10)}.bind(this)}):(this.wrapper.css({display:"block",opacity:1}),this.positionOnFadeComplete&&this.position()&&(this.positionOnFadeComplete=!1),this._fireEvent("onOpenComplete")))}.bind(this);return!this.options.delayOpen||this.isOpen||this.isClosing||n.ignoreDelay?i():this.timer=setTimeout(i,this.options.delayOpen),this},e.prototype.close=function(n){if(n=n||{},t("body").off("click.jBox-"+this.id+" tap.jBox-"+this.id),this.isTouchDevice&&t("body > *").off("click.jBox-"+this.id+" tap.jBox-"+this.id),this.isDestroyed||this.isClosing)return this;if(this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var i,o,r,s=function(){var n;this._fireEvent("onClose"),this.options.cancelAjaxOnClose&&this.cancelAjax(),this.isOpen&&(this.isOpen=!1,this._detachEvents(),this.options.blockScroll&&(this.options.blockScrollAdjust?(e.blockScrollScopes=e.blockScrollScopes?--e.blockScrollScopes:0)||this.unscroll.reset():t("body").removeClass("jBox-blockScroll-"+this.id)),this.options.overlay&&this._hideOverlay(),this.options.animation&&!this.isOpening&&this._animate("close"),this.options.audio&&this.options.audio.close&&this.audio(this.options.audio.close,this.options.volume.close),(n=this.isTouchDevice&&"mouse"==this.options.target?0:this.options.fade)?this.wrapper.stop().animate({opacity:0},{queue:!1,duration:n,start:function(){this.isClosing=!0}.bind(this),complete:function(){this.wrapper.css({display:"none"}),this._fireEvent("onCloseComplete")}.bind(this),always:function(){this.isClosing=!1}.bind(this)}):(this.wrapper.css({display:"none",opacity:0}),this._fireEvent("onCloseComplete")))}.bind(this);return n.ignoreDelay||this.isTouchDevice&&"mouse"==this.options.target?s():(this.options.delayOnHover||this.options.showCountdown)&&10<this.options.delayClose?(o=(i=this).options.delayClose,r=Date.now(),this.options.showCountdown&&!this.inner&&(n=t('<div class="jBox-countdown" />'),this.inner=t('<div class="jBox-countdown-inner" />'),n.prepend(this.inner),t("#"+this.id).append(n)),this.countdown=function(){var t=Date.now();i.isHovered||(o-=t-r),r=t,0<o?(i.options.showCountdown&&i.inner.css("width",100*o/i.options.delayClose+"%"),window.requestAnimationFrame(i.countdown)):s()},window.requestAnimationFrame(this.countdown)):this.timer=setTimeout(s,Math.max(this.options.delayClose,10)),this},e.prototype.toggle=function(t){return this[this.isOpen?"close":"open"](t),this},e.prototype.disable=function(){return this.isDisabled=!0,this},e.prototype.enable=function(){return this.isDisabled=!1,this},e.prototype.hide=function(){return this.disable(),this.wrapper&&(this.cacheWrapperDisplay=this.wrapper.css("display"),this.wrapper.css({display:"none"})),this.overlay&&(this.cacheOverlayDisplay=this.overlay.css("display"),this.overlay.css({display:"none"})),this},e.prototype.show=function(){return this.enable(),this.wrapper&&this.cacheWrapperDisplay&&(this.wrapper.css({display:this.cacheWrapperDisplay}),this.cacheWrapperDisplay=null),this.overlay&&this.cacheOverlayDisplay&&(this.overlay.css({display:this.cacheOverlayDisplay}),this.cacheOverlayDisplay=null),this},e.prototype.ajax=function(e,n){e=e||{},t.each([["getData","data"],["getURL","url"]],function(t,n){this.options.ajax[n[0]]&&!e[n[1]]&&this.source&&null!=this.source.attr(this.options.ajax[n[0]])&&(e[n[1]]=this.source.attr(this.options.ajax[n[0]])||"")}.bind(this));var i=t.extend(!0,{},this.options.ajax);this.cancelAjax();var o=e.beforeSend||i.beforeSend||function(){},r=e.complete||i.complete||function(){},s=e.success||i.success||function(){},a=e.error||i.error||function(){},l=t.extend(!0,i,e);return l.beforeSend=function(e){l.loadingClass&&this.wrapper.addClass(!0===l.loadingClass?"jBox-loading":l.loadingClass),l.spinner&&(this.spinnerDelay=setTimeout(function(){this.wrapper.addClass("jBox-loading-spinner"),l.spinnerReposition&&(n?this.positionOnFadeComplete=!0:this.position()),this.spinner=t(!0!==l.spinner?l.spinner:'<div class="jBox-spinner"></div>').appendTo(this.container),this.titleContainer&&"absolute"==this.spinner.css("position")&&this.spinner.css({transform:"translateY("+.5*this.titleContainer.outerHeight()+"px)"})}.bind(this),""!=this.content.html()&&l.spinnerDelay||0)),o.bind(this)(e)}.bind(this),l.complete=function(t){this.spinnerDelay&&clearTimeout(this.spinnerDelay),this.wrapper.removeClass("jBox-loading jBox-loading-spinner jBox-loading-spinner-delay"),this.spinner&&this.spinner.length&&this.spinner.remove()&&l.spinnerReposition&&(n?this.positionOnFadeComplete=!0:this.position()),this.ajaxLoaded=!0,r.bind(this)(t)}.bind(this),l.success=function(t){l.setContent&&this.setContent(t,!0)&&(n?this.positionOnFadeComplete=!0:this.position()),l.setContent&&this.source&&this.source.data("jBox-ajax-data",t),s.bind(this)(t)}.bind(this),l.error=function(t){a.bind(this)(t)}.bind(this),this.ajaxRequest=t.ajax(l),this},e.prototype.cancelAjax=function(){this.ajaxRequest&&(this.ajaxRequest.abort(),this.ajaxLoaded=!1)},e.prototype.audio=function(n,i){if(!n)return this;var o;(e._audio=e._audio?e._audio:{})[n]||(o=t("<audio/>"),t("<source/>",{src:n+".mp3"}).appendTo(o),t("<source/>",{src:n+".ogg"}).appendTo(o),e._audio[n]=o[0]),e._audio[n].volume=Math.min((null!=i?i:100)/100,1);try{e._audio[n].pause(),e._audio[n].currentTime=0}catch(n){}return e._audio[n].play(),this},e._animationSpeeds={tada:1e3,tadaSmall:1e3,flash:500,shake:400,pulseUp:250,pulseDown:250,popIn:250,popOut:250,fadeIn:200,fadeOut:200,slideUp:400,slideRight:400,slideLeft:400,slideDown:400},e.prototype.animate=function(t,n){n=n||{},this.animationTimeout||(this.animationTimeout={}),n.element||(n.element=this.wrapper),n.element.data("jBox-animating-id")||n.element.data("jBox-animating-id",e._getUniqueElementID()),n.element.data("jBox-animating")&&(n.element.removeClass(n.element.data("jBox-animating")).data("jBox-animating",null),this.animationTimeout[n.element.data("jBox-animating-id")]&&clearTimeout(this.animationTimeout[n.element.data("jBox-animating-id")])),n.element.addClass("jBox-animated-"+t).data("jBox-animating","jBox-animated-"+t),this.animationTimeout[n.element.data("jBox-animating-id")]=setTimeout((function(){n.element.removeClass(n.element.data("jBox-animating")).data("jBox-animating",null),n.complete&&n.complete()}),e._animationSpeeds[t])},e.prototype.swipeDetector=function(e,n){var i=0,o=0,r=0,s=0,a=0;return n=t.extend({swipeThreshold:70,useOnlyTouch:!1},n),e.on("mousedown touchstart",(function(t){n.useOnlyTouch&&!t.originalEvent.touches||(t.originalEvent.touches&&(t=t.originalEvent.touches[0]),0===i&&(i=1,o=t.clientX,r=t.clientY))})),t("html").on("mouseup touchend",(function(o){2===i&&(i=0,Math.abs(s)>Math.abs(a)&&Math.abs(s)>n.swipeThreshold?s<0?e.trigger(t.Event("swipeLeft.sd")):e.trigger(t.Event("swipeRight.sd")):Math.abs(a)>n.swipeThreshold&&(a<0?e.trigger(t.Event("swipeUp.sd")):e.trigger(t.Event("swipeDown.sd"))))})),t("html").on("mousemove touchmove",(function(t){var e;1===i&&(e=(t=t.originalEvent.touches?t.originalEvent.touches[0]:t).clientX-o,t=t.clientY-r,(Math.abs(e)>n.swipeThreshold||Math.abs(t)>n.swipeThreshold)&&(i=2,s=e,a=t))})),e},e.prototype.destroy=function(){return this.detach(),this.isOpen&&this.close({ignoreDelay:!0}),this.wrapper&&this.wrapper.remove(),this.overlay&&this.overlay.remove(),this._styles&&this._styles.remove(),this.isDestroyed=!0,this},e._getUniqueID=(n=1,function(){return n++}),e._getUniqueElementID=(i=1,function(){return i++}),e._pluginOptions={},e.plugin=function(t,n){e._pluginOptions[t]=n},t.fn.jBox=function(n,i){return new e(n=n||{},t.extend(i=i||{},{attach:this}))},e}function jBoxConfirmWrapper(jBox,jQuery){new jBox.plugin("Confirm",{confirmButton:"Submit",cancelButton:"Cancel",confirm:null,cancel:null,closeOnConfirm:!0,target:window,fixed:!0,attach:"[data-confirm]",getContent:"data-confirm",content:"Do you really want to do this?",minWidth:360,maxWidth:500,blockScroll:!0,closeOnEsc:!0,closeOnClick:!1,closeButton:!1,overlay:!0,animation:"zoomIn",preventDefault:!0,_onAttach:function(t){var e;this.options.confirm||(e=t.attr("onclick")?t.attr("onclick"):t.attr("href")?t.attr("target")?'window.open("'+t.attr("href")+'", "'+t.attr("target")+'");':'window.location.href = "'+t.attr("href")+'";':"",t.prop("onclick",null).data("jBox-Confirm-submit",e))},_onCreated:function(){this.wrapper.addClass("jBox-Modal"),this.footer=jQuery('<div class="jBox-Confirm-footer"/>'),jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-cancel"/>').html(this.options.cancelButton).on("click tap",function(){this.options.cancel&&this.options.cancel(this.source),this.close()}.bind(this)).appendTo(this.footer),this.submitButton=jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-submit"/>').html(this.options.confirmButton).appendTo(this.footer),this.footer.appendTo(this.container)},_onOpen:function(){this.submitButton.off("click.jBox-Confirm"+this.id+" tap.jBox-Confirm"+this.id).on("click.jBox-Confirm"+this.id+" tap.jBox-Confirm"+this.id,function(){this.options.confirm?this.options.confirm(this.source):eval(this.source.data("jBox-Confirm-submit")),this.options.closeOnConfirm&&this.close()}.bind(this))}})}function jBoxImageWrapper(t,e){new t.plugin("Image",{src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:360,imageSize:"contain",imageCounter:!1,imageCounterSeparator:"/",downloadButton:!1,downloadButtonText:null,downloadButtonUrl:null,mobileImageAttr:null,mobileImageBreakpoint:null,preloadFirstImage:!1,target:window,attach:"[data-jbox-image]",fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"button",closeButton:!0,overlay:!0,animation:"zoomIn",preventDefault:!0,width:"100%",height:"100%",adjustDistance:{top:40,right:0,bottom:40,left:0},_onInit:function(){this.images=this.currentImage={},this.imageZIndex=1,this.initImage=function(t){var n,i;(t=e(t)).data("jBox-image-gallery")||(n=t.attr(this.options.src),this.options.mobileImageAttr&&this.options.mobileImageBreakpoint&&t.attr(this.options.mobileImageAttr)&&e(window).width()<=this.options.mobileImageBreakpoint&&(n=t.attr(this.options.mobileImageAttr)),i=t.attr(this.options.gallery)||"default",this.images[i]||(this.images[i]=[]),this.images[i].push({src:n,label:t.attr(this.options.imageLabel)||"",downloadUrl:this.options.downloadButtonUrl&&t.attr(this.options.downloadButtonUrl)?t.attr(this.options.downloadButtonUrl):null}),"title"==this.options.imageLabel&&t.removeAttr("title"),t.data("jBox-image-gallery",i),t.data("jBox-image-id",this.images[i].length-1))}.bind(this),this.attachedElements&&this.attachedElements.length&&e.each(this.attachedElements,function(t,e){this.initImage(e)}.bind(this));var t=function(t,n,i,o){if(!e("#jBox-image-"+t+"-"+n).length){var r=e("<div/>",{id:"jBox-image-"+t+"-"+n,class:"jBox-image-container"+(i?" jBox-image-"+t+"-current":"")}).css({backgroundSize:this.options.imageSize,opacity:o?1:0,zIndex:i?this.imageZIndex++:0}).appendTo(this.content);return this.swipeDetector(r).on("swipeLeft.sd swipeRight.sd",function(t){"swipeLeft"===t.type?this.showImage("next"):"swipeRight"===t.type&&this.showImage("prev")}.bind(this)),e("<div/>",{id:"jBox-image-label-"+t+"-"+n,class:"jBox-image-label"+(i?" active":"")}).html(this.images[t][n].label).on("click tap",(function(){e(this).toggleClass("expanded")})).appendTo(this.imageLabelContainer),i&&r.animate({opacity:1},o?0:this.options.imageFade),r}}.bind(this);this.downloadImage=function(t){var e=document.createElement("a");e.href=t,e.setAttribute("download",t.substring(t.lastIndexOf("/")+1)),document.body.appendChild(e),e.click()};var n=function(n,i,o,r){var s=t(n,i,o,r);s.addClass("jBox-image-loading"),e('<img src="'+this.images[n][i].src+'" />').each(function(){var t=new Image;t.onload=function(){s.removeClass("jBox-image-loading"),s.css({backgroundImage:'url("'+this.images[n][i].src+'")'})}.bind(this),t.onerror=function(){s.removeClass("jBox-image-loading"),s.addClass("jBox-image-not-found")}.bind(this),t.src=this.images[n][i].src}.bind(this))}.bind(this);this.showImage=function(t){var i,o,r;if("open"!=t)i=this.currentImage.gallery,r=(r=this.currentImage.id+(+("prev"==t)?-1:1))>this.images[i].length-1?0:r<0?this.images[i].length-1:r;else{if(this.source)i=this.source.data("jBox-image-gallery"),r=this.source.data("jBox-image-id");else{if(!this.attachedElements||!this.attachedElements.length)return;i=e(this.attachedElements[0]).data("jBox-image-gallery"),r=e(this.attachedElements[0]).data("jBox-image-id")}this.images&&this.images[i]&&e(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:1<this.images[i].length?"block":"none"})}e(".jBox-image-"+i+"-current").length&&e(".jBox-image-"+i+"-current").removeClass("jBox-image-"+i+"-current").animate({opacity:0},"open"==t?0:this.options.imageFade),this.currentImage={gallery:i,id:r},e("#jBox-image-"+i+"-"+r).length?e("#jBox-image-"+i+"-"+r).addClass("jBox-image-"+i+"-current").css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==t?0:this.options.imageFade):n(i,r,!0,"open"===t),o=i,t=r,e(".jBox-image-label.active").removeClass("active expanded"),e("#jBox-image-label-"+o+"-"+t).addClass("active"),this.imageCounter&&(this.images[i]&&1<this.images[i].length?(this.wrapper.addClass("jBox-image-has-counter"),this.imageCounter.find(".jBox-image-counter-all").html(this.images[i].length),this.imageCounter.find(".jBox-image-counter-current").html(r+1)):this.wrapper.removeClass("jBox-image-has-counter")),this.images[i]&&this.images[i].length-1&&(r=(r+=1)>this.images[i].length-1?0:r<0?this.images[i].length-1:r,e("#jBox-image-"+i+"-"+r).length||n(i,r,!1,!1))},this.options.preloadFirstImage&&e(window).on("load",function(){this.showImage("open")}.bind(this))},_onAttach:function(t){this.initImage&&this.initImage(t)},_onCreated:function(){this.imageLabelWrapper=e('<div class="jBox-image-label-wrapper"/>').appendTo(this.wrapper),this.imagePrevButton=e('<div class="jBox-image-pointer-prev"/>').on("click tap",function(){this.showImage("prev")}.bind(this)),this.imageNextButton=e('<div class="jBox-image-pointer-next"/>').on("click tap",function(){this.showImage("next")}.bind(this)),this.imageLabelContainer=e('<div class="jBox-image-label-container"/>'),this.imageLabelWrapper.append(this.imagePrevButton).append(this.imageLabelContainer).append(this.imageNextButton),this.options.downloadButton&&(this.downloadButton=e("<div/>",{class:"jBox-image-download-button-wrapper"}).appendTo(this.wrapper).append(this.options.downloadButtonText?e("<div/>",{class:"jBox-image-download-button-text"}).html(this.options.downloadButtonText):null).append(e("<div/>",{class:"jBox-image-download-button-icon"})).on("click tap",function(){var t;t=this.images[this.currentImage.gallery][this.currentImage.id].downloadUrl||this.wrapper.find(".jBox-image-"+this.currentImage.gallery+"-current")[0].style.backgroundImage.slice(4,-1).replace(/["']/g,""),this.downloadImage(t)}.bind(this))),this.options.imageCounter&&(this.imageCounter=e("<div/>",{class:"jBox-image-counter-container"}).insertAfter(this.imageLabelContainer),this.imageCounter.append(e("<span/>",{class:"jBox-image-counter-current"})).append(e("<span/>").html(this.options.imageCounterSeparator)).append(e("<span/>",{class:"jBox-image-counter-all"})))},_onOpen:function(){e(document).on("keyup.jBox-Image-"+this.id,function(t){37==t.keyCode&&this.showImage("prev"),39==t.keyCode&&this.showImage("next")}.bind(this)),this.showImage("open")},_onClose:function(){e(document).off("keyup.jBox-Image-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}})}function jBoxNoticeWrapper(t,e){new t.plugin("Notice",{color:null,stack:!0,stackSpacing:10,autoClose:6e3,attributes:{x:"right",y:"top"},position:{x:15,y:15},responsivePositions:{500:{x:5,y:5},768:{x:10,y:10}},target:window,fixed:!0,animation:"zoomIn",closeOnClick:"box",zIndex:12e3,_onInit:function(){this.defaultNoticePosition=e.extend({},this.options.position),this._adjustNoticePositon=function(){var t=e(window),n=t.width();t.height(),this.options.position=e.extend({},this.defaultNoticePosition),e.each(this.options.responsivePositions,function(t,e){if(n<=t)return this.options.position=e,!1}.bind(this)),this.options.adjustDistance={top:this.options.position.y,right:this.options.position.x,bottom:this.options.position.y,left:this.options.position.x}},this.options.content instanceof e&&(this.options.content=this.options.content.clone().attr("id","")),e(window).on("resize.responsivejBoxNotice-"+this.id,function(t){this.isOpen&&this._adjustNoticePositon()}.bind(this)),this.open()},_onCreated:function(){this.wrapper.addClass("jBox-Notice-color jBox-Notice-"+(this.options.color||"gray")),this.wrapper.data("jBox-Notice-position",this.options.attributes.x+"-"+this.options.attributes.y)},_onOpen:function(){this.options.stack||(this._adjustNoticePositon(),e.each(e(".jBox-Notice"),function(t,n){(n=e(n)).attr("id")!=this.id&&n.data("jBox-Notice-position")==this.options.attributes.x+"-"+this.options.attributes.y&&(this.options.stack||n.data("jBox").close({ignoreDelay:!0}))}.bind(this)))},_onPosition:function(){var t,n={};for(t in e.each(e(".jBox-Notice"),(function(t,i){var o=(i=e(i)).data("jBox-Notice-position");n[o]||(n[o]=[]),n[o].push(i)})),n){var i=t.split("-")[1];n[t].reverse();var o,r=0;for(o in n[t]){var s=e(n[t][o]);s.css("margin-"+i,r),r+=s.outerHeight()+this.options.stackSpacing}}},_onCloseComplete:function(){this.destroy(),this.options._onPosition.bind(this).call()}})}!function(t,e){__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(755)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(e){return t.jBox=function(t){var e=jBoxWrapper(t);try{void 0!==jBoxConfirmWrapper&&jBoxConfirmWrapper&&jBoxConfirmWrapper(e,t)}catch(t){console.error(t)}try{void 0!==jBoxImageWrapper&&jBoxImageWrapper&&jBoxImageWrapper(e,t)}catch(t){console.error(t)}try{void 0!==jBoxNoticeWrapper&&jBoxNoticeWrapper&&jBoxNoticeWrapper(e,t)}catch(t){console.error(t)}return e}(e)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(this)},755:function(t,e){var n;!function(e,n){"use strict";"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(i,o){"use strict";var r=[],s=Object.getPrototypeOf,a=r.slice,l=r.flat?function(t){return r.flat.call(t)}:function(t){return r.concat.apply([],t)},c=r.push,u=r.indexOf,d={},h=d.toString,p=d.hasOwnProperty,f=p.toString,g=f.call(Object),m={},y=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},v=function(t){return null!=t&&t===t.window},b=i.document,x={type:!0,src:!0,nonce:!0,noModule:!0};function _(t,e,n){var i,o,r=(n=n||b).createElement("script");if(r.text=t,e)for(i in x)(o=e[i]||e.getAttribute&&e.getAttribute(i))&&r.setAttribute(i,o);n.head.appendChild(r).parentNode.removeChild(r)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?d[h.call(t)]||"object":typeof t}var S="3.6.0",E=function(t,e){return new E.fn.init(t,e)};function T(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!y(t)&&!v(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}E.fn=E.prototype={jquery:S,constructor:E,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=E.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return E.each(this,t)},map:function(t){return this.pushStack(E.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(E.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:r.sort,splice:r.splice},E.extend=E.fn.extend=function(){var t,e,n,i,o,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||y(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(c&&i&&(E.isPlainObject(i)||(o=Array.isArray(i)))?(n=s[e],r=o&&!Array.isArray(n)?[]:o||E.isPlainObject(n)?n:{},o=!1,s[e]=E.extend(c,r,i)):void 0!==i&&(s[e]=i));return s},E.extend({expando:"jQuery"+(S+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==h.call(t)||(e=s(t))&&("function"!=typeof(n=p.call(e,"constructor")&&e.constructor)||f.call(n)!==g))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){_(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(T(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?E.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:u.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,o=t.length;i<n;i++)t[o++]=e[i];return t.length=o,t},grep:function(t,e,n){for(var i=[],o=0,r=t.length,s=!n;o<r;o++)!e(t[o],o)!==s&&i.push(t[o]);return i},map:function(t,e,n){var i,o,r=0,s=[];if(T(t))for(i=t.length;r<i;r++)null!=(o=e(t[r],r,n))&&s.push(o);else for(r in t)null!=(o=e(t[r],r,n))&&s.push(o);return l(s)},guid:1,support:m}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=r[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){d["[object "+e+"]"]=e.toLowerCase()}));var A=function(t){var e,n,i,o,r,s,a,l,c,u,d,h,p,f,g,m,y,v,b,x="sizzle"+1*new Date,_=t.document,w=0,S=0,E=lt(),T=lt(),A=lt(),k=lt(),C=function(t,e){return t===e&&(d=!0),0},D={}.hasOwnProperty,N=[],I=N.pop,j=N.push,M=N.push,B=N.slice,L=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",z="[\\x20\\t\\r\\n\\f]",P="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",H="\\[[\\x20\\t\\r\\n\\f]*("+P+")(?:"+z+"*([*^$|!~]?=)"+z+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+P+"))|)"+z+"*\\]",R=":("+P+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+H+")*)|.*)\\)|)",U=new RegExp(z+"+","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),q=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),F=new RegExp(z+"|>"),$=new RegExp(R),Y=new RegExp("^"+P+"$"),Q={ID:new RegExp("^#("+P+")"),CLASS:new RegExp("^\\.("+P+")"),TAG:new RegExp("^("+P+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ot=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},rt=function(){h()},st=xt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{M.apply(N=B.call(_.childNodes),_.childNodes),N[_.childNodes.length].nodeType}catch(t){M={apply:N.length?function(t,e){j.apply(t,B.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,o){var r,a,c,u,d,f,y,v=e&&e.ownerDocument,_=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==_&&9!==_&&11!==_)return i;if(!o&&(h(e),e=e||p,g)){if(11!==_&&(d=J.exec(t)))if(r=d[1]){if(9===_){if(!(c=e.getElementById(r)))return i;if(c.id===r)return i.push(c),i}else if(v&&(c=v.getElementById(r))&&b(e,c)&&c.id===r)return i.push(c),i}else{if(d[2])return M.apply(i,e.getElementsByTagName(t)),i;if((r=d[3])&&n.getElementsByClassName&&e.getElementsByClassName)return M.apply(i,e.getElementsByClassName(r)),i}if(n.qsa&&!k[t+" "]&&(!m||!m.test(t))&&(1!==_||"object"!==e.nodeName.toLowerCase())){if(y=t,v=e,1===_&&(F.test(t)||W.test(t))){for((v=tt.test(t)&&yt(e.parentNode)||e)===e&&n.scope||((u=e.getAttribute("id"))?u=u.replace(it,ot):e.setAttribute("id",u=x)),a=(f=s(t)).length;a--;)f[a]=(u?"#"+u:":scope")+" "+bt(f[a]);y=f.join(",")}try{return M.apply(i,v.querySelectorAll(y)),i}catch(e){k(t,!0)}finally{u===x&&e.removeAttribute("id")}}}return l(t.replace(V,"$1"),e,i,o)}function lt(){var t=[];return function e(n,o){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=o}}function ct(t){return t[x]=!0,t}function ut(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function dt(t,e){for(var n=t.split("|"),o=n.length;o--;)i.attrHandle[n[o]]=e}function ht(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ct((function(e){return e=+e,ct((function(n,i){for(var o,r=t([],n.length,e),s=r.length;s--;)n[o=r[s]]&&(n[o]=!(i[o]=n[o]))}))}))}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},r=at.isXML=function(t){var e=t&&t.namespaceURI,n=t&&(t.ownerDocument||t).documentElement;return!X.test(e||n&&n.nodeName||"HTML")},h=at.setDocument=function(t){var e,o,s=t?t.ownerDocument||t:_;return s!=p&&9===s.nodeType&&s.documentElement?(f=(p=s).documentElement,g=!r(p),_!=p&&(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",rt,!1):o.attachEvent&&o.attachEvent("onunload",rt)),n.scope=ut((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Z.test(p.getElementsByClassName),n.getById=ut((function(t){return f.appendChild(t).id=x,!p.getElementsByName||!p.getElementsByName(x).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,o,r=e.getElementById(t);if(r){if((n=r.getAttributeNode("id"))&&n.value===t)return[r];for(o=e.getElementsByName(t),i=0;r=o[i++];)if((n=r.getAttributeNode("id"))&&n.value===t)return[r]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},y=[],m=[],(n.qsa=Z.test(p.querySelectorAll))&&(ut((function(t){var e;f.appendChild(t).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+O+")"),t.querySelectorAll("[id~="+x+"-]").length||m.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+x+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Z.test(v=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",R)})),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),e=Z.test(f.compareDocumentPosition),b=e||Z.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},C=e?function(t,e){if(t===e)return d=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==p||t.ownerDocument==_&&b(_,t)?-1:e==p||e.ownerDocument==_&&b(_,e)?1:u?L(u,t)-L(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return d=!0,0;var n,i=0,o=t.parentNode,r=e.parentNode,s=[t],a=[e];if(!o||!r)return t==p?-1:e==p?1:o?-1:r?1:u?L(u,t)-L(u,e):0;if(o===r)return ht(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?ht(s[i],a[i]):s[i]==_?-1:a[i]==_?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(h(t),n.matchesSelector&&g&&!k[e+" "]&&(!y||!y.test(e))&&(!m||!m.test(e)))try{var i=v.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){k(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&h(t),b(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&h(t);var o=i.attrHandle[e.toLowerCase()],r=o&&D.call(i.attrHandle,e.toLowerCase())?o(t,e,!g):void 0;return void 0!==r?r:n.attributes||!g?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},at.escape=function(t){return(t+"").replace(it,ot)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],o=0,r=0;if(d=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(C),d){for(;e=t[r++];)e===t[r]&&(o=i.push(r));for(;o--;)t.splice(i[o],1)}return u=null,t},o=at.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=o(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=o(e);return n},i=at.selectors={cacheLength:50,createPseudo:ct,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Q.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&$.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+z+"|$)"))&&E(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var o=at.attr(i,t);return null==o?"!="===e:!e||(o+="","="===e?o===n:"!="===e?o!==n:"^="===e?n&&0===o.indexOf(n):"*="===e?n&&o.indexOf(n)>-1:"$="===e?n&&o.slice(-n.length)===n:"~="===e?(" "+o.replace(U," ")+" ").indexOf(n)>-1:"|="===e&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,o){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var c,u,d,h,p,f,g=r!==s?"nextSibling":"previousSibling",m=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!l&&!a,b=!1;if(m){if(r){for(;g;){for(h=e;h=h[g];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&v){for(b=(p=(c=(u=(d=(h=m)[x]||(h[x]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&c[1])&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(b=p=0)||f.pop();)if(1===h.nodeType&&++b&&h===e){u[t]=[w,p,b];break}}else if(v&&(b=p=(c=(u=(d=(h=e)[x]||(h[x]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]||[])[0]===w&&c[1]),!1===b)for(;(h=++p&&h&&h[g]||(b=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++b||(v&&((u=(d=h[x]||(h[x]={}))[h.uniqueID]||(d[h.uniqueID]={}))[t]=[w,b]),h!==e)););return(b-=o)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,o=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return o[x]?o(e):o.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,n){for(var i,r=o(t,e),s=r.length;s--;)t[i=L(t,r[s])]=!(n[i]=r[s])})):function(t){return o(t,0,n)}):o}},pseudos:{not:ct((function(t){var e=[],n=[],i=a(t.replace(V,"$1"));return i[x]?ct((function(t,e,n,o){for(var r,s=i(t,null,o,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))})):function(t,o,r){return e[0]=t,i(e,null,r,n),e[0]=null,!n.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||o(e)).indexOf(t)>-1}})),lang:ct((function(t){return Y.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return G.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:mt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ft(e);function vt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function xt(t,e,n){var i=e.dir,o=e.next,r=o||i,s=n&&"parentNode"===r,a=S++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,o);return!1}:function(e,n,l){var c,u,d,h=[w,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(u=(d=e[x]||(e[x]={}))[e.uniqueID]||(d[e.uniqueID]={}),o&&o===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=u[r])&&c[0]===w&&c[1]===a)return h[2]=c[2];if(u[r]=h,h[2]=t(e,n,l))return!0}return!1}}function _t(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function wt(t,e,n,i,o){for(var r,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(r=t[a])&&(n&&!n(r,i,o)||(s.push(r),c&&e.push(a)));return s}function St(t,e,n,i,o,r){return i&&!i[x]&&(i=St(i)),o&&!o[x]&&(o=St(o,r)),ct((function(r,s,a,l){var c,u,d,h=[],p=[],f=s.length,g=r||function(t,e,n){for(var i=0,o=e.length;i<o;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!r&&e?g:wt(g,h,t,a,l),y=n?o||(r?t:f||i)?[]:s:m;if(n&&n(m,y,a,l),i)for(c=wt(y,p),i(c,[],a,l),u=c.length;u--;)(d=c[u])&&(y[p[u]]=!(m[p[u]]=d));if(r){if(o||t){if(o){for(c=[],u=y.length;u--;)(d=y[u])&&c.push(m[u]=d);o(null,y=[],c,l)}for(u=y.length;u--;)(d=y[u])&&(c=o?L(r,d):h[u])>-1&&(r[c]=!(s[c]=d))}}else y=wt(y===s?y.splice(f,y.length):y),o?o(null,s,y,l):M.apply(s,y)}))}function Et(t){for(var e,n,o,r=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,u=xt((function(t){return t===e}),a,!0),d=xt((function(t){return L(e,t)>-1}),a,!0),h=[function(t,n,i){var o=!s&&(i||n!==c)||((e=n).nodeType?u(t,n,i):d(t,n,i));return e=null,o}];l<r;l++)if(n=i.relative[t[l].type])h=[xt(_t(h),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[x]){for(o=++l;o<r&&!i.relative[t[o].type];o++);return St(l>1&&_t(h),l>1&&bt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(V,"$1"),n,l<o&&Et(t.slice(l,o)),o<r&&Et(t=t.slice(o)),o<r&&bt(t))}h.push(n)}return _t(h)}return vt.prototype=i.filters=i.pseudos,i.setFilters=new vt,s=at.tokenize=function(t,e){var n,o,r,s,a,l,c,u=T[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=i.preFilter;a;){for(s in n&&!(o=q.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),n=!1,(o=W.exec(a))&&(n=o.shift(),r.push({value:n,type:o[0].replace(V," ")}),a=a.slice(n.length)),i.filter)!(o=Q[s].exec(a))||c[s]&&!(o=c[s](o))||(n=o.shift(),r.push({value:n,type:s,matches:o}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):T(t,l).slice(0)},a=at.compile=function(t,e){var n,o=[],r=[],a=A[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=Et(e[n]))[x]?o.push(a):r.push(a);a=A(t,function(t,e){var n=e.length>0,o=t.length>0,r=function(r,s,a,l,u){var d,f,m,y=0,v="0",b=r&&[],x=[],_=c,S=r||o&&i.find.TAG("*",u),E=w+=null==_?1:Math.random()||.1,T=S.length;for(u&&(c=s==p||s||u);v!==T&&null!=(d=S[v]);v++){if(o&&d){for(f=0,s||d.ownerDocument==p||(h(d),a=!g);m=t[f++];)if(m(d,s||p,a)){l.push(d);break}u&&(w=E)}n&&((d=!m&&d)&&y--,r&&b.push(d))}if(y+=v,n&&v!==y){for(f=0;m=e[f++];)m(b,x,s,a);if(r){if(y>0)for(;v--;)b[v]||x[v]||(x[v]=I.call(l));x=wt(x)}M.apply(l,x),u&&!r&&x.length>0&&y+e.length>1&&at.uniqueSort(l)}return u&&(w=E,c=_),b};return n?ct(r):r}(r,o)),a.selector=t}return a},l=at.select=function(t,e,n,o){var r,l,c,u,d,h="function"==typeof t&&t,p=!o&&s(t=h.selector||t);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&g&&i.relative[l[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(r=Q.needsContext.test(t)?0:l.length;r--&&(c=l[r],!i.relative[u=c.type]);)if((d=i.find[u])&&(o=d(c.matches[0].replace(et,nt),tt.test(l[0].type)&&yt(e.parentNode)||e))){if(l.splice(r,1),!(t=o.length&&bt(l)))return M.apply(n,o),n;break}}return(h||a(t,p))(o,e,!g,n,!e||tt.test(t)&&yt(e.parentNode)||e),n},n.sortStable=x.split("").sort(C).join("")===x,n.detectDuplicates=!!d,h(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||dt("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||dt("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||dt(O,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(i);E.find=A,E.expr=A.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=A.uniqueSort,E.text=A.getText,E.isXMLDoc=A.isXML,E.contains=A.contains,E.escapeSelector=A.escape;var k=function(t,e,n){for(var i=[],o=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&E(t).is(n))break;i.push(t)}return i},C=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},D=E.expr.match.needsContext;function N(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var I=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(t,e,n){return y(e)?E.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?E.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?E.grep(t,(function(t){return u.call(e,t)>-1!==n})):E.filter(e,t,n)}E.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?E.find.matchesSelector(i,t)?[i]:[]:E.find.matches(t,E.grep(e,(function(t){return 1===t.nodeType})))},E.fn.extend({find:function(t){var e,n,i=this.length,o=this;if("string"!=typeof t)return this.pushStack(E(t).filter((function(){for(e=0;e<i;e++)if(E.contains(o[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)E.find(t,o[e],n);return i>1?E.uniqueSort(n):n},filter:function(t){return this.pushStack(j(this,t||[],!1))},not:function(t){return this.pushStack(j(this,t||[],!0))},is:function(t){return!!j(this,"string"==typeof t&&D.test(t)?E(t):t||[],!1).length}});var M,B=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(t,e,n){var i,o;if(!t)return this;if(n=n||M,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:B.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof E?e[0]:e,E.merge(this,E.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:b,!0)),I.test(i[1])&&E.isPlainObject(e))for(i in e)y(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(o=b.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==n.ready?n.ready(t):t(E):E.makeArray(t,this)}).prototype=E.fn,M=E(b);var L=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function z(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}E.fn.extend({has:function(t){var e=E(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(E.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,o=this.length,r=[],s="string"!=typeof t&&E(t);if(!D.test(t))for(;i<o;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&E.find.matchesSelector(n,t))){r.push(n);break}return this.pushStack(r.length>1?E.uniqueSort(r):r)},index:function(t){return t?"string"==typeof t?u.call(E(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),E.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return k(t,"parentNode")},parentsUntil:function(t,e,n){return k(t,"parentNode",n)},next:function(t){return z(t,"nextSibling")},prev:function(t){return z(t,"previousSibling")},nextAll:function(t){return k(t,"nextSibling")},prevAll:function(t){return k(t,"previousSibling")},nextUntil:function(t,e,n){return k(t,"nextSibling",n)},prevUntil:function(t,e,n){return k(t,"previousSibling",n)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return null!=t.contentDocument&&s(t.contentDocument)?t.contentDocument:(N(t,"template")&&(t=t.content||t),E.merge([],t.childNodes))}},(function(t,e){E.fn[t]=function(n,i){var o=E.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=E.filter(i,o)),this.length>1&&(O[t]||E.uniqueSort(o),L.test(t)&&o.reverse()),this.pushStack(o)}}));var P=/[^\x20\t\r\n\f]+/g;function H(t){return t}function R(t){throw t}function U(t,e,n,i){var o;try{t&&y(o=t.promise)?o.call(t).done(e).fail(n):t&&y(o=t.then)?o.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}E.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return E.each(t.match(P)||[],(function(t,n){e[n]=!0})),e}(t):E.extend({},t);var e,n,i,o,r=[],s=[],a=-1,l=function(){for(o=o||t.once,i=e=!0;s.length;a=-1)for(n=s.shift();++a<r.length;)!1===r[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=r.length,n=!1);t.memory||(n=!1),e=!1,o&&(r=n?[]:"")},c={add:function(){return r&&(n&&!e&&(a=r.length-1,s.push(n)),function e(n){E.each(n,(function(n,i){y(i)?t.unique&&c.has(i)||r.push(i):i&&i.length&&"string"!==w(i)&&e(i)}))}(arguments),n&&!e&&l()),this},remove:function(){return E.each(arguments,(function(t,e){for(var n;(n=E.inArray(e,r,n))>-1;)r.splice(n,1),n<=a&&a--})),this},has:function(t){return t?E.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=n="",this},disabled:function(){return!r},lock:function(){return o=s=[],n||e||(r=n=""),this},locked:function(){return!!o},fireWith:function(t,n){return o||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},E.extend({Deferred:function(t){var e=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return E.Deferred((function(n){E.each(e,(function(e,i){var o=y(t[i[4]])&&t[i[4]];r[i[1]]((function(){var t=o&&o.apply(this,arguments);t&&y(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,o?[t]:arguments)}))})),t=null})).promise()},then:function(t,n,o){var r=0;function s(t,e,n,o){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<r)){if((i=n.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,y(c)?o?c.call(i,s(r,e,H,o),s(r,e,R,o)):(r++,c.call(i,s(r,e,H,o),s(r,e,R,o),s(r,e,H,e.notifyWith))):(n!==H&&(a=void 0,l=[i]),(o||e.resolveWith)(a,l))}},u=o?c:function(){try{c()}catch(i){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(i,u.stackTrace),t+1>=r&&(n!==R&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(E.Deferred.getStackHook&&(u.stackTrace=E.Deferred.getStackHook()),i.setTimeout(u))}}return E.Deferred((function(i){e[0][3].add(s(0,i,y(o)?o:H,i.notifyWith)),e[1][3].add(s(0,i,y(t)?t:H)),e[2][3].add(s(0,i,y(n)?n:R))})).promise()},promise:function(t){return null!=t?E.extend(t,o):o}},r={};return E.each(e,(function(t,i){var s=i[2],a=i[5];o[i[1]]=s.add,a&&s.add((function(){n=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(i[3].fire),r[i[0]]=function(){return r[i[0]+"With"](this===r?void 0:this,arguments),this},r[i[0]+"With"]=s.fireWith})),o.promise(r),t&&t.call(r,r),r},when:function(t){var e=arguments.length,n=e,i=Array(n),o=a.call(arguments),r=E.Deferred(),s=function(t){return function(n){i[t]=this,o[t]=arguments.length>1?a.call(arguments):n,--e||r.resolveWith(i,o)}};if(e<=1&&(U(t,r.done(s(n)).resolve,r.reject,!e),"pending"===r.state()||y(o[n]&&o[n].then)))return r.then();for(;n--;)U(o[n],s(n),r.reject);return r.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&V.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},E.readyException=function(t){i.setTimeout((function(){throw t}))};var q=E.Deferred();function W(){b.removeEventListener("DOMContentLoaded",W),i.removeEventListener("load",W),E.ready()}E.fn.ready=function(t){return q.then(t).catch((function(t){E.readyException(t)})),this},E.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--E.readyWait:E.isReady)||(E.isReady=!0,!0!==t&&--E.readyWait>0||q.resolveWith(b,[E]))}}),E.ready.then=q.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?i.setTimeout(E.ready):(b.addEventListener("DOMContentLoaded",W),i.addEventListener("load",W));var F=function(t,e,n,i,o,r,s){var a=0,l=t.length,c=null==n;if("object"===w(n))for(a in o=!0,n)F(t,e,a,n[a],!0,r,s);else if(void 0!==i&&(o=!0,y(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(E(t),n)})),e))for(;a<l;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return o?t:c?e.call(t):l?e(t[0],n):r},$=/^-ms-/,Y=/-([a-z])/g;function Q(t,e){return e.toUpperCase()}function X(t){return t.replace($,"ms-").replace(Y,Q)}var K=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function G(){this.expando=E.expando+G.uid++}G.uid=1,G.prototype={cache:function(t){var e=t[this.expando];return e||(e={},K(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,o=this.cache(t);if("string"==typeof e)o[X(e)]=n;else for(i in e)o[X(i)]=e[i];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][X(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(X):(e=X(e))in i?[e]:e.match(P)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||E.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!E.isEmptyObject(e)}};var Z=new G,J=new G,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(t){}J.set(t,e,n)}else n=void 0;return n}E.extend({hasData:function(t){return J.hasData(t)||Z.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return Z.access(t,e,n)},_removeData:function(t,e){Z.remove(t,e)}}),E.fn.extend({data:function(t,e){var n,i,o,r=this[0],s=r&&r.attributes;if(void 0===t){if(this.length&&(o=J.get(r),1===r.nodeType&&!Z.get(r,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=X(i.slice(5)),nt(r,i,o[i]));Z.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each((function(){J.set(this,t)})):F(this,(function(e){var n;if(r&&void 0===e)return void 0!==(n=J.get(r,t))||void 0!==(n=nt(r,t))?n:void 0;this.each((function(){J.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){J.remove(this,t)}))}}),E.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Z.get(t,e),n&&(!i||Array.isArray(n)?i=Z.access(t,e,E.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=E.queue(t,e),i=n.length,o=n.shift(),r=E._queueHooks(t,e);"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===e&&n.unshift("inprogress"),delete r.stop,o.call(t,(function(){E.dequeue(t,e)}),r)),!i&&r&&r.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Z.get(t,n)||Z.access(t,n,{empty:E.Callbacks("once memory").add((function(){Z.remove(t,[e+"queue",n])}))})}}),E.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?E.queue(this[0],t):void 0===e?this:this.each((function(){var n=E.queue(this,t,e);E._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&E.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){E.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,o=E.Deferred(),r=this,s=this.length,a=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Z.get(r[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),o.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ot=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),rt=["Top","Right","Bottom","Left"],st=b.documentElement,at=function(t){return E.contains(t.ownerDocument,t)},lt={composed:!0};st.getRootNode&&(at=function(t){return E.contains(t.ownerDocument,t)||t.getRootNode(lt)===t.ownerDocument});var ct=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===E.css(t,"display")};function ut(t,e,n,i){var o,r,s=20,a=i?function(){return i.cur()}:function(){return E.css(t,e,"")},l=a(),c=n&&n[3]||(E.cssNumber[e]?"":"px"),u=t.nodeType&&(E.cssNumber[e]||"px"!==c&&+l)&&ot.exec(E.css(t,e));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)E.style(t,e,u+c),(1-r)*(1-(r=a()/l||.5))<=0&&(s=0),u/=r;u*=2,E.style(t,e,u+c),n=n||[]}return n&&(u=+u||+l||0,o=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=o)),o}var dt={};function ht(t){var e,n=t.ownerDocument,i=t.nodeName,o=dt[i];return o||(e=n.body.appendChild(n.createElement(i)),o=E.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),dt[i]=o,o)}function pt(t,e){for(var n,i,o=[],r=0,s=t.length;r<s;r++)(i=t[r]).style&&(n=i.style.display,e?("none"===n&&(o[r]=Z.get(i,"display")||null,o[r]||(i.style.display="")),""===i.style.display&&ct(i)&&(o[r]=ht(i))):"none"!==n&&(o[r]="none",Z.set(i,"display",n)));for(r=0;r<s;r++)null!=o[r]&&(t[r].style.display=o[r]);return t}E.fn.extend({show:function(){return pt(this,!0)},hide:function(){return pt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ct(this)?E(this).show():E(this).hide()}))}});var ft,gt,mt=/^(?:checkbox|radio)$/i,yt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i;ft=b.createDocumentFragment().appendChild(b.createElement("div")),(gt=b.createElement("input")).setAttribute("type","radio"),gt.setAttribute("checked","checked"),gt.setAttribute("name","t"),ft.appendChild(gt),m.checkClone=ft.cloneNode(!0).cloneNode(!0).lastChild.checked,ft.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!ft.cloneNode(!0).lastChild.defaultValue,ft.innerHTML="<option></option>",m.option=!!ft.lastChild;var bt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function xt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&N(t,e)?E.merge([t],n):n}function _t(t,e){for(var n=0,i=t.length;n<i;n++)Z.set(t[n],"globalEval",!e||Z.get(e[n],"globalEval"))}bt.tbody=bt.tfoot=bt.colgroup=bt.caption=bt.thead,bt.th=bt.td,m.option||(bt.optgroup=bt.option=[1,"<select multiple='multiple'>","</select>"]);var wt=/<|&#?\w+;/;function St(t,e,n,i,o){for(var r,s,a,l,c,u,d=e.createDocumentFragment(),h=[],p=0,f=t.length;p<f;p++)if((r=t[p])||0===r)if("object"===w(r))E.merge(h,r.nodeType?[r]:r);else if(wt.test(r)){for(s=s||d.appendChild(e.createElement("div")),a=(yt.exec(r)||["",""])[1].toLowerCase(),l=bt[a]||bt._default,s.innerHTML=l[1]+E.htmlPrefilter(r)+l[2],u=l[0];u--;)s=s.lastChild;E.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(e.createTextNode(r));for(d.textContent="",p=0;r=h[p++];)if(i&&E.inArray(r,i)>-1)o&&o.push(r);else if(c=at(r),s=xt(d.appendChild(r),"script"),c&&_t(s),n)for(u=0;r=s[u++];)vt.test(r.type||"")&&n.push(r);return d}var Et=/^([^.]*)(?:\.(.+)|)/;function Tt(){return!0}function At(){return!1}function kt(t,e){return t===function(){try{return b.activeElement}catch(t){}}()==("focus"===e)}function Ct(t,e,n,i,o,r){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Ct(t,a,n,i,e[a],r);return t}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),!1===o)o=At;else if(!o)return t;return 1===r&&(s=o,o=function(t){return E().off(t),s.apply(this,arguments)},o.guid=s.guid||(s.guid=E.guid++)),t.each((function(){E.event.add(this,e,o,i,n)}))}function Dt(t,e,n){n?(Z.set(t,e,!1),E.event.add(t,e,{namespace:!1,handler:function(t){var i,o,r=Z.get(this,e);if(1&t.isTrigger&&this[e]){if(r.length)(E.event.special[e]||{}).delegateType&&t.stopPropagation();else if(r=a.call(arguments),Z.set(this,e,r),i=n(this,e),this[e](),r!==(o=Z.get(this,e))||i?Z.set(this,e,!1):o={},r!==o)return t.stopImmediatePropagation(),t.preventDefault(),o&&o.value}else r.length&&(Z.set(this,e,{value:E.event.trigger(E.extend(r[0],E.Event.prototype),r.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Z.get(t,e)&&E.event.add(t,e,Tt)}E.event={global:{},add:function(t,e,n,i,o){var r,s,a,l,c,u,d,h,p,f,g,m=Z.get(t);if(K(t))for(n.handler&&(n=(r=n).handler,o=r.selector),o&&E.find.matchesSelector(st,o),n.guid||(n.guid=E.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(e){return void 0!==E&&E.event.triggered!==e.type?E.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(P)||[""]).length;c--;)p=g=(a=Et.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(d=E.event.special[p]||{},p=(o?d.delegateType:d.bindType)||p,d=E.event.special[p]||{},u=E.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&E.expr.match.needsContext.test(o),namespace:f.join(".")},r),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,i,f,s)||t.addEventListener&&t.addEventListener(p,s)),d.add&&(d.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,u):h.push(u),E.event.global[p]=!0)},remove:function(t,e,n,i,o){var r,s,a,l,c,u,d,h,p,f,g,m=Z.hasData(t)&&Z.get(t);if(m&&(l=m.events)){for(c=(e=(e||"").match(P)||[""]).length;c--;)if(p=g=(a=Et.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=E.event.special[p]||{},h=l[p=(i?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=h.length;r--;)u=h[r],!o&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(h.splice(r,1),u.selector&&h.delegateCount--,d.remove&&d.remove.call(t,u));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(t,f,m.handle)||E.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)E.event.remove(t,p+e[c],n,i,!0);E.isEmptyObject(l)&&Z.remove(t,"handle events")}},dispatch:function(t){var e,n,i,o,r,s,a=new Array(arguments.length),l=E.event.fix(t),c=(Z.get(this,"events")||Object.create(null))[l.type]||[],u=E.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=E.event.handlers.call(this,l,c),e=0;(o=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(i=((E.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,i,o,r,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(r=[],s={},n=0;n<l;n++)void 0===s[o=(i=e[n]).selector+" "]&&(s[o]=i.needsContext?E(o,this).index(c)>-1:E.find(o,this,null,[c]).length),s[o]&&r.push(i);r.length&&a.push({elem:c,handlers:r})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(E.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[E.expando]?t:new E.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return mt.test(e.type)&&e.click&&N(e,"input")&&Dt(e,"click",Tt),!1},trigger:function(t){var e=this||t;return mt.test(e.type)&&e.click&&N(e,"input")&&Dt(e,"click"),!0},_default:function(t){var e=t.target;return mt.test(e.type)&&e.click&&N(e,"input")&&Z.get(e,"click")||N(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},E.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},E.Event=function(t,e){if(!(this instanceof E.Event))return new E.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Tt:At,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&E.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:At,isPropagationStopped:At,isImmediatePropagationStopped:At,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Tt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Tt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Tt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},(function(t,e){E.event.special[t]={setup:function(){return Dt(this,t,kt),!1},trigger:function(){return Dt(this,t),!0},_default:function(){return!0},delegateType:e}})),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){E.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,o=t.relatedTarget,r=t.handleObj;return o&&(o===i||E.contains(i,o))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}})),E.fn.extend({on:function(t,e,n,i){return Ct(this,t,e,n,i)},one:function(t,e,n,i){return Ct(this,t,e,n,i,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,E(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=At),this.each((function(){E.event.remove(this,t,n,e)}))}});var Nt=/<script|<style|<link/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,jt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Mt(t,e){return N(t,"table")&&N(11!==e.nodeType?e:e.firstChild,"tr")&&E(t).children("tbody")[0]||t}function Bt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Lt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ot(t,e){var n,i,o,r,s,a;if(1===e.nodeType){if(Z.hasData(t)&&(a=Z.get(t).events))for(o in Z.remove(e,"handle events"),a)for(n=0,i=a[o].length;n<i;n++)E.event.add(e,o,a[o][n]);J.hasData(t)&&(r=J.access(t),s=E.extend({},r),J.set(e,s))}}function zt(t,e){var n=e.nodeName.toLowerCase();"input"===n&&mt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Pt(t,e,n,i){e=l(e);var o,r,s,a,c,u,d=0,h=t.length,p=h-1,f=e[0],g=y(f);if(g||h>1&&"string"==typeof f&&!m.checkClone&&It.test(f))return t.each((function(o){var r=t.eq(o);g&&(e[0]=f.call(this,o,r.html())),Pt(r,e,n,i)}));if(h&&(r=(o=St(e,t[0].ownerDocument,!1,t,i)).firstChild,1===o.childNodes.length&&(o=r),r||i)){for(a=(s=E.map(xt(o,"script"),Bt)).length;d<h;d++)c=o,d!==p&&(c=E.clone(c,!0,!0),a&&E.merge(s,xt(c,"script"))),n.call(t[d],c,d);if(a)for(u=s[s.length-1].ownerDocument,E.map(s,Lt),d=0;d<a;d++)c=s[d],vt.test(c.type||"")&&!Z.access(c,"globalEval")&&E.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?E._evalUrl&&!c.noModule&&E._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):_(c.textContent.replace(jt,""),c,u))}return t}function Ht(t,e,n){for(var i,o=e?E.filter(e,t):t,r=0;null!=(i=o[r]);r++)n||1!==i.nodeType||E.cleanData(xt(i)),i.parentNode&&(n&&at(i)&&_t(xt(i,"script")),i.parentNode.removeChild(i));return t}E.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,o,r,s,a=t.cloneNode(!0),l=at(t);if(!(m.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||E.isXMLDoc(t)))for(s=xt(a),i=0,o=(r=xt(t)).length;i<o;i++)zt(r[i],s[i]);if(e)if(n)for(r=r||xt(t),s=s||xt(a),i=0,o=r.length;i<o;i++)Ot(r[i],s[i]);else Ot(t,a);return(s=xt(a,"script")).length>0&&_t(s,!l&&xt(t,"script")),a},cleanData:function(t){for(var e,n,i,o=E.event.special,r=0;void 0!==(n=t[r]);r++)if(K(n)){if(e=n[Z.expando]){if(e.events)for(i in e.events)o[i]?E.event.remove(n,i):E.removeEvent(n,i,e.handle);n[Z.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),E.fn.extend({detach:function(t){return Ht(this,t,!0)},remove:function(t){return Ht(this,t)},text:function(t){return F(this,(function(t){return void 0===t?E.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Pt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Mt(this,t).appendChild(t)}))},prepend:function(){return Pt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Mt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Pt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Pt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(E.cleanData(xt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return E.clone(this,t,e)}))},html:function(t){return F(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Nt.test(t)&&!bt[(yt.exec(t)||["",""])[1].toLowerCase()]){t=E.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(E.cleanData(xt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Pt(this,arguments,(function(e){var n=this.parentNode;E.inArray(this,t)<0&&(E.cleanData(xt(this)),n&&n.replaceChild(e,this))}),t)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){E.fn[t]=function(t){for(var n,i=[],o=E(t),r=o.length-1,s=0;s<=r;s++)n=s===r?this:this.clone(!0),E(o[s])[e](n),c.apply(i,n.get());return this.pushStack(i)}}));var Rt=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),Ut=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},Vt=function(t,e,n){var i,o,r={};for(o in e)r[o]=t.style[o],t.style[o]=e[o];for(o in i=n.call(t),e)t.style[o]=r[o];return i},qt=new RegExp(rt.join("|"),"i");function Wt(t,e,n){var i,o,r,s,a=t.style;return(n=n||Ut(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||at(t)||(s=E.style(t,e)),!m.pixelBoxStyles()&&Rt.test(s)&&qt.test(e)&&(i=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function Ft(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",st.appendChild(c).appendChild(u);var t=i.getComputedStyle(u);n="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",s=36===e(t.right),o=36===e(t.width),u.style.position="absolute",r=12===e(u.offsetWidth/3),st.removeChild(c),u=null}}function e(t){return Math.round(parseFloat(t))}var n,o,r,s,a,l,c=b.createElement("div"),u=b.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===u.style.backgroundClip,E.extend(m,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),r},reliableTrDimensions:function(){var t,e,n,o;return null==a&&(t=b.createElement("table"),e=b.createElement("tr"),n=b.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="border:1px solid",e.style.height="1px",n.style.height="9px",n.style.display="block",st.appendChild(t).appendChild(e).appendChild(n),o=i.getComputedStyle(e),a=parseInt(o.height,10)+parseInt(o.borderTopWidth,10)+parseInt(o.borderBottomWidth,10)===e.offsetHeight,st.removeChild(t)),a}}))}();var $t=["Webkit","Moz","ms"],Yt=b.createElement("div").style,Qt={};function Xt(t){return E.cssProps[t]||Qt[t]||(t in Yt?t:Qt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=$t.length;n--;)if((t=$t[n]+e)in Yt)return t}(t)||t)}var Kt=/^(none|table(?!-c[ea]).+)/,Gt=/^--/,Zt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"};function te(t,e,n){var i=ot.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ee(t,e,n,i,o,r){var s="width"===e?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=E.css(t,n+rt[s],!0,o)),i?("content"===n&&(l-=E.css(t,"padding"+rt[s],!0,o)),"margin"!==n&&(l-=E.css(t,"border"+rt[s]+"Width",!0,o))):(l+=E.css(t,"padding"+rt[s],!0,o),"padding"!==n?l+=E.css(t,"border"+rt[s]+"Width",!0,o):a+=E.css(t,"border"+rt[s]+"Width",!0,o));return!i&&r>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-r-l-a-.5))||0),l}function ne(t,e,n){var i=Ut(t),o=(!m.boxSizingReliable()||n)&&"border-box"===E.css(t,"boxSizing",!1,i),r=o,s=Wt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Rt.test(s)){if(!n)return s;s="auto"}return(!m.boxSizingReliable()&&o||!m.reliableTrDimensions()&&N(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===E.css(t,"display",!1,i))&&t.getClientRects().length&&(o="border-box"===E.css(t,"boxSizing",!1,i),(r=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+ee(t,e,n||(o?"border":"content"),r,i,s)+"px"}function ie(t,e,n,i,o){return new ie.prototype.init(t,e,n,i,o)}E.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Wt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,s,a=X(e),l=Gt.test(e),c=t.style;if(l||(e=Xt(a)),s=E.cssHooks[e]||E.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(o=s.get(t,!1,i))?o:c[e];"string"==(r=typeof n)&&(o=ot.exec(n))&&o[1]&&(n=ut(t,e,o),r="number"),null!=n&&n==n&&("number"!==r||l||(n+=o&&o[3]||(E.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,i){var o,r,s,a=X(e);return Gt.test(e)||(e=Xt(a)),(s=E.cssHooks[e]||E.cssHooks[a])&&"get"in s&&(o=s.get(t,!0,n)),void 0===o&&(o=Wt(t,e,i)),"normal"===o&&e in Jt&&(o=Jt[e]),""===n||n?(r=parseFloat(o),!0===n||isFinite(r)?r||0:o):o}}),E.each(["height","width"],(function(t,e){E.cssHooks[e]={get:function(t,n,i){if(n)return!Kt.test(E.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ne(t,e,i):Vt(t,Zt,(function(){return ne(t,e,i)}))},set:function(t,n,i){var o,r=Ut(t),s=!m.scrollboxSize()&&"absolute"===r.position,a=(s||i)&&"border-box"===E.css(t,"boxSizing",!1,r),l=i?ee(t,e,i,a,r):0;return a&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(r[e])-ee(t,e,"border",!1,r)-.5)),l&&(o=ot.exec(n))&&"px"!==(o[3]||"px")&&(t.style[e]=n,n=E.css(t,e)),te(0,n,l)}}})),E.cssHooks.marginLeft=Ft(m.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Wt(t,"marginLeft"))||t.getBoundingClientRect().left-Vt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),E.each({margin:"",padding:"",border:"Width"},(function(t,e){E.cssHooks[t+e]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];i<4;i++)o[t+rt[i]+e]=r[i]||r[i-2]||r[0];return o}},"margin"!==t&&(E.cssHooks[t+e].set=te)})),E.fn.extend({css:function(t,e){return F(this,(function(t,e,n){var i,o,r={},s=0;if(Array.isArray(e)){for(i=Ut(t),o=e.length;s<o;s++)r[e[s]]=E.css(t,e[s],!1,i);return r}return void 0!==n?E.style(t,e,n):E.css(t,e)}),t,e,arguments.length>1)}}),E.Tween=ie,ie.prototype={constructor:ie,init:function(t,e,n,i,o,r){this.elem=t,this.prop=n,this.easing=o||E.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=r||(E.cssNumber[n]?"":"px")},cur:function(){var t=ie.propHooks[this.prop];return t&&t.get?t.get(this):ie.propHooks._default.get(this)},run:function(t){var e,n=ie.propHooks[this.prop];return this.options.duration?this.pos=e=E.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ie.propHooks._default.set(this),this}},ie.prototype.init.prototype=ie.prototype,ie.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=E.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){E.fx.step[t.prop]?E.fx.step[t.prop](t):1!==t.elem.nodeType||!E.cssHooks[t.prop]&&null==t.elem.style[Xt(t.prop)]?t.elem[t.prop]=t.now:E.style(t.elem,t.prop,t.now+t.unit)}}},ie.propHooks.scrollTop=ie.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},E.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},E.fx=ie.prototype.init,E.fx.step={};var oe,re,se=/^(?:toggle|show|hide)$/,ae=/queueHooks$/;function le(){re&&(!1===b.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(le):i.setTimeout(le,E.fx.interval),E.fx.tick())}function ce(){return i.setTimeout((function(){oe=void 0})),oe=Date.now()}function ue(t,e){var n,i=0,o={height:t};for(e=e?1:0;i<4;i+=2-e)o["margin"+(n=rt[i])]=o["padding"+n]=t;return e&&(o.opacity=o.width=t),o}function de(t,e,n){for(var i,o=(he.tweeners[e]||[]).concat(he.tweeners["*"]),r=0,s=o.length;r<s;r++)if(i=o[r].call(n,e,t))return i}function he(t,e,n){var i,o,r=0,s=he.prefilters.length,a=E.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var e=oe||ce(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),r=0,s=c.tweens.length;r<s;r++)c.tweens[r].run(i);return a.notifyWith(t,[c,i,n]),i<1&&s?n:(s||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:E.extend({},e),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},n),originalProperties:e,originalOptions:n,startTime:oe||ce(),duration:n.duration,tweens:[],createTween:function(e,n){var i=E.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(o)return this;for(o=!0;n<i;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var n,i,o,r,s;for(n in t)if(o=e[i=X(n)],r=t[n],Array.isArray(r)&&(o=r[1],r=t[n]=r[0]),n!==i&&(t[i]=r,delete t[n]),(s=E.cssHooks[i])&&"expand"in s)for(n in r=s.expand(r),delete t[i],r)n in t||(t[n]=r[n],e[n]=o);else e[i]=o}(u,c.opts.specialEasing);r<s;r++)if(i=he.prefilters[r].call(c,t,u,c.opts))return y(i.stop)&&(E._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return E.map(u,de,c),y(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),E.fx.timer(E.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}E.Animation=E.extend(he,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ut(n.elem,t,ot.exec(e),n),n}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(P);for(var n,i=0,o=t.length;i<o;i++)n=t[i],he.tweeners[n]=he.tweeners[n]||[],he.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,o,r,s,a,l,c,u,d="width"in e||"height"in e,h=this,p={},f=t.style,g=t.nodeType&&ct(t),m=Z.get(t,"fxshow");for(i in n.queue||(null==(s=E._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,h.always((function(){h.always((function(){s.unqueued--,E.queue(t,"fx").length||s.empty.fire()}))}))),e)if(o=e[i],se.test(o)){if(delete e[i],r=r||"toggle"===o,o===(g?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||E.style(t,i)}if((l=!E.isEmptyObject(e))||!E.isEmptyObject(p))for(i in d&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=m&&m.display)&&(c=Z.get(t,"display")),"none"===(u=E.css(t,"display"))&&(c?u=c:(pt([t],!0),c=t.style.display||c,u=E.css(t,"display"),pt([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===E.css(t,"float")&&(l||(h.done((function(){f.display=c})),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=Z.access(t,"fxshow",{display:c}),r&&(m.hidden=!g),g&&pt([t],!0),h.done((function(){for(i in g||pt([t]),Z.remove(t,"fxshow"),p)E.style(t,i,p[i])}))),l=de(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?he.prefilters.unshift(t):he.prefilters.push(t)}}),E.speed=function(t,e,n){var i=t&&"object"==typeof t?E.extend({},t):{complete:n||!n&&e||y(t)&&t,duration:t,easing:n&&e||e&&!y(e)&&e};return E.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in E.fx.speeds?i.duration=E.fx.speeds[i.duration]:i.duration=E.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&E.dequeue(this,i.queue)},i},E.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ct).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=E.isEmptyObject(t),r=E.speed(e,n,i),s=function(){var e=he(this,E.extend({},t),r);(o||Z.get(this,"finish"))&&e.stop(!0)};return s.finish=s,o||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,o=null!=t&&t+"queueHooks",r=E.timers,s=Z.get(this);if(o)s[o]&&s[o].stop&&i(s[o]);else for(o in s)s[o]&&s[o].stop&&ae.test(o)&&i(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(n),e=!1,r.splice(o,1));!e&&n||E.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=Z.get(this),i=n[t+"queue"],o=n[t+"queueHooks"],r=E.timers,s=i?i.length:0;for(n.finish=!0,E.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),E.each(["toggle","show","hide"],(function(t,e){var n=E.fn[e];E.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ue(e,!0),t,i,o)}})),E.each({slideDown:ue("show"),slideUp:ue("hide"),slideToggle:ue("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){E.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),E.timers=[],E.fx.tick=function(){var t,e=0,n=E.timers;for(oe=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||E.fx.stop(),oe=void 0},E.fx.timer=function(t){E.timers.push(t),E.fx.start()},E.fx.interval=13,E.fx.start=function(){re||(re=!0,le())},E.fx.stop=function(){re=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(t,e){return t=E.fx&&E.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var o=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(o)}}))},function(){var t=b.createElement("input"),e=b.createElement("select").appendChild(b.createElement("option"));t.type="checkbox",m.checkOn=""!==t.value,m.optSelected=e.selected,(t=b.createElement("input")).value="t",t.type="radio",m.radioValue="t"===t.value}();var pe,fe=E.expr.attrHandle;E.fn.extend({attr:function(t,e){return F(this,E.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){E.removeAttr(this,t)}))}}),E.extend({attr:function(t,e,n){var i,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===t.getAttribute?E.prop(t,e,n):(1===r&&E.isXMLDoc(t)||(o=E.attrHooks[e.toLowerCase()]||(E.expr.match.bool.test(e)?pe:void 0)),void 0!==n?null===n?void E.removeAttr(t,e):o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:(t.setAttribute(e,n+""),n):o&&"get"in o&&null!==(i=o.get(t,e))?i:null==(i=E.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&N(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,o=e&&e.match(P);if(o&&1===t.nodeType)for(;n=o[i++];)t.removeAttribute(n)}}),pe={set:function(t,e,n){return!1===e?E.removeAttr(t,n):t.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=fe[e]||E.find.attr;fe[e]=function(t,e,i){var o,r,s=e.toLowerCase();return i||(r=fe[s],fe[s]=o,o=null!=n(t,e,i)?s:null,fe[s]=r),o}}));var ge=/^(?:input|select|textarea|button)$/i,me=/^(?:a|area)$/i;function ye(t){return(t.match(P)||[]).join(" ")}function ve(t){return t.getAttribute&&t.getAttribute("class")||""}function be(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(P)||[]}E.fn.extend({prop:function(t,e){return F(this,E.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[E.propFix[t]||t]}))}}),E.extend({prop:function(t,e,n){var i,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&E.isXMLDoc(t)||(e=E.propFix[e]||e,o=E.propHooks[e]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:t[e]=n:o&&"get"in o&&null!==(i=o.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=E.find.attr(t,"tabindex");return e?parseInt(e,10):ge.test(t.nodeName)||me.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(E.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){E.propFix[this.toLowerCase()]=this})),E.fn.extend({addClass:function(t){var e,n,i,o,r,s,a,l=0;if(y(t))return this.each((function(e){E(this).addClass(t.call(this,e,ve(this)))}));if((e=be(t)).length)for(;n=this[l++];)if(o=ve(n),i=1===n.nodeType&&" "+ye(o)+" "){for(s=0;r=e[s++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");o!==(a=ye(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,o,r,s,a,l=0;if(y(t))return this.each((function(e){E(this).removeClass(t.call(this,e,ve(this)))}));if(!arguments.length)return this.attr("class","");if((e=be(t)).length)for(;n=this[l++];)if(o=ve(n),i=1===n.nodeType&&" "+ye(o)+" "){for(s=0;r=e[s++];)for(;i.indexOf(" "+r+" ")>-1;)i=i.replace(" "+r+" "," ");o!==(a=ye(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):y(t)?this.each((function(n){E(this).toggleClass(t.call(this,n,ve(this),e),e)})):this.each((function(){var e,o,r,s;if(i)for(o=0,r=E(this),s=be(t);e=s[o++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||((e=ve(this))&&Z.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Z.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ye(ve(n))+" ").indexOf(e)>-1)return!0;return!1}});var xe=/\r/g;E.fn.extend({val:function(t){var e,n,i,o=this[0];return arguments.length?(i=y(t),this.each((function(n){var o;1===this.nodeType&&(null==(o=i?t.call(this,n,E(this).val()):t)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=E.map(o,(function(t){return null==t?"":t+""}))),(e=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))}))):o?(e=E.valHooks[o.type]||E.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(xe,""):null==n?"":n:void 0}}),E.extend({valHooks:{option:{get:function(t){var e=E.find.attr(t,"value");return null!=e?e:ye(E.text(t))}},select:{get:function(t){var e,n,i,o=t.options,r=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?r+1:o.length;for(i=r<0?l:s?r:0;i<l;i++)if(((n=o[i]).selected||i===r)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(e=E(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,o=t.options,r=E.makeArray(e),s=o.length;s--;)((i=o[s]).selected=E.inArray(E.valHooks.option.get(i),r)>-1)&&(n=!0);return n||(t.selectedIndex=-1),r}}}}),E.each(["radio","checkbox"],(function(){E.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=E.inArray(E(t).val(),e)>-1}},m.checkOn||(E.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),m.focusin="onfocusin"in i;var _e=/^(?:focusinfocus|focusoutblur)$/,we=function(t){t.stopPropagation()};E.extend(E.event,{trigger:function(t,e,n,o){var r,s,a,l,c,u,d,h,f=[n||b],g=p.call(t,"type")?t.type:t,m=p.call(t,"namespace")?t.namespace.split("."):[];if(s=h=a=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!_e.test(g+E.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[E.expando]?t:new E.Event(g,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:E.makeArray(e,[t]),d=E.event.special[g]||{},o||!d.trigger||!1!==d.trigger.apply(n,e))){if(!o&&!d.noBubble&&!v(n)){for(l=d.delegateType||g,_e.test(l+g)||(s=s.parentNode);s;s=s.parentNode)f.push(s),a=s;a===(n.ownerDocument||b)&&f.push(a.defaultView||a.parentWindow||i)}for(r=0;(s=f[r++])&&!t.isPropagationStopped();)h=s,t.type=r>1?l:d.bindType||g,(u=(Z.get(s,"events")||Object.create(null))[t.type]&&Z.get(s,"handle"))&&u.apply(s,e),(u=c&&s[c])&&u.apply&&K(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=g,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),e)||!K(n)||c&&y(n[g])&&!v(n)&&((a=n[c])&&(n[c]=null),E.event.triggered=g,t.isPropagationStopped()&&h.addEventListener(g,we),n[g](),t.isPropagationStopped()&&h.removeEventListener(g,we),E.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(t,e,n){var i=E.extend(new E.Event,n,{type:t,isSimulated:!0});E.event.trigger(i,null,e)}}),E.fn.extend({trigger:function(t,e){return this.each((function(){E.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return E.event.trigger(t,e,n,!0)}}),m.focusin||E.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){E.event.simulate(e,t.target,E.event.fix(t))};E.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,o=Z.access(i,e);o||i.addEventListener(t,n,!0),Z.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,o=Z.access(i,e)-1;o?Z.access(i,e,o):(i.removeEventListener(t,n,!0),Z.remove(i,e))}}}));var Se=i.location,Ee={guid:Date.now()},Te=/\?/;E.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){}return n=e&&e.getElementsByTagName("parsererror")[0],e&&!n||E.error("Invalid XML: "+(n?E.map(n.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var Ae=/\[\]$/,ke=/\r?\n/g,Ce=/^(?:submit|button|image|reset|file)$/i,De=/^(?:input|select|textarea|keygen)/i;function Ne(t,e,n,i){var o;if(Array.isArray(e))E.each(e,(function(e,o){n||Ae.test(t)?i(t,o):Ne(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,n,i)}));else if(n||"object"!==w(e))i(t,e);else for(o in e)Ne(t+"["+o+"]",e[o],n,i)}E.param=function(t,e){var n,i=[],o=function(t,e){var n=y(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!E.isPlainObject(t))E.each(t,(function(){o(this.name,this.value)}));else for(n in t)Ne(n,t[n],e,o);return i.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=E.prop(this,"elements");return t?E.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!E(this).is(":disabled")&&De.test(this.nodeName)&&!Ce.test(t)&&(this.checked||!mt.test(t))})).map((function(t,e){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,(function(t){return{name:e.name,value:t.replace(ke,"\r\n")}})):{name:e.name,value:n.replace(ke,"\r\n")}})).get()}});var Ie=/%20/g,je=/#.*$/,Me=/([?&])_=[^&]*/,Be=/^(.*?):[ \t]*([^\r\n]*)$/gm,Le=/^(?:GET|HEAD)$/,Oe=/^\/\//,ze={},Pe={},He="*/".concat("*"),Re=b.createElement("a");function Ue(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,r=e.toLowerCase().match(P)||[];if(y(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function Ve(t,e,n,i){var o={},r=t===Pe;function s(a){var l;return o[a]=!0,E.each(t[a]||[],(function(t,a){var c=a(e,n,i);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)})),l}return s(e.dataTypes[0])||!o["*"]&&s("*")}function qe(t,e){var n,i,o=E.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((o[n]?t:i||(i={}))[n]=e[n]);return i&&E.extend(!0,t,i),t}Re.href=Se.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Se.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Se.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":He,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?qe(qe(t,E.ajaxSettings),e):qe(E.ajaxSettings,t)},ajaxPrefilter:Ue(ze),ajaxTransport:Ue(Pe),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,o,r,s,a,l,c,u,d,h,p=E.ajaxSetup({},e),f=p.context||p,g=p.context&&(f.nodeType||f.jquery)?E(f):E.event,m=E.Deferred(),y=E.Callbacks("once memory"),v=p.statusCode||{},x={},_={},w="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Be.exec(r);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?r:null},setRequestHeader:function(t,e){return null==c&&(t=_[t.toLowerCase()]=_[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)S.always(t[S.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||w;return n&&n.abort(e),T(0,e),this}};if(m.promise(S),p.url=((t||p.url||Se.href)+"").replace(Oe,Se.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(P)||[""],null==p.crossDomain){l=b.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Re.protocol+"//"+Re.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=E.param(p.data,p.traditional)),Ve(ze,p,e,S),c)return S;for(d in(u=E.event&&p.global)&&0==E.active++&&E.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Le.test(p.type),o=p.url.replace(je,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ie,"+")):(h=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(Te.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(Me,"$1"),h=(Te.test(o)?"&":"?")+"_="+Ee.guid+++h),p.url=o+h),p.ifModified&&(E.lastModified[o]&&S.setRequestHeader("If-Modified-Since",E.lastModified[o]),E.etag[o]&&S.setRequestHeader("If-None-Match",E.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+He+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(f,S,p)||c))return S.abort();if(w="abort",y.add(p.complete),S.done(p.success),S.fail(p.error),n=Ve(Pe,p,e,S)){if(S.readyState=1,u&&g.trigger("ajaxSend",[S,p]),c)return S;p.async&&p.timeout>0&&(a=i.setTimeout((function(){S.abort("timeout")}),p.timeout));try{c=!1,n.send(x,T)}catch(t){if(c)throw t;T(-1,t)}}else T(-1,"No Transport");function T(t,e,s,l){var d,h,b,x,_,w=e;c||(c=!0,a&&i.clearTimeout(a),n=void 0,r=l||"",S.readyState=t>0?4:0,d=t>=200&&t<300||304===t,s&&(x=function(t,e,n){for(var i,o,r,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(o in a)if(a[o]&&a[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}if(r)return r!==l[0]&&l.unshift(r),n[r]}(p,S,s)),!d&&E.inArray("script",p.dataTypes)>-1&&E.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),x=function(t,e,n,i){var o,r,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(r=u.shift();r;)if(t.responseFields[r]&&(n[t.responseFields[r]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(o in c)if((a=o.split(" "))[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[o]:!0!==c[o]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}(p,x,S,d),d?(p.ifModified&&((_=S.getResponseHeader("Last-Modified"))&&(E.lastModified[o]=_),(_=S.getResponseHeader("etag"))&&(E.etag[o]=_)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=x.state,h=x.data,d=!(b=x.error))):(b=w,!t&&w||(w="error",t<0&&(t=0))),S.status=t,S.statusText=(e||w)+"",d?m.resolveWith(f,[h,w,S]):m.rejectWith(f,[S,w,b]),S.statusCode(v),v=void 0,u&&g.trigger(d?"ajaxSuccess":"ajaxError",[S,p,d?h:b]),y.fireWith(f,[S,w]),u&&(g.trigger("ajaxComplete",[S,p]),--E.active||E.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,n){return E.get(t,e,n,"json")},getScript:function(t,e){return E.get(t,void 0,e,"script")}}),E.each(["get","post"],(function(t,e){E[e]=function(t,n,i,o){return y(n)&&(o=o||i,i=n,n=void 0),E.ajax(E.extend({url:t,type:e,dataType:o,data:n,success:i},E.isPlainObject(t)&&t))}})),E.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),E._evalUrl=function(t,e,n){return E.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){E.globalEval(t,e,n)}})},E.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=E(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y(t)?this.each((function(e){E(this).wrapInner(t.call(this,e))})):this.each((function(){var e=E(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y(t);return this.each((function(n){E(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){E(this).replaceWith(this.childNodes)})),this}}),E.expr.pseudos.hidden=function(t){return!E.expr.pseudos.visible(t)},E.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var We={0:200,1223:204},Fe=E.ajaxSettings.xhr();m.cors=!!Fe&&"withCredentials"in Fe,m.ajax=Fe=!!Fe,E.ajaxTransport((function(t){var e,n;if(m.cors||Fe&&!t.crossDomain)return{send:function(o,r){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)a.setRequestHeader(s,o[s]);e=function(t){return function(){e&&(e=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(We[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),n=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){e&&n()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),E.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return E.globalEval(t),t}}}),E.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),E.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,o){e=E("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),b.head.appendChild(e[0])},abort:function(){n&&n()}}}));var $e,Ye=[],Qe=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ye.pop()||E.expando+"_"+Ee.guid++;return this[t]=!0,t}}),E.ajaxPrefilter("json jsonp",(function(t,e,n){var o,r,s,a=!1!==t.jsonp&&(Qe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Qe,"$1"+o):!1!==t.jsonp&&(t.url+=(Te.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||E.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=i[o],i[o]=function(){s=arguments},n.always((function(){void 0===r?E(i).removeProp(o):i[o]=r,t[o]&&(t.jsonpCallback=e.jsonpCallback,Ye.push(o)),s&&y(r)&&r(s[0]),s=r=void 0})),"script"})),m.createHTMLDocument=(($e=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===$e.childNodes.length),E.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(m.createHTMLDocument?((i=(e=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,e.head.appendChild(i)):e=b),r=!n&&[],(o=I.exec(t))?[e.createElement(o[1])]:(o=St([t],e,r),r&&r.length&&E(r).remove(),E.merge([],o.childNodes)));var i,o,r},E.fn.load=function(t,e,n){var i,o,r,s=this,a=t.indexOf(" ");return a>-1&&(i=ye(t.slice(a)),t=t.slice(0,a)),y(e)?(n=e,e=void 0):e&&"object"==typeof e&&(o="POST"),s.length>0&&E.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done((function(t){r=arguments,s.html(i?E("<div>").append(E.parseHTML(t)).find(i):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,r||[t.responseText,e,t])}))}),this},E.expr.pseudos.animated=function(t){return E.grep(E.timers,(function(e){return t===e.elem})).length},E.offset={setOffset:function(t,e,n){var i,o,r,s,a,l,c=E.css(t,"position"),u=E(t),d={};"static"===c&&(t.style.position="relative"),a=u.offset(),r=E.css(t,"top"),l=E.css(t,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(s=(i=u.position()).top,o=i.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),y(e)&&(e=e.call(t,n,E.extend({},a))),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+o),"using"in e?e.using.call(t,d):u.css(d)}},E.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){E.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],o={top:0,left:0};if("fixed"===E.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===E.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((o=E(t).offset()).top+=E.css(t,"borderTopWidth",!0),o.left+=E.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-E.css(i,"marginTop",!0),left:e.left-o.left-E.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===E.css(t,"position");)t=t.offsetParent;return t||st}))}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;E.fn[t]=function(i){return F(this,(function(t,i,o){var r;if(v(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===o)return r?r[e]:t[i];r?r.scrollTo(n?r.pageXOffset:o,n?o:r.pageYOffset):t[i]=o}),t,i,arguments.length)}})),E.each(["top","left"],(function(t,e){E.cssHooks[e]=Ft(m.pixelPosition,(function(t,n){if(n)return n=Wt(t,e),Rt.test(n)?E(t).position()[e]+"px":n}))})),E.each({Height:"height",Width:"width"},(function(t,e){E.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){E.fn[i]=function(o,r){var s=arguments.length&&(n||"boolean"!=typeof o),a=n||(!0===o||!0===r?"margin":"border");return F(this,(function(e,n,o){var r;return v(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===o?E.css(e,n,a):E.style(e,n,o,a)}),e,s?o:void 0,s)}}))})),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){E.fn[e]=function(t){return this.on(e,t)}})),E.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){E.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var Xe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;E.proxy=function(t,e){var n,i,o;if("string"==typeof e&&(n=t[e],e=t,t=n),y(t))return i=a.call(arguments,2),o=function(){return t.apply(e||this,i.concat(a.call(arguments)))},o.guid=t.guid=t.guid||E.guid++,o},E.holdReady=function(t){t?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=N,E.isFunction=y,E.isWindow=v,E.camelCase=X,E.type=w,E.now=Date.now,E.isNumeric=function(t){var e=E.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},E.trim=function(t){return null==t?"":(t+"").replace(Xe,"")},void 0===(n=function(){return E}.apply(e,[]))||(t.exports=n);var Ke=i.jQuery,Ge=i.$;return E.noConflict=function(t){return i.$===E&&(i.$=Ge),t&&i.jQuery===E&&(i.jQuery=Ke),E},void 0===o&&(i.jQuery=i.$=E),E}))},846:t=>{t.exports=function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};e[s][0].call(c.exports,(function(t){return o(e[s][1][t]||t)}),c,c.exports,t,e,n,i)}return n[s].exports}for(var r=void 0,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return new function(t){if(this._event=t,this._data=t.data,this.receivedTime=t.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&t.data[0],this.channel=15&t.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&t.data[1],this.velocity=127&t.data[2];break;case 144:this.messageType="noteon",this.key=127&t.data[1],this.velocity=127&t.data[2];break;case 160:this.messageType="keypressure",this.key=127&t.data[1],this.pressure=127&t.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&t.data[1],this.controllerValue=127&t.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=t.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&t.data[1];break;case 224:this.messageType="pitchbendchange";var e=127&t.data[2],n=127&t.data[1];this.pitchBend=(e<<8)+n}}(t)},e.exports=n.default},{}]},{},[1])(1)},681:(t,e,n)=>{"use strict";function i(t,e){return Array(e+1).join(t)}function o(t){return"number"==typeof t}function r(t,e){return Math.pow(2,(t-69)/12)*(e||440)}n.r(e),n.d(e,{regex:()=>a,parse:()=>c,build:()=>u,midi:()=>d,freq:()=>h,letter:()=>p,acc:()=>f,pc:()=>g,step:()=>m,alt:()=>y,chroma:()=>v,oct:()=>b});var s=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function a(){return s}var l=[0,2,4,5,7,9,11];function c(t,e,n){if("string"!=typeof t)return null;var i=s.exec(t);if(!i||!e&&i[4])return null;var o={letter:i[1].toUpperCase(),acc:i[2].replace(/x/g,"##")};o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length;var a=l[o.step]+o.alt;return o.chroma=a<0?12+a:a%12,i[3]&&(o.oct=+i[3],o.midi=a+12*(o.oct+1),o.freq=r(o.midi,n)),e&&(o.tonicOf=i[4]),o}function u(t,e,n){return null==t?null:t.step?u(t.step,t.alt,t.oct):t<0||t>6?null:"CDEFGAB".charAt(t)+(o(r=e)?r<0?i("b",-r):i("#",r):"")+function(t){return o(t)?""+t:""}(n);var r}function d(t){if((o(t)||"string"==typeof t)&&t>=0&&t<128)return+t;var e=c(t);return e&&void 0!==e.midi?e.midi:null}function h(t,e){var n=d(t);return null===n?null:r(n,e)}function p(t){return(c(t)||{}).letter}function f(t){return(c(t)||{}).acc}function g(t){return(c(t)||{}).pc}function m(t){return(c(t)||{}).step}function y(t){return(c(t)||{}).alt}function v(t){return(c(t)||{}).chroma}function b(t){return(c(t)||{}).oct}},986:function(t){var e;"undefined"!=typeof self&&self,e=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){(function(e){t.exports=function(t,n){var i,o,r,s,a,l,c,u=e.window,d=u.document,h=d.documentElement,p=d.querySelector("body"),f=t.getContext("2d"),g=function(t){return"rgba(0,0,0,".concat(t/100,")")},m=Object.assign({viewport:null,styles:{"header,footer,section,article":g(8),"h1,a":g(10),"h2,h3,h4":g(8)},back:g(2),view:g(5),drag:g(10),interval:null},n),y=function(t,e,n,i){return n.split(/\s+/).forEach((function(n){return t[e](n,i)}))},v=function(t,e,n){return y(t,"addEventListener",e,n)},b=function(t,e,n){return y(t,"removeEventListener",e,n)},x=function(t,e,n,i){return{x:t,y:e,w:n,h:i}},_=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return x(t.x-e.x,t.y-e.y,t.w,t.h)},w=function(t){var e=t.getBoundingClientRect();return{x:e.left+u.pageXOffset,y:e.top+u.pageYOffset}},S=function(t){var e=w(t),n=e.x,i=e.y;return x(n+t.clientLeft,i+t.clientTop,t.clientWidth,t.clientHeight)},E=(i=t.clientWidth,o=t.clientHeight,function(t,e){return Math.min(i/t,o/e)}),T=m.viewport,A=!1,k=function(t,e){e&&(f.beginPath(),f.rect(t.x,t.y,t.w,t.h),f.fillStyle=e,f.fill())},C=function(){var e,n,i,o,l,c,p;r=T?(i=(n=w(e=T)).x,o=n.y,x(i+e.clientLeft-e.scrollLeft,o+e.clientTop-e.scrollTop,e.scrollWidth,e.scrollHeight)):x(0,0,h.scrollWidth,h.scrollHeight),s=T?S(T):x(u.pageXOffset,u.pageYOffset,h.clientWidth,h.clientHeight),a=E(r.w,r.h),l=r.w*a,c=r.h*a,t.width=l,t.height=c,t.style.width="".concat(l,"px"),t.style.height="".concat(c,"px"),f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,t.width,t.height),f.scale(a,a),k(_(r,r),m.back),p=m.styles,Object.keys(p).forEach((function(t){var e=p[t];(function(t){return Array.from((T||d).querySelectorAll(t))})(t).forEach((function(t){k(_(function(t){var e=w(t),n=e.x,i=e.y;return x(n,i,t.offsetWidth,t.offsetHeight)}(t),r),e)}))})),k(_(s,r),A?m.drag:m.view)},D=function(e){e.preventDefault();var n=S(t),i=(e.pageX-n.x)/a-s.w*l,o=(e.pageY-n.y)/a-s.h*c;T?(T.scrollLeft=i,T.scrollTop=o):u.scrollTo(i,o),C()},N=function e(n){A=!1,t.style.cursor="pointer",p.style.cursor="auto",b(u,"mousemove",D),b(u,"mouseup",e),D(n)};return t.style.cursor="pointer",v(t,"mousedown",(function(e){A=!0;var n=S(t),i=_(s,r);l=((e.pageX-n.x)/a-i.x)/i.w,c=((e.pageY-n.y)/a-i.y)/i.h,(l<0||l>1||c<0||c>1)&&(l=.5,c=.5),t.style.cursor="crosshair",p.style.cursor="crosshair",v(u,"mousemove",D),v(u,"mouseup",N),D(e)})),v(T||u,"load resize scroll",C),m.interval>0&&setInterval((function(){return C()}),m.interval),C(),{redraw:C}}}).call(this,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n}])},t.exports=e()},316:t=>{function e(t,e){return function(n,i,o,r){t(n,i,o,r),e(n,i,o,r)}}t.exports=function(t){return t.on=function(n,i){if(1===arguments.length&&"function"==typeof n)return t.on("event",n);var o="on"+n,r=t[o];return t[o]=r?e(r,i):i,t},t}},272:(t,e,n)=>{"use strict";var i=n(451),o=n(316),r=n(861),s=n(41),a=n(549);function l(t,e,n){return a(s(r(o(i(t,e,n)))))}t.exports&&(t.exports=l),"undefined"!=typeof window&&(window.SamplePlayer=l)},549:(t,e,n)=>{var i=n(846);t.exports=function(t){return t.listenToMidi=function(e,n){var o={},r=n||{},s=r.gain||function(t){return t/127};return e.onmidimessage=function(e){var n=e.messageType?e:i(e);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!r.channel||n.channel===r.channel)switch(n.messageType){case"noteon":o[n.key]=t.play(n.key,0,{gain:s(n.velocity)});break;case"noteoff":o[n.key]&&(o[n.key].stop(),delete o[n.key])}},t},t}},861:(t,e,n)=>{"use strict";var i=n(46),o=function(t){return function(t){return null!==t&&t!==[]&&t>=0&&t<129}(t)?+t:i.midi(t)};t.exports=function(t){if(t.buffers){var e=t.opts.map,n="function"==typeof e?e:o,i=function(t){return t?n(t)||t:null};t.buffers=function(t,e){return Object.keys(t).reduce((function(n,i){return n[e(i)]=t[i],n}),{})}(t.buffers,i);var r=t.start;t.start=function(t,e,n){var o=i(t),s=o%1;return s&&(o=Math.floor(o),n=Object.assign(n||{},{cents:Math.floor(100*s)})),r(o,e,n)}}return t}},451:(t,e,n)=>{"use strict";var i=n(729),o={},r={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function s(t){return"number"==typeof t}var a=["attack","decay","sustain","release"];t.exports=function(t,e,n){var l=!1,c=0,u={},d=t.createGain();d.gain.value=1;var h=Object.assign({},r,n),p={context:t,out:d,opts:h};return e instanceof AudioBuffer?p.buffer=e:p.buffers=e,p.start=function(e,n,i){if(p.buffer&&null!==e)return p.start(null,e,n);var r=e?p.buffers[e]:p.buffer;if(r){if(l){var s=i||o;n=Math.max(t.currentTime,n||0),p.emit("start",n,e,s);var a=f(e,r,s);return a.id=function(e,n){return n.id=c++,u[n.id]=n,n.source.onended=function(){var e=t.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),p.emit("ended",e,n.id,n)},n.id}(0,a),a.env.start(n),a.source.start(n),p.emit("started",n,a.id,a),s.duration&&a.stop(n+s.duration),a}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+e+" not found.")},p.play=function(t,e,n){return p.start(t,e,n)},p.stop=function(t,e){var n;return(e=e||Object.keys(u)).map((function(e){return(n=u[e])?(n.stop(t),n.id):null}))},p.connect=function(t){return l=!0,d.connect(t),p},p.emit=function(t,e,n,i){p.onevent&&p.onevent(t,e,n,i);var o=p["on"+t];o&&o(e,n,i)},p;function f(e,n,o){var r,l=t.createGain();return l.gain.value=0,l.connect(d),l.env=function(t,e,n){var o=i(t),r=e.adsr||n.adsr;return a.forEach((function(t,i){o[t]=r?r[i]:e[t]||n[t]})),o.value.value=s(e.gain)?e.gain:s(n.gain)?n.gain:1,o}(t,o,h),l.env.connect(l.gain),l.source=t.createBufferSource(),l.source.buffer=n,l.source.connect(l),l.source.loop=o.loop||h.loop,l.source.playbackRate.value=(r=o.cents||h.cents)?Math.pow(2,r/1200):1,l.source.loopStart=o.loopStart||h.loopStart,l.source.loopEnd=o.loopEnd||h.loopEnd,l.stop=function(n){var i=n||t.currentTime;p.emit("stop",i,e);var o=l.env.stop(i);l.source.stop(o)},l}}},41:t=>{"use strict";var e=Array.isArray,n={};t.exports=function(t){return t.schedule=function(i,o){var r,s,a,l,c=t.context.currentTime,u=i<c?c:i;return t.emit("schedule",u,o),o.map((function(i){return i?(e(i)?(r=i[0],s=i[1]):(r=i.time,s=i),function(t){return t&&"object"==typeof t}(s)?(a=s.name||s.key||s.note||s.midi||null,l=s):(a=s,l=n),t.start(a,u+(r||0),l)):null}))},t}},46:t=>{"use strict";var e=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,n=[0,2,4,5,7,9,11];function i(t,i,r){if("string"!=typeof t)return null;var s=e.exec(t);if(!s||!i&&s[4])return null;var a={letter:s[1].toUpperCase(),acc:s[2].replace(/x/g,"##")};return a.pc=a.letter+a.acc,a.step=(a.letter.charCodeAt(0)+3)%7,a.alt="b"===a.acc[0]?-a.acc.length:a.acc.length,a.chroma=n[a.step]+a.alt,s[3]&&(a.oct=+s[3],a.midi=a.chroma+12*(a.oct+1),a.freq=o(a.midi,r)),i&&(a.tonicOf=s[4]),a}function o(t,e){return Math.pow(2,(t-69)/12)*(e||440)}var r={parse:i,regex:function(){return e},midiToFreq:o};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(t){r[t]=function(e){var n=i(e);return n&&void 0!==n[t]?n[t]:null}})),t.exports=r},346:(t,e,n)=>{"use strict";var i=n(665),o=n(272);function r(t){return/\.js(\?.*)?$/i.test(t)}function s(t,e,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(e="FluidR3_GM"===e?e:"MusyngKite")+"/"+t+"-"+(n="ogg"===n?n:"mp3")+".js"}var a=n(975);a.instrument=function t(e,n,a){if(1===arguments.length)return function(n,i){return t(e,n,i)};var l=a||{},c=l.isSoundfontURL||r,u=l.nameToUrl||s,d=c(n)?n:u(n,l.soundfont,l.format);return i(e,d,{only:l.only||l.notes}).then((function(t){var i=o(e,t,l).connect(l.destination?l.destination:e.destination);return i.url=d,i.name=n,i}))},a.nameToUrl=s,t.exports&&(t.exports=a),"undefined"!=typeof window&&(window.Soundfont=a)},975:(t,e,n)=>{"use strict";var i=n(681);function o(t,e){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof o))return new o(t);this.nameToUrl=e||o.nameToUrl,this.ctx=t,this.instruments={},this.promises=[]}function r(t,e){return e=e||{},function(n,o,r,s){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var a=n>0&&n<129?+n:i.midi(n),l=a?i.midiToFreq(a,440):null;if(l){r=r||.2;var c=(s=s||{}).destination||e.destination||t.destination,u=s.vcoType||e.vcoType||"sine",d=s.gain||e.gain||.4,h=t.createOscillator();h.type=u,h.frequency.value=l;var p=t.createGain();return p.gain.value=d,h.connect(p),p.connect(c),h.start(o),r>0&&h.stop(o+r),h}}}o.prototype.onready=function(t){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(t)},o.prototype.instrument=function(t,e){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((t=t||"default")in this.instruments)return this.instruments[t];var i={name:t,play:r(n,e)};if(this.instruments[t]=i,"default"!==t){var s=o.instrument(n,t,e).then((function(t){return i.play=t.play,i}));this.promises.push(s),i.onready=function(t){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),s.then(t)}}else i.onready=function(t){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),t()};return i},o.loadBuffers=function(t,e,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),o.instrument(t,e,n).then((function(t){return t.buffers}))},o.noteToMidi=i.midi,t.exports=o}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(343)})();
//# sourceMappingURL=app.js.map?id=fd1456853923c93634f8