/*! For license information please see app.js.LICENSE.txt */
(()=>{var e={729:e=>{e.exports=function(e){var i=e.createGain(),o=i._voltage=function(e){var t=e.createBufferSource(),r=e.createBuffer(1,2,e.sampleRate);return r.getChannelData(0).set(n),t.buffer=r,t.loop=!0,t}(e),a=r(o),s=r(o),l=r(o);return i._startAmount=r(s),i._endAmount=r(l),i._multiplier=r(a),i._multiplier.connect(i),i._startAmount.connect(i),i._endAmount.connect(i),i.value=a.gain,i.startValue=s.gain,i.endValue=l.gain,i.startValue.value=0,i.endValue.value=0,Object.defineProperties(i,t),i};var t={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var o=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(o,this._decayFrom,i(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,o=this._startAmount.gain,a=this._endAmount.gain;r.cancelScheduledValues(e),o.cancelScheduledValues(e),a.cancelScheduledValues(e);var s=i(this.release);if(this.attack&&e<this._decayFrom){var l=function(e,t,n,r,i){var o=0+(i-n)/(r-n)*1;return o<=0&&(o=0),o>=1&&(o=1),o}(0,0,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(l,e),o.linearRampToValueAtTime(1-l,e),o.setTargetAtTime(0,e,s)}a.setTargetAtTime(1,e,s),r.setTargetAtTime(0,e,s)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},n=new Float32Array([1,1]);function r(e){var t=e.context.createGain();return e.connect(t),t}function i(e){return Math.log(e+1)/Math.log(100)}},158:e=>{"use strict";e.exports={decode:function(e,t){for(var n,r,i,o=e.replace(/[^A-Za-z0-9\+\/]/g,""),a=o.length,s=t?Math.ceil((3*a+1>>2)/t)*t:3*a+1>>2,l=new Uint8Array(s),u=0,c=0,d=0;d<a;d++)if(r=3&d,u|=((i=o.charCodeAt(d))>64&&i<91?i-65:i>96&&i<123?i-71:i>47&&i<58?i+4:43===i?62:47===i?63:0)<<18-6*r,3===r||a-d==1){for(n=0;n<3&&c<s;n++,c++)l[c]=u>>>(16>>>n&24)&255;u=0}return l}}},799:e=>{"use strict";e.exports=function(e,t){return new Promise((function(n,r){var i=new XMLHttpRequest;t&&(i.responseType=t),i.open("GET",e),i.onload=function(){200===i.status?n(i.response):r(Error(i.statusText))},i.onerror=function(){r(Error("Network Error"))},i.send()}))}},665:(e,t,n)=>{"use strict";var r=n(158),i=n(799);function o(e){return function(t){return"string"==typeof t&&e.test(t)}}function a(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function s(e,t,n,r){var i,o=t instanceof ArrayBuffer?l:u(t)?c:(i=t)&&"function"==typeof i.then?d:h(t)?f:function(e){return e&&"object"==typeof e}(t)?p:g(t)?m:v(t)?y:b(t)?_:null;return o?o(e,t,n||{}):r?Promise.resolve(r):Promise.reject("Source not valid ("+t+")")}function l(e,t,n){return new Promise((function(n,r){e.decodeAudioData(t,(function(e){n(e)}),(function(){r("Can't decode audio data ("+t.slice(0,30)+"...)")}))}))}s.fetch=i;var u=o(/\.(mp3|wav|ogg)(\?.*)?$/i);function c(e,t,n){var r=a(n.from,t);return s(e,s.fetch(r,"arraybuffer"),n)}function d(e,t,n){return t.then((function(t){return s(e,t,n)}))}var h=Array.isArray;function f(e,t,n){return Promise.all(t.map((function(t){return s(e,t,n,t)})))}function p(e,t,n){var r={},i=Object.keys(t).map((function(i){if(n.only&&-1===n.only.indexOf(i))return null;var o=t[i];return s(e,o,n,o).then((function(e){r[i]=e}))}));return Promise.all(i).then((function(){return r}))}var g=o(/\.json(\?.*)?$/i);function m(e,t,n){var r=a(n.from,t);return s(e,s.fetch(r,"text").then(JSON.parse),n)}var v=o(/^data:audio/);function y(e,t,n){var i=t.indexOf(",");return s(e,r.decode(t.slice(i+1)).buffer,n)}var b=o(/\.js(\?.*)?$/i);function _(e,t,n){var r=a(n.from,t);return s(e,s.fetch(r,"text").then(x),n)}function x(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=s),"undefined"!=typeof window&&(window.loadAudio=s)},898:(e,t,n)=>{"use strict";n.r(t),n.d(t,{naturalize_notes:()=>a});var r=n(974),i=n(714),o=n(624);function a(){if(selected[0].classList.contains("note"))if(0!=(0,o.draw_context_of)(selected[0]).layer_number){var e=selected.concat(extraselected);e.forEach(s),e.forEach(i.dB)}else console.log("No modifications allowed to original layer.");else console.log("Can only naturalize notes.")}function s(e){let t=e.querySelector(".accid");if(!t)return void console.log("No accidental to remove");!function(e){for(var t=e.parentElement;!t.classList.contains("note");)t=t.parentElement;var n,r=(0,o.get_id)(t);(n=(0,o.get_by_id)(mei,r)).removeAttribute("accid"),Array.from(n.children).filter((e=>"accid"==e.tagName)).forEach((e=>n.removeChild(e)))}(t),t.classList.add("hidden");let n=(0,o.get_id)(t);var i=(0,r.kg)();for(const e of i){let t=e.id_prefix+n,r=document.getElementById(t);r&&r.classList.add("hidden")}}document.getElementById("naturalizebutton").addEventListener("click",a)},974:(e,t,n)=>{"use strict";n.d(t,{Jt:()=>P,lk:()=>I,qG:()=>L,i9:()=>C,lC:()=>O,Yu:()=>F,kg:()=>U,ro:()=>V,p8:()=>q,LO:()=>W,jA:()=>Q,tu:()=>Y,DR:()=>$,k4:()=>H,xM:()=>B,Ln:()=>K});var r=n(865),i=n.n(r),o=n(803),a=n(83),s=n(787),l=(n(360),n(944),n(359),n(480),n(863),n(121),n(879),n(200),n(624));function u(e,t,n){if(("beam"==t.tagName||"measure"==t.tagName)&&-1==n.findIndex((e=>e.nodeType==Node.ELEMENT_NODE&&("note"==e.tagName||e.getElementsByTagName("note").length>0))))return null;var r=t.cloneNode();return e?r.setAttribute("corresp",t.getAttribute("xml:id")):r.setAttribute("copyof",t.getAttribute("xml:id")),n.forEach((e=>r.appendChild(e))),r}function c(e,t){if(t.nodeType!=Node.ELEMENT_NODE)return[t.cloneNode(),!1];var n=document.getElementById((0,l.id_in_svg)(e,(0,l.get_id)(t)));if("note"==t.tagName&&(!n||n.classList.contains("hidden")))return[note_to_space(mei,t),!0];var r=Array.from(t.childNodes).map((t=>c(e,t))),i=r.map((e=>e[0])).filter((e=>null!=e)),o=i.length!=t.childNodes.length||null!=r.find((e=>e[1]));return[u(o,t,i),o]}function d(e=null){e||(e=U()[0]);var t=e.mei_score,[n,r]=c(e,t),i=t.parentElement.getElementsByTagName("score").length+"-";return(0,l.prefix_ids)(n,i),t.parentNode.insertBefore(n,t.nextSibling),n}function h(e,t){if(!e.contains(t))return console.log("Score element not in MEI, aborting"),null;var n,r=(0,l.clone_mei)(e),i=(n=t.hasAttribute("xml:id")?(0,l.get_by_id)(r,t.getAttribute("xml:id")):r.getElementsByTagName("score")[0]).parentElement;for(let e of Array.from(i.getElementsByTagName("score")))e!==n&&i.removeChild(e);return r}var f=n(714);function p(e,t,n){var r=[],i=e.svg_elem,o=e.id_prefix,a=o+n.getAttribute("xml:id"),s=(0,l.relation_type)(n),u=(0,l.relation_primaries)(t,n).map((t=>document.getElementById((0,l.id_in_svg)(e,(0,l.node_to_note_id)(t))))),c=(0,l.relation_secondaries)(t,n).map((t=>document.getElementById((0,l.id_in_svg)(e,(0,l.node_to_note_id)(t))))),d=u.concat(c);if(d.sort(((e,t)=>{if(!e)return-1;if(!t)return 1;var n=(0,l.note_coords)(e),r=(0,l.note_coords)(t);return n[0]-r[0]?n[0]-r[0]:n[1]-r[1]})),!d[0])return console.log("Note missing, relation not drawn"),null;var h=(0,l.roundedHull)(d.map(l.note_coords));return h.setAttribute("id",a),""!=o&&h.setAttribute("oldid",n.getAttribute("xml:id")),h.classList.add("relation"),h.setAttribute("type",s),(0,f.U2)()&&(0,f.up)(h),h.onwheel=e=>{var t=e.target;return(0,l.flip_to_bg)(t),h.onmouseout(),!1},h.onclick=function(e){(0,f.dB)(h,e.shiftKey)},h.onmouseover=function(e){u.forEach((e=>{e.classList.add("extrahover")})),c.forEach((e=>{e.classList.add("selecthover")}))},h.onmouseout=function(e){u.forEach((e=>{e.classList.remove("extrahover")})),c.forEach((e=>{e.classList.remove("selecthover")}))},(0,l.add_to_svg_bg)(i,h),r.push(h),r}function g(e,t,n){var r=[],i=e.svg_elem,o=e.id_prefix+n.getAttribute("xml:id"),a=(0,l.relation_type)(n),s=(0,l.relation_allnodes)(t,n).map((t=>document.getElementById(e.id_prefix+(0,l.get_id)(t))));if(-1!=s.indexOf(null))return console.log("Missing relation, not drawing metarelation"),[];var u=s.map(l.get_metarelation_target),c=(0,l.average)(u.map((e=>e[0]))),d=s.concat([i.getElementsByClassName("system")[0]]).map((e=>e.getBBox().y)).sort(((e,t)=>e>t))[0]-500;return u.push([c,d]),(n=(0,l.g)()).setAttribute("id",o),n.classList.add("metarelation"),n.setAttribute("type",a),n.appendChild((0,l.circle)([c,d],200)),u.forEach((e=>{var t=(0,l.line)([c,d],e);n.appendChild(t)})),(0,f.U2)()&&(0,f.up)(n),n.onwheel=e=>{var t=e.target;return(0,l.flip_to_bg)(t.closest("g")),n.onmouseout(),!1},n.onclick=function(e){(0,f.dB)(n,e.shiftKey)},n.onmouseover=function(e){s.forEach((e=>{e.classList.add("relationhover")}))},n.onmouseout=function(e){s.forEach((e=>{e.classList.remove("relationhover")}))},(0,l.add_to_svg_bg)(i,n),r.push(n),r}var m,v,y,b,_,x=n(506),w=n(235),E=n(362);window.selected=[],window.extraselected=[],n(898),window.mei=null;var S,T,k=new FileReader,A=[],N=[],M=[],D=[];function C(e,t,n=!1){if(console.debug("Using globals: selected, extraselected, mei, undo_actions"),0!=selected.length||0!=extraselected){var r,i;if(selected.concat(extraselected)[0].classList.contains("relation")){var o=[];selected.concat(extraselected).forEach((t=>{o.push([t.getAttribute("type"),e]);var n=(0,l.id_or_oldid)(t),r=[(0,l.get_by_id)(document,n)].concat((0,l.get_by_oldid)(document,n));r.forEach((t=>t.setAttribute("type",e))),(0,l.get_by_id)(mei,n).getElementsByTagName("label")[0].setAttribute("type",e),r.forEach(f.up)})),A.push(["change relation type",o.reverse(),selected,extraselected])}else if(selected.concat(extraselected)[0].classList.contains("note")){(0,l.check_for_duplicate_relations)(e,extraselected,selected);var a=[],s=extraselected.map((e=>(0,l.add_mei_node_for)(v,e))),u=selected.map((e=>(0,l.add_mei_node_for)(v,e)));a.push(s.concat(u)),[r,i]=function(e,t,n,r,i){var o=[],a=e.getRootNode().createElement("node");a.setAttribute("type","relation");var s,u=e.getRootNode().createElement("label");void 0!==r&&u.setAttribute("type",r),a.appendChild(u),s=void 0===i?"he-"+(0,l.random_id)(5):i,a.setAttribute("xml:id",s),e.appendChild(a),o.push(a);for(var c=0;c<t.length;c++)(d=mei.createElement("arc")).setAttribute("from","#"+s),d.setAttribute("to","#"+t[c].getAttribute("xml:id")),d.setAttribute("type","primary"),e.appendChild(d),o.push(d);for(c=0;c<n.length;c++){var d;(d=mei.createElement("arc")).setAttribute("from","#"+s),d.setAttribute("to","#"+n[c].getAttribute("xml:id")),d.setAttribute("type","secondary"),e.appendChild(d),o.push(d)}return[s,o.reverse()]}(v,s,u,e,t),a.push(i);for(var c=0;c<M.length;c++){let e=p(M[c],v,(0,l.get_by_id)(v.getRootNode(),r));e&&(a.push(e),(0,l.mark_secondaries)(M[c],v,(0,l.get_by_id)(v.getRootNode(),r)))}A.push(["relation",a.reverse(),selected,extraselected]),selected.concat(extraselected).forEach(f.dB)}n||(0,w.I$)(),(0,f.e6)()}}function I(e){var t=selected.concat(extraselected);if(!(t.length<3||extraselected.length>2)){t.sort(((e,t)=>{var[n,r]=(0,l.note_coords)(e),[i,o]=(0,l.note_coords)(t);return n-i}));var n=t.shift(),r=t.pop();selected=selected.filter((e=>e==n||e==r)),C(E.yu.main[e].outer),extraselected=[n,r],selected=t,C(E.yu.main[e].total),(0,f.e6)()}}function L(e,t,n=!1){if(console.debug("Using globals:  mei_graph, selected, extraselected"),0!=selected.length||0!=extraselected){var r=(0,l.get_class_from_classlist)(selected.concat(extraselected)[0]);if("relation"==r||"metarelation"==r){var i,o,a=[],s=extraselected.map((e=>(0,l.get_by_id)(v.getRootNode(),(0,l.id_or_oldid)(e)))),u=selected.map((e=>(0,l.get_by_id)(v.getRootNode(),(0,l.id_or_oldid)(e)))),[i,o]=function(e,t,n,r,i){var o=[],a=e.getRootNode().createElement("node");a.setAttribute("type","metarelation");var s,l=e.getRootNode().createElement("label");void 0!==r&&l.setAttribute("type",r),a.appendChild(l),s=void 0===i?"he-"+Math.floor(Math.random()*(1<<20)).toString(16):i,a.setAttribute("xml:id",s),e.appendChild(a),o.push(a);for(var u=0;u<t.length;u++)(c=e.getRootNode().createElement("arc")).setAttribute("from","#"+s),c.setAttribute("to","#"+t[u].getAttribute("xml:id")),c.setAttribute("type","primary"),e.appendChild(c),o.push(c);for(u=0;u<n.length;u++){var c;(c=e.getRootNode().createElement("arc")).setAttribute("from","#"+s),c.setAttribute("to","#"+n[u].getAttribute("xml:id")),c.setAttribute("type","secondary"),e.appendChild(c),o.push(c)}return[s,o.reverse()]}(v,s,u,e,t);a.push(o);for(var c=0;c<M.length;c++)a.push(g(M[c],v,(0,l.get_by_id)(v.getRootNode(),i)));A.push(["metarelation",a,selected,extraselected]),selected.concat(extraselected).forEach(f.dB),(0,f.e6)(),n||(0,w.I$)()}}}function j(){console.debug("Using globals: mei"),function(e,t,n){console.debug("Using globals: document, window");var r=new Blob([e],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,t);else{var i=document.createElement("a"),o=URL.createObjectURL(r);i.href=o,i.download=t,document.body.appendChild(i),i.click(),setTimeout((()=>{document.body.removeChild(i),window.URL.revokeObjectURL(o)}),0)}}((new XMLSerializer).serializeToString(mei),S+".mei","text/xml")}function O(e){console.debug("Using globals: mei_graph, mei, selected, extraselected, document");var t=Array.from(v.getElementsByTagName("node")),n=t.filter((e=>"relation"==e.getAttribute("type"))),r=t.filter((e=>"metarelation"==e.getAttribute("type")));n.forEach((t=>{p(e,v,t)&&(0,l.mark_secondaries)(e,v,t)})),r.forEach((t=>g(e,v,t)))}function B(e=!1,t=M[0]){t.svg_elem;var n=h(mei,t.layer.score_elem);return Array.from(n.getElementsByTagName("note")).forEach((r=>{let i=document.getElementById((0,l.id_in_svg)(t,(0,l.get_id)(r)));if(!i||i.classList.contains("hidden")){var o=r.parentNode;if(e&&!["chord","bTrem","fTrem"].includes(o.tagName)){var a=(0,l.note_to_rest)(n,r);o.insertBefore(a,r)}o.removeChild(r)}})),Array.from(n.getElementsByTagName("chord")).forEach((e=>{e.parentNode,0==e.getElementsByTagName("note").length&&e.parentNode.removeChild(e)})),n}function P(e,t=!1,n=!1){var r;r=t?new_sliced_layer(e,n):d(e);let i=h(mei,r);var[o,a]=R(i);if(!a)return console.log("Verovio could not generate SVG from MEI."),!1;var s=(0,l.new_layer_element)(),[u,c]=(0,l.new_view_elements)(s);c.innerHTML=a;var f={mei:i,layer_elem:s,layer_number:D.length,score_elem:r,id_mapping:(0,l.get_id_pairs)(r),original_score:!1,number_of_views:1};D.push(f);var p={mei_score:r,svg_elem:c,view_elem:u,layer:f,layer_number:f.layer_number,view_number:0,id_prefix:"",zoom:1,reductions:[]};p.id_prefix=M.length,z(p)}function z(e){e.measure_map=(0,x.Vk)(e),M.reverse(),M.push(e),M.reverse(),(0,f.N7)(e);for(let t of e.svg_elem.getElementsByClassName("note"))t.onclick=function(e){(0,f.dB)(t,e.shiftKey)};for(let t of e.svg_elem.getElementsByClassName("staff")){let[e,n]=(0,x.e6)(t);t.y_to_p=e,t.p_to_y=n}O(e),(0,f.rp)()}function R(e){var t=(new XMLSerializer).serializeToString((0,l.sanitize_xml)(e));return[t,m.renderData(t,{pageWidth:2e4,pageHeight:1e4,breaks:"none"})]}function H(e){var[t,n]=(0,l.new_view_elements)(e.layer.layer_elem),r=B(!1,e),[i,o]=R(r);if(!o)return console.log("Verovio could not generate SVG from MEI."),!1;n.innerHTML=o,e.layer.number_of_views+=1;var a={mei_score:e.mei_score,svg_elem:n,view_elem:t,layer:e.layer,layer_number:e.layer.layer_number,view_number:e.layer.number_of_views-1,id_prefix:"",zoom:1,reductions:[]};a.id_prefix=M.length,(0,l.prefix_ids)(a.svg_elem,a.id_prefix),z(a)}window.addEventListener("beforeunload",(function(e){var t="Leave app? You may lose unsaved changes.";return e.preventDefault(),e.returnValue=t,t})),i()(document).ready((function(){document.getElementsByTagName("html")[0].classList.remove("loader"),(0,f.XG)(),i()("#hull_controller").on("change",f.PB),(0,f.K5)(document.getElementById("relations_panel")),(0,f.rp)(),[["delete_all","deletebutton"],["add_bookmark","addbookmarkbutton"],["show_hide_notation","equalizebutton"],["toggle_type_shades","shadesbutton"],["toggle_add_note","addnotebutton"],["jump_to_next_bookmark","previousbookmarkbutton"],["jump_to_previous_bookmark","nextbookmarkbutton"],["jump_to_context_below","previouscontextbutton"],["jump_to_context_above","nextcontextbutton"]].forEach((e=>document.getElementById(e[1]).setAttribute("title",s.custom_conf[e[0]]||a.navigation_conf[e[0]]||o.action_conf[e[0]])))})),window.onerror=function(e,t,n){return document.getElementsByTagName("html")[0].classList.remove("loader"),alert(`An error occured: ${e}\n Please report the relevant console log as a GitHub issue.\n The app will try to continue running nonetheless.`),!1},document.getElementById("downloadbutton").addEventListener("click",j),document.getElementById("svgdownloadbutton").addEventListener("click",j),document.getElementById("fileupload").addEventListener("change",(function(){console.debug("Using globals: selected_extraselected, upload, reader, filenmae"),selected=[],extraselected=[];var e=document.getElementById("fileupload");1==e.files.length&&(k.onload=function(e){_=k.result,setTimeout((()=>{setTimeout((()=>{!function(e){console.debug("Using globals data, parser, mei, jquery document, document, mei_graph, midi, changes, undo_cations, redo_actions, reduce_actions, rerendered_after_action, shades");var t=new DOMParser;try{mei=t.parseFromString(_,"text/xml"),mei.getElementsByTagName("parsererror").length>0&&console.log("This is not a valid XML or MEI file. However it could be ABC or Humdrum, for instance")}catch(e){i()("#fileupload").val("")}if(m=new verovio.toolkit,"http://www.music-encoding.org/ns/mei"!=mei.documentElement.namespaceURI){try{m.renderData(_,{pageWidth:2e4,pageHeight:1e4,breaks:"none"})}catch(e){if(!new_svg)return console.log("Verovio could not generate SVG from non-MEI file."),i()("#fileupload").val(""),!1}_=m.getMEI(),t=new DOMParser;try{mei=t.parseFromString(_,"text/xml")}catch(e){return alert("Cannot parse this XML file as valid MEI."),i()("#fileupload").val(""),!1}}else mei=(0,l.fix_synonyms)(mei);try{v=function(){console.debug("Using globals: mei");var e=mei.getElementsByTagName("graph");if(e.length)return e[0];var t=mei.createElement("graph");return t.setAttribute("type","directed"),mei.getElementsByTagName("body")[0].appendChild(t),t}()}catch(e){return alert("Cannot parse this XML file as valid MEI."),i()("#fileupload").val(""),!1}M=[],D=[],document.getElementById("layers").innerHTML="",i()("#hull_controller").val(200),M.hullPadding=i()("#hull_controller").val();var n=Array.from(mei.getElementsByTagName("body")[0].getElementsByTagName("score"));for(let e in n){let t=n[e],i=h(mei,t),[c,d]=R(i);if(!d)return console.log("Verovio could not generate SVG from MEI."),!1;var r=(0,l.new_layer_element)(),[o,a]=(0,l.new_view_elements)(r);a.innerHTML=d;var s={mei:i,layer_elem:r,layer_number:0,score_elem:t,id_mapping:(0,l.get_id_pairs)(t),original_score:0==e,number_of_views:1};D.push(s);var u={mei_score:t,svg_elem:a,view_elem:o,layer:s,layer_number:0,view_number:0,id_prefix:"",zoom:1,reductions:[]};0==e?(y=m.renderToMIDI(),b=y):u.id_prefix=M.length,z(u)}A=[],N=[],T=0,(0,f.U2)()||(0,f.XG)(),document.onkeypress=function(e){(0,f.Z6)(e)},document.onkeydown=f.qY,document.onkeyup=f.$Z,document.getElementById("layers").onclick=f.oq,document.dispatchEvent(new Event("scoreload")),(0,f.Pw)()}(),(0,f.bf)(),(0,l.indicate_current_context)()}),1e3)}),1e3)},k.readAsText(e.files[0]),""==(S=e.files[0].name.split(".").slice(0,-1).join("."))&&(S=e.files[0].name))})),console.log("Main webapp library is loaded");const U=()=>M,V=()=>v,q=()=>b,$=()=>m,F=()=>_,Y=()=>A,W=()=>N,K=e=>N=e,Q=()=>T},36:(e,t,n)=>{"use strict";n.r(t),n.d(t,{shades_array:()=>r,type_keys:()=>i,type_shades:()=>o,meta_keys:()=>a,meta_shades:()=>s,combo_keys:()=>l,button_shades:()=>u,action_conf:()=>c,navigation_conf:()=>d,custom_conf:()=>h,meta_conf:()=>f,type_conf:()=>p,combo_conf:()=>g,type_synonym:()=>m,type_full_conf:()=>v,meta_full_conf:()=>y,hide_classes:()=>b,strip_mei_tags:()=>_,strip_xml_tags:()=>x,CONFIG_OK:()=>w});const r=n(617).K2I,i={},o={},a={},s={},l={},u={},c={undo:"U",redo:"I",deselect_all:"d",delete_all:"D",add_bookmark:"^",move_relation_to_front:"z",reduce_relations:"r",show_hide_notation:"s",toggle_type_shades:"h",select_same_notes:"+",toggle_add_note:"x",naturalize_note:"Z"},d={pan_left:"[",pan_right:"]",jump_to_next_bookmark:"{",jump_to_previous_bookmark:"}",jump_to_context_below:",",jump_to_context_above:".",toggle_palette:"-",zoom_out:"(",zoom_in:")",switch_context_on_hover:!1},h={relation:"R",meta_relation:"M"},f={context:{key:"c",colour:0},layer:{key:"l",colour:6},phrase:{key:"r",colour:2},section:{key:"t",colour:3}},p={repeat:{key:"e",colour:0},passing:{key:"p",colour:6},neighbour:{key:"n",colour:2},harmonic:{key:"i",colour:3},arpeggio:{key:"a",colour:4},urlinie:{key:"u",colour:5},bassbrechung:{key:"b",colour:5}},g={passing_comb:{key:"P",total:"passing",outer:"arpeggio"},neighbour_comb:{key:"N",total:"neighbour",outer:"repeat"}},m={prolongation:"passing",arp:"arpeggio",bassbrech:"bassbrechung"},v=["neighbour","repetition","arpeggiation","passing","back_relating_dominant","displacement","register_transfer","56_shift","added_root","initial_ascent","arpeggiated_ascent","urlinie","urlinie_transference","bassbrechung_component","coupling","voice_exchange_component","voice_exchange_component_chromaticized","mixture","phrygian_ii"],y=["auxiliary_cadence","superposition","reaching_over","urlinie_meta","ursatz","bassbrechung","bassbrechung_transference","ursatz_transference","unfolding","motion_into_the_inner_voice","motion_from_the_inner_voice","linear_intervallic_progression","linear_intervallic_progression_module","interruption","interruption_branch_1","interruption_branch_2","voice_exchange","motivic_parallelism","motive","contradiction","indeterminacy","parallel_fifths","parallel_octaves"],b=["barLineAttr","fermata","rest","stem","flag","tie","artic","slur","dynam","tempo","tupletNum","dir","verse"],_=["label","labelAbbr","tempo"],x=[],w=!0},506:(e,t,n)=>{"use strict";n.d(t,{Vk:()=>l,e6:()=>c,f5:()=>p,r4:()=>g,xy:()=>m,Kd:()=>v,M_:()=>y,TU:()=>b});var r=n(974),i=n(714),o=n(235),a=n(624),s="cdefgab";function l(e){let t=e.svg_elem;var n=Array.from(t.getElementsByClassName("measure")),r=(n.length&&Array.from(n[0].getElementsByClassName("staff")),Array.from(t.getElementsByClassName("note")),n.map((e=>[e.getBBox().x+e.getBBox().width,e])));return r.sort(((e,t)=>e[0]-t[0])),r}function u(e){let t=e.children[2].getBBox();return t.y+t.height/2}function c(e){const t=u(e),n=-Math.abs(function(e){let t=e.children[2].getBBox(),n=e.children[1].getBBox();return Math.abs(t.y-n.y)}(e)),r=n/2,i=e.getElementsByClassName("note");var o;if(i.length>0)o=i[0];else{const n=e.closest(".system");o=Array.from(n.getElementsByClassName("staff")).find((e=>u(e)==t&&e.getElementsByClassName("note").length>0)).getElementsByClassName("note")[0]}const l=function(e){var t=(0,a.get_by_id)(mei,(0,a.get_id)(e)),n=t.getAttribute("pname");return 7*t.getAttribute("oct")+s.indexOf(n)}(o)-Math.floor(((0,a.note_coords)(o)[1]-t)/r);return[e=>{var n=Math.floor((e+r/2-t)/r)+l,i=Math.floor(n/7);return[s[(0,a.mod)(n,7)],i]},(e,n)=>{var i=7*n+s.indexOf(e);return t+(i-l)*r}]}function d(){var e=(0,i.c)();const t=function(){var e=(0,i.c)(),t=e.svg_elem.children[0],n=e.svg_elem.getElementsByClassName("system")[0],r=t.createSVGPoint();return r.x=(0,i.jM)(),r.y=(0,i.hT)(),r.matrixTransform(n.parentElement.getScreenCTM().inverse())}(),n=function(e,t){let n=e.measure_map.find((e=>e[0]>t.x));return n?n[1]:void 0}(e,t);if(!n)return console.log("Pointer outside measures"),[null,null,null];const r=function(e,t,n){var r=Array.from(n.getElementsByClassName("staff")).map((e=>[u(e),e]));r.sort(((e,t)=>e[0]-t[0]));var i=r.findIndex((e=>t.y<e[0]));if(0==i)return r[0][1];if(-1==i)return r[r.length-1][1];const o=(0,a.average2)(r[i-1][0],r[i][0]);return t.y<o?r[i-1][1]:r[i][1]}(0,t,n),[o,s]=function(e,t,n){return n.getElementsByClassName("note")[0],n.y_to_p(t.y)}(0,t,r),l=function(e,t,n){var r=Array.from(n.getElementsByClassName("note")).map((e=>[(0,a.note_coords)(e)[0],e]));if(0==r.length)return null;r.sort(((e,t)=>e[0]-t[0]));var i=r.findIndex((e=>t.x<e[0]));if(0==i)return r[0][1];if(-1==i)return r[r.length-1][1];const o=(0,a.average2)(r[i-1][0],r[i][0]);return t.x<o?r[i-1][1]:r[i][1]}(0,t,r);return l?[o,s,l]:[null,null,null]}function h(e,t,n){var r=n.closest(".staff");return r.getElementsByClassName("note")[0],[(0,a.note_coords)(n)[0],r.p_to_y(e,t)]}function f(e,t,n,r=!0,o=""){(0,i.c)();var s=document.getElementById(o);if(s&&s.parentElement.removeChild(s),r){let[r,i]=h(e,t,n),[s,u]=(0,a.note_coords)(n);var l=document.createElementNS("http://www.w3.org/2000/svg","use");l.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+n.id),l.setAttribute("x",r-s),l.setAttribute("y",i-u),l.id=o,n.parentElement.appendChild(l)}}function p(e,t,n,s,l,u=!1){var c="new-"+(0,a.random_id)();let d=n;void 0!==l&&(c=l);var f=[];console.log(n),f.push(function(e,t,n,r=!0,o=""){(0,i.c)();var a=document.getElementById(o),s=[];if(a&&a.parentElement.removeChild(a),r){let[r,a]=h(e,t,n);var l=document.createElementNS("http://www.w3.org/2000/svg","g"),u=document.createElementNS("http://www.w3.org/2000/svg","g"),c=document.createElementNS("http://www.w3.org/2000/svg","use");c.setAttributeNS("http://www.w3.org/1999/xlink","href",n.getElementsByTagName("use")[0].getAttributeNS("http://www.w3.org/1999/xlink","href")),c.setAttribute("x",r-100),c.setAttribute("y",a),c.setAttribute("height","720px"),c.setAttribute("width","720px"),l.id=o,l.classList.add("note"),u.classList.add("notehead"),u.appendChild(c),l.appendChild(u),n.parentElement.appendChild(l),l.onclick=function(e){(0,i.dB)(l,e.shiftKey)},s.push(l)}return s.reverse()}(e,t,n,s,c));var p=(0,i.c)();f.push(function(e,t,n,r,i=!0,o=""){var s=(0,a.get_by_id)(mei,(0,a.get_id)(r));if(!e.score_elem.contains(s))return console.log("Note not in layer?"),!1;var l=mei.createElement("note"),u=[];if(l.setAttribute("xml:id",o),!i)return console.log("Not implemented"),!1;{let r;s.closest("chord")?r=s.closest("chord"):(r=(0,a.note_to_chord)(mei,s),s.parentElement.insertBefore(r,s),s.parentElement.removeChild(s),r.appendChild(s),u.push(r)),l.setAttribute("pname",t),l.setAttribute("oct",n),r.appendChild(l),u.push(l),e.id_mapping.push([o,o])}return u.reverse()}(p.layer,e,t,n,s,c)),y(),u||(0,o.I$)(),(0,r.tu)().push(["add note",f.reverse(),[d],[]])}function g(){var e=(0,i.c)();if(""!=(0,i.h4)()&&!e.layer.original_score){let[e,t,n]=d();if(!e)return;p(e,t,n,!0)}}function m(){var e=(0,i.c)(),t=(0,i.h4)();if(void 0!==e){if(e.layer.original_score)return;let[n,r,o]=d();t="temp"+(0,a.random_id)(),(0,i.vI)(t),$("#addnotebutton").addClass("active"),document.getElementById("layers").style.cursor="crosshair",n&&f(n,r,o,!0,t)}}function v(){var e=(0,i.h4)();let t=document.getElementById(e);t&&t.parentElement.removeChild(t),e="",(0,i.vI)(e),$("#addnotebutton").removeClass("active"),document.getElementById("layers").style.cursor="default"}function y(){var e=(0,i.c)(),t=(0,i.h4)();null!=e&&e.layer.original_score||(t?v():m())}function b(){if((0,i.c)().layer.original_score)return;let[e,t,n]=d();e&&f(e,t,n,!0,(0,i.h4)())}document.getElementById("addnotebutton").addEventListener("click",y)},504:(e,t,n)=>{"use strict";n.d(t,{x:()=>l});var r=n(974),i=n(714),o=n(235),a=n(624);function s(e){console.debug("Using globals: mei for element selection");var t=(0,a.get_id)(e),n=(0,a.get_by_id)(mei,t),o=[],s="metarelation"==(0,a.get_class_from_classlist)(e),l=(0,r.ro)(),u=(0,r.kg)();for(const e of u){let r=(0,a.get_by_id)(document,e.id_prefix+t);r&&(o.push(r),s||(0,a.unmark_secondaries)(e,l,n))}var c=Array.from(mei.getElementsByTagName("arc")).filter((t=>t.getAttribute("to")=="#"+e.id||t.getAttribute("from")=="#"+e.id)).concat(o);c.push(n);var d=c.map((e=>{var t=[e,e.parentElement,e.nextSibling];try{$(`g #${e.getAttribute("to").substring(4)}`).removeClass().addClass("note")}catch(e){}return e.parentElement.removeChild(e),t}));return(0,i.e6)(),d}function l(e=!1){console.debug("Using globals: selected for element selection, undo_actions for storing the action");var t=selected.concat(extraselected);if(0==t.length||"relation"!=(0,a.get_class_from_classlist)(t[0])&&"metarelation"!=(0,a.get_class_from_classlist)(t[0]))console.log("No (meta)relation selected!");else{var n=t.flatMap(s);(0,r.tu)().push(["delete relation",n.reverse(),selected,extraselected]),t.forEach(i.dB),e||(0,o.I$)()}}document.getElementById("deletebutton").addEventListener("click",l)},200:(e,t,n)=>{"use strict";n.d(t,{Z:()=>He});const r=document.documentElement,i=(document.body,getComputedStyle(r),()=>["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)),o=Object.freeze({escape:27,left:37,right:39,a:65,z:90}),a=({keyCode:e},t)=>e===o[t];function s(e,t=null){const n=function({metaKey:e,shiftKey:t,ctrlKey:n,altKey:r}){const i={meta:e,shift:t,ctrl:n,alt:r},o=Object.keys(i).filter((e=>i[e]));return o.length?o:null}(e);return t?(r=n,i=[t].flat(),null!==(o=null==i?void 0:i.every((e=>null==r?void 0:r.includes(e))))&&void 0!==o&&o):null!==n;var r,i,o}const l=/Macintosh/.test(navigator.userAgent)?"meta":"ctrl";function u(e){let t=!1,n=Object.defineProperty({},e,{get:()=>{t=!0}});try{window.addEventListener("test",n,n),window.removeEventListener("test",n,n)}catch(e){t=!1}return t}u("passive");const c=u("capture"),d=function({capture:e=!1,passive:t=!0,once:n=!1}={}){return c?{capture:e,passive:t,once:n}:e},h=(d(),d({passive:!1}),d({capture:!0,passive:!1}));d({once:!0}),d({capture:!0,passive:!1,once:!0});let f=null;const p={x:0,y:0},g=new class{tick({x:e,y:t},n){f||window.requestAnimationFrame((n=>{this.update(e,t);const r=f;f=null,r(p)})),f=n}update(e,t){p.x=e,p.y=t}};let m=null;class v{constructor(e){this.app=e,this.init()}init(){window.addEventListener("resize",this.onResize.bind(this)),document.addEventListener("click",this.onTap.bind(this),h),document.addEventListener("mousedown",this.onTapStart.bind(this),h),document.addEventListener("mousemove",this.onMouseMove.bind(this),h),document.addEventListener("mouseup",this.onTapEnd.bind(this),h),document.addEventListener("touchstart",this.onTapStart.bind(this),h),document.addEventListener("touchmove",this.onTouchMove.bind(this),h),document.addEventListener("touchend",this.onTapEnd.bind(this),h),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),document.addEventListener("change",this.onChange.bind(this),h),document.addEventListener("blur",this.onBlur.bind(this),h),document.addEventListener("undoredo",this.onUndoRedo.bind(this)),document.addEventListener("scoreload",this.onScoreLoad.bind(this)),document.addEventListener("scoreselection",this.onScoreSelection.bind(this))}onResize(){!function(e,t=100){clearTimeout(m),r.classList.add("resizing"),m=setTimeout((()=>{r.classList.remove("resizing"),e()}),t)}((()=>{var e,t;null===(e=this.app.viewport)||void 0===e||e.onResize(),null===(t=this.app.ui)||void 0===t||t.onResize()}))}onTap(e){var t,n,r;null===(t=this.app.player)||void 0===t||t.onTap(e),null===(n=this.app.ui)||void 0===n||n.onTap(e),null===(r=this.app.history)||void 0===r||r.onTap(e)}onTapStart(e){var t;null===(t=this.app.ui)||void 0===t||t.onTapStart(e)}onTapEnd(){var e;null===(e=this.app.ui)||void 0===e||e.onTapEnd()}onMouseMove(e){g.tick(e,(({x:e,y:t})=>{var n;null===(n=this.app.ui)||void 0===n||n.onTapMove(e,t)}))}onTouchMove(e){const t={x:Math.round(e.touches[0].clientX),y:Math.round(e.touches[0].clientY)};g.tick(t,(({x:e,y:t})=>{var n;null===(n=this.app.ui)||void 0===n||n.onTapMove(e,t)}))}onChange(e){var t,n,r;null===(t=this.app.player)||void 0===t||t.onChange(e),null===(n=this.app.ui)||void 0===n||null===(r=n.filters)||void 0===r||r.onChange(e)}onBlur(e){var t,n;null===(t=this.app.ui)||void 0===t||null===(n=t.relations)||void 0===n||n.onBlur(e)}onUndoRedo(e){var t;null===(t=this.app.history)||void 0===t||t.onUndoRedo(e)}onScoreLoad(e){var t,n;null===(t=this.app.score)||void 0===t||t.onScoreLoad(e),null===(n=this.app.ui)||void 0===n||n.onScoreLoad(e)}onScoreSelection(e){var t,n;null===(t=this.app.score)||void 0===t||t.onScoreSelection(e),null===(n=this.app.ui)||void 0===n||n.onScoreSelection(e)}onKeyDown(e){if(!i()){if(a(e,"z")){if(s(e,[l,"shift"]))return this.app.history.redo();if(s(e,l))return this.app.history.undo()}return a(e,"a")&&s(e,l)?this.app.ui.selection.selectAll():void 0}}onKeyUp(e){s(e)||a(e,"escape")&&i()&&document.activeElement.blur()}}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),e}for(var w={VERSION:"2.0.16",NOTES:[],HEADER_CHUNK_LENGTH:14,CIRCLE_OF_FOURTHS:["C","F","Bb","Eb","Ab","Db","Gb","Cb","Fb","Bbb","Ebb","Abb"],CIRCLE_OF_FIFTHS:["C","G","D","A","E","B","F#","C#","G#","D#","A#","E#"]},E=[["C"],["C#","Db"],["D"],["D#","Eb"],["E"],["F"],["F#","Gb"],["G"],["G#","Ab"],["A"],["A#","Bb"],["B"]],S=0,T=function(e){E.forEach((function(t){t.forEach((function(t){return w.NOTES[S]=t+e})),S++}))},k=-1;k<=9;k++)T(k);var A=function(){function e(){b(this,e)}return x(e,null,[{key:"byteToHex",value:function(e){return("0"+e.toString(16)).slice(-2)}},{key:"bytesToHex",value:function(t){var n=[];return t.forEach((function(t){return n.push(e.byteToHex(t))})),n.join("")}},{key:"hexToNumber",value:function(e){return parseInt(e,16)}},{key:"bytesToNumber",value:function(t){return e.hexToNumber(e.bytesToHex(t))}},{key:"bytesToLetters",value:function(e){var t=[];return e.forEach((function(e){return t.push(String.fromCharCode(e))})),t.join("")}},{key:"decToBinary",value:function(e){return(e>>>0).toString(2)}},{key:"getVarIntLength",value:function(e){for(var t=e[0],n=1;t>=128;)t=e[n],n++;return n}},{key:"readVarInt",value:function(e){var t=0;return e.forEach((function(e){128&e?(t+=127&e,t<<=7):t+=e})),t}},{key:"atob",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return"function"==typeof atob?atob(e):Buffer.from(e,"base64").toString("binary")}))}]),e}(),N=function(){function e(t,n){b(this,e),this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.index=t,this.data=n,this.delta=0,this.runningDelta=0,this.events=[];var r=this.data.subarray(this.data.length-3,this.data.length);if(255!==r[0]||47!==r[1]||0!==r[2])throw"Invalid MIDI file; Last three bytes of track "+this.index+"must be FF 2F 00 to mark end of track"}return x(e,[{key:"reset",value:function(){return this.enabled=!0,this.eventIndex=0,this.pointer=0,this.lastTick=0,this.lastStatus=null,this.delta=0,this.runningDelta=0,this}},{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"setEventIndexByTick",value:function(e){for(var t in e=e||0,this.events)if(this.events[t].tick>=e)return this.eventIndex=t,this}},{key:"getCurrentByte",value:function(){return this.data[this.pointer]}},{key:"getDeltaByteCount",value:function(){return A.getVarIntLength(this.data.subarray(this.pointer))}},{key:"getDelta",value:function(){return A.readVarInt(this.data.subarray(this.pointer,this.pointer+this.getDeltaByteCount()))}},{key:"handleEvent",value:function(e,t){if(t=t||!1){var n=e-this.lastTick>=this.getDelta();if(this.pointer<this.data.length&&(t||n)){var r=this.parseEvent();if(this.enabled)return r}}else if(this.events[this.eventIndex]&&this.events[this.eventIndex].tick<=e&&(this.eventIndex++,this.enabled))return this.events[this.eventIndex-1];return null}},{key:"getStringData",value:function(e){var t=A.getVarIntLength(this.data.subarray(e+2)),n=A.readVarInt(this.data.subarray(e+2,e+2+t));return A.bytesToLetters(this.data.subarray(e+2+t,e+2+t+n))}},{key:"parseEvent",value:function(){var e=this.pointer+this.getDeltaByteCount(),t={},n=this.getDeltaByteCount();if(t.track=this.index+1,t.delta=this.getDelta(),this.lastTick=this.lastTick+t.delta,this.runningDelta+=t.delta,t.tick=this.runningDelta,t.byteIndex=this.pointer,255==this.data[e]){switch(this.data[e+1]){case 0:t.name="Sequence Number";break;case 1:t.name="Text Event",t.string=this.getStringData(e);break;case 2:t.name="Copyright Notice";break;case 3:t.name="Sequence/Track Name",t.string=this.getStringData(e);break;case 4:t.name="Instrument Name",t.string=this.getStringData(e);break;case 5:t.name="Lyric",t.string=this.getStringData(e);break;case 6:t.name="Marker";break;case 7:t.name="Cue Point",t.string=this.getStringData(e);break;case 9:t.name="Device Name",t.string=this.getStringData(e);break;case 32:t.name="MIDI Channel Prefix";break;case 33:t.name="MIDI Port",t.data=A.bytesToNumber([this.data[e+3]]);break;case 47:t.name="End of Track";break;case 81:t.name="Set Tempo",t.data=Math.round(6e7/A.bytesToNumber(this.data.subarray(e+3,e+6))),this.tempo=t.data;break;case 84:t.name="SMTPE Offset";break;case 88:t.name="Time Signature",t.data=this.data.subarray(e+3,e+7),t.timeSignature=t.data[0]+"/"+Math.pow(2,t.data[1]);break;case 89:t.name="Key Signature",t.data=this.data.subarray(e+3,e+5),t.data[0]>=0?t.keySignature=w.CIRCLE_OF_FIFTHS[t.data[0]]:t.data[0]<0&&(t.keySignature=w.CIRCLE_OF_FOURTHS[Math.abs(t.data[0])]),0==t.data[1]?t.keySignature+=" Major":1==t.data[1]&&(t.keySignature+=" Minor");break;case 127:t.name="Sequencer-Specific Meta-event";break;default:t.name="Unknown: "+this.data[e+1].toString(16)}var r=A.getVarIntLength(this.data.subarray(e+2)),i=A.readVarInt(this.data.subarray(e+2,e+2+r));this.pointer+=n+3+i}else if(240===this.data[e]){t.name="Sysex";var o=A.getVarIntLength(this.data.subarray(e+1)),a=A.readVarInt(this.data.subarray(e+1,e+1+o));t.data=this.data.subarray(e+1+o,e+1+o+a),this.pointer+=n+1+o+a}else if(247===this.data[e]){t.name="Sysex (escape)";var s=A.getVarIntLength(this.data.subarray(e+1)),l=A.readVarInt(this.data.subarray(e+1,e+1+s));t.data=this.data.subarray(e+1+s,e+1+s+l),this.pointer+=n+1+s+l}else if(this.data[e]<128)if(t.running=!0,t.noteNumber=this.data[e],t.noteName=w.NOTES[this.data[e]],t.velocity=this.data[e+1],this.lastStatus<=143)t.name="Note off",t.channel=this.lastStatus-128+1,this.pointer+=n+2;else if(this.lastStatus<=159)t.name="Note on",t.channel=this.lastStatus-144+1,this.pointer+=n+2;else if(this.lastStatus<=175)t.name="Polyphonic Key Pressure",t.channel=this.lastStatus-160+1,t.note=w.NOTES[this.data[e+1]],t.pressure=event[1],this.pointer+=n+2;else if(this.lastStatus<=191)t.name="Controller Change",t.channel=this.lastStatus-176+1,t.number=this.data[e+1],t.value=this.data[e+2],this.pointer+=n+2;else if(this.lastStatus<=207)t.name="Program Change",t.channel=this.lastStatus-192+1,t.value=this.data[e+1],this.pointer+=n+1;else if(this.lastStatus<=223)t.name="Channel Key Pressure",t.channel=this.lastStatus-208+1,this.pointer+=n+1;else{if(!(this.lastStatus<=239))throw"Unknown event (running): ".concat(this.lastStatus);t.name="Pitch Bend",t.channel=this.lastStatus-224+1,t.value=this.data[e+2],this.pointer+=n+2}else if(this.lastStatus=this.data[e],this.data[e]<=143)t.name="Note off",t.channel=this.lastStatus-128+1,t.noteNumber=this.data[e+1],t.noteName=w.NOTES[this.data[e+1]],t.velocity=Math.round(this.data[e+2]/127*100),this.pointer+=n+3;else if(this.data[e]<=159)t.name="Note on",t.channel=this.lastStatus-144+1,t.noteNumber=this.data[e+1],t.noteName=w.NOTES[this.data[e+1]],t.velocity=Math.round(this.data[e+2]/127*100),this.pointer+=n+3;else if(this.data[e]<=175)t.name="Polyphonic Key Pressure",t.channel=this.lastStatus-160+1,t.note=w.NOTES[this.data[e+1]],t.pressure=event[2],this.pointer+=n+3;else if(this.data[e]<=191)t.name="Controller Change",t.channel=this.lastStatus-176+1,t.number=this.data[e+1],t.value=this.data[e+2],this.pointer+=n+3;else if(this.data[e]<=207)t.name="Program Change",t.channel=this.lastStatus-192+1,t.value=this.data[e+1],this.pointer+=n+2;else if(this.data[e]<=223)t.name="Channel Key Pressure",t.channel=this.lastStatus-208+1,this.pointer+=n+2;else{if(!(this.data[e]<=239))throw"Unknown event: ".concat(this.data[e]);t.name="Pitch Bend",t.channel=this.lastStatus-224+1,this.pointer+=n+3}return this.delta+=t.delta,this.events.push(t),t}},{key:"endOfTrack",value:function(){return 255==this.data[this.pointer+1]&&47==this.data[this.pointer+2]&&0==this.data[this.pointer+3]}}]),e}();Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach});var M=function(){function e(t,n){b(this,e),this.sampleRate=5,this.startTime=0,this.buffer=n||null,this.midiChunksByteLength=null,this.division,this.format,this.setIntervalId=!1,this.tracks=[],this.instruments=[],this.defaultTempo=120,this.tempo=null,this.startTick=0,this.tick=0,this.lastTick=null,this.inLoop=!1,this.totalTicks=0,this.events=[],this.totalEvents=0,this.eventListeners={},"function"==typeof t&&this.on("midiEvent",t)}return x(e,[{key:"loadFile",value:function(e){throw"loadFile is only supported on Node.js"}},{key:"loadArrayBuffer",value:function(e){return this.buffer=new Uint8Array(e),this.fileLoaded()}},{key:"loadDataUri",value:function(e){for(var t=A.atob(e.split(",")[1]),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return this.buffer=n,this.fileLoaded()}},{key:"getFilesize",value:function(){return this.buffer?this.buffer.length:0}},{key:"fileLoaded",value:function(){if(!this.validate())throw"Invalid MIDI file; should start with MThd";return this.setTempo(this.defaultTempo).getDivision().getFormat().getTracks().dryRun()}},{key:"validate",value:function(){return"MThd"===A.bytesToLetters(this.buffer.subarray(0,4))}},{key:"getFormat",value:function(){return this.format=A.bytesToNumber(this.buffer.subarray(8,10)),this}},{key:"getTracks",value:function(){this.tracks=[];for(var e=0;e<this.buffer.length;){if("MTrk"==A.bytesToLetters(this.buffer.subarray(e,e+4))){var t=A.bytesToNumber(this.buffer.subarray(e+4,e+8));this.tracks.push(new N(this.tracks.length,this.buffer.subarray(e+8,e+8+t)))}e+=A.bytesToNumber(this.buffer.subarray(e+4,e+8))+8}var n=0;return this.tracks.forEach((function(e){n+=8+e.data.length})),this.midiChunksByteLength=w.HEADER_CHUNK_LENGTH+n,this}},{key:"enableTrack",value:function(e){return this.tracks[e-1].enable(),this}},{key:"disableTrack",value:function(e){return this.tracks[e-1].disable(),this}},{key:"getDivision",value:function(){return this.division=A.bytesToNumber(this.buffer.subarray(12,w.HEADER_CHUNK_LENGTH)),this}},{key:"playLoop",value:function(e){this.inLoop||(this.inLoop=!0,this.tick=this.getCurrentTick(),this.tracks.forEach((function(t,n){if(!e&&this.endOfFile())this.triggerPlayerEvent("endOfFile"),this.stop();else{var r=t.handleEvent(this.tick,e);e&&r?(r.hasOwnProperty("name")&&"Set Tempo"===r.name&&(this.defaultTempo=r.data,this.setTempo(r.data)),r.hasOwnProperty("name")&&"Program Change"===r.name&&(this.instruments.includes(r.value)||this.instruments.push(r.value))):r&&(r.hasOwnProperty("name")&&"Set Tempo"===r.name&&(this.setTempo(r.data),this.isPlaying()&&this.pause().play()),this.emitEvent(r))}}),this),e||this.triggerPlayerEvent("playing",{tick:this.tick}),this.inLoop=!1)}},{key:"setTempo",value:function(e){return this.tempo=e,this}},{key:"setStartTime",value:function(e){return this.startTime=e,this}},{key:"play",value:function(){if(this.isPlaying())throw"Already playing...";return this.startTime||(this.startTime=(new Date).getTime()),this.setIntervalId=setInterval(this.playLoop.bind(this),this.sampleRate),this}},{key:"loop",value:function(){setTimeout(function(){this.playLoop(),this.loop()}.bind(this),this.sampleRate)}},{key:"pause",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=this.tick,this.startTime=0,this}},{key:"stop",value:function(){return clearInterval(this.setIntervalId),this.setIntervalId=!1,this.startTick=0,this.startTime=0,this.resetTracks(),this}},{key:"skipToTick",value:function(e){return this.stop(),this.startTick=e,this.tracks.forEach((function(t){t.setEventIndexByTick(e)})),this}},{key:"skipToPercent",value:function(e){if(e<0||e>100)throw"Percent must be number between 1 and 100.";return this.skipToTick(Math.round(e/100*this.totalTicks)),this}},{key:"skipToSeconds",value:function(e){var t=this.getSongTime();if(e<0||e>t)throw e+" seconds not within song time of "+t;return this.skipToPercent(e/t*100),this}},{key:"isPlaying",value:function(){return this.setIntervalId>0||"object"===y(this.setIntervalId)}},{key:"dryRun",value:function(){for(this.resetTracks();!this.endOfFile();)this.playLoop(!0);return this.events=this.getEvents(),this.totalEvents=this.getTotalEvents(),this.totalTicks=this.getTotalTicks(),this.startTick=0,this.startTime=0,this.resetTracks(),this.triggerPlayerEvent("fileLoaded",this),this}},{key:"resetTracks",value:function(){return this.tracks.forEach((function(e){return e.reset()})),this}},{key:"getEvents",value:function(){return this.tracks.map((function(e){return e.events}))}},{key:"getTotalTicks",value:function(){return Math.max.apply(null,this.tracks.map((function(e){return e.delta})))}},{key:"getTotalEvents",value:function(){return this.tracks.reduce((function(e,t){return{events:{length:e.events.length+t.events.length}}}),{events:{length:0}}).events.length}},{key:"getSongTime",value:function(){return this.totalTicks/this.division/this.tempo*60}},{key:"getSongTimeRemaining",value:function(){return Math.round((this.totalTicks-this.getCurrentTick())/this.division/this.tempo*60)}},{key:"getSongPercentRemaining",value:function(){return Math.round(this.getSongTimeRemaining()/this.getSongTime()*100)}},{key:"bytesProcessed",value:function(){return w.HEADER_CHUNK_LENGTH+8*this.tracks.length+this.tracks.reduce((function(e,t){return{pointer:e.pointer+t.pointer}}),{pointer:0}).pointer}},{key:"eventsPlayed",value:function(){return this.tracks.reduce((function(e,t){return{eventIndex:e.eventIndex+t.eventIndex}}),{eventIndex:0}).eventIndex}},{key:"endOfFile",value:function(){return this.isPlaying()?this.totalTicks-this.tick<=0:this.bytesProcessed()>=this.midiChunksByteLength}},{key:"getCurrentTick",value:function(){return this.startTime?Math.round(((new Date).getTime()-this.startTime)/1e3*(this.division*(this.tempo/60)))+this.startTick:this.startTick}},{key:"emitEvent",value:function(e){return this.triggerPlayerEvent("midiEvent",e),this}},{key:"on",value:function(e,t){return this.eventListeners.hasOwnProperty(e)||(this.eventListeners[e]=[]),this.eventListeners[e].push(t),this}},{key:"triggerPlayerEvent",value:function(e,t){return this.eventListeners.hasOwnProperty(e)&&this.eventListeners[e].forEach((function(e){return e(t||{})})),this}}]),e}(),D={Player:M,Utils:A,Constants:w},C=n(346),I=n.n(C),L=n(974);const j=(e,t,n)=>Math.max(t,Math.min(n,e));class O{constructor(e=""){this.ctn=document.getElementById(`${e}-progress-ctn`),this.el=document.getElementById(`${e}-progress`),this.doneEl=document.getElementById(`${e}-progress-done`),this.maxEl=document.getElementById(`${e}-progress-max`),this.reset()}update(e=this.done,t=this.max){if(t<=0)return this.reset();this.done=e,this.max=t,this.el.max=t,this.el.value=e,this.el.innerHTML=`${e} / ${t}`;const n=((e,t=0)=>(t=10**t,Math.round(e*t)/t))(this.el.position,3);this.setBar(n),this.updateLabel()}setBar(e){this.ctn.style.setProperty("--progress",j(0,e,1))}updateLabel(){this.doneEl.innerHTML=this.formatTime(this.done),this.maxEl.innerHTML=this.formatTime(this.max)}formatTime(e){return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,0)}`}reset(){this.el.innerHTML="",this.el.removeAttribute("value"),this.el.removeAttribute("max"),this.setBar(0),this.done=0,this.max=0}}const B=new AudioContext;let P;const z=new class{constructor(){this.midiId=null,this.playhead=0,this.playBtn=document.getElementById("player-play"),this.pauseBtn=document.getElementById("player-pause"),this.stopBtn=document.getElementById("player-stop"),this.timelineRange=document.getElementById("player-timeline-input"),this.init()}loadSound(e,t=""){this.midiId!=t&&(this.stop(),this.midiId=t),P.loadDataUri(`data:audio/midi;base64,${e}`)}onTap({target:e}){if(e==this.playBtn&&!P.isPlaying()){const e=(0,L.p8)();return"original"!=this.midiId&&this.loadSound(e,"original"),void this.play()}e==this.pauseBtn&&P.isPlaying()?this.pause():e==this.stopBtn&&P.isPlaying()&&this.stop()}onChange({target:e}){e==this.timelineRange&&P.skipToSeconds(e.value).play()}updateProgress(){let e=P.getSongTime(),t=P.getSongTimeRemaining();(isNaN(e)||isNaN(t))&&(e=0,t=0);const n=e-t;this.progressBar.update(n,e),this.timelineRange.setAttribute("max",e),this.timelineRange.setAttribute("value",n)}play(){this.playhead&&P.skipToTick(this.playhead),P.play()}stop(){P.stop(),this.updateProgress(),this.playhead=0}pause(){this.playhead=P.getCurrentTick(),P.pause()}init(){I().instrument(B,"/instruments/acoustic-grand-piano-mp3.js").then((e=>{P=new D.Player((t=>{"Note on"==t.name&&t.velocity>0&&e.play(t.noteName,B.currentTime,{gain:t.velocity/100}),this.updateProgress()})),P.on("endOfFile",(()=>this.stop()))})),this.progressBar=new O("player")}},R=(e,t=null)=>{const n={},r=e.getBoundingClientRect();for(const e in r)t&&!t.includes(e)||(n[e]=r[e]);return n};class H{}var U,V,q;q=e=>1==e.nodeType,(V="isElement")in(U=H)?Object.defineProperty(U,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):U[V]=q;const $=e=>e[0].toUpperCase()+e.slice(1);class F{constructor(e,t){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"createFilterElement",(({type:e,checked:t})=>`\n    <li>\n        <label class="checkable color-${this.namespace}-${e}" for="${this.namespace}-filter-${e}">\n            ${$(e)}\n            <input class="checkable__input" type="checkbox" id="${this.namespace}-filter-${e}" data-type="${e}" ${t?"checked":""}>\n            <span class="checkbox checkbox--colored">\n                <svg class="checkable__icon btn__icon" width="12" height="10">\n                    <use xlink:href="#check-path"/>\n                </svg>\n            </span>\n        </label>\n    </li>\n  `)),this.namespace=e,this.ctn=document.getElementById(t.filterCtnId),this.paths=t.svgCtn.getElementsByClassName(e),this.fields=[]}onChange(e){e.composedPath().includes(this.ctn)&&this.toggleRelationsPaths(e.target.dataset.type,e.target.checked)}toggleRelationsPaths(e,t){Array.from(this.paths).filter((t=>t.getAttribute("type")==e)).forEach((e=>e.classList.toggle("relation--filtered",!t)))}getRelations(){const e=new Set(Array.from(this.paths,(e=>e.getAttribute("type"))));this.fields=Array.from(e,(e=>({type:e,checked:!0,el:null})))}hasRelationType(e){return this.fields.some((t=>t.type==e))}wasLastOfType(e){return!Array.from(this.paths).some((t=>t.getAttribute("type")==e))}render(){let e=this.fields.map((e=>this.createFilterElement(e))).join(" ");this.ctn.innerHTML=e}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const W=new class{constructor(){Y(this,"createFiltersGroups",(()=>[new F("relation",{filterCtnId:"relations-filters",svgCtn:this.svgCtn}),new F("metarelation",{filterCtnId:"meta-relations-filters",svgCtn:this.svgCtn})])),Y(this,"createMutationObserver",(()=>new MutationObserver((e=>{if(e.filter((e=>"attributes"==e.type&&"type"==e.attributeName)).filter((e=>e.target.getAttribute("type")!=e.oldValue)).length>0)return this.update();const t=1==e.length&&e.filter((e=>{var t;return"childList"==e.type&&1==(null===(t=e.addedNodes)||void 0===t?void 0:t.length)})).map((e=>{var t;return null===(t=e.addedNodes)||void 0===t?void 0:t.item(0)})).find(H.isElement);if(t){const e=t.getAttribute("type");if(!this.groups.some((t=>t.hasRelationType(e))))return this.update()}const n=1==e.length&&e.filter((e=>{var t;return"childList"==e.type&&1==(null===(t=e.removedNodes)||void 0===t?void 0:t.length)})).map((e=>{var t;return null===(t=e.removedNodes)||void 0===t?void 0:t.item(0)})).find(H.isElement);if(n){const e=n.getAttribute("type");if(this.groups.some((t=>t.wasLastOfType(e))))return this.update()}})))),this.visible=!1,this.ctn=document.getElementById("filters"),this.toggleBtn=document.getElementById("filters-toggle"),this.svgCtn=document.getElementById("layers"),this.observer=this.createMutationObserver(),this.groups=this.createFiltersGroups()}onTap({target:e}){e==this.toggleBtn&&this.toggle()}onChange(e){this.groups.forEach((t=>t.onChange(e)))}onScoreLoad(){this.toggle(!1),this.observer.disconnect(),this.update(),this.observe()}observe(){this.observer.observe(document.querySelector("#layers .svg_container > svg .page-margin"),{subtree:!0,childList:!0,attributeOldValue:!0,attributeFilter:["type"]})}toggle(e=!this.visible){this.visible=e,this.ctn.classList.toggle("fly-out--expanded",e),this.ctn.classList.toggle("fly-out--collapsed",!e)}update(){this.groups.forEach((e=>e.getRelations())),this.groups.forEach((e=>e.render()))}};var K=n(624);function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X extends Map{constructor(...e){super(...e),Q(this,"add",((e,t)=>this.has(e)?this:this.set(e,t))),Q(this,"remember",((e,t)=>(this.add(e,t),t)))}}function G(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Z(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,J(e,t,"get"))}function J(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}const ee=["note","relation","metarelation"];var te=new WeakMap,ne=new WeakMap;const re=new class{constructor(){G(this,te,{writable:!0,value:void 0}),G(this,ne,{writable:!0,value:new X}),this.loaded=!1,this.mei=null}get selection(){return Z(this,te)}set selection(e){Z(this,ne).clear(),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,J(e,t,"set"),n)}(this,te,e)}get flatSelection(){return Z(this,ne).remember("flatSelection",Object.values(this.selection).flat())}get selectionType(){var e;const t=null!==(e=ee.find((e=>{var t;return null===(t=this.flatSelection[0])||void 0===t?void 0:t.classList.contains(e)})))&&void 0!==e?e:null;return Z(this,ne).remember("selectionType",t)}onScoreLoad(){this.loaded=!0,this.mei=window.mei,Z(this,ne).clear()}onScoreSelection({detail:e}){this.selection=e}},ie=re,oe={title:{label:"Title",saveBtn:"Update title",placeholder:"The name  of the song "},roles:{composer:{label:"Composer",saveBtn:"Update composer",placeholder:"Wolfgang Amadeus Mozart"},analyst:{label:"Analyst",saveBtn:"Assign responsibility",placeholder:"Maybe you?"},annotator:{label:"Annotator",saveBtn:"Assign responsibility",placeholder:"Maybe you?"}}},ae=(e,{label:t,placeholder:n=""},r="")=>`\n  <label class="fillable fly-out__title" for="metadata-${e}">\n      ${t}\n      <input\n          class="fillable__input"\n          id="metadata-${e}"\n          type="text"\n          placeholder="${n}"\n          value="${r}"\n      >\n  </label>\n`,se=(e,{saveBtn:t})=>`\n  <button\n      class="btn btn--plain btn--small"\n      id="metadata-${e}-assign"\n      type="button"\n      data-role="${e}"\n  >${t}</button>\n`,le=new DOMParser,ue=new RegExp(/^metadata-\w+-assign$/),ce=new class{constructor(){this.visible=!1,this.ctn=document.getElementById("metadata"),this.toggleBtn=document.getElementById("metadata-toggle"),this.persRoles=Object.keys(oe.roles),this.formDOM={ctn:document.getElementById("metadata-form")},this.formDOM.inputs=this.formDOM.ctn.getElementsByClassName("fillable__input"),this.scoreHead={titleStmt:null,title:null,respStmt:null,respPersName:[]}}onTap({target:e}){if(e==this.toggleBtn)return this.toggle();if(ue.test(e.id)){const t=e.id.replace("metadata-","").replace("-assign","");this.updateScoreMetadata(t)}}onScoreLoad(){this.initScore(),this.initFields()}toggle(e=!this.visible){this.visible=e,this.ctn.classList.toggle("fly-out--expanded",e),this.ctn.classList.toggle("fly-out--collapsed",!e)}updateScoreMetadata(e){const t=[...this.formDOM.inputs].find((({id:t})=>`metadata-${e}`));if(!t)return;const n=t.value;if("title"==e)return void(this.scoreHead.title[0].innerHTML=n);const r=this.persNames.find((t=>t.role==e));r.value=n,r.el.innerHTML=n,"composer"!=e&&ie.flatSelection.forEach((t=>{const n=(0,K.get_id)(t),r=(0,K.get_by_id)(ie.mei,n);("note"==r.tagName?r:r.firstChild).setAttribute("resp",e)}))}initScore(){this.scoreHead.titleStmt=ie.mei.querySelector("meiHead fileDesc titleStmt"),this.scoreHead.titleStmt&&(this.initStmtEl("title"),this.initStmtEl("respStmt"),this.initRoles())}initStmtEl(e){if(this.scoreHead[e]=this.scoreHead.titleStmt.getElementsByTagName(e),!this.scoreHead[e].length){const t=ie.mei.createElement(e);this.scoreHead.titleStmt.appendChild(t)}}initRoles(){this.scoreHead.respPersName=this.scoreHead.respStmt[0].getElementsByTagName("persName"),this.persNames=Array.from(this.scoreHead.respPersName).filter((e=>this.persRoles.includes(e.getAttribute("role")))).map((e=>({el:e,role:e.getAttribute("role"),value:e.innerHTML,config:oe.roles[e.getAttribute("role")]}))),this.persRoles.filter((e=>!this.persNames.find((t=>t.role==e)))).forEach((e=>this.initRole(e)))}initRole(e){const t=le.parseFromString(`<persName role="${e}" xml:id="${e}" />`,"text/xml").firstChild;this.scoreHead.respStmt[0].appendChild(t),this.persNames.push({el:t,role:e,value:"",config:oe.roles[e]})}initFields(){this.formDOM.ctn.innerHTML=ae("title",oe.title,this.scoreHead.title[0].innerHTML)+se("title",oe.title)+this.persNames.map((({role:e,config:t,value:n})=>`\n    <hr class="fly-out__hr">\n    ${ae(e,t,n)}\n    ${se(e,t)}\n  `)).join("")}},de=ce,he=new class{constructor(){this.update()}onResize(){this.update()}update(){this.w=window.innerWidth,this.h=window.innerHeight}},fe=new class{constructor(){this.toLeftBtn=document.getElementById("to-left"),this.toRightBtn=document.getElementById("to-right")}onTap(e){return e.target==this.toLeftBtn?this.toLeft():e.target==this.toRightBtn?this.toRight():void 0}toLeft(){this.goTo(-(he.w-200))}toRight(){this.goTo(he.w-200)}goTo(e){r.scrollBy(e,0)}};var pe=n(362);class ge{constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e.hide=n}(this,"hide",(()=>this.toggleVisibility(!1))),this.ctn={el:document.getElementById(e)},this.closeBtn=this.ctn.el.querySelector(".fly-out__closeBtn"),this.visible=!1}onTap(e){if(e.composedPath().includes(this.ctn.el))return e.target==this.closeBtn?this.toggleVisibility(!1):void 0}toggleVisibility(e=!this.visible){this.ctn.el.classList.toggle("fly-out--visible",e),this.visible=e}}const me=e=>e/10+"rem";function ve(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,ye(e,t,"get"))}function ye(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var be=new WeakMap;class _e extends ge{constructor(e){super(e),function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}(this,be,{writable:!0,value:!1}),this.dragHandle={el:this.ctn.el.querySelector(".fly-out__drag")},this.visible=!1,this.x=0,this.y=0,this.computeValues()}onTapStart(e){e.target==this.dragHandle.el&&function(e,t=null){e.preventDefault(),t&&t.call()}(e,(()=>this.toggleDragging(!0)))}onTapMove(e,t){this.visible&&ve(this,be)&&this.updatePosition(e,t)}onTapEnd(){this.visible&&ve(this,be)&&(this.toggleDragging(!1),this.computeValues())}onResize(){this.visible&&this.computeValues()}updatePosition(e=this.x,t=this.y){this.x=e-this.ctn.handleDeltaX,this.y=t-this.ctn.handleDeltaY,this.ctn.el.style.setProperty("--fly-out-x",me(this.x)),this.ctn.el.style.setProperty("--fly-out-y",me(this.y))}toggleDragging(e=!ve(this,be)){(function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,ye(e,t,"set"),n)})(this,be,e),this.ctn.el.classList.toggle("fly-out--grabbing",e),r.classList.toggle("dragging-fly-out",e)}snapInViewport(){const e=j(this.x,10,he.w-this.ctn.width-10),t=j(this.y,10,he.h-this.ctn.height-10);e==this.x&&t==this.y||(this.ctn.el.classList.add("fly-out--snapping"),this.ctn.el.addEventListener("transitionend",this.onSnapTransitionEnd.bind(this)),this.updatePosition(e+this.ctn.handleDeltaX,t+this.ctn.handleDeltaY))}onSnapTransitionEnd({propertyName:e}){"transform"==e&&(this.ctn.el.classList.remove("fly-out--snapping"),this.ctn.el.removeEventListener("transitionend",this.onSnapTransitionEnd.bind(this)))}computeValues(){const e=R(this.ctn.el,["x","y","width","height"]);Object.assign(this.ctn,e);const t=R(this.dragHandle.el,["width","height"]);Object.assign(this.dragHandle,t,{offsetLeft:this.dragHandle.el.offsetLeft,offsetTop:this.dragHandle.el.offsetTop}),this.ctn.handleDeltaX=this.dragHandle.offsetLeft+this.dragHandle.width/2,this.ctn.handleDeltaY=this.dragHandle.offsetTop+this.dragHandle.height/2,this.snapInViewport()}}const xe=e=>`<option value="${e}">`;function we(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Ee(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Te(e,t,"set"),n),n}function Se(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Te(e,t,"get"))}function Te(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ke=new WeakMap,Ae=new WeakMap;class Ne{constructor(e,t,n={}){we(this,ke,{writable:!0,value:!1}),we(this,Ae,{writable:!0,value:!1}),this.type=e,this.name=t.name,this.eventCallbacks=n,this.initHtml(t)}get isVisible(){return Se(this,ke)}get isExpanded(){return Se(this,Ae)}onTap(){this.toggle()}show(){this.toggleVisibility(!0)}hide(){this.toggleVisibility(!1)}expand(){this.toggle(!0)}collapse(){this.toggle(!1)}toggleVisibility(e=!Se(this,ke)){Ee(this,ke,e),this.ctn.classList.toggle("fly-out__btnGroup--visible",e)}toggle(e=!Se(this,Ae)){Ee(this,Ae,e),this.ctn.classList.toggle("fly-out__btnGroup--expanded",e)}initHtml(e){const t=Object.keys(e.main).map((e=>((e,t)=>`\n  <button\n      type="button"\n      class="btn btn--hollow btn--relation color-relation-${e}"\n      data-relation-name="${e}"\n      data-relation-type="${this.type}"\n  >\n      ${$(e)}\n  </button>\n`)(e))).join("");let n="";var r,i;(e.main.length>3||"additional"in e)&&(n+=`\n  <button\n      type="button"\n      class="fly-out__showMore | btn btn--hollow"\n      data-relation-type="${r=this.type}"\n  >\n      <span class="visually-hidden">View more ${r}</span>\n      &hellip;\n  </button>\n`),"additional"in e&&(n+='<hr class="fly-out__hr">'+((e,{label:t,placeholder:n=""})=>`\n  <label class="fillable fly-out__title" for="free-field-${e}">\n      <span class="fillable__label">\n          ${t}\n          <svg class="fillable__label__triangle | btn__icon" width="10" height="8">\n              <use xlink:href="#triangle-path"/>\n          </svg>\n      </span>\n\n      <input\n          class="fillable__input"\n          id="free-field-${e}"\n          type="text"\n          list="datalist-${e}"\n          placeholder="${n}"\n          data-relation-type="${e}"\n      >\n  </label>\n`)(this.type,{label:"Select a "+this.name})+(i=e.additional,`\n  <datalist id="datalist-${this.type}">${(e=>e.map(xe).join(""))(i)}</datalist>\n`)),this.ctn=document.getElementById(`${this.type}-btns`),this.ctn.innerHTML=t+n,this.btns=this.ctn.getElementsByClassName("btn--relation"),this.freeField=this.ctn.querySelector(`#free-field-${this.type}`)}}const Me=new class extends _e{constructor(){super("relations-menu"),this.innerCtn=this.ctn.el.querySelector(".fly-out__innerSomething"),this.init()}get visibleGroups(){return[this.relations,this.metarelations,this.comborelations].filter((({isVisible:e})=>e))}onTap(e){super.onTap(e);const{dataset:t,classList:n}=e.target;if(!("relationType"in t))return;const r=t.relationType;if(n.contains("btn--relation"))return this[r].eventCallbacks.tap(t.relationName);n.contains("btn")&&(this[r].onTap(),this.compact(),this.computeValues())}onBlur({target:{dataset:e,value:t,id:n},target:r}){if(null==e||!e.hasOwnProperty("relationType"))return;const{relationType:i}=e;return t&&n==`free-field-${i}`?this[i].eventCallbacks.tap(t):void 0}onScoreSelection({detail:e}){this.toggleVisibility(ie.flatSelection.length),this.reorder(),this.relations.show(),this.metarelations.toggleVisibility("note"!=ie.selectionType),this.compact(),1==ie.flatSelection.length&&this.computeValues()}reorder(){if(1!==ie.flatSelection.length)return;const e=(0,pe.Ti)(ie.selectionType);for(let t=e.length-1;t>0;t--)this.innerCtn.insertBefore(this[e[t-1]].ctn,this[e[t]].ctn),t>1&&this[e[t-1]].toggle(!0)}compact(){if(1!==ie.flatSelection.length)return;const e=!this[(0,pe.Ti)(ie.selectionType)[0]].isExpanded;this.ctn.el.classList.toggle("fly-out--relations-compact",e),this.ctn.el.classList.toggle("fly-out--big",!e);const t=this.relations.isExpanded&&"note"==ie.selectionType&&ie.flatSelection.length>2&&ie.selection.extraselected.length<3;this.comborelations.toggleVisibility(t)}init(){this.relations=new Ne("relations",pe.W3,{tap:L.i9}),this.metarelations=new Ne("metarelations",pe.pX,{tap:L.qG}),this.comborelations=new Ne("comborelations",pe.yu,{tap:L.lk}),this.title=this.ctn.el.querySelector(".fly-out__title")}},De=Me;var Ce=n(714);const Ie=e=>`<li class="selection__listItem">${e.toUpperCase()}</li>`,Le=e=>`<li class="selection__listItem">${e.getAttribute("type")}</li>`;class je extends ge{constructor(){super("selection-legend"),this.title=document.getElementById("selection-type"),this.primary=document.getElementById("selection-primary"),this.primaryList=document.getElementById("selection-list-primary"),this.secondary=document.getElementById("selection-secondary"),this.secondaryList=document.getElementById("selection-list-secondary"),this.hide()}update({selected:e,extraselected:t}){this.toggleVisibility(ie.flatSelection.length>0),this.visible&&(this.updateTitle(),this.updateRow("primary",e),this.updateRow("secondary",t))}updateTitle(){this.title.innerHTML=ie.selectionType?`Selected ${ie.selectionType}s`:"Selection is empty"}updateRow(e,t){this[e].classList.toggle("none",!t.length),this[`${e}List`].innerHTML=(e=>{console.log(e);const t=ie.selectionType;return e.length?("note"==t?(0,K.to_text)(e).map(Ie):e.map(Le)).join(""):"-"})(t)}}const Oe=new class{constructor(){this.selectBtn=document.getElementById("select-all"),this.unselectBtn=document.getElementById("unselect-all"),this.legend=new je}selectAll(){const e=(0,Ce.c)();e&&(0,Ce.Au)(e)}selectNone(){(0,Ce.Nv)()}onTap({target:e}){return e==this.selectBtn?this.selectAll():e==this.unselectBtn?this.selectNone():void 0}onScoreSelection(e){this.legend.update(e)}},Be=new class{constructor(){this.zoomInBtn=document.getElementById("zoom-in"),this.zoomOutBtn=document.getElementById("zoom-out"),this.resetBtn=document.getElementById("zoom-reset"),this.levelEl=document.getElementById("zoom-level")}onTap({target:e}){return e==this.zoomInBtn?this.in():e==this.zoomOutBtn?this.out():e==this.resetBtn?this.reset():void 0}in(){this.by(1.1)}out(){this.by(.9090909090909091)}reset(){this.by(1)}by(e=1){const t=(0,Ce.c)();t&&(t.zoom=1==e?1:t.zoom*e,t.svg_elem.style.transform=`scale(${t.zoom})`,this.levelEl.innerHTML=this.format(t.zoom))}format(e){return`${Math.round(100*e)}%`}},Pe=new class{constructor(){this.ctn=document.getElementById("ui"),this.init()}onTap(e){var t,n,r,i,o,a;null===(t=this.relations)||void 0===t||t.onTap(e),e.composedPath().includes(this.ctn)&&(null===(n=this.zoom)||void 0===n||n.onTap(e),null===(r=this.selection)||void 0===r||r.onTap(e),null===(i=this.metadata)||void 0===i||i.onTap(e),null===(o=this.navigation)||void 0===o||o.onTap(e),null===(a=this.filters)||void 0===a||a.onTap(e))}onTapStart(e){var t;null===(t=this.relations)||void 0===t||t.onTapStart(e)}onTapMove(e,t){var n;null===(n=this.relations)||void 0===n||n.onTapMove(e,t)}onTapEnd(){var e;null===(e=this.relations)||void 0===e||e.onTapEnd()}onResize(){var e;null===(e=this.relations)||void 0===e||e.onResize()}onScoreLoad(e){var t,n;null===(t=this.filters)||void 0===t||t.onScoreLoad(e),null===(n=this.metadata)||void 0===n||n.onScoreLoad(e)}onScoreSelection({detail:e}){var t,n;null===(t=this.selection)||void 0===t||t.onScoreSelection(e),null===(n=this.relations)||void 0===n||n.onScoreSelection(e)}init(){this.zoom=Be,this.selection=Oe,this.navigation=fe,this.metadata=de,this.filters=W,this.relations=De}};var ze=n(235);const Re=new class{constructor(){this.undoBtn=document.getElementById("undo"),this.redoBtn=document.getElementById("redo"),this.updateBtns(0,0)}onTap({target:e}){return e==this.undoBtn?this.undo():e==this.redoBtn?this.redo():void 0}undo(){(0,ze.FB)()}redo(){(0,ze.VJ)()}updateBtns(e=0,t=0){this.undoBtn.toggleAttribute("disabled",0==e),this.redoBtn.toggleAttribute("disabled",0==t)}onUndoRedo({detail:e}){this.updateBtns(e.undoAbleCount,e.redoAbleCount)}},He=new class{constructor(){this.init()}init(){r.classList.remove("loading"),r.classList.add("ready"),this.viewport=he,(e=>{new v(this)})(),this.ui=Pe,this.score=ie,this.player=z,this.history=Re}}},362:(e,t,n)=>{"use strict";n.d(t,{W3:()=>i,pX:()=>o,yu:()=>a,Ti:()=>s});const r={note:["relations","metarelations","comborelations"],relation:["metarelations","relations","comborelations"],metarelation:["metarelations","comborelations","relations"]},i={name:"relation",main:{repeat:{key:"e",color:0},passing:{key:"p",color:6},neighbour:{key:"n",color:2},harmonic:{key:"i",color:3},arpeggio:{key:"a",color:4},urlinie:{key:"u",color:5},bassbrechung:{key:"b",color:5},untyped:{color:5}},additional:["repetition","arpeggiation","back_relating_dominant","displacement","register_transfer","56_shift","added_root","initial_ascent","arpeggiated_ascent","urlinie_transference","bassbrechung_component","coupling","voice_exchange_component","voice_exchange_component_chromaticized","mixture","phrygian_ii"]},o={name:"metarelation",main:{context:{key:"c",colour:0},layer:{key:"l",colour:6},phrase:{key:"r",colour:2},section:{key:"t",colour:3}},additional:["auxiliary_cadence","superposition","reaching_over","urlinie_meta","ursatz","bassbrechung","bassbrechung_transference","ursatz_transference","unfolding","motion_into_the_inner_voice","motion_from_the_inner_voice","linear_intervallic_progression","linear_intervallic_progression_module","interruption","interruption_branch_1","interruption_branch_2","voice_exchange","motivic_parallelism","motive","contradiction","indeterminacy","parallel_fifths","parallel_octaves"]},a={name:"comborelation",main:{"passing comborelation":{key:"P",total:"passing",outer:"arpeggio"},"neighbour comborelation":{key:"N",total:"neighbour",outer:"repeat"}}},s=e=>r[e]},714:(e,t,n)=>{"use strict";n.d(t,{N7:()=>K,Sr:()=>me,hv:()=>ge,Nv:()=>ue,Pw:()=>he,c:()=>Ae,jM:()=>H,hT:()=>U,h4:()=>Te,U2:()=>Ee,gB:()=>Se,oq:()=>G,PB:()=>ce,qY:()=>Q,Z6:()=>Z,$Z:()=>X,K5:()=>de,rp:()=>ve,bf:()=>pe,Au:()=>W,vI:()=>ke,dB:()=>Y,up:()=>te,XG:()=>re,e6:()=>fe});var r=n(986),o=n.n(r),a=n(501),s=n.n(a),l=n(200),u=n(36),c=n(974),d=n(624);function h(e,t,n){var r=t.map((t=>(0,d.relation_primaries)(e,t))).flat();t=t.filter((e=>!n.includes(e))),r=r.concat(t.map((t=>(0,d.relation_secondaries)(e,t))).flat());do{var i=n.filter((t=>(0,d.relation_secondaries)(e,t).findIndex((e=>r.includes(e)))>-1));t=t.concat(i),n=n.filter((e=>!i.includes(e))),r=r.concat(i.map((t=>(0,d.relation_secondaries)(e,t))).flat())}while(i.length>0);return[n,[...new Set(n.flatMap((t=>(0,d.relation_secondaries)(e,t))))]]}function f(e){!function(e,t,n,r){var i=n.concat(r).map((e=>(0,d.get_by_id)(t.getRootNode(),(0,d.get_id)(e)))),o=Array.from(t.getElementsByTagName("node")).filter((e=>"relation"==e.getAttribute("type"))).filter((t=>{var n=(0,d.get_by_id)(document,e.id_prefix+t.getAttribute("xml:id"));return null!=n&&!n.classList.contains("hidden")}));0==i.length&&(i=o);var[a,s]=h(t,o,i),l=[];l.push(a.map((t=>(0,d.hide_he)(e,t)))),l.push(s.map((t=>(0,d.hide_note)(e,t)))),l.push(a.map((t=>(0,d.hide_he_hier)(e,t)))),l.push(s.map((t=>(0,d.hide_note_hier)(e,t))));var u=[a,s,l];e.reductions.push(["reduce",u,n,r])}(e,(0,c.ro)(),selected,extraselected)}function p(e,t=200,n=!0){var r=e.svg_elem,i=e.id_prefix,o=(ge(e),(0,d.g)());o.id="hier"+i;var a=Array.from(r.getElementsByClassName("note")).map(d.get_id).map((e=>(0,d.get_by_id)(mei,e))).map(d.get_id).map((e=>(0,d.get_by_id)(mei,"gn-"+e))).filter((e=>null!=e)),s=Array.from(r.getElementsByClassName("relation")).map(d.get_id).map((e=>(0,d.get_by_id)(mei,e))),l=function(e,t,n=!0){var r=(0,c.ro)(),i=[],o=t,a=e.filter((e=>null!=e));do{let e=[];n&&(e=a.filter((e=>!o.find((t=>(0,d.relation_allnodes)(r,t).includes(e))))));var[s,l]=h(r,o,o);e=e.concat(l.filter((e=>a.includes(e)))),i.push(e),a=a.filter((t=>!e.includes(t))),o=o.filter((e=>!s.includes(e)))}while(l.length+s.length>0);return i.push(a),i}(a,s,n),u=l.flatMap(((t,n)=>t.map((t=>{let r=document.getElementById((0,d.id_in_svg)(e,(0,d.node_to_note_id)(t))),[i,o]=(0,d.note_coords)(r);return[t,[i,0-500*n]]})))),f={};u.forEach((([e,n])=>{let r,a=t<100?50:t/2,s=a<100?200:a>200?400:2*a,l=(0,d.node_to_note_id)(e),u=f[n],c=[n[0]+a+10,n[1]+a+25-s];if(u)r=u.getElementsByTagName("text")[0];else{u=(0,d.g)();let e=(0,d.circle)(n,a);u.appendChild(e),u.id="hier"+i+l,r=(0,d.text)("",c),r.style.fontFamiy="sans-serif",r.style.fontSize=s+"px",r.classList.add("nodetext"),u.appendChild(r),o.appendChild(u),f[n]=u}let h=(0,d.tspan)((0,d.note_to_text)(l),c,s);r.appendChild(h)})),s.forEach((e=>{let n=i+e.getAttribute("xml:id"),r=(0,d.relation_type)(e),a=document.getElementById(n),s=(0,d.relation_allnodes)((0,c.ro)(),e).map((e=>u.find((t=>t[0]==e))[1])),l=(0,d.roundedHull)(s,t);l.setAttribute("id","hier"+n),""!=i&&l.setAttribute("oldid",o.getAttribute("xml:id")),l.classList.add("relation"),l.setAttribute("type",r),Ee()&&te(l),l.onclick=function(e){Y(a,e.shiftKey)},l.onmouseover=function(e){a.classList.add("relationhover"),a.onmouseover()},l.onmouseout=function(e){a.classList.remove("relationhover"),a.onmouseout()},l.onwheel=e=>{var t=e.target;return(0,d.flip_to_bg)(t),l.onmouseout(),!1},o.appendChild(l)})),(0,d.add_to_svg_bg)(r,o),me(e,500*l.length)}function g(e,t,n){0!=e.children.length?(e.children.forEach((e=>g(e,t,n))),e.y=n+e.children.map((e=>e.y)).reduce(((e,t)=>e>t?e:t))):e.y=t}function m(e,t,n){0!=e.children.length&&(Math.abs(t-e.y)>n&&(e.y+=(t-n-e.y)/2),e.children.forEach((t=>m(t,e.y,n))))}function v(e){return 0==e.children.length?[e]:e.children.flatMap(v)}function y(e){e.children.forEach(y),0!=e.children.length&&null==e.x&&(e.x=(0,d.average)(e.children.map((e=>e.x))))}function b(e,t=0,n=-500){y(e),g(e,t,n),m(e,e.y,n)}function _(e,t=100){var n=(0,d.g)(),r=(0,d.text)(e.label,[e.x,e.y+(0==e.children.length?t:0)]);r.style.fontFamiy="sans-serif",r.style.fontSize=t+"px",r.style.textAnchor="middle",r.classList.add("nodetext");var i=e.children.map((t=>(0,d.line)([e.x,e.y],[t.x,t.y]))),o=e.children.flatMap((e=>_(e,t)));return i.forEach((e=>n.appendChild(e))),o.forEach((e=>n.appendChild(e))),n.appendChild(r),n}function x(e,t=25){var n=e.getBBox(),r=(0,d.rect)([n.x-t,n.y-t],n.width+t,n.height+t);e.parentNode.insertBefore(r,e)}function w(e){var t,n,r=mei.createElement("label");if(r.append(e.label),console.log(e.note_id),e.note_id){var i=mei.createElement("note");i.setAttribute("sameas","#"+e.note_id),r.appendChild(i)}return 0==e.children.length?t=mei.createElement("eLeaf"):(t=mei.createElement("eTree"),n=e.children.map(w)),t.appendChild(r),n&&n.forEach((e=>t.appendChild(e))),t}function E(e){var t=e.children[0],n={label:t.textContent};0!=t.children.length&&(n.note_id=t.querySelector("note").getAttribute("sameas").replace("#",""));var r=Array.from(e.children);return r.shift(),n.children=r.map(E),n}function S(e,t){t.note_id&&(t.x=(0,d.note_coords)((0,d.get_by_id)(document,(0,d.id_in_svg)(e,t.note_id)))[0]),t.children.forEach((t=>S(e,t)))}function T(e){var t=mei.querySelector("eTree");if(t){var n=function(e){return E(e)}(t),r=JSON.stringify(n);document.getElementById(e.id_prefix+"treeinput").value=r}else console.log("No tree to load")}function k(e){var t=document.getElementById(e.id_prefix+"treeinput");if(""!=t.value){var n=t.value,r=JSON.parse(n);if(r)return r;console.log("Failed to parse tree.")}else console.log("No tree to be parsed")}function A(e){var t=k(e);if(t){var n=document.getElementById(e.id_prefix+"treeinput"),r=selected.concat(extraselected);0==selected.length?r=Array.from(e.svg_elem.getElementsByClassName("note")):1==selected.length?selected[0].classList.contains("relation")&&(r=relation_get_notes(selected[0]).map((t=>(0,d.get_by_id)(document,(0,d.id_in_svg)(e,t.getAttribute("xml:id")))))):selected[0].classList.contains("metarelation")||selected.length;var o=r.map((e=>[(0,d.note_coords)(e)[0],e]));o.sort(((e,t)=>e[0]-t[0]));var a=v(t);if(a.length==o.length){for(i in a)a[i].x=o[i][0],a[i].note_id=o[i][1].id;var s=JSON.stringify(t);n.value=s,e.svg_elem.getRootNode().getElementById("tree"+e.id_prefix)&&N(e)}else console.log("Wrong length of list, expected "+a.length+" got "+o.length)}}function N(e,t=0,n=-1e3){var r=e.svg_elem,i=e.id_prefix,o=(ge(e),k(e));if((o||(console.log("No tree in input, attempting to load from XML"),T(e),o=k(e)))&&(function(e){return v(e)[0].hasOwnProperty("note_id")}(o)||(console.log("Tree not aligned, attempting to align to selection"),A(e),o=k(e)))){(function(e){return v(e)[0].hasOwnProperty("x")})(o)||S(e,o),b(o,t,n);var a=_(o);a.id="tree"+i,(0,d.add_to_svg_bg)(r,a),Array.from(a.getElementsByTagName("text")).forEach(x),adjust_top(e,-o.y)}}var M,D,C,I=n(506),L=n(504),j=n(235),O=n(898),B=!1,P=!1,z=!1,R="";const H=()=>D,U=()=>C;var V,q=null,F=!0;function Y(e,t){console.debug("Using globals: selected, extraselected for adding/removing selected items. JQuery for changing displayed text of selected items");var n=(0,d.get_class_from_classlist)(e),r=e.closest("div");if(selected.length>0||extraselected.length>0){var i=(0,d.get_class_from_classlist)(selected.concat(extraselected)[0]),o=selected.concat(extraselected)[0].closest("div");if(n!=i)return;if(r!=o)return}"note"==n?selected.find((t=>t===e))||extraselected.find((t=>t===e))?(e.classList.remove("selectednote"),e.classList.remove("extraselectednote"),selected=selected.filter((t=>t!==e)),extraselected=extraselected.filter((t=>t!==e))):t?(e.classList.add("extraselectednote"),extraselected.push(e),q=e):(e.classList.add("selectednote"),selected.push(e),q=e):"relation"!=n&&"metarelation"!=n||(0==selected.concat(extraselected).length&&J(!0),selected.find((t=>t===e))||extraselected.find((t=>t===e))?(e.classList.remove("extraselectedrelation"),e.classList.remove("selectedrelation"),selected=selected.filter((t=>t!==e)),extraselected=extraselected.filter((t=>t!==e))):t?(e.classList.add("extraselectedrelation"),extraselected.push(e),q=e):(e.classList.add("selectedrelation"),selected.push(e),q=e),0==selected.concat(extraselected).length&&(J(!1),q=null)),document.dispatchEvent(new CustomEvent("scoreselection",{detail:{selected,extraselected}}))}function W(e){var t=Array.from(e.svg_elem.getElementsByClassName("relation")).filter((e=>!e.classList.contains("relation--filtered")));if(t.length>0){(0,d.get_class_from_classlist)(t[0]);var n=t[0].closest("div");if(selected.length>0||extraselected.length>0){var r=(0,d.get_class_from_classlist)(selected.concat(extraselected)[0]),i=selected.concat(extraselected)[0].closest("div");"relation"!=r&&ue(),n!=i&&ue()}t.forEach((e=>{e.classList.contains("selectedrelation")||Y(e)}))}}function K(e){!function(e){var t=document.createElement("div");t.id=e.id_prefix+"sidebardiv",t.classList.add("sidebar"),e.view_elem.prepend(t);var n=document.createElement("div");n.id=e.id_prefix+"filterdiv",n.classList.add("filterdiv"),n.innerHTML=`&#9776;&nbsp;L${e.layer_number}&nbsp;V${e.view_number}<br/></br>`,t.prepend(n);var r=document.createElement("div");r.classList.add("zoom_buttons");var i=(0,d.button)("+");i.classList.add("zoominbutton"),i.id=e.id_prefix+"zoominbutton";var o=(0,d.button)("");o.classList.add("zoomoutbutton"),o.id=e.id_prefix+"zoomoutbutton",i.onclick=()=>{se(e)},o.onclick=()=>{le(e)},r.appendChild(i),r.appendChild(o),n.appendChild(r)}(e);var t=e,n=document.createElement("div");n.classList.add("view_buttons"),n.id=e.id_prefix+"view_buttons";var r=(0,d.button)("Create new layer");r.classList.add("newlayerbutton"),r.id=e.id_prefix+"newlayerbutton";var i=(0,d.checkbox)("Sliced");i.id=e.id_prefix+"slicedcb",i.checked=!1;var o=(0,d.checkbox)("Tied");o.id=e.id_prefix+"tiedcb",o.checked=!1;var a=(0,d.button)("Reduce");a.classList.add("reducebutton"),a.id=e.id_prefix+"reducebutton";var s=(0,d.button)("Unreduce");s.classList.add("unreducebutton"),s.id=e.id_prefix+"unreducebutton";var u=(0,d.button)("Create new view");u.classList.add("rerenderbutton"),u.id=e.id_prefix+"rerenderbutton";var h=(0,d.button)("Play reduction");h.classList.add("midireducebutton"),h.id=e.id_prefix+"midireducebutton";var g=(0,d.button)("Show/update hierarchy");g.classList.add("hierarchybutton"),g.id=e.id_prefix+"hierarchybutton";var m=(0,d.button)("Hide tree/hierarchy");m.classList.add("hidetopbutton"),m.id=e.id_prefix+"hidetopbutton";var v=(0,d.checkbox)("Roots low");v.id=e.id_prefix+"hierarchycb",v.checked=!0,s.onclick=()=>{!function(e){console.log("Using globals: selected/extraselected");var t=e.reductions;if(0!=t.length){selected.forEach(Y),extraselected.forEach((e=>{Y(e,!0)}));var[n,r,i,o]=t.pop(),[a,s,l]=r;l.flat().forEach((e=>{e&&e.classList.remove("hidden")})),i.forEach((e=>{Y(e)})),o.forEach((e=>{Y(e,!0)}))}else console.log("Nothing to unreduce")}(t)},a.onclick=()=>{f(t)},u.onclick=()=>{(0,c.k4)(t)},r.onclick=()=>{(0,c.Jt)(t,i.checked,o.checked)},h.onclick=()=>{l.Z.player.loadSound(function(e=null){e||(e=(0,c.kg)()[0]);var t=(0,c.DR)(),n=(0,c.xM)(!0,e),r=(new XMLSerializer).serializeToString(n);t.loadData(r);const i=t.renderToMIDI();var o=(0,c.Yu)();return t.loadData(o),i}(t),t.id_prefix),l.Z.player.play()},g.onclick=()=>{p(t,50,v.checked)},m.onclick=()=>{!function(e){var t=e.svg_elem;e.id_prefix,ge(e)&&(t.getElementsByClassName("definition-scale")[0].setAttribute("viewBox",e.old_viewbox),t.children[0].setAttribute("height",e.old_height))}(t)},n.appendChild(document.createTextNode("")),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(s),n.appendChild(document.createElement("br")),n.appendChild(a),n.appendChild(document.createElement("br")),n.appendChild(u),n.appendChild(document.createElement("br")),n.appendChild(r),n.appendChild(document.createElement("br")),n.appendChild(i);var y=document.createElement("label");y.htmlFor=e.id_prefix+"slicedcb",y.appendChild(document.createTextNode("Sliced")),n.append(y),n.appendChild(o);var b=document.createElement("label");b.htmlFor=e.id_prefix+"tiedcb",b.appendChild(document.createTextNode("Tied")),n.append(b),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(h),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(g),n.appendChild(document.createElement("br")),n.appendChild(v);var _=document.createElement("label");_.htmlFor=e.id_prefix+"hierarchycb",_.appendChild(document.createTextNode("Draw roots low")),n.append(_),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),n.appendChild(m),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br"));var x=document.createElement("textarea");x.id=e.id_prefix+"treeinput",x.width="100px";var E=(0,d.button)("Load tree");E.id=e.id_prefix+"treebutton",E.onclick=()=>{T(t)};var S=(0,d.button)("Save tree");S.id=e.id_prefix+"treebutton",S.onclick=()=>{!function(e){var t,n,r=k(e);r&&(t=w(r),(n=(0,c.ro)().parentNode).querySelector("eTree")&&n.removeChild(n.querySelector("eTree")),n.appendChild(t))}(t)};var M=(0,d.button)("Draw tree: ");M.id=e.id_prefix+"treebutton",M.onclick=()=>{N(t)};var D=(0,d.button)("Align tree to selection");D.id=e.id_prefix+"treebutton",D.onclick=()=>{A(t)},x.onfocus=ie,x.onblur=oe,n.appendChild(M),n.appendChild(document.createElement("br")),n.appendChild(x),n.appendChild(document.createElement("br")),n.appendChild(D),n.appendChild(document.createElement("br")),n.appendChild(E),n.appendChild(S),e.view_elem.children[0].appendChild(n)}function Q(e){"Control"==e.key&&(0,I.xy)(),"Shift"===e.key&&$("#layers").addClass("shift-pressed")}function X(e){"Control"==e.key&&(0,I.Kd)(),"Shift"===e.key&&$("#layers").removeClass("shift-pressed")}function G(e){(0,I.r4)()}function Z(e){if(console.debug("Using globals: text_input, meta_keys, type_keys"),!P)if("Enter"==e.key);else if(e.key==action_conf.move_relation_to_front){var t=document.elementFromPoint(D,C);"circle"==t.tagName&&(t=t.closest("g")),(0,d.flip_to_bg)(t),t.onmouseout&&t.onmouseout()}else e.key==action_conf.undo?(0,j.FB)():e.key==action_conf.redo?(0,j.VJ)():e.key==action_conf.reduce_relations?f(M):e.key==action_conf.show_hide_notation?ee():e.key==action_conf.toggle_type_shades?re():e.key==action_conf.select_same_notes?(select_samenote(),(0,c.i9)("repeat")):e.key==action_conf.naturalize_note?(0,O.naturalize_notes)():e.key==action_conf.toggle_add_note?(0,I.M_)():e.key==navigation_conf.zoom_out?le(M):e.key==navigation_conf.zoom_in?se(M):e.key==navigation_conf.jump_to_next_bookmark?_e(-1):e.key==navigation_conf.jump_to_previous_bookmark?_e(1):e.key==navigation_conf.jump_to_context_below?xe(1):e.key==navigation_conf.jump_to_context_above?xe(-1):e.key==action_conf.deselect_all?ue():e.key==action_conf.delete_all?(0,L.x)():e.key==action_conf.add_bookmark?be():e.key==custom_conf.relation||e.key==custom_conf.meta_relation?(e.preventDefault(),$("#relations_panel").hasClass("collapsed")&&ae()):u.type_keys[e.key]?(0,c.i9)(u.type_keys[e.key]):u.meta_keys[e.key]?(0,c.qG)(u.meta_keys[e.key]):u.combo_keys[e.key]?(0,c.lk)(u.combo_keys[e.key]):e.key==navigation_conf.toggle_palette?ae():console.log(e)}function J(e){console.debug("Using globals: document for changing button texts/visibility"),e?document.getElementById("meta_buttons").classList.remove("none"):document.getElementById("meta_buttons").classList.add("none")}function ee(){var e;console.debug("Using globals: non_notes_hidden"),e=B=!B,console.debug("Using globals: document for element selection"),Array.from(document.getElementsByClassName("beam")).forEach((t=>{Array.from(t.children).forEach((t=>{"polygon"==t.tagName&&(e?t.classList.add("hidden"):t.classList.remove("hidden"))}))})),u.hide_classes.forEach((t=>{Array.from(document.getElementsByClassName(t)).forEach((t=>{e?t.classList.add("hidden"):t.classList.remove("hidden")}))})),B||we()}function te(e){console.debug("Using globals: shades, type_shades, meta_shades, type_synonym"),!z&&e.getAttribute("old_fill")?(e.setAttribute("fill",e.getAttribute("old_fill")),e.removeAttribute("old_fill")):z&&u.type_shades[e.getAttribute("type")]?(e.setAttribute("old_fill",e.getAttribute("fill")),e.setAttribute("fill",u.type_shades[e.getAttribute("type")])):z&&u.meta_shades[e.getAttribute("type")]?(e.setAttribute("old_fill",e.getAttribute("fill")),e.setAttribute("fill",u.meta_shades[e.getAttribute("type")])):z&&u.type_synonym[e.getAttribute("type")]&&(e.setAttribute("old_fill",e.getAttribute("fill")),e.setAttribute("fill",u.type_shades[u.type_synonym[e.getAttribute("type")]]))}function ne(e){console.debug("Using globals: shades, button_shades"),e.style.color=z?u.button_shades[e.getAttribute("id")]:""}function re(){console.debug("Using globals: shades, document for element selection"),z=!z,Array.from(document.getElementsByClassName("relation")).forEach(te),Array.from(document.getElementsByClassName("metarelation")).forEach(te),Array.from(document.getElementsByClassName("relationbutton")).forEach(ne),Array.from(document.getElementsByClassName("metarelationbutton")).forEach(ne)}function ie(){P=!0}function oe(){P=!1}function ae(){$("#relations_panel").hasClass("collapsed")?($("#relations_panel").removeClass("collapsed"),$("#relations_panel input").removeClass("none")):($("#relations_panel").addClass("collapsed"),$("#relations_panel input").addClass("none"))}function se(e){void 0!==e&&(e.zoom=1.1*e.zoom,e.svg_elem.style.transform="scale("+e.zoom+")")}function le(e){void 0!==e&&(e.zoom=.9090909090909*e.zoom,e.svg_elem.style.transform="scale("+e.zoom+")")}function ue(){selected.forEach((e=>Y(e))),extraselected.forEach((e=>Y(e,!0)))}function ce(){var e=(0,c.ro)(),t=(0,c.kg)();ue(),$(".relation").remove(),$(".metarelation").remove();var n=Array.from(e.getElementsByTagName("node")),r=n.filter((e=>"relation"==e.getAttribute("type")));n.filter((e=>"metarelation"==e.getAttribute("type"))),t.forEach((t=>{r.forEach((n=>{(0,d.unmark_secondaries)(t,e,n)}))})),t.hullPadding=$("#hull_controller").val(),t.forEach((e=>(0,c.lC)(e))),t.forEach((e=>{e.svg_elem.getRootNode().getElementById("hier"+e.id_prefix)&&p(e)}))}function de(e){var t=0,n=0,r=0,i=0;function o(o){(o=o||window.event).preventDefault(),t=r-o.clientX,n=i-o.clientY,r=o.clientX,i=o.clientY,r>=0&&i>=0&&(e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px")}function a(){document.onmouseup=null,document.onmousemove=null,"undefined"!=typeof drag_selector&&drag_selector.start()}e.onmousedown=function(e){"INPUT"!==e.target.tagName&&((e=e||window.event).preventDefault(),r=e.clientX,i=e.clientY,document.onmouseup=a,document.onmousemove=o,"undefined"!=typeof drag_selector&&drag_selector.stop())}}function he(e){window.drag_selector=new(s())({selectables:document.getElementsByClassName("relation"),area:$("#layers")[0],draggability:!1,overflowTolerance:{x:1,y:1},autoScrollSpeed:1e-4}),drag_selector.subscribe("dragstart",(({items:e,event:t,isDragging:n})=>{$(".ds-selector-area").show()})),drag_selector.subscribe("dragmove",(({items:e,event:t,isDragging:n})=>{""!=R||document.getElementById("minimap").classList.contains("dragging")||(($(".ds-selector").height()>10||$(".ds-selector").width()>10&&"hull_controller"!=document.activeElement.id)&&($("#load_save, #metadata_input, #relations_panel, .sidebar, #minimap").fadeOut(300),document.getElementById("layers").style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjJwdCIgaGVpZ2h0PSIyMnB0IiB2aWV3Qm94PSIwIDAgMjIgMjIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjQ0OTIxOSAxNC44MDA3ODEgQyA0LjI2OTUzMSAxNC42MjEwOTQgMy45ODA0NjkgMTQuNjIxMDk0IDMuODAwNzgxIDE0LjgwMDc4MSBDIDMuNjIxMDk0IDE0Ljk4MDQ2OSAzLjYyMTA5NCAxNS4yNjk1MzEgMy44MDA3ODEgMTUuNDQ5MjE5IEMgNS43Njk1MzEgMTcuNDE3OTY5IDUuNzY5NTMxIDE5LjI1IDMuODAwNzgxIDIxLjIxODc1IEMgMy42MjEwOTQgMjEuMzk4NDM4IDMuNjIxMDk0IDIxLjY4NzUgMy44MDA3ODEgMjEuODY3MTg4IEMgMy44OTA2MjUgMjEuOTU3MDMxIDQuMDA3ODEyIDIyIDQuMTI1IDIyIEMgNC4yNDIxODggMjIgNC4zNTkzNzUgMjEuOTU3MDMxIDQuNDQ5MjE5IDIxLjg2NzE4OCBDIDYuNzU3ODEyIDE5LjU1NDY4OCA2Ljc1NzgxMiAxNy4xMTMyODEgNC40NDkyMTkgMTQuODAwNzgxIFogTSA0LjQ0OTIxOSAxNC44MDA3ODEgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjEyNSAxMS45MTc5NjkgQyAzLjExMzI4MSAxMS45MTc5NjkgMi4yOTI5NjkgMTIuNzM4MjgxIDIuMjkyOTY5IDEzLjc1IEMgMi4yOTI5NjkgMTQuNzYxNzE5IDMuMTEzMjgxIDE1LjU4MjAzMSA0LjEyNSAxNS41ODIwMzEgQyA1LjEzNjcxOSAxNS41ODIwMzEgNS45NTcwMzEgMTQuNzYxNzE5IDUuOTU3MDMxIDEzLjc1IEMgNS45NTcwMzEgMTIuNzM4MjgxIDUuMTM2NzE5IDExLjkxNzk2OSA0LjEyNSAxMS45MTc5NjkgWiBNIDQuMTI1IDE0LjY2Nzk2OSBDIDMuNjIxMDk0IDE0LjY2Nzk2OSAzLjIwNzAzMSAxNC4yNTM5MDYgMy4yMDcwMzEgMTMuNzUgQyAzLjIwNzAzMSAxMy4yNDYwOTQgMy42MjEwOTQgMTIuODMyMDMxIDQuMTI1IDEyLjgzMjAzMSBDIDQuNjI4OTA2IDEyLjgzMjAzMSA1LjA0Mjk2OSAxMy4yNDYwOTQgNS4wNDI5NjkgMTMuNzUgQyA1LjA0Mjk2OSAxNC4yNTM5MDYgNC42Mjg5MDYgMTQuNjY3OTY5IDQuMTI1IDE0LjY2Nzk2OSBaIE0gNC4xMjUgMTQuNjY3OTY5ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDAlLDAlLDAlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMjEuNzY1NjI1IDEzLjgwODU5NCBMIDEzLjUxNTYyNSA5LjIyMjY1NiBDIDEzLjM0Mzc1IDkuMTI4OTA2IDEzLjEzNjcxOSA5LjE1MjM0NCAxMi45ODgyODEgOS4yODEyNSBDIDEyLjg0Mzc1IDkuNDEwMTU2IDEyLjc5Mjk2OSA5LjYxMzI4MSAxMi44NjcxODggOS43OTY4NzUgTCAxNi41MzEyNSAxOC45NjA5MzggQyAxNi42MDE1NjIgMTkuMTMyODEyIDE2Ljc2OTUzMSAxOS4yNSAxNi45NTMxMjUgMTkuMjUgQyAxNi45NTMxMjUgMTkuMjUgMTYuOTU3MDMxIDE5LjI1IDE2Ljk1NzAzMSAxOS4yNSBDIDE3LjE0MDYyNSAxOS4yNSAxNy4zMDg1OTQgMTkuMTQwNjI1IDE3LjM3ODkwNiAxOC45NzI2NTYgTCAxOC42ODM1OTQgMTUuOTMzNTk0IEwgMjEuNzIyNjU2IDE0LjYyODkwNiBDIDIxLjg4MjgxMiAxNC41NjI1IDIxLjk4ODI4MSAxNC40MDYyNSAyMiAxNC4yMzA0NjkgQyAyMi4wMDc4MTIgMTQuMDU4NTk0IDIxLjkxNzk2OSAxMy44OTQ1MzEgMjEuNzY1NjI1IDEzLjgwODU5NCBaIE0gMjEuNzY1NjI1IDEzLjgwODU5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYigwJSwwJSwwJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDUuNjY0MDYyIDEyLjc2NTYyNSBDIDUuNTc4MTI1IDEyLjYyODkwNiA1LjQ3MjY1NiAxMi41MDc4MTIgNS4zNTU0NjkgMTIuNDAyMzQ0IEMgNS4zMzk4NDQgMTIuMzg2NzE5IDUuMzI0MjE5IDEyLjM3NSA1LjMwODU5NCAxMi4zNjMyODEgQyA1LjIxMDkzOCAxMi4yNzczNDQgNS4xMDU0NjkgMTIuMjA3MDMxIDQuOTkyMTg4IDEyLjE0NDUzMSBDIDQuOTYwOTM4IDEyLjEyODkwNiA0LjkyOTY4OCAxMi4xMDkzNzUgNC44OTg0MzggMTIuMDkzNzUgQyA0Ljc3MzQzOCAxMi4wMzUxNTYgNC42NDQ1MzEgMTEuOTg4MjgxIDQuNTA3ODEyIDExLjk1NzAzMSBDIDQuNDY4NzUgMTEuOTQ5MjE5IDQuNDI1NzgxIDExLjk0OTIxOSA0LjM4MjgxMiAxMS45NDE0MDYgQyA0LjI2OTUzMSAxMS45MjU3ODEgNC4xNTIzNDQgMTEuOTE3OTY5IDQuMDM5MDYyIDExLjkyNTc4MSBDIDMuNjMyODEyIDExLjk0NTMxMiAzLjI2NTYyNSAxMi4wOTc2NTYgMi45Njg3NSAxMi4zMzU5MzggQyAzLjE5MTQwNiAxMi40OTYwOTQgMy40MTQwNjIgMTIuNjQ4NDM4IDMuNjU2MjUgMTIuNzkyOTY5IEMgMy43NSAxMi44NDc2NTYgMy44NTkzNzUgMTIuODY3MTg4IDMuOTY4NzUgMTIuODUxNTYyIEMgNC4zNDc2NTYgMTIuNzg1MTU2IDQuNzUzOTA2IDEyLjk3NjU2MiA0LjkzNzUgMTMuMzM1OTM4IEMgNC45ODgyODEgMTMuNDMzNTk0IDUuMDcwMzEyIDEzLjUxMTcxOSA1LjE2Nzk2OSAxMy41NTA3ODEgQyA1LjQyMTg3NSAxMy42NTYyNSA1LjY4NzUgMTMuNzM4MjgxIDUuOTQ5MjE5IDEzLjgyODEyNSBDIDUuOTQ5MjE5IDEzLjgwMDc4MSA1Ljk1NzAzMSAxMy43NzczNDQgNS45NTcwMzEgMTMuNzUgQyA1Ljk1NzAzMSAxMy4zODY3MTkgNS44NDc2NTYgMTMuMDUwNzgxIDUuNjY0MDYyIDEyLjc2NTYyNSBaIE0gNS42NjQwNjIgMTIuNzY1NjI1ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDAlLDAlLDAlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMTMuMzgyODEyIDEzLjU1ODU5NCBDIDExLjE5MTQwNiAxMy44OTg0MzggOC44NTkzNzUgMTMuNzUgNi44MDQ2ODggMTMuMTUyMzQ0IEMgNi44NDc2NTYgMTMuMzQzNzUgNi44NzUgMTMuNTQyOTY5IDYuODc1IDEzLjc1IEMgNi44NzUgMTMuODcxMDk0IDYuODU1NDY5IDEzLjk4ODI4MSA2LjgzOTg0NCAxNC4xMDkzNzUgQyA4LjE1NjI1IDE0LjQ2ODc1IDkuNTY2NDA2IDE0LjY2Nzk2OSAxMSAxNC42Njc5NjkgQyAxMS45MjU3ODEgMTQuNjY3OTY5IDEyLjgzOTg0NCAxNC41ODIwMzEgMTMuNzM0Mzc1IDE0LjQyOTY4OCBaIE0gMTMuMzgyODEyIDEzLjU1ODU5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYigwJSwwJSwwJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDExIDAgQyA0LjkzMzU5NCAwIDAgMy4yODkwNjIgMCA3LjMzMjAzMSBDIDAgOC45NDE0MDYgMC44MDQ2ODggMTAuNDkyMTg4IDIuMjM4MjgxIDExLjc1NzgxMiBDIDIuNDY4NzUgMTEuNTM5MDYyIDIuNzM4MjgxIDExLjM1NTQ2OSAzLjAzNTE1NiAxMS4yMjY1NjIgQyAxLjY3OTY4OCAxMC4xMDkzNzUgMC45MTc5NjkgOC43MzgyODEgMC45MTc5NjkgNy4zMzIwMzEgQyAwLjkxNzk2OSAzLjc5Njg3NSA1LjQ0MTQwNiAwLjkxNzk2OSAxMSAwLjkxNzk2OSBDIDE2LjU1ODU5NCAwLjkxNzk2OSAyMS4wODIwMzEgMy43OTY4NzUgMjEuMDgyMDMxIDcuMzMyMDMxIEMgMjEuMDgyMDMxIDguNzUzOTA2IDIwLjM0Mzc1IDEwLjEwMTU2MiAxOC45ODgyODEgMTEuMjE4NzUgTCAxOS44Mzk4NDQgMTEuNjg3NSBDIDIxLjIyNjU2MiAxMC40Mzc1IDIyIDguOTEwMTU2IDIyIDcuMzMyMDMxIEMgMjIgMy4yODkwNjIgMTcuMDY2NDA2IDAgMTEgMCBaIE0gMTEgMCAiLz4KPC9nPgo8L3N2Zz4K), auto"),document.elementsFromPoint(D,C).map((e=>{switch(e.tagName){case"path":return e;case"use":return e.parentElement.parentElement;case"circle":return e.parentElement;default:return!1}})).filter((e=>{if(void 0===e||void 0===e.classList)return!1;var n=t.shiftKey;return e.classList.contains("relation")&&!e.classList.contains("relation--filtered")&&!e.classList.contains("selectedrelation")&&!e.classList.contains("extraselectedrelation")&&!n||e.classList.contains("note")&&!e.classList.contains("selectednote")&&!e.classList.contains("extraselectednote")||e.classList.contains("metarelation")&&!e.classList.contains("selectedrelation")&&!e.classList.contains("extraselectedrelation")&&!n})).forEach((e=>Y(e))))})),drag_selector.subscribe("callback",(({items:e,event:t,isDragging:n})=>{document.getElementById("layers").style.cursor="default",$(".ds-selector-area").hide(),$("#load_save, #metadata_input, #relations_panel, .sidebar, #minimap").fadeIn(300)}))}function fe(){if(null!=D){var e=[document.elementFromPoint(D,C)].map((e=>{if(e)switch(e.tagName){case"path":return e;case"use":return e.parentElement.parentElement;case"circle":return e.parentElement;default:return!1}})).filter((e=>void 0!==e&&void 0!==e.classList&&(e.classList.contains("relation")&&!e.classList.contains("relation--filtered")||e.classList.contains("metarelation"))))[0];(e=e?e.getAttribute("type"):"")&&V.setContent(e)}}function pe(){}function ge(e){var t=e.svg_elem,n=e.id_prefix,r=t.getRootNode().getElementById("hier"+n);return(r||!!(r=t.getRootNode().getElementById("tree"+n)))&&(r.parentNode.removeChild(r),!0)}function me(e,t){var n,r,i,o,a=e.svg_elem,s=a.children[0].getAttribute("height"),l=a.getElementsByClassName("definition-scale")[0].getAttribute("viewBox");e.old_viewbox?([n,r,i,o]=e.old_viewbox.split(" "),s=e.old_height):([n,r,i,o]=l.split(" "),e.old_viewbox=l,e.old_height=s),a.getElementsByClassName("definition-scale")[0].setAttribute("viewBox",[n,Number(r)-t,i,Number(o)+t].join(" "));var u=Number(s.split("p")[0]);a.children[0].setAttribute("height",u*((o-(r-t))/(o-r))+"px")}function ve(){document.getElementById("minimap").width=100,o()(document.querySelector("#minimap"),{viewport:null,styles:{".svg_container":"rgba(0,0,0,0.30)",".layer":"rgba(0,0,0,0.00)"},back:"rgba(0,0,0,0.30)",view:"rgba(0,0,0,0.20)",drag:"rgba(0,0,0,0.30)",interval:null})}window.onmousedown=e=>{var t=document.elementFromPoint(D,C),n=(0,c.kg)().find((e=>e.view_elem.contains(t)));!navigation_conf.switch_context_on_hover&&n&&Ne(n),(0,d.indicate_current_context)()},window.onmousemove=e=>{D=e.clientX,C=e.clientY;var t=document.elementFromPoint(D,C),n=(0,c.kg)().find((e=>e.view_elem.contains(t)));navigation_conf.switch_context_on_hover&&n&&Ne(n),(0,d.indicate_current_context)(),""!=R&&(0,I.TU)()},document.getElementById("equalizebutton").addEventListener("click",ee),document.getElementById("shadesbutton").addEventListener("click",re),document.getElementById("relations_panel_toggle").addEventListener("click",ae);var ye=[];function be(){if(!q)return!1;if(!q.classList.contains("note"))return!1;var e=q,t=document.createElementNS("http://www.w3.org/2000/svg","rect"),n=M.id_prefix?M.id_prefix:"0";t.dataset.draw_context=n,t.classList.add("bookmark"),t.setAttribute("fill","red"),t.setAttribute("width","500px"),t.setAttribute("height","1500px"),t.setAttribute("transform","translate(-120 -750)"),t.setAttribute("x",e.children[0].children[0].getAttribute("x")),t.setAttribute("y",e.children[0].children[0].getAttribute("y")),$(M.svg_elem).find(".page-margin")[0].prepend(t),ye.push(t),ye.sort((function(e,t){return e.getAttribute("x")-t.getAttribute("x")}))}function _e(e=1){var t=Ae();if(t){var n=t.id_prefix?t.id_prefix:"0",r=ye.filter((e=>e.dataset.draw_context==n)),i=r.map((e=>e.getBoundingClientRect().x)),o=i.findIndex((e=>e>=window.innerWidth)),a=i.filter((e=>e<=0)).length-1;if(1==e&&-1!=o)var s=r[o];else{if(-1!=e||-1==a)return!1;s=r[a]}s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}}function xe(e=1){var t,n=(0,c.kg)().sort(((e,t)=>e.view_elem.getBoundingClientRect().y-t.view_elem.getBoundingClientRect().y)),r=n.map((e=>e.view_elem.getBoundingClientRect().y)),i=n.map((e=>e.view_elem.getBoundingClientRect().bottom));if(1==e)t=i.findIndex((e=>e>window.innerHeight));else{if(-1!=e)return!1;t=r.filter((e=>e<0)).length-1}-1!=t&&n[t].view_elem.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}function we(){Array.from(document.querySelectorAll("g.note")).forEach((e=>e.classList.remove("hidden")))}document.getElementById("addbookmarkbutton").addEventListener("click",be),document.getElementById("previousbookmarkbutton").addEventListener("click",(()=>_e(-1))),document.getElementById("nextbookmarkbutton").addEventListener("click",(()=>_e(1))),document.getElementById("previouscontextbutton").addEventListener("click",(()=>xe(-1))),document.getElementById("nextcontextbutton").addEventListener("click",(()=>xe(1))),document.getElementById("orphannotesbutton").addEventListener("click",(function(){var e,t,n;(F=!F)?we():(e=(0,c.ro)(),t=Array.from(document.getElementsByClassName("note")).map((e=>e.id)),n=Array.from(e.getElementsByTagName("arc")).map((e=>e.getAttribute("to"))),t.forEach((e=>{var t=e.replace(/(^\d+-?)/,"");n.includes(`#gn-${t}`)||document.getElementById(e).classList.add("hidden")})),B||ee())}));const Ee=()=>z,Se=()=>V,Te=()=>R,ke=e=>R=e,Ae=()=>M,Ne=e=>M=e},235:(e,t,n)=>{"use strict";n.d(t,{FB:()=>l,I$:()=>u,VJ:()=>c});var r=n(974),i=n(506),o=n(504),a=n(714),s=n(624);function l(){console.debug("Using globals: undo_actions, selected, extraselected, mei, rerendered_after_action");var e=(0,r.tu)();if(0==e.length)return void console.log("Nothing to undo");if(e.length==(0,r.jA)())return console.log("Cannot undo past a rerender"),void alert("Cannot undo past a rerender.");selected.forEach(a.dB),extraselected.forEach((e=>{(0,a.dB)(e,!0)}));var t=(0,r.kg)(),n=(0,r.LO)();const[i,o,l,u]=e.pop();if("edges"==i||"relation"==i||"metarelation"==i){var c=o;let e,d,h=c.flat().find((e=>"node"==e.tagName&&e.getAttribute("type")==i));if(!h)return void console.log("Could not find graph element of (meta)relation to undo: ",o);if(e=h.getAttribute("xml:id"),h.children.length>0&&(d=h.children[0].getAttribute("type")),"relation"==i)for(const e of t)(0,s.unmark_secondaries)(e,(0,r.ro)(),h);c.flat().forEach((e=>{(0,s.node_referred_to)(e.getAttribute("xml:id"))||e.parentNode.removeChild(e)})),Array.from(document.querySelectorAll('[oldid="'+e+'"]')).forEach((e=>e.parentNode.removeChild(e))),l.forEach((e=>{(0,a.dB)(document.getElementById(e.id))})),u.forEach((e=>{(0,a.dB)(document.getElementById(e.id),!0)})),n.push([i,[d,e],l,u])}else if("delete relation"==i)o.forEach((e=>{e[1].insertBefore(e[0],e[2]);let n=t.find((t=>t.svg_elem.contains(e[0]))),i="relation"==(0,s.get_class_from_classlist)(e[0]);if(n&&i){let t=(0,s.get_id)(e[0]),i=(0,s.get_by_id)(mei,t);(0,s.mark_secondaries)(n,(0,r.ro)(),i)}})),l.forEach((e=>{(0,a.dB)(e)})),u.forEach((e=>{(0,a.dB)(e,!0)})),n.push([i,[],l,u]);else if("change relation type"==i){var h=o;let e=o[0][1];l.concat(u).forEach((e=>{var[t,n]=h.pop(),r=(0,s.id_or_oldid)(e),i=[(0,s.get_by_id)(document,r)].concat((0,s.get_by_oldid)(document,r));i.forEach((e=>e.setAttribute("type",t))),(0,s.get_by_id)(mei,r).getElementsByTagName("label")[0].setAttribute("type",t),i.forEach(a.up)})),l.forEach((e=>{(0,a.dB)(e)})),u.forEach((e=>{(0,a.dB)(e,!0)})),n.push([i,e,l,u])}else if("add note"==i){var[f,p]=o;p.forEach((e=>e.parentNode.removeChild(e)));let e=f[0].getAttribute("pname"),t=f[0].getAttribute("oct"),r=f[0].getAttribute("xml:id"),a=l[0];if(f[0].parentNode.removeChild(f[0]),f.length>1){var g=f[1];g.parentNode.insertBefore(g.children[0],g),g.parentNode.removeChild(g)}n.push([i,[e,t,a,r],l,u])}(0,a.e6)(),d()}function u(){(0,r.Ln)([]),d()}function c(){var e=(0,r.LO)();if(0==e.length)return void console.log("Nothing to redo");selected.forEach(a.dB),extraselected.forEach((e=>{(0,a.dB)(e,!0)}));const[t,n,s,l]=e.pop();let u,c;switch(s.forEach((e=>(0,a.dB)(document.getElementById(e.id)))),l.forEach((e=>{(0,a.dB)(document.getElementById(e.id),!0)})),t){case"relation":[u,c]=n,(0,r.i9)(u,c,!0);break;case"metarelation":[u,c]=n,(0,r.qG)(u,c,!0);break;case"change relation type":u=n,(0,r.i9)(u,"",!0);break;case"delete relation":(0,o.x)(!0);break;case"add note":let[e,t,l,d]=n;(0,i.f5)(e,t,l,d,!0),(0,a.dB)(s[0])}d()}function d(){document.dispatchEvent(new CustomEvent("undoredo",{detail:{redoAbleCount:(0,r.LO)().length,undoAbleCount:(0,r.tu)().length}}))}},624:(e,t,n)=>{"use strict";n.r(t),n.d(t,{roundedHull:()=>h,line:()=>f,circle:()=>p,rect:()=>g,text:()=>m,tspan:()=>v,flip_to_bg:()=>y,add_to_svg_bg:()=>b,g:()=>_,random_id:()=>x,note_coords:()=>w,get_by_oldid:()=>E,get_by_id:()=>S,id_or_oldid:()=>T,get_id:()=>k,id_in_svg:()=>A,node_referred_to:()=>N,node_to_note_id:()=>M,mod:()=>D,average2:()=>C,relation_get_notes:()=>I,relation_get_notes_separated:()=>L,relation_allnodes:()=>j,relation_primaries:()=>O,relation_secondaries:()=>B,relation_type:()=>P,add_mei_node_for:()=>z,hide_note:()=>R,hide_note_hier:()=>H,hide_he:()=>U,hide_he_hier:()=>V,mark_secondaries:()=>q,unmark_secondaries:()=>F,get_class_from_classlist:()=>Y,get_metarelation_target:()=>W,average:()=>K,note_to_text:()=>Q,to_text:()=>X,fix_synonyms:()=>G,note_to_rest:()=>J,note_to_chord:()=>ee,prefix_ids:()=>te,clone_mei:()=>ne,get_id_pairs:()=>re,new_layer_element:()=>ie,new_view_elements:()=>oe,checkbox:()=>ae,button:()=>se,indicate_current_context:()=>le,sanitize_xml:()=>ue,check_for_duplicate_relations:()=>ce,draw_context_of:()=>de});var r=n(617),i=n(974),o=n(36),a=n(714),s=function(e,t){return[e*t[0],e*t[1]]},l=function(e,t){return[e[0]+t[0],e[1]+t[1]]},u=function(e,t){var n=[e[1]-t[1],t[0]-e[0]],r=Math.sqrt(n[0]*n[0]+n[1]*n[1]);return[n[0]/r,n[1]/r]},c=function(e,t){var n=[e[0][0],e[0][1]-t];return"M "+n+" A "+[t,t,"0,0,0",[e[0][0],parseInt(e[0][1])+parseInt(t)]].join(",")+" A "+[t,t,"0,0,0",n].join(",")},d=function(e,t){var n=s(t,u(e[0],e[1])),r=s(-1,n),i=l(e[0],n),o=l(e[1],n),a=l(e[1],r),c=l(e[0],r);return"M "+i+" L "+o+" A "+[t,t,"0,0,0",a].join(",")+" L "+c+" A "+[t,t,"0,0,0",i].join(",")};function h(e){var t=(0,i.kg)().hullPadding||200,n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("fill",function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(4+8*Math.random())];return e}()),1==e.length?n.setAttribute("d",c(e,t)):2==e.length?n.setAttribute("d",d(e,t)):n.setAttribute("d",function(e,t){if(!e||e.length<1)return"";if(1===e.length)return c(e,t);if(2===e.length)return d(e,t);for(var n=new Array(e.length),r=0;r<n.length;++r){var i=0===r?e[e.length-1]:e[r-1],o=e[r],a=s(t,u(i,o));n[r]=[l(i,a),l(o,a)]}var h="A "+[t,t,"0,0,0,"].join(",");return(n=n.map((function(e,t){var r="";return 0===t&&(r="M "+n[n.length-1][1]+" "),r+(h+e[0]+" L ")+e[1]}))).join(" ")}((0,r.WFE)(e),t)),n}function f(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1",e[0]),n.setAttribute("y1",e[1]),n.setAttribute("x2",t[0]),n.setAttribute("y2",t[1]),n.style.stroke="#000",n.style.strokeWidth="15px",n}function p(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","circle");return n.setAttribute("cx",e[0]),n.setAttribute("cy",e[1]),n.setAttribute("r",t),n.style.stroke="#000",n.style.strokeWidth="15px",n}function g(e,t,n){var r=document.createElementNS("http://www.w3.org/2000/svg","rect");return r.setAttribute("x",e[0]),r.setAttribute("y",e[1]),r.setAttribute("width",t),r.setAttribute("height",n),r.style.stroke="#000",r.style.fill="white",r.style.strokeWidth="15px",r}function m(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","text");return t&&(n.setAttribute("x",t[0]),n.setAttribute("y",t[1])),n.append(e),n}function v(e,t,n,r=0){var i=document.createElementNS("http://www.w3.org/2000/svg","tspan");return i.setAttribute("x",t[0]),i.setAttribute("dx",r),i.setAttribute("dy",n),i.append(e),i}function y(e){var t=(0,a.gB)(),n=e.parentElement;n.removeChild(e),n.insertBefore(e,n.children[0]),t.close(),t.open()}function b(e,t){var n=e.getElementsByClassName("system")[0];n.parentNode.insertBefore(t,n)}function _(){return document.createElementNS("http://www.w3.org/2000/svg","g")}function x(e=5){return Math.floor(Math.random()*(1<<4*e)).toString(16)}function w(e){return[e.getElementsByTagName("use")[0].x.animVal.value+100,e.getElementsByTagName("use")[0].y.animVal.value]}function E(e,t){"#"==t[0]&&(t=t.slice(1));var n=e.querySelectorAll("[*|oldid='"+t+"']");return n?Array.from(n):Array.from(e.all).find((e=>e.getAttribute("oldid")==t))}function S(e,t){return t?("#"==t[0]&&(t=t.slice(1)),e.querySelector("[*|id='"+t+"']")||Array.from(e.getElementsByTagName("*")).find((e=>e.getAttribute("id")==t||e.getAttribute("xml:id")==t))):null}function T(e){return e.hasAttribute("oldid")?e.getAttribute("oldid"):e.id}function k(e){if(document.contains(e))return e.hasAttribute("oldid")?k(document.getElementById(e.getAttribute("oldid"))):e.id;if(e.hasAttribute("xml:id")){if(e.hasAttribute("sameas"))return k(S(mei,e.getAttribute("sameas")));if(e.hasAttribute("corresp"))return k(S(mei,e.getAttribute("corresp")));if(e.hasAttribute("copyof"))return k(S(mei,e.getAttribute("copyof")));if(e.hasAttribute("xml:id"))return e.getAttribute("xml:id")}}function A(e,t){if(t){"#"==t[0]&&(t=t.slice(1));var n=function(e,t){"#"==t[0]&&(t=t.slice(1));var n=e.id_mapping.find((e=>e[1]==t));return n?n[0]:void 0}(e.layer,t),r=document.getElementById(n);return e.svg_elem.contains(r)?n:n?e.id_prefix+n:void 0}}function N(e){return console.debug("Using global: mei to find element"),Array.from(mei.getElementsByTagName("arc")).filter((t=>t.getAttribute("from")=="#"+e||t.getAttribute("to")=="#"+e)).length>0}function M(e){return e.getElementsByTagName("label")[0].getElementsByTagName("note")[0].getAttribute("sameas").replace("#","")}function D(e,t){return(e%t+t)%t}function C(e,t){return(e+t)/2}function I(e){return j((0,i.ro)(),e=S(mei,k(e))).map(M).map((e=>S(mei,e)))}function L(e){var t=(0,i.ro)();return[O(t,e=S(mei,k(e))).map(M).map((e=>S(mei,e))),B(t,e).map(M).map((e=>S(mei,e)))]}function j(e,t){var n=Array.from(e.getElementsByTagName("arc")),r=[];return n.forEach((n=>{n.getAttribute("from")=="#"+t.getAttribute("xml:id")&&r.push(S(e.getRootNode(),n.getAttribute("to")))})),r}function O(e,t){var n=Array.from(e.getElementsByTagName("arc")),r=[];return n.forEach((n=>{n.getAttribute("from")=="#"+t.getAttribute("xml:id")&&"primary"==n.getAttribute("type")&&r.push(S(e.getRootNode(),n.getAttribute("to")))})),r}function B(e,t){var n=Array.from(e.getElementsByTagName("arc")),r=[];return n.forEach((n=>{n.getAttribute("from")=="#"+t.getAttribute("xml:id")&&"secondary"==n.getAttribute("type")&&r.push(S(e.getRootNode(),n.getAttribute("to")))})),r}function P(e){return 0==e.children.length?"":e.children[0].getAttribute("type")}function z(e,t){var n=k(t),r=k(S(mei,n)),i=S(e.getRootNode(),"gn-"+r);if(null!=i)return i;i=e.getRootNode().createElement("node");var o=e.getRootNode().createElement("label");return(t=e.getRootNode().createElement("note")).setAttribute("sameas","#"+r),i.appendChild(o),o.appendChild(t),i.setAttribute("xml:id","gn-"+r),e.appendChild(i),i}function R(e,t){var n=S(e.svg_elem.getRootNode(),A(e,M(t)));return n&&e.svg_elem.contains(n)&&n.classList.add("hidden"),n}function H(e,t){var n=S(e.svg_elem.getRootNode(),"hier"+A(e,M(t)));return n&&e.svg_elem.contains(n)&&n.classList.add("hidden"),n}function U(e,t){var n=S(e.svg_elem.getRootNode(),e.id_prefix+t.getAttribute("xml:id"));return n&&e.svg_elem.contains(n)&&n.classList.add("hidden"),n}function V(e,t){var n=S(e.svg_elem.getRootNode(),"hier"+e.id_prefix+t.getAttribute("xml:id"));return n&&e.svg_elem.contains(n)&&n.classList.add("hidden"),n}function q(e,t,n){e.svg_elem,"node"!=n.tagName&&(n=S(t.getRootNode(),n.id)),B(t,n).forEach((t=>{!function(e){if(e)if(e.classList.contains("secondarynote")){var t=getComputedStyle(e).getPropertyValue("--how-secondary");e.style.setProperty("--how-secondary",2*t)}else e.classList.add("secondarynote"),e.style.setProperty("--how-secondary",2);else console.log("Not a note")}(document.getElementById(A(e,M(t))))}))}function F(e,t,n){e.svg_elem,"node"!=n.tagName&&(n=S(t.getRootNode(),n.id)),B(t,n).forEach((t=>{!function(e){if(e){var t=getComputedStyle(e).getPropertyValue("--how-secondary");e.style.setProperty("--how-secondary",t/2),t/2==1&&e.classList.remove("secondarynote")}else console.log("Not a note")}(document.getElementById(A(e,M(t))))}))}function Y(e){if(void 0!==e){var t="";return e.classList.contains("note")?t="note":e.classList.contains("relation")?t="relation":e.classList.contains("metarelation")&&(t="metarelation"),t}return!1}function W(e){if(e.classList.contains("metarelation")){var t=e.getElementsByTagName("circle")[0];return[t.cx.baseVal.value,t.cy.baseVal.value]}return e.classList.contains("relation")?function(e){var t=e.getBBox();return[t.x+t.width/2,t.y+t.height/2]}(e):(console.log("wtf"),console.log(e),[0,0])}function K(e){return e.reduce(((e,t)=>e+t),0)/e.length}function Q(e){var t=S(mei,e),n=function(e){if(console.debug("Using globals: document, mei to find element"),document.contains(e)&&(e=S(mei,k(e))),e.hasAttribute("accid.ges"))return e.getAttribute("accid.ges");if(e.hasAttribute("accid"))return e.getAttribute("accid");if(0==e.children.length)return"";var t=e.getElementsByTagName("accid");if(0==t.length)return"";var n=t[0];return n.hasAttribute("accid.ges")?n.getAttribute("accid.ges"):n.hasAttribute("accid")?n.getAttribute("accid"):""}(t);return n=(n=(n=n.replace(/s/g,"#")).replace(/f/g,"b")).replace(/n/g,""),t.getAttribute("pname")+n+t.getAttribute("oct")}function X(e){return 0==e.length?"":e[0].classList.contains("note")?(e.sort(((e,t)=>{const[n,r]=w(e),[i,o]=w(t);return n-i==0?o-r:n-i})),e.map((e=>Q(k(e))))):void 0}function G(e){return Array.from(e.getElementsByTagName("node")).forEach((e=>{"hyperedge"==e.getAttribute("type")&&e.setAttribute("type","relation"),"metaedge"==e.getAttribute("type")&&e.setAttribute("type","metarelation")})),e}var Z=["dur","n","dots","when","layer","staff","tstamp.ges","tstamp.real","tstamp","loc","dur.ges","dots.ges","dur.metrical","dur.ppq","dur.real","dur.recip","beam","fermata","tuplet"];function J(e,t){var n=e.createElementNS("http://www.music-encoding.org/ns/mei","rest");n.setAttribute("xml:id","rest-"+t.getAttribute("xml:id"));for(let e of Z)t.hasAttribute(e)&&n.setAttribute(e,t.getAttribute(e));return n}function ee(e,t){var n=e.createElementNS("http://www.music-encoding.org/ns/mei","chord");n.setAttribute("xml:id","chord-"+t.getAttribute("xml:id"));for(const e of Z)t.hasAttribute(e)&&n.setAttribute(e,t.getAttribute(e));return n}function te(e,t){e.id&&(e.setAttribute("oldid",e.id),e.id=t+e.id),e.getAttribute("xml:id")&&e.setAttribute("xml:id",t+e.getAttribute("xml:id")),e.getAttribute("startid")&&e.setAttribute("startid",t+e.getAttribute("startid")),e.getAttribute("endid")&&e.setAttribute("endid",t+e.getAttribute("endid")),Array.from(e.children).forEach((e=>te(e,t)))}function ne(e){var t=e.implementation.createDocument(e.namespaceURI,null,null),n=t.importNode(e.documentElement,!0);return t.appendChild(n),t}function re(e){var t;return e.id?t=[e.id,k(e)]:e.hasAttribute("xml:id")&&(t=[e.getAttribute("xml:id"),k(e)]),t?[t].concat(Array.from(e.children).flatMap(re)):Array.from(e.children).flatMap(re)}function ie(){var e=document.getElementById("layers"),t=document.createElement("div");return t.id="layer"+e.children.length,t.classList.add("layer"),e.appendChild(t),t}function oe(e){var t=(0,i.kg)(),n=document.createElement("div");n.id="view"+t.length,n.classList.add("view");var r=document.createElement("div");return r.id="svg"+t.length,r.classList.add("svg_container"),n.appendChild(r),e.appendChild(n),[n,r]}function ae(e){var t=document.createElement("input");return t.setAttribute("type","checkbox"),t.setAttribute("value",e),t}function se(e){var t=document.createElement("input");return t.setAttribute("type","button"),t.setAttribute("value",e),t}function le(){var e=(0,a.c)();void 0!==e&&($(".view").removeClass("view--active"),e.view_elem.classList.add("view--active"),$(".sidebar").removeClass("sidebar_active"),e.view_elem.children[0].classList.add("sidebar_active"))}function ue(e){var t=e;return o.strip_xml_tags.forEach((t=>{Array.from(e.getElementsByTagName(t)).forEach((e=>{e.parentNode.removeChild(e)}))})),t}function ce(e,t,n){var r=(0,i.ro)(),o=t.map((e=>e.getAttribute("id").replace(/(^\d+-?)/,"gn-"))).sort(((e,t)=>e<t)),a=n.map((e=>e.getAttribute("id").replace(/(^\d+-?)/,"gn-"))).sort(((e,t)=>e<t));return Array.from(r.querySelectorAll("[type='relation']")).filter((t=>t.children[0].getAttribute("type")==e)).forEach((e=>{var t=L(e),n=t[0],r=t[1];if(n=n.map((e=>e.getAttribute("xml:id"))).sort(((e,t)=>e<t)),r=r.map((e=>e.getAttribute("xml:id"))).sort(((e,t)=>e<t)),JSON.stringify(o)==JSON.stringify(n)&&JSON.stringify(a)==JSON.stringify(r))return alert("Warning: This relation already exists.\nCreating a duplicate anyway."),!1})),!0}function de(e){var t=(0,i.kg)().filter((t=>t.svg_elem.contains(e)));return 0==t.length?null:t[0]}},617:(e,t,n)=>{"use strict";function r(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var i,o;n.d(t,{WFE:()=>Cn,K2I:()=>Bn}),1===(i=r).length&&(o=i,i=function(e,t){return r(o(e),t)});var a=Array.prototype;function s(){}function l(e){return null==e?s:function(){return this.querySelector(e)}}function u(){return[]}function c(e){return null==e?u:function(){return this.querySelectorAll(e)}}function d(e){return function(){return this.matches(e)}}function h(e){return new Array(e.length)}function f(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function p(e,t,n,r,i,o){for(var a,s=0,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new f(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function g(e,t,n,r,i,o,a){var s,l,u,c={},d=t.length,h=o.length,p=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(p[s]=u="$"+a.call(l,l.__data__,s,t),u in c?i[s]=l:c[u]=l);for(s=0;s<h;++s)(l=c[u="$"+a.call(e,o[s],s,o)])?(r[s]=l,l.__data__=o[s],c[u]=null):n[s]=new f(e,o[s]);for(s=0;s<d;++s)(l=t[s])&&c[p[s]]===l&&(i[s]=l)}function m(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}a.slice,a.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2),Array.prototype.slice,f.prototype={constructor:f,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var v="http://www.w3.org/1999/xhtml";const y={svg:"http://www.w3.org/2000/svg",xhtml:v,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function b(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),y.hasOwnProperty(t)?{space:y[t],local:e}:e}function _(e){return function(){this.removeAttribute(e)}}function x(e){return function(){this.removeAttributeNS(e.space,e.local)}}function w(e,t){return function(){this.setAttribute(e,t)}}function E(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function S(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function T(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function k(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function A(e){return function(){this.style.removeProperty(e)}}function N(e,t,n){return function(){this.style.setProperty(e,t,n)}}function M(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function D(e,t){return e.style.getPropertyValue(t)||k(e).getComputedStyle(e,null).getPropertyValue(t)}function C(e){return function(){delete this[e]}}function I(e,t){return function(){this[e]=t}}function L(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function j(e){return e.trim().split(/^|\s+/)}function O(e){return e.classList||new B(e)}function B(e){this._node=e,this._names=j(e.getAttribute("class")||"")}function P(e,t){for(var n=O(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function z(e,t){for(var n=O(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function R(e){return function(){P(this,e)}}function H(e){return function(){z(this,e)}}function U(e,t){return function(){(t.apply(this,arguments)?P:z)(this,e)}}function V(){this.textContent=""}function q(e){return function(){this.textContent=e}}function $(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function F(){this.innerHTML=""}function Y(e){return function(){this.innerHTML=e}}function W(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function K(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function X(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===v&&t.documentElement.namespaceURI===v?t.createElement(e):t.createElementNS(n,e)}}function G(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Z(e){var t=b(e);return(t.local?G:X)(t)}function J(){return null}function ee(){var e=this.parentNode;e&&e.removeChild(this)}function te(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ne(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}B.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var re={},ie=null;function oe(e,t,n){return e=ae(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function ae(e,t,n){return function(r){var i=ie;ie=r;try{e.call(this,this.__data__,t,n)}finally{ie=i}}}function se(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function le(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function ue(e,t,n){var r=re.hasOwnProperty(e.type)?oe:ae;return function(i,o,a){var s,l=this.__on,u=r(t,o,a);if(l)for(var c=0,d=l.length;c<d;++c)if((s=l[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=t);this.addEventListener(e.type,u,n),s={type:e.type,name:e.name,value:t,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function ce(e,t,n){var r=k(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function de(e,t){return function(){return ce(this,e,t)}}function he(e,t){return function(){return ce(this,e,t.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(re={mouseenter:"mouseover",mouseleave:"mouseout"}));var fe=[null];function pe(e,t){this._groups=e,this._parents=t}function ge(){return new pe([[document.documentElement]],fe)}pe.prototype=ge.prototype={constructor:pe,select:function(e){"function"!=typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=t[i],u=s.length,c=r[i]=new Array(u),d=0;d<u;++d)(o=s[d])&&(a=e.call(o,o.__data__,d,s))&&("__data__"in o&&(a.__data__=o.__data__),c[d]=a);return new pe(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=c(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,s=t[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(e.call(a,a.__data__,u,s)),i.push(a));return new pe(r,i)},filter:function(e){"function"!=typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new pe(r,this._parents)},data:function(e,t){if(!e)return m=new Array(this.size()),c=-1,this.each((function(e){m[++c]=e})),m;var n,r=t?g:p,i=this._parents,o=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=o.length,s=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var d=i[c],h=o[c],f=h.length,m=e.call(d,d&&d.__data__,c,i),v=m.length,y=l[c]=new Array(v),b=s[c]=new Array(v);r(d,h,y,b,u[c]=new Array(f),m,t);for(var _,x,w=0,E=0;w<v;++w)if(_=y[w]){for(w>=E&&(E=w+1);!(x=b[E])&&++E<v;);_._next=x||null}}return(s=new pe(s,i))._enter=l,s._exit=u,s},enter:function(){return new pe(this._enter||this._groups.map(h),this._parents)},exit:function(){return new pe(this._exit||this._groups.map(h),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(i=t(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=t[s],c=n[s],d=u.length,h=a[s]=new Array(d),f=0;f<d;++f)(l=u[f]||c[f])&&(h[f]=l);for(;s<r;++s)a[s]=t[s];return new pe(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=m);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(t)}return new pe(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=b(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?x:_:"function"==typeof t?n.local?T:S:n.local?E:w)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?A:"function"==typeof t?M:N)(e,t,null==n?"":n)):D(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?C:"function"==typeof t?L:I)(e,t)):this.node()[e]},classed:function(e,t){var n=j(e+"");if(arguments.length<2){for(var r=O(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?U:t?R:H)(n,t))},text:function(e){return arguments.length?this.each(null==e?V:("function"==typeof e?$:q)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?F:("function"==typeof e?W:Y)(e)):this.node().innerHTML},raise:function(){return this.each(K)},lower:function(){return this.each(Q)},append:function(e){var t="function"==typeof e?e:Z(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:Z(e),r=null==t?J:"function"==typeof t?t:l(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ee)},clone:function(e){return this.select(e?ne:te)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=se(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?ue:le,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],t,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?he:de)(e,t))}};const me=ge;var ve={value:function(){}};function ye(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new be(r)}function be(e){this._=e}function _e(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function xe(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function we(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=ve,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}be.prototype=ye.prototype={constructor:be,on:function(e,t){var n,r=this._,i=_e(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=we(r[n],e.name,t);else if(null==t)for(n in r)r[n]=we(r[n],e.name,null);return this}for(;++o<a;)if((n=(e=i[o]).type)&&(n=xe(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new be(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};const Ee=ye;var Se,Te,ke=0,Ae=0,Ne=0,Me=0,De=0,Ce=0,Ie="object"==typeof performance&&performance.now?performance:Date,Le="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function je(){return De||(Le(Oe),De=Ie.now()+Ce)}function Oe(){De=0}function Be(){this._call=this._time=this._next=null}function Pe(e,t,n){var r=new Be;return r.restart(e,t,n),r}function ze(){De=(Me=Ie.now())+Ce,ke=Ae=0;try{!function(){je(),++ke;for(var e,t=Se;t;)(e=De-t._time)>=0&&t._call.call(null,e),t=t._next;--ke}()}finally{ke=0,function(){for(var e,t,n=Se,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Se=t);Te=e,He(r)}(),De=0}}function Re(){var e=Ie.now(),t=e-Me;t>1e3&&(Ce-=t,Me=e)}function He(e){ke||(Ae&&(Ae=clearTimeout(Ae)),e-De>24?(e<1/0&&(Ae=setTimeout(ze,e-Ie.now()-Ce)),Ne&&(Ne=clearInterval(Ne))):(Ne||(Me=Ie.now(),Ne=setInterval(Re,1e3)),ke=1,Le(ze)))}function Ue(e,t,n){var r=new Be;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r}Be.prototype=Pe.prototype={constructor:Be,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?je():+n)+(null==t?0:+t),this._next||Te===this||(Te?Te._next=this:Se=this,Te=this),this._call=e,this._time=n,He()},stop:function(){this._call&&(this._call=null,this._time=1/0,He())}};var Ve=Ee("start","end","cancel","interrupt"),qe=[];function $e(e,t,n,r,i,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(l){var u,c,d,h;if(1!==n.state)return s();for(u in i)if((h=i[u]).name===n.name){if(3===h.state)return Ue(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[u]):+u<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[u])}if(Ue((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),u=0,c=-1;u<d;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=Pe((function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:Ve,tween:qe,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function Fe(e,t){var n=We(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ye(e,t){var n=We(e,t);if(n.state>3)throw new Error("too late; already running");return n}function We(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ke(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Qe,Xe,Ge,Ze,Je=180/Math.PI,et={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tt(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Je,skewX:Math.atan(l)*Je,scaleX:a,scaleY:s}}function nt(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:Ke(e,i)},{i:l-2,x:Ke(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Ke(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Ke(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,l),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Ke(e,n)},{i:s-2,x:Ke(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var rt=nt((function(e){return"none"===e?et:(Qe||(Qe=document.createElement("DIV"),Xe=document.documentElement,Ge=document.defaultView),Qe.style.transform=e,e=Ge.getComputedStyle(Xe.appendChild(Qe),null).getPropertyValue("transform"),Xe.removeChild(Qe),tt(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}),"px, ","px)","deg)"),it=nt((function(e){return null==e?et:(Ze||(Ze=document.createElementNS("http://www.w3.org/2000/svg","g")),Ze.setAttribute("transform",e),(e=Ze.transform.baseVal.consolidate())?tt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):et)}),", ",")",")");function ot(e,t){var n,r;return function(){var i=Ye(this,e),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}i.tween=r}}function at(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Ye(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function st(e,t,n){var r=e._id;return e.each((function(){var e=Ye(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return We(e,r).value[t]}}function lt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ut(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ct(){}var dt=.7,ht=1/dt,ft="\\s*([+-]?\\d+)\\s*",pt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",gt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mt=/^#([0-9a-f]{3,8})$/,vt=new RegExp("^rgb\\("+[ft,ft,ft]+"\\)$"),yt=new RegExp("^rgb\\("+[gt,gt,gt]+"\\)$"),bt=new RegExp("^rgba\\("+[ft,ft,ft,pt]+"\\)$"),_t=new RegExp("^rgba\\("+[gt,gt,gt,pt]+"\\)$"),xt=new RegExp("^hsl\\("+[pt,gt,gt]+"\\)$"),wt=new RegExp("^hsla\\("+[pt,gt,gt,pt]+"\\)$"),Et={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function St(){return this.rgb().formatHex()}function Tt(){return this.rgb().formatRgb()}function kt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=mt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?At(t):3===n?new Ct(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Nt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Nt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=vt.exec(e))?new Ct(t[1],t[2],t[3],1):(t=yt.exec(e))?new Ct(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=bt.exec(e))?Nt(t[1],t[2],t[3],t[4]):(t=_t.exec(e))?Nt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=xt.exec(e))?Ot(t[1],t[2]/100,t[3]/100,1):(t=wt.exec(e))?Ot(t[1],t[2]/100,t[3]/100,t[4]):Et.hasOwnProperty(e)?At(Et[e]):"transparent"===e?new Ct(NaN,NaN,NaN,0):null}function At(e){return new Ct(e>>16&255,e>>8&255,255&e,1)}function Nt(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ct(e,t,n,r)}function Mt(e){return e instanceof ct||(e=kt(e)),e?new Ct((e=e.rgb()).r,e.g,e.b,e.opacity):new Ct}function Dt(e,t,n,r){return 1===arguments.length?Mt(e):new Ct(e,t,n,null==r?1:r)}function Ct(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function It(){return"#"+jt(this.r)+jt(this.g)+jt(this.b)}function Lt(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function jt(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Ot(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Pt(e,t,n,r)}function Bt(e){if(e instanceof Pt)return new Pt(e.h,e.s,e.l,e.opacity);if(e instanceof ct||(e=kt(e)),!e)return new Pt;if(e instanceof Pt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new Pt(a,s,l,e.opacity)}function Pt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function zt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Rt(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function Ht(e){return function(){return e}}function Ut(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Ht(isNaN(e)?t:e)}lt(ct,kt,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:St,formatHex:St,formatHsl:function(){return Bt(this).formatHsl()},formatRgb:Tt,toString:Tt}),lt(Ct,Dt,ut(ct,{brighter:function(e){return e=null==e?ht:Math.pow(ht,e),new Ct(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?dt:Math.pow(dt,e),new Ct(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:It,formatHex:It,formatRgb:Lt,toString:Lt})),lt(Pt,(function(e,t,n,r){return 1===arguments.length?Bt(e):new Pt(e,t,n,null==r?1:r)}),ut(ct,{brighter:function(e){return e=null==e?ht:Math.pow(ht,e),new Pt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?dt:Math.pow(dt,e),new Pt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ct(zt(e>=240?e-240:e+120,i,r),zt(e,i,r),zt(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const Vt=function e(t){var n=function(e){return 1==(e=+e)?Ut:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Ht(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Dt(e)).r,(t=Dt(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Ut(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function qt(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Dt(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}qt((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return Rt((n-r/t)*t,a,i,o,s)}})),qt((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Rt((n-r/t)*t,i,o,a,s)}}));var $t=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ft=new RegExp($t.source,"g");function Yt(e,t){var n,r,i,o=$t.lastIndex=Ft.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=$t.exec(e))&&(r=Ft.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Ke(n,r)})),o=Ft.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function Wt(e,t){var n;return("number"==typeof t?Ke:t instanceof kt?Vt:(n=kt(t))?(t=n,Vt):Yt)(e,t)}function Kt(e){return function(){this.removeAttribute(e)}}function Qt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Xt(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttribute(e);return a===o?null:a===r?i:i=t(r=a,n)}}function Gt(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===r?i:i=t(r=a,n)}}function Zt(e,t,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,l));this.removeAttribute(e)}}function Jt(e,t,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,l));this.removeAttributeNS(e.space,e.local)}}function en(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function tn(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function nn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&tn(e,i)),n}return i._value=t,i}function rn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&en(e,i)),n}return i._value=t,i}function on(e,t){return function(){Fe(this,e).delay=+t.apply(this,arguments)}}function an(e,t){return t=+t,function(){Fe(this,e).delay=t}}function sn(e,t){return function(){Ye(this,e).duration=+t.apply(this,arguments)}}function ln(e,t){return t=+t,function(){Ye(this,e).duration=t}}function un(e,t){if("function"!=typeof t)throw new Error;return function(){Ye(this,e).ease=t}}function cn(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Fe:Ye;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}var dn=me.prototype.constructor;function hn(e){return function(){this.style.removeProperty(e)}}function fn(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function pn(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&fn(e,o,n)),r}return o._value=t,o}function gn(e){return function(t){this.textContent=e.call(this,t)}}function mn(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&gn(r)),t}return r._value=e,r}var vn=0;function yn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function bn(){return++vn}var _n=me.prototype;yn.prototype=function(e){return me().transition(e)}.prototype={constructor:yn,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=l(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,u,c=r[a],d=c.length,h=o[a]=new Array(d),f=0;f<d;++f)(s=c[f])&&(u=e.call(s,s.__data__,f,c))&&("__data__"in s&&(u.__data__=s.__data__),h[f]=u,$e(h[f],t,n,f,h,We(s,n)));return new yn(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=c(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],d=u.length,h=0;h<d;++h)if(l=u[h]){for(var f,p=e.call(l,l.__data__,h,u),g=We(l,n),m=0,v=p.length;m<v;++m)(f=p[m])&&$e(f,t,n,m,p,g);o.push(p),a.push(l)}return new yn(o,a,t,n)},filter:function(e){"function"!=typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new yn(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=t[s],c=n[s],d=u.length,h=a[s]=new Array(d),f=0;f<d;++f)(l=u[f]||c[f])&&(h[f]=l);for(;s<r;++s)a[s]=t[s];return new yn(a,this._parents,this._name,this._id)},selection:function(){return new dn(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=bn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=We(a,t);$e(a,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new yn(r,this._parents,e,n)},call:_n.call,nodes:_n.nodes,node:_n.node,size:_n.size,empty:_n.empty,each:_n.each,on:function(e,t){var n=this._id;return arguments.length<2?We(this.node(),n).on.on(e):this.each(cn(n,e,t))},attr:function(e,t){var n=b(e),r="transform"===n?it:Wt;return this.attrTween(e,"function"==typeof t?(n.local?Jt:Zt)(n,r,st(this,"attr."+e,t)):null==t?(n.local?Qt:Kt)(n):(n.local?Gt:Xt)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=b(e);return this.tween(n,(r.local?nn:rn)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?rt:Wt;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=D(this,e),a=(this.style.removeProperty(e),D(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}(e,r)).on("end.style."+e,hn(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var a=D(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=D(this,e)),a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s))}}(e,r,st(this,"style."+e,t))).each(function(e,t){var n,r,i,o,a="style."+t,s="end."+a;return function(){var l=Ye(this,e),u=l.on,c=null==l.value[a]?o||(o=hn(t)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var a=D(this,e);return a===o?null:a===r?i:i=t(r=a,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,pn(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(st(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,mn(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=We(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?ot:at)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?on:an)(t,e)):We(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?sn:ln)(t,e)):We(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(un(t,e)):We(this.node(),t).ease},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=Ye(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}))}))}};var xn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function wn(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return xn.time=je(),xn;return n}function En(e){return{type:e}}me.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,o=e.__transition,a=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete e.__transition}}(this,e)}))},me.prototype.transition=function(e){var t,n;e instanceof yn?(t=e._id,e=e._name):(t=bn(),(n=xn).time=je(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&$e(a,e,t,u,s,n||wn(a,t));return new yn(r,this._parents,e,t)},["w","e"].map(En),["n","s"].map(En),["n","w","e","s","nw","ne","sw","se"].map(En),Math.cos,Math.sin,Math.PI,Math.max,Array.prototype.slice;var Sn="$";function Tn(){}function kn(e,t){var n=new Tn;if(e instanceof Tn)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var r,i=-1,o=e.length;if(null==t)for(;++i<o;)n.set(i,e[i]);else for(;++i<o;)n.set(t(r=e[i],i,e),r)}else if(e)for(var a in e)n.set(a,e[a]);return n}function An(){}Tn.prototype=kn.prototype={constructor:Tn,has:function(e){return Sn+e in this},get:function(e){return this[Sn+e]},set:function(e,t){return this[Sn+e]=t,this},remove:function(e){var t=Sn+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===Sn&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===Sn&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===Sn&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===Sn&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===Sn&&++e;return e},empty:function(){for(var e in this)if(e[0]===Sn)return!1;return!0},each:function(e){for(var t in this)t[0]===Sn&&e(this[t],t.slice(1),this)}};var Nn=kn.prototype;function Mn(e,t){return e[0]-t[0]||e[1]-t[1]}function Dn(e){for(var t=e.length,n=[0,1],r=2,i=2;i<t;++i){for(;r>1&&(o=e[n[r-2]],a=e[n[r-1]],s=e[i],(a[0]-o[0])*(s[1]-o[1])-(a[1]-o[1])*(s[0]-o[0])<=0);)--r;n[r++]=i}var o,a,s;return n.slice(0,r)}function Cn(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),i=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort(Mn),t=0;t<n;++t)i[t]=[r[t][0],-r[t][1]];var o=Dn(r),a=Dn(i),s=a[0]===o[0],l=a[a.length-1]===o[o.length-1],u=[];for(t=o.length-1;t>=0;--t)u.push(e[r[o[t]][2]]);for(t=+s;t<a.length-l;++t)u.push(e[r[a[t]][2]]);return u}function In(){return Math.random()}An.prototype=function(e,t){var n=new An;if(e instanceof An)e.each((function(e){n.add(e)}));else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}.prototype={constructor:An,has:Nn.has,add:function(e){return this[Sn+(e+="")]=e,this},remove:Nn.remove,clear:Nn.clear,values:Nn.keys,size:Nn.size,empty:Nn.empty,each:Nn.each},Array.prototype.slice,Math.PI,Math.sqrt(5),function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,1===arguments.length?(n=e,e=0):n-=e,function(){return t()*n+e}}return n.source=e,n}(In);const Ln=function e(t){function n(e,n){var r,i;return e=null==e?0:+e,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*t()-1,o=2*t()-1,i=r*r+o*o}while(!i||i>1);return e+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=e,n}(In),jn=(function e(t){function n(){var e=Ln.source(t).apply(this,arguments);return function(){return Math.exp(e())}}return n.source=e,n}(In),function e(t){function n(e){return function(){for(var n=0,r=0;r<e;++r)n+=t();return n}}return n.source=e,n}(In));(function e(t){function n(e){var n=jn.source(t)(e);return function(){return n()/e}}return n.source=e,n})(In),function e(t){function n(e){return function(){return-Math.log(1-t())/e}}return n.source=e,n}(In);var On=Array.prototype;On.map,On.slice;const Bn=function(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function Pn(){this._=null}function zn(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Rn(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Hn(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Un(e){for(;e.L;)e=e.L;return e}Pn.prototype={constructor:Pn,insert:function(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=Un(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(Rn(this,n),n=(e=n).U),n.C=!1,r.C=!0,Hn(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(Hn(this,n),n=(e=n).U),n.C=!1,r.C=!0,Rn(this,r)),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,i=e.U,o=e.L,a=e.R;if(n=o?a?Un(a):o:a,i?i.L===e?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=e.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=e.U,e=n.R,i.L=e,n.R=a,a.U=n):(n.U=i,i=n,e=n.R)):(r=e.C,e=n),e&&(e.U=i),!r)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,Rn(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,Hn(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,Rn(this,i),e=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,Hn(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Rn(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,Hn(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}};const Vn=Pn;function qn(e,t,n,r){var i=[null,null],o=fr.push(i)-1;return i.left=e,i.right=t,n&&Fn(i,e,t,n),r&&Fn(i,t,e,r),dr[e.index].halfedges.push(o),dr[t.index].halfedges.push(o),i}function $n(e,t,n){var r=[t,n];return r.left=e,r}function Fn(e,t,n,r){e[0]||e[1]?e.left===n?e[1]=r:e[0]=r:(e[0]=r,e.left=t,e.right=n)}function Yn(e,t,n,r,i){var o,a=e[0],s=e[1],l=a[0],u=a[1],c=0,d=1,h=s[0]-l,f=s[1]-u;if(o=t-l,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<d&&(d=o)}else if(h>0){if(o>d)return;o>c&&(c=o)}if(o=r-l,h||!(o<0)){if(o/=h,h<0){if(o>d)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<d&&(d=o)}if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<d&&(d=o)}else if(f>0){if(o>d)return;o>c&&(c=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>d)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<d&&(d=o)}return!(c>0||d<1)||(c>0&&(e[0]=[l+c*h,u+c*f]),d<1&&(e[1]=[l+d*h,u+d*f]),!0)}}}}}function Wn(e,t,n,r,i){var o=e[1];if(o)return!0;var a,s,l=e[0],u=e.left,c=e.right,d=u[0],h=u[1],f=c[0],p=c[1],g=(d+f)/2,m=(h+p)/2;if(p===h){if(g<t||g>=r)return;if(d>f){if(l){if(l[1]>=i)return}else l=[g,n];o=[g,i]}else{if(l){if(l[1]<n)return}else l=[g,i];o=[g,n]}}else if(s=m-(a=(d-f)/(p-h))*g,a<-1||a>1)if(d>f){if(l){if(l[1]>=i)return}else l=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/a,i];o=[(n-s)/a,n]}else if(h<p){if(l){if(l[0]>=r)return}else l=[t,a*t+s];o=[r,a*r+s]}else{if(l){if(l[0]<t)return}else l=[r,a*r+s];o=[t,a*t+s]}return e[0]=l,e[1]=o,!0}function Kn(e,t){var n=e.site,r=t.left,i=t.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=t[1],i=t[0]):(r=t[0],i=t[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Qn(e,t){return t[+(t.left!==e.site)]}function Xn(e,t){return t[+(t.left===e.site)]}var Gn,Zn=[];function Jn(){zn(this),this.x=this.y=this.arc=this.site=this.cy=null}function er(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,i=e.site,o=n.site;if(r!==o){var a=i[0],s=i[1],l=r[0]-a,u=r[1]-s,c=o[0]-a,d=o[1]-s,h=2*(l*d-u*c);if(!(h>=-gr)){var f=l*l+u*u,p=c*c+d*d,g=(d*f-u*p)/h,m=(l*p-c*f)/h,v=Zn.pop()||new Jn;v.arc=e,v.site=i,v.x=g+a,v.y=(v.cy=m+s)+Math.sqrt(g*g+m*m),e.circle=v;for(var y=null,b=hr._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}hr.insert(y,v),y||(Gn=v)}}}}function tr(e){var t=e.circle;t&&(t.P||(Gn=t.N),hr.remove(t),Zn.push(t),zn(t),e.circle=null)}var nr=[];function rr(){zn(this),this.edge=this.site=this.circle=null}function ir(e){var t=nr.pop()||new rr;return t.site=e,t}function or(e){tr(e),cr.remove(e),nr.push(e),zn(e)}function ar(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],o=e.P,a=e.N,s=[e];or(e);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<pr&&Math.abs(r-l.circle.cy)<pr;)o=l.P,s.unshift(l),or(l),l=o;s.unshift(l),tr(l);for(var u=a;u.circle&&Math.abs(n-u.circle.x)<pr&&Math.abs(r-u.circle.cy)<pr;)a=u.N,s.push(u),or(u),u=a;s.push(u),tr(u);var c,d=s.length;for(c=1;c<d;++c)u=s[c],l=s[c-1],Fn(u.edge,l.site,u.site,i);l=s[0],(u=s[d-1]).edge=qn(l.site,u.site,null,i),er(l),er(u)}function sr(e){for(var t,n,r,i,o=e[0],a=e[1],s=cr._;s;)if((r=lr(s,a)-o)>pr)s=s.L;else{if(!((i=o-ur(s,a))>pr)){r>-pr?(t=s.P,n=s):i>-pr?(t=s,n=s.N):t=n=s;break}if(!s.R){t=s;break}s=s.R}!function(e){dr[e.index]={site:e,halfedges:[]}}(e);var l=ir(e);if(cr.insert(t,l),t||n){if(t===n)return tr(t),n=ir(t.site),cr.insert(l,n),l.edge=n.edge=qn(t.site,l.site),er(t),void er(n);if(n){tr(t),tr(n);var u=t.site,c=u[0],d=u[1],h=e[0]-c,f=e[1]-d,p=n.site,g=p[0]-c,m=p[1]-d,v=2*(h*m-f*g),y=h*h+f*f,b=g*g+m*m,_=[(m*y-f*b)/v+c,(h*b-g*y)/v+d];Fn(n.edge,u,p,_),l.edge=qn(u,e,null,_),n.edge=qn(e,p,null,_),er(t),er(n)}else l.edge=qn(t.site,l.site)}}function lr(e,t){var n=e.site,r=n[0],i=n[1],o=i-t;if(!o)return r;var a=e.P;if(!a)return-1/0;var s=(n=a.site)[0],l=n[1],u=l-t;if(!u)return s;var c=s-r,d=1/o-1/u,h=c/u;return d?(-h+Math.sqrt(h*h-2*d*(c*c/(-2*u)-l+u/2+i-o/2)))/d+r:(r+s)/2}function ur(e,t){var n=e.N;if(n)return lr(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var cr,dr,hr,fr,pr=1e-6,gr=1e-12;function mr(e,t){return t[1]-e[1]||t[0]-e[0]}function vr(e,t){var n,r,i,o=e.sort(mr).pop();for(fr=[],dr=new Array(e.length),cr=new Vn,hr=new Vn;;)if(i=Gn,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(sr(o),n=o[0],r=o[1]),o=e.pop();else{if(!i)break;ar(i.arc)}if(function(){for(var e,t,n,r,i=0,o=dr.length;i<o;++i)if((e=dr[i])&&(r=(t=e.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=Kn(e,fr[t[n]]);for(a.sort((function(e,t){return s[t]-s[e]})),n=0;n<r;++n)s[n]=t[a[n]];for(n=0;n<r;++n)t[n]=s[n]}}(),t){var a=+t[0][0],s=+t[0][1],l=+t[1][0],u=+t[1][1];!function(e,t,n,r){for(var i,o=fr.length;o--;)Wn(i=fr[o],e,t,n,r)&&Yn(i,e,t,n,r)&&(Math.abs(i[0][0]-i[1][0])>pr||Math.abs(i[0][1]-i[1][1])>pr)||delete fr[o]}(a,s,l,u),function(e,t,n,r){var i,o,a,s,l,u,c,d,h,f,p,g,m=dr.length,v=!0;for(i=0;i<m;++i)if(o=dr[i]){for(a=o.site,s=(l=o.halfedges).length;s--;)fr[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)p=(f=Xn(o,fr[l[s]]))[0],g=f[1],d=(c=Qn(o,fr[l[++s%u]]))[0],h=c[1],(Math.abs(p-d)>pr||Math.abs(g-h)>pr)&&(l.splice(s,0,fr.push($n(a,f,Math.abs(p-e)<pr&&r-g>pr?[e,Math.abs(d-e)<pr?h:r]:Math.abs(g-r)<pr&&n-p>pr?[Math.abs(h-r)<pr?d:n,r]:Math.abs(p-n)<pr&&g-t>pr?[n,Math.abs(d-n)<pr?h:t]:Math.abs(g-t)<pr&&p-e>pr?[Math.abs(h-t)<pr?d:e,t]:null))-1),++u);u&&(v=!1)}if(v){var y,b,_,x=1/0;for(i=0,v=null;i<m;++i)(o=dr[i])&&(_=(y=(a=o.site)[0]-e)*y+(b=a[1]-t)*b)<x&&(x=_,v=o);if(v){var w=[e,t],E=[e,r],S=[n,r],T=[n,t];v.halfedges.push(fr.push($n(a=v.site,w,E))-1,fr.push($n(a,E,S))-1,fr.push($n(a,S,T))-1,fr.push($n(a,T,w))-1)}}for(i=0;i<m;++i)(o=dr[i])&&(o.halfedges.length||delete dr[i])}(a,s,l,u)}this.edges=fr,this.cells=dr,cr=hr=fr=dr=null}function yr(e,t,n){this.k=e,this.x=t,this.y=n}vr.prototype={constructor:vr,polygons:function(){var e=this.edges;return this.cells.map((function(t){var n=t.halfedges.map((function(n){return Qn(t,e[n])}));return n.data=t.site.data,n}))},triangles:function(){var e=[],t=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s=n.site,l=-1,u=t[i[o-1]],c=u.left===s?u.right:u.left;++l<o;)a=c,c=(u=t[i[l]]).left===s?u.right:u.left,a&&c&&r<a.index&&r<c.index&&(h=a,f=c,((d=s)[0]-f[0])*(h[1]-d[1])-(d[0]-h[0])*(f[1]-d[1])<0)&&e.push([s.data,a.data,c.data]);var d,h,f})),e},links:function(){return this.edges.filter((function(e){return e.right})).map((function(e){return{source:e.left.data,target:e.right.data}}))},find:function(e,t,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=e-i.site[0],u=t-i.site[1],c=l*l+u*u;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=e-s[0],u=t-s[1],d=l*l+u*u;d<c&&(c=d,a=s.index)}}))}while(null!==a);return o._found=r,null==n||c<=n*n?i.site:null}},yr.prototype={constructor:yr,scale:function(e){return 1===e?this:new yr(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new yr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new yr(1,0,0),yr.prototype},501:function(e){e.exports=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,n){return u=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&s(i,n.prototype),i},u.apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return u(e,arguments,a(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,e)},c(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?d(e):t}function f(e){var t=l();return function(){var n,r=a(e);if(t){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function p(e,t,n){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}},p(e,t,n||e)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e,t,n){var r=e.x,i=e.y,o=n.x,a=n.y;return{"+":{x:r+o,y:i+a},"-":{x:r-o,y:i-a},"*":{x:r*o,y:i*a},"/":{x:r/o,y:i/a}}[t]},_=function(e){return{x:e.left,y:e.top}},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{left:e.x,top:e.y,right:e.x,bottom:e.y,width:t,height:t}},w=function(){var e,t,n,r;return{y:(null===(e=document.body)||void 0===e?void 0:e.scrollTop)||(null===(t=document.documentElement)||void 0===t?void 0:t.scrollTop)||0,x:(null===(n=document.body)||void 0===n?void 0:n.scrollLeft)||(null===(r=document.documentElement)||void 0===r?void 0:r.scrollLeft)||0}},E=function(e){return!e||e instanceof Document?w():{x:e.scrollLeft>=0?e.scrollLeft:w().x,y:e.scrollTop>=0?e.scrollTop:w().y}},S=function(e){var t=e.elementRect,n=e.containerRect,r=e.tolerance,i=void 0===r?{x:0,y:0}:r,o=[];return t.top-i.y<n.top&&o.push("top"),t.left-i.x<n.left&&o.push("left"),t.bottom+i.y>n.bottom&&o.push("bottom"),t.right+i.y>n.right&&o.push("right"),o},T=function(e){var t=e.event;return{x:t.clientX,y:t.clientY}},k=function(e){var t={x:0,y:0},n=window.getComputedStyle(e);if(!n.transform||"none"===n.transform)return t;if(n.transform.indexOf("3d")>=0){var r=n.transform.trim().match(/matrix3d\((.*?)\)/);if(r&&r.length){var i,o=null===(i=r[1])||void 0===i?void 0:i.split(",");t.x=parseInt(o[12])||0,t.y=parseInt(o[13])||0}return t}var a=n.transform.trim().match(/matrix\((.*?)\)/);if(a&&a.length){var s,l=null===(s=a[1])||void 0===s?void 0:s.split(",");t.x=parseInt(l[4])||0,t.y=parseInt(l[5])||0}return t},A=function(e,t){return t?function(e){var t=e.style.transform;if(!t||t.indexOf("translate")<0)return k(e);var n={x:0,y:0},r=t.trim().match(/translate[3dD]*?\(.*?\)/);if(r){var i,o=null===(i=r[0])||void 0===i?void 0:i.split("(");if(o){var a,s=null===(a=o[1])||void 0===a?void 0:a.split(",");n.x=parseInt(s[0])||0,n.y=parseInt(s[1])||0}}return n.x||n.x?n:k(e)}(e):function(e){var t=e.style,n={x:parseInt(t.left)||0,y:parseInt(t.top)||0};if(!n.x&&!n.x){var r=window.getComputedStyle(e);return{x:parseInt(r.left)||0,y:parseInt(r.top)||0}}return n}(e)},N=function(e){var t=e.computedStyle,n=e.node,r=t.position;n instanceof HTMLDocument||"absolute"===r||"relative"===r||"fixed"===r||(n.style.position="relative")},M=function(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top},D=function(e){var t=e.element,n=e.posDirection,r=e.containerRect,i=e.useTransform,o=A(t,i),a=b(o,"+",n);C(t,a,i);var s=t.getBoundingClientRect();!function(e){var t=e.element,n=e.edges,r=e.elementRect,i=e.containerRect,o=e.elementPos,a=e.useTransform;n.includes("top")&&C(t,{y:o.y+i.top-r.top,x:o.x},a),n.includes("left")&&C(t,{y:o.y,x:o.x+i.left-r.left},a),n.includes("bottom")&&C(t,{y:o.y+i.bottom-r.bottom,x:o.x},a),n.includes("right")&&C(t,{y:o.y,x:o.x+i.right-r.right},a)}({element:t,edges:S({elementRect:s,containerRect:r}),elementRect:s,containerRect:r,elementPos:a,useTransform:i})},C=function(e,t,n){if(n){var r=e.style.transform;e.style.transform="translate3d(".concat(t.x,"px,").concat(t.y,"px,1px) ").concat(r.replace(/translate.*?\)/g,""))}else e.style.left="".concat(t.x,"px"),e.style.top="".concat(t.y,"px");return e},I=function(e){for(var t=e.subscribe,n=e.publish,o=e.Interaction,a=e.SelectedSet,s=function(){var e=g(u[l],2),s=e[0],c=e[1];["pre",!1].forEach((function(e){return t(e?"".concat(s,":").concat(e):s,(function(t){return c.forEach((function(s){return(!s.condition||s.condition(t))&&n(e?"".concat(e).concat(s.name):s.name,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({items:a.elements,isDragging:o.isDragging},t))}))}))}))},l=0,u=Object.entries({"Selected:added":[{name:"elementselect"}],"Selected:removed":[{name:"elementunselect"}],"Area:scroll":[{name:"autoscroll"}],"Interaction:start":[{name:"dragstart"}],"Interaction:update":[{name:"dragmove",condition:function(e){return e.event}}],"Interaction:end":[{name:"callback"}],"Drag:keyboardDrag":[{name:"dragstart"},{name:"dragmove"}]});l<u.length;l++)s()},L=function(e){return e?!Array.isArray(e)&&(e instanceof HTMLElement||e instanceof SVGElement)?[e]:m(e):[]},j=function(e,t){e.style.left="".concat(t.left,"px"),e.style.top="".concat(t.top,"px"),e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px")},O=function(){function t(n){var i,o,a,s=this,l=n.area,u=n.PS,c=n.zoom;e(this,t),r(this,"_modificationCallback",void 0),r(this,"_modificationObserver",void 0),r(this,"_zoom",void 0),r(this,"_node",void 0),r(this,"_parentNodes",void 0),r(this,"_computedStyle",void 0),r(this,"_computedBorder",void 0),r(this,"_rect",void 0),r(this,"start",(function(){var e,t,n;e=s.parentNodes,t=s._modificationCallback,n=s._modificationObserver,window.addEventListener("resize",t),window.addEventListener("scroll",t),e.forEach((function(e,t){n.observe(e,{childList:0!==t,attributes:!0})}))})),r(this,"reset",(function(){s._computedStyle=void 0,s._rect=void 0,s._computedBorder=void 0,s._parentNodes=void 0})),r(this,"stop",(function(){var e,t;e=s._modificationObserver,t=s._modificationCallback,window.removeEventListener("resize",t),window.removeEventListener("scroll",t),e.disconnect(),s.reset()})),r(this,"scroll",(function(e,t){(function(e,t,n){if(t.length){var r=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,i=e instanceof HTMLDocument?r||document.body:e,o=t.includes("top")&&i.scrollTop>0,a=t.includes("bottom")&&i.scrollTop<i.scrollHeight,s=t.includes("left")&&i.scrollLeft>0,l=t.includes("right")&&i.scrollLeft<i.scrollWidth;o&&(i.scrollTop-=1*n),a&&(i.scrollTop+=1*n),s&&(i.scrollLeft-=1*n),l&&(i.scrollLeft+=1*n)}})(s._node,e,t),s.PubSub.publish("Area:scroll",{scroll_directions:e,scroll_multiplier:t})})),this._node=l,this._zoom=c,this.PubSub=u,N({computedStyle:this.computedStyle,node:this._node}),this._modificationCallback=(i=function(e){s.reset(),s.PubSub.publish("Area:modified",{event:e,item:s})},o=60,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=function(){a=null,i.apply(void 0,t)};clearTimeout(a),a=setTimeout(r,o)}),this._modificationObserver=new MutationObserver(this._modificationCallback),setTimeout((function(){s.reset(),s.PubSub.publish("Area:modified",{event,item:s})})),this.PubSub.subscribe("Interaction:init",this.start),this.PubSub.subscribe("Interaction:end",this.reset)}return n(t,[{key:"HTMLNode",get:function(){return this._node}},{key:"computedBorder",get:function(){return this._computedBorder?this._computedBorder:{top:parseInt(this.computedStyle.borderTopWidth),bottom:parseInt(this.computedStyle.borderBottomWidth),left:parseInt(this.computedStyle.borderLeftWidth),right:parseInt(this.computedStyle.borderRightWidth)}}},{key:"computedStyle",get:function(){return this._computedStyle?this._computedStyle:this.HTMLNode instanceof HTMLDocument?this._computedStyle=window.getComputedStyle(this.HTMLNode.body||this.HTMLNode.documentElement):this._computedStyle=window.getComputedStyle(this.HTMLNode)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=function(e,t){if(e instanceof Document)return{top:0,left:0,bottom:0,right:0,width:window.innerWidth,height:window.innerHeight};var n=e.getBoundingClientRect();return{top:n.top,left:n.left,bottom:n.bottom,right:n.right,width:(e.clientWidth||n.width)*t,height:(e.clientHeight||n.height)*t}}(this.HTMLNode,this._zoom)}},{key:"parentNodes",get:function(){if(this._parentNodes)return this._parentNodes;return this._parentNodes=function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=null===(n=t[r])||void 0===n?void 0:n.parentNode;return i?(t.push(i),e(t,++r)):t}([this.HTMLNode]),this._parentNodes}}]),t}(),B=function(){function t(n){var i=this,o=n.DS,a=n.dragKeys,s=n.draggability,l=n.keyboardDrag,u=n.keyboardDragSpeed,c=n.useTransform,d=n.zoom;e(this,t),r(this,"_useTransform",void 0),r(this,"_prevCursorPos",void 0),r(this,"_prevScrollPos",void 0),r(this,"_elements",[]),r(this,"_draggability",void 0),r(this,"_dragKeys",void 0),r(this,"_dragKeysFlat",void 0),r(this,"_keyboardDrag",void 0),r(this,"_keyboardDragSpeed",void 0),r(this,"_zoom",void 0),r(this,"keyboardDrag",(function(e){var t=e.event,n=e.key;if(i._keyboardDrag&&i._dragKeysFlat.includes(n)&&i.DS.SelectedSet.size&&i._draggability&&!i.DS.continue){i.DS.publish("Interaction:start",{event:t,isDragging:!0,isDraggingKeyboard:!0}),i._elements=i.DS.getSelection(),i.handleZIndex(!0);var r=function(e){var t=e.shiftKey,n=e.keyboardDragSpeed,r=e.zoom,i=e.key,o=e.dragKeys,a=e.scrollDiff,s=e.canScroll,l=e.scrollCallback,u={x:0,y:0},c=t?4*n*r:n*r;return o.left.includes(i)&&(u.x=a.x||-c,t||a.x||!s||l(["left"],n)),o.right.includes(i)&&(u.x=a.x||c,t||a.x||!s||l(["right"],n)),o.up.includes(i)&&(u.y=a.y||-c,t||a.y||!s||l(["top"],n)),o.down.includes(i)&&(u.y=a.y||c,t||a.y||!s||l(["bottom"],n)),u}({shiftKey:i.DS.stores.KeyStore.currentValues.includes("shift"),keyboardDragSpeed:i._keyboardDragSpeed,zoom:i._zoom,key:n,scrollCallback:i.DS.Area.scroll,scrollDiff:i._scrollDiff,canScroll:i.DS.stores.ScrollStore.canScroll,dragKeys:i._dragKeys});i._elements.forEach((function(e){return D({element:e,posDirection:r,containerRect:i.DS.SelectorArea.rect,useTransform:i._useTransform})})),i.DS.publish("Interaction:update",{event:t,isDragging:!0,isDraggingKeyboard:!0})}})),r(this,"keyboardEnd",(function(e){var t=e.event,n=e.key;i._keyboardDrag&&i._dragKeysFlat.includes(n)&&i.DS.SelectedSet.size&&i._draggability&&i.DS.publish("Interaction:end",{event:t,isDragging:i._draggability,isDraggingKeyboard:!0})})),r(this,"start",(function(e){var t=e.isDragging,n=e.isDraggingKeyboard;t&&!n&&(i._prevCursorPos=null,i._prevScrollPos=null,i._elements=i.DS.getSelection(),i.handleZIndex(!0))})),r(this,"stop",(function(e){null!=e&&e.isKeyboard||(i._prevCursorPos=null,i._prevScrollPos=null,i.handleZIndex(!1),i._elements=[])})),r(this,"update",(function(e){var t=e.isDragging,n=e.isDraggingKeyboard;if(t&&i._elements.length&&!n&&!i.DS.continue){var r=b(i._cursorDiff,"+",i._scrollDiff);i._elements.forEach((function(e){return D({element:e,posDirection:r,containerRect:i.DS.SelectorArea.rect,useTransform:i._useTransform})}))}})),r(this,"handleZIndex",(function(e){i._elements.forEach((function(t){return t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)+e?9999:-9998)}))})),this.DS=o,this._useTransform=c,this._keyboardDragSpeed=u,this._keyboardDrag=l,this._zoom=d,this._draggability=s,this._dragKeys={up:a.up.map((function(e){return e.toLowerCase()})),down:a.down.map((function(e){return e.toLowerCase()})),left:a.left.map((function(e){return e.toLowerCase()})),right:a.right.map((function(e){return e.toLowerCase()}))},this._dragKeysFlat=[].concat(m(this._dragKeys.up),m(this._dragKeys.down),m(this._dragKeys.left),m(this._dragKeys.right)),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("KeyStore:down",this.keyboardDrag),this.DS.subscribe("KeyStore:up",this.keyboardEnd)}return n(t,[{key:"_cursorDiff",get:function(){var e=this.DS.stores.PointerStore.currentVal,t=this._prevCursorPos?b(e,"-",this._prevCursorPos):{x:0,y:0};return this._prevCursorPos=e,t}},{key:"_scrollDiff",get:function(){var e=this.DS.stores.ScrollStore.currentVal,t=this._prevScrollPos?b(e,"-",this._prevScrollPos):{x:0,y:0};return this._prevScrollPos=e,t}}]),t}(),P=function(){function t(n){var i=this,o=n.areaElement,a=n.DS,s=n.draggability,l=n.immediateDrag;e(this,t),r(this,"_areaElement",void 0),r(this,"_draggability",void 0),r(this,"_immediateDrag",void 0),r(this,"isInteracting",void 0),r(this,"isDragging",void 0),r(this,"init",(function(){i.stop(),i._areaElement.addEventListener("mousedown",i.start),i._areaElement.addEventListener("touchstart",i.start,{passive:!1}),i.DS.publish("Interaction:init",{})})),r(this,"start",(function(e){"touchstart"===e.type&&e.preventDefault(),i._canInteract(e)&&(i.isInteracting=!0,i.isDragging=i.isDragEvent(e),i.DS.publish("Interaction:start",{event:e,isDragging:i.isDragging}),document.addEventListener("mouseup",i.reset),document.addEventListener("touchend",i.reset))})),r(this,"isDragEvent",(function(e){return!(!i._draggability||i.DS.stores.KeyStore.isMultiSelectKeyPressed(e)||!i.DS.SelectableSet.has(e.target)||(i._immediateDrag&&(i.DS.SelectedSet.size?i.DS.SelectedSet.has(e.target)||(i.DS.SelectedSet.clear(),i.DS.SelectedSet.add(e.target)):i.DS.SelectedSet.add(e.target)),!i.DS.SelectedSet.has(e.target)))})),r(this,"onClick",(function(e){var t=e.event;if(i._canInteract(t)&&!(t.detail>0)){var n=i.DS,r=n.stores,o=r.PointerStore,a=r.KeyStore,s=n.SelectableSet,l=n.SelectedSet,u=n.publish;o.start(t);var c=t.target;s.has(c)&&(a.isMultiSelectKeyPressed(t)||l.clear(),l.toggle(c),u("Interaction:end",{event:t,isDragging:i.isDragging}))}})),r(this,"stop",(function(){i.isInteracting=!1,i.isDragging=!1,i._areaElement.removeEventListener("mousedown",i.start),i._areaElement.removeEventListener("touchstart",i.start,{passive:!1}),document.removeEventListener("mouseup",i.reset),document.removeEventListener("touchend",i.reset)})),r(this,"update",(function(e){var t=e.event,n=e.scroll_directions,r=e.scroll_multiplier;i.isInteracting&&i.DS.publish("Interaction:update",{event:t,scroll_directions:n,scroll_multiplier:r,isDragging:i.isDragging})})),r(this,"reset",(function(e){var t=i.isDragging;i.stop(),i.init(),i.DS.publish("Interaction:end",{event:e,isDragging:t})})),this._areaElement=o,this._draggability=s,this._immediateDrag=l,this.DS=a,this.DS.subscribe("PointerStore:updated",this.update),this.DS.subscribe("Selectable:click",this.onClick),this.DS.subscribe("Selectable:pointer",(function(e){var t=e.event;return i.start(t)})),this.DS.subscribe("Area:scroll",this.update)}return n(t,[{key:"_canInteract",value:function(e){return!(2===e.button||this.isInteracting||e.target&&!this.DS.SelectorArea.isInside(e.target))}}]),t}(),z=function t(){var n=this;e(this,t),r(this,"subscribers",{}),r(this,"subscribe",(function(e,t){return Array.isArray(n.subscribers[e])||(n.subscribers[e]=[]),n.subscribers[e].push(t),n.subscribers[e].length-1})),r(this,"unsubscribe",(function(e,t,r){r>=0?n.subscribers[e].splice(r,1):t&&(n.subscribers[e]=n.subscribers[e].filter((function(e){return e!==t})))})),r(this,"publish",(function(e,t){var r,i;Array.isArray(n.subscribers[e])&&(null===(r=n.subscribers["".concat(e,":pre")])||void 0===r||r.forEach((function(e){return e(t)})),null===(i=n.subscribers[e])||void 0===i||i.forEach((function(e){return e(t)})))}))},R=function(t){o(s,t);var i=f(s);function s(t){var n,o=t.elements,a=t.className,l=t.hoverClassName,u=t.draggability,c=t.useTransform,h=t.DS;return e(this,s),r(d(n=i.call(this)),"_initElements",void 0),r(d(n),"_className",void 0),r(d(n),"_hoverClassName",void 0),r(d(n),"_useTransform",void 0),r(d(n),"_draggability",void 0),r(d(n),"init",(function(){return n._initElements.forEach((function(e){return n.add(e)}))})),r(d(n),"clear",(function(){return n.forEach((function(e){return n.delete(e)}))})),r(d(n),"_onClick",(function(e){return n.DS.publish("Selectable:click",{event:e})})),r(d(n),"_onPointer",(function(e){return n.DS.publish("Selectable:pointer",{event:e})})),r(d(n),"addAll",(function(e){return e.forEach((function(e){return n.add(e)}))})),r(d(n),"deleteAll",(function(e){return e.forEach((function(e){return n.delete(e)}))})),n.DS=h,n._initElements=L(o),n._className=a,n._hoverClassName=l,n._useTransform=c,n._draggability=u,n.DS.subscribe("Interaction:init",n.init),n}return n(s,[{key:"add",value:function(e){return e.classList.add(this._className),e.addEventListener("click",this._onClick),e.addEventListener("mousedown",this._onPointer),e.addEventListener("touchstart",this._onPointer,{passive:!1}),this._draggability&&!this._useTransform&&N({computedStyle:window.getComputedStyle(e),node:e}),p(a(s.prototype),"add",this).call(this,e)}},{key:"delete",value:function(e){return e.classList.remove(this._className),e.classList.remove(this._hoverClassName),e.removeEventListener("click",this._onClick),e.removeEventListener("mousedown",this._onPointer),e.removeEventListener("touchstart",this._onPointer,{passive:!1}),p(a(s.prototype),"delete",this).call(this,e)}},{key:"elements",get:function(){return Array.from(this.values())}}]),s}(c(Set)),H=function(t){o(s,t);var i=f(s);function s(t){var n,o=t.className,a=t.DS;return e(this,s),r(d(n=i.call(this)),"_className",void 0),r(d(n),"clear",(function(){return n.forEach((function(e){return n.delete(e)}))})),r(d(n),"addAll",(function(e){return e.forEach((function(e){return n.add(e)}))})),r(d(n),"deleteAll",(function(e){return e.forEach((function(e){return n.delete(e)}))})),n.DS=a,n._className=o,n}return n(s,[{key:"add",value:function(e){if(!p(a(s.prototype),"has",this).call(this,e))return p(a(s.prototype),"add",this).call(this,e),e.classList.add(this._className),this.DS.publish("Selected:added",{items:this.elements,item:e}),e.style.zIndex="".concat((parseInt(e.style.zIndex)||0)+1),this}},{key:"delete",value:function(e){if(p(a(s.prototype),"has",this).call(this,e)){var t=p(a(s.prototype),"delete",this).call(this,e);return e.classList.remove(this._className),this.DS.publish("Selected:removed",{items:this.elements,item:e}),e.style.zIndex="".concat((parseInt(e.style.zIndex)||0)-1),t}}},{key:"toggle",value:function(e){return this.has(e)?this.delete(e):this.add(e),e}},{key:"elements",get:function(){return Array.from(this.values())}}]),s}(c(Set)),U=function(){function t(n){var i=this,o=n.DS,a=n.hoverClassName,s=n.multiSelectToggling;e(this,t),r(this,"_prevSelectedSet",void 0),r(this,"_hoverClassName",void 0),r(this,"_multiSelectToggling",void 0),r(this,"start",(function(e){var t=e.event;e.isDragging||(i._storePrevious(t),i._handleInsideSelection(!0,t))})),r(this,"update",(function(e){e.isDragging||i.DS.continue||i._handleInsideSelection()})),r(this,"_handleInsideSelection",(function(e,t){for(var n=i.DS,r=n.SelectableSet,o=n.SelectorArea,a=n.Selector,s=r.elements.map((function(e){return[e,e.getBoundingClientRect()]})),l=[],u=[],c=0,d=s.length;c<d;c++)o.isInside(s[c][0],s[c][1])&&(M(s[c][1],a.rect)?l.push(s[c][0]):u.push(s[c][0]));var h=i.DS.stores.KeyStore.isMultiSelectKeyPressed(t)&&i._multiSelectToggling;l.forEach((function(t){return function(e){var t=e.element,n=e.force,r=e.multiSelectionToggle,i=e.SelectedSet,o=e.hoverClassName;t.classList.contains(o)&&!n||(i.has(t)?r&&i.delete(t):i.add(t),t.classList.add(o))}({element:t,force:e,multiSelectionToggle:h,SelectedSet:i.DS.SelectedSet,hoverClassName:i._hoverClassName})})),u.forEach((function(t){return function(e){var t=e.element,n=e.force,r=e.SelectedSet,i=e.PrevSelectedSet,o=e.hoverClassName;if(!t.classList.contains(o)&&!n)return!1;var a=r.has(t),s=i.has(t);a&&!s?r.delete(t):!a&&s&&r.add(t),t.classList.remove(o)}({element:t,force:e,SelectedSet:i.DS.SelectedSet,hoverClassName:i._hoverClassName,PrevSelectedSet:i._prevSelectedSet})}))})),this._hoverClassName=a,this._multiSelectToggling=s,this.DS=o,this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update)}return n(t,[{key:"_storePrevious",value:function(e){var t=this.DS,n=t.stores.KeyStore,r=t.SelectedSet;n.isMultiSelectKeyPressed(e)?this._prevSelectedSet=new Set(r):this._prevSelectedSet=new Set}}]),t}(),V=function(){function t(n){var i=this,o=n.DS,a=n.selector,s=n.selectorClass,l=n.customStyles;e(this,t),r(this,"_rect",void 0),r(this,"start",(function(e){if(!e.isDragging){var t=i.DS.stores.PointerStore.initialValArea;j(i.HTMLNode,x(t,1)),i.HTMLNode.style.display="block",i._rect=null}})),r(this,"stop",(function(){i.HTMLNode.style.width="0",i.HTMLNode.style.height="0",i.HTMLNode.style.display="none"})),r(this,"update",(function(e){if(!e.isDragging&&!i.DS.continue){var t=i.DS.stores,n=t.ScrollStore,r=t.PointerStore,o=function(e){var t=e.scrollAmount,n=e.initialPointerPos,r=e.pointerPos,i={};return r.x>n.x-t.x?(i.left=n.x-t.x,i.width=r.x-n.x+t.x):(i.left=r.x,i.width=n.x-r.x-t.x),r.y>n.y-t.y?(i.top=n.y-t.y,i.height=r.y-n.y+t.y):(i.top=r.y,i.height=n.y-r.y-t.y),i}({scrollAmount:n.scrollAmount,initialPointerPos:r.initialValArea,pointerPos:r.currentValArea});j(i.HTMLNode,o),i._rect=null}})),this.DS=o,this.HTMLNode=a||function(e){var t=document.createElement("div");return t.style.position="absolute",e||(t.style.background="rgba(0, 0, 255, 0.1)",t.style.border="1px solid rgba(0, 0, 255, 0.45)",t.style.display="none",t.style.pointerEvents="none"),t}(l),this.HTMLNode.classList.add(s),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("Interaction:end",this.stop)}return n(t,[{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),t}(),q=function(){function t(n){var i=this,o=n.DS,a=n.selectorAreaClass,s=n.autoScrollSpeed,l=n.overflowTolerance;e(this,t),r(this,"_autoScrollSpeed",void 0),r(this,"_scrollInterval",void 0),r(this,"_rect",void 0),r(this,"currentEdges",[]),r(this,"_overflowTolerance",void 0),r(this,"start",(function(){return i.applyElements("append")})),r(this,"applyElements",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"append",t=document.body?"body":"documentElement",n="".concat(e,"Child");i.HTMLNode[n](i.DS.Selector.HTMLNode),document[t][n](i.HTMLNode)})),r(this,"updatePos",(function(){i._rect=null;var e=i.DS.Area.rect,t=i.DS.Area.computedBorder,n=i.HTMLNode.style,r="".concat(e.top+t.top,"px"),o="".concat(e.left+t.left,"px"),a="".concat(e.width,"px"),s="".concat(e.height,"px");n.top!==r&&(n.top=r),n.left!==o&&(n.left=o),n.width!==a&&(n.width=a),n.height!==s&&(n.height=s)})),r(this,"stop",(function(e){i.stopAutoScroll(),e&&i.applyElements("remove")})),r(this,"startAutoScroll",(function(){i.currentEdges=[],i._scrollInterval=setInterval((function(){return i.handleAutoScroll()}),16)})),r(this,"handleAutoScroll",(function(){if(!i.DS.continue){var e=i.DS,t=e.stores.PointerStore,n=e.Area;i.currentEdges=S({elementRect:x(t.currentVal),containerRect:i.rect,tolerance:i._overflowTolerance}),i.currentEdges.length&&n.scroll(i.currentEdges,i._autoScrollSpeed)}})),r(this,"stopAutoScroll",(function(){i.currentEdges=[],clearInterval(i._scrollInterval)})),r(this,"isInside",(function(e,t){return!(!i.DS.Area.HTMLNode.contains(e)||!i.DS.stores.ScrollStore.canScroll)||M(i.rect,t||e.getBoundingClientRect())})),this._autoScrollSpeed=s,this._overflowTolerance=l,this.DS=o,this.HTMLNode=function(e){var t=document.createElement("div");return t.style.position="fixed",t.style.overflow="hidden",t.style.pointerEvents="none",t.style.zIndex="999999999999999999",t.classList.add(e),t}(a),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Interaction:init",this.start),this.DS.subscribe("Interaction:start",this.startAutoScroll),this.DS.subscribe("Interaction:end",(function(){i.updatePos(),i.stopAutoScroll()}))}return n(t,[{key:"isClicked",value:function(){var e=this.DS.stores.PointerStore;return M({left:e.initialVal.x,top:e.initialVal.y,right:e.initialVal.x,bottom:e.initialVal.y},this.rect)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),t}(),$=function(){function t(n){var i=this,o=n.DS,a=n.multiSelectKeys,s=n.multiSelectMode;e(this,t),r(this,"_multiSelectMode",void 0),r(this,"_multiSelectKeys",void 0),r(this,"_currentValues",new Set),r(this,"_keyMapping",{control:"ctrlKey",shift:"shiftKey",meta:"metaKey"}),r(this,"init",(function(){document.addEventListener("keydown",i.keydown),document.addEventListener("keyup",i.keyup),window.addEventListener("blur",i.reset)})),r(this,"keydown",(function(e){var t=e.key.toLowerCase();i._currentValues.add(t),i.DS.publish("KeyStore:down",{event:e,key:t})})),r(this,"keyup",(function(e){var t=e.key.toLowerCase();i._currentValues.delete(t),i.DS.publish("KeyStore:up",{event:e,key:t})})),r(this,"stop",(function(){document.removeEventListener("keydown",i.keydown),document.removeEventListener("keyup",i.reset),window.removeEventListener("blur",i.reset),i.reset()})),r(this,"reset",(function(){return i._currentValues.clear()})),this.DS=o,this._multiSelectMode=s,this._multiSelectKeys=a.map((function(e){var t={ctrlKey:"Control",shiftKey:"Shift",metaKey:"Meta"}[e];return t?(console.warn("[DragSelect] ".concat(e,' is deprecated. Use "').concat(t,'" instead. Act Now!. See docs for more info')),t.toLowerCase()):e.toLowerCase()})),this.DS.subscribe("Interaction:init",this.init)}return n(t,[{key:"isMultiSelectKeyPressed",value:function(e){var t=this;return!!this._multiSelectMode||!!this.currentValues.some((function(e){return t._multiSelectKeys.includes(e)}))||!(!e||!this._multiSelectKeys.some((function(n){return e[t._keyMapping[n]]})))}},{key:"currentValues",get:function(){return Array.from(this._currentValues.values())}}]),t}(),F=function(){function t(n){var i=this,o=n.DS;e(this,t),r(this,"_isMouseInteraction",!1),r(this,"_initialValArea",void 0),r(this,"_currentValArea",void 0),r(this,"_lastValArea",void 0),r(this,"_initialVal",void 0),r(this,"_currentVal",void 0),r(this,"_lastVal",void 0),r(this,"_lastTouch",void 0),r(this,"init",(function(){document.addEventListener("mousemove",i.update),document.addEventListener("touchmove",i.update,{passive:!1})})),r(this,"update",(function(e){e&&(i.currentVal=T({event:i._normalizedEvent(e)}),i._isMouseInteraction&&i.DS.publish("PointerStore:updated",{event:e}))})),r(this,"stop",(function(){document.removeEventListener("mousemove",i.update),document.removeEventListener("touchmove",i.update,{passive:!1}),setTimeout((function(){return i._isMouseInteraction=!1}),100)})),r(this,"reset",(function(e){e&&(i.currentVal=i.lastVal=T({event:i._normalizedEvent(e)}),i.stop(),i.init())})),this.DS=o,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(e){var t=e.event;return i.start(t)})),this.DS.subscribe("Interaction:end",(function(e){var t=e.event;return i.reset(t)}))}return n(t,[{key:"start",value:function(e){e&&(this._isMouseInteraction=!0,this.currentVal=this.initialVal=T({event:this._normalizedEvent(e)}))}},{key:"_normalizedEvent",value:function(e){return"touches"in e&&"touchend"!==e.type&&(this._lastTouch=e),"touches"in e?this._lastTouch.touches[0]:e}},{key:"initialValArea",get:function(){return this._initialValArea?this._initialValArea:{x:0,y:0}}},{key:"currentValArea",get:function(){return this._currentValArea?this._currentValArea:{x:0,y:0}}},{key:"lastValArea",get:function(){return this._lastValArea?this._lastValArea:{x:0,y:0}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}},set:function(e){this._initialVal=e,this._initialValArea=e&&b(e,"-",b(_(this.DS.Area.rect),"+",_(this.DS.Area.computedBorder)))}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}},set:function(e){this._currentVal=e,this._currentValArea=e&&b(e,"-",b(_(this.DS.Area.rect),"+",_(this.DS.Area.computedBorder)))}},{key:"lastVal",get:function(){return this._lastVal?this._lastVal:{x:0,y:0}},set:function(e){this._lastVal=e,this._lastValArea=e&&b(e,"-",b(_(this.DS.Area.rect),"+",_(this.DS.Area.computedBorder)))}}]),t}(),Y=function(){function t(n){var i=this,o=n.DS,a=n.areaElement,s=n.zoom;e(this,t),r(this,"_initialVal",void 0),r(this,"_currentVal",void 0),r(this,"_areaElement",void 0),r(this,"_canScroll",void 0),r(this,"init",(function(){return i._areaElement.addEventListener("scroll",i.update)})),r(this,"start",(function(){i._currentVal=i._initialVal=E(i._areaElement),i._areaElement.addEventListener("scroll",i.update)})),r(this,"update",(function(){return i._currentVal=E(i._areaElement)})),r(this,"stop",(function(){i._areaElement.removeEventListener("scroll",i.update),i._initialVal={x:0,y:0},i._canScroll=null})),r(this,"reset",(function(){i.stop(),i.start()})),this._areaElement=a,this.DS=o,this.zoom=s,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(){return i.start()})),this.DS.subscribe("Interaction:end",(function(){return i.reset()}))}return n(t,[{key:"canScroll",get:function(){return"boolean"==typeof this._canScroll?this._canScroll:this._canScroll=(e=this._areaElement,!!((t=E(e)).x||t.y||(e instanceof HTMLDocument?e.body?e.body.scrollTop=1:e.documentElement.scrollTop=1:e.scrollTop=1)));var e,t}},{key:"scrollAmount",get:function(){var e,t=b(this.currentVal,"-",this.initialVal),n={x:e=this.zoom,y:e},r=b(b(t,"*",n),"-",t);return{x:t.x+r.x,y:t.y+r.y}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}}},{key:"currentVal",get:function(){return this._currentVal||(this._currentVal=E(this._areaElement)),this._currentVal}}]),t}(),W=function(){function t(n){var i=this,o=n.area,a=void 0===o?document:o,s=n.selectables,l=void 0===s?[]:s,u=n.autoScrollSpeed,c=void 0===u?5:u,d=n.overflowTolerance,h=void 0===d?{x:25,y:25}:d,f=n.zoom,p=void 0===f?1:f,g=n.customStyles,m=void 0!==g&&g,v=n.multiSelectMode,y=void 0!==v&&v,b=n.multiSelectToggling,_=void 0===b||b,x=n.multiSelectKeys,w=void 0===x?["Control","Shift","Meta"]:x,E=n.selector,S=void 0===E?void 0:E,T=n.draggability,k=void 0===T||T,A=n.immediateDrag,N=void 0===A||A,M=n.keyboardDrag,D=void 0===M||M,C=n.dragKeys,L=n.keyboardDragSpeed,j=void 0===L?10:L,W=n.useTransform,K=void 0===W||W,Q=n.hoverClass,X=void 0===Q?"ds-hover":Q,G=n.selectableClass,Z=void 0===G?"ds-selectable":G,J=n.selectedClass,ee=void 0===J?"ds-selected":J,te=n.selectorClass,ne=void 0===te?"ds-selector":te,re=n.selectorAreaClass,ie=void 0===re?"ds-selector-area":re,oe=n.callback,ae=n.onDragMove,se=n.onDragStartBegin,le=n.onDragStart,ue=n.onElementSelect,ce=n.onElementUnselect;e(this,t),r(this,"continue",!1),r(this,"start",(function(){return i.Interaction.init()})),r(this,"break",(function(){return i.continue=!0})),r(this,"getSelection",(function(){return i.SelectedSet.elements})),r(this,"getSelectables",(function(){return i.SelectableSet.elements})),r(this,"getInitialCursorPosition",(function(){return i.stores.PointerStore.initialVal})),r(this,"getCurrentCursorPosition",(function(){return i.stores.PointerStore.currentVal})),r(this,"getPreviousCursorPosition",(function(){return i.stores.PointerStore.lastVal})),r(this,"getInitialCursorPositionArea",(function(){return i.stores.PointerStore.initialValArea})),r(this,"getCurrentCursorPositionArea",(function(){return i.stores.PointerStore.currentValArea})),r(this,"getPreviousCursorPositionArea",(function(){return i.stores.PointerStore.lastValArea})),r(this,"isMultiSelect",(function(e){return i.stores.KeyStore.isMultiSelectKeyPressed(e)})),r(this,"isDragging",(function(){return i.Interaction.isDragging})),this.PubSub=new z,this.subscribe=this.PubSub.subscribe,this.unsubscribe=this.PubSub.unsubscribe,this.publish=this.PubSub.publish,this._callbacksTemp({callback:oe,onDragMove:ae,onDragStart:le,onDragStartBegin:se,onElementSelect:ue,onElementUnselect:ce}),this.stores={PointerStore:new F({DS:this}),ScrollStore:new Y({DS:this,areaElement:a,zoom:p}),KeyStore:new $({DS:this,multiSelectKeys:w,multiSelectMode:y})},this.Area=new O({area:a,PS:this.PubSub,zoom:p}),this.Selector=new V({DS:this,selector:S,selectorClass:ne,customStyles:m}),this.SelectorArea=new q({DS:this,selectorAreaClass:ie,autoScrollSpeed:c,overflowTolerance:h}),this.SelectableSet=new R({elements:l,DS:this,className:Z,hoverClassName:X,useTransform:K,draggability:k}),this.SelectedSet=new H({DS:this,className:ee}),this.Selection=new U({DS:this,hoverClassName:X,multiSelectToggling:_}),this.Drag=new B({DS:this,draggability:k,useTransform:K,keyboardDrag:D,dragKeys:Object.assign({up:["ArrowUp"],down:["ArrowDown"],left:["ArrowLeft"],right:["ArrowRight"]},C),zoom:p,keyboardDragSpeed:j}),this.Interaction=new P({areaElement:a,DS:this,draggability:k,immediateDrag:N}),I({subscribe:this.subscribe,publish:this.publish,SelectedSet:this.SelectedSet,Interaction:this.Interaction}),this.subscribe("Interaction:end",(function(){return i.continue=!1})),this.start()}return n(t,[{key:"_callbacksTemp",value:function(e){var t=e.callback,n=e.onDragMove,r=e.onDragStart,i=e.onDragStartBegin,o=e.onElementSelect,a=e.onElementUnselect,s=function(e,t){return console.warn("[DragSelect] ".concat(e,' is deprecated. Use DragSelect.subscribe("').concat(t,'", (callbackObject) => {}) instead. Act Now! See docs for more info'))};t&&(s("callback","callback"),this.subscribe("callback",(function(e){var n=e.items,r=(e.item,e.event);return t(n,r)}))),n&&(s("onDragMove","dragmove"),this.subscribe("dragmove",(function(e){e.items,e.item;var t=e.event;return n(t)}))),r&&(s("onDragStart","dragstart"),this.subscribe("dragstart",(function(e){e.items,e.item;var t=e.event;return r(t)}))),i&&(s("onDragStartBegin","dragstart"),this.subscribe("dragstart",(function(e){e.items,e.item;var t=e.event;return i(t)}))),o&&(s("onElementSelect","elementselect"),this.subscribe("elementselect",(function(e){e.items;var t=e.item,n=e.event;return o(t,n)}))),a&&(s("onElementUnselect","elementunselect"),this.subscribe("elementunselect",(function(e){e.items;var t=e.item,n=e.event;return a(t,n)})))}},{key:"stop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.publish("callback",{items:this.getSelection()}),this.Interaction.stop(),this.Area.stop(),this.Drag.stop(),this.Selector.stop(),this.SelectorArea.stop(e),this.stores.KeyStore.stop(),this.stores.PointerStore.stop(),this.stores.ScrollStore.stop(),e&&this.SelectableSet.clear(),t&&this.SelectedSet.clear()}},{key:"addSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.SelectedSet.addAll(L(e)),n||this.addSelectables(e),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"removeSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.SelectedSet.deleteAll(L(e)),n&&this.removeSelectables(e),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"toggleSelection",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return L(e).forEach((function(i){return t.SelectedSet.has(i)?t.removeSelection(e,n,r):t.addSelection(e,n,r)})),n&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"setSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.clearSelection(),this.addSelection(e,t,n),this.getSelection()}},{key:"clearSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.SelectedSet.clear(),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"addSelectables",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=L(e);return this.SelectableSet.addAll(n),t&&this.SelectedSet.addAll(n),e}},{key:"setSelectables",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.removeSelectables(e,t),this.addSelectables(e,n)}},{key:"removeSelectables",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.SelectableSet.deleteAll(L(e)),t&&this.removeSelection(e),e}},{key:"getCursorPositionDifference",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.warn("[DragSelect] Using .getCursorPositionDifference is deprecated. Calculate yourself instead. i.e. `.getCurrentCursorPosition().x - .getInitialCursorPosition().x`");var n=t?this.getCurrentCursorPositionArea():this.getCurrentCursorPosition(),r=e?t?this.getPreviousCursorPositionArea():this.getPreviousCursorPosition():t?this.getInitialCursorPositionArea():this.getInitialCursorPosition();return b(n,"-",r)}}]),t}();return W}()},865:(e,t,n)=>{var r=n(755),i=n(672);void 0===i.$&&(i.$=r),void 0===i.jQuery&&(i.jQuery=r),e.exports=r},803:(e,t,n)=>{var r=n(36),i=n(672),o=r.action_conf;void 0===i.action_conf&&(i.action_conf=o),e.exports=r},359:(e,t,n)=>{var r=n(36),i=n(672),o=r.combo_conf;void 0===i.combo_conf&&(i.combo_conf=o),e.exports=r},787:(e,t,n)=>{var r=n(36),i=n(672),o=r.custom_conf;void 0===i.custom_conf&&(i.custom_conf=o),e.exports=r},360:(e,t,n)=>{var r=n(36),i=n(672),o=r.meta_conf;void 0===i.meta_conf&&(i.meta_conf=o),e.exports=r},863:(e,t,n)=>{var r=n(36),i=n(672),o=r.meta_full_conf;void 0===i.meta_full_conf&&(i.meta_full_conf=o),e.exports=r},83:(e,t,n)=>{var r=n(36),i=n(672),o=r.navigation_conf;void 0===i.navigation_conf&&(i.navigation_conf=o),e.exports=r},879:(e,t,n)=>{var r=n(624),i=n(672),o=r.relation_get_notes_separated;void 0===i.relation_get_notes_separated&&(i.relation_get_notes_separated=o),e.exports=r},121:(e,t,n)=>{var r=n(624),i=n(672),o=r.relation_get_notes;void 0===i.relation_get_notes&&(i.relation_get_notes=o),e.exports=r},944:(e,t,n)=>{var r=n(36),i=n(672),o=r.type_conf;void 0===i.type_conf&&(i.type_conf=o),e.exports=r},480:(e,t,n)=>{var r=n(36),i=n(672),o=r.type_full_conf;void 0===i.type_full_conf&&(i.type_full_conf=o),e.exports=r},672:(e,t,n)=>{"use strict";e.exports=function(){if("object"==typeof globalThis)return globalThis;var e;try{e=this||new Function("return this")()}catch(e){if("object"==typeof window)return window;if("object"==typeof self)return self;if(void 0!==n.g)return n.g}return e}()},755:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(r,i){"use strict";var o=[],a=Object.getPrototypeOf,s=o.slice,l=o.flat?function(e){return o.flat.call(e)}:function(e){return o.concat.apply([],e)},u=o.push,c=o.indexOf,d={},h=d.toString,f=d.hasOwnProperty,p=f.toString,g=p.call(Object),m={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},b=r.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function x(e,t,n){var r,i,o=(n=n||b).createElement("script");if(o.text=e,t)for(r in _)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?d[h.call(e)]||"object":typeof e}var E="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function T(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}S.fn=S.prototype={jquery:E,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(e){return this.pushStack(S.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(S.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:o.sort,splice:o.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(u&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(u,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(E+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==h.call(e)||(t=a(e))&&("function"!=typeof(n=f.call(t,"constructor")&&t.constructor)||p.call(n)!==g))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){x(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(T(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(T(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:c.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(T(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return l(a)},guid:1,support:m}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=o[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){d["[object "+t+"]"]=t.toLowerCase()}));var k=function(e){var t,n,r,i,o,a,s,l,u,c,d,h,f,p,g,m,v,y,b,_="sizzle"+1*new Date,x=e.document,w=0,E=0,S=le(),T=le(),k=le(),A=le(),N=function(e,t){return e===t&&(d=!0),0},M={}.hasOwnProperty,D=[],C=D.pop,I=D.push,L=D.push,j=D.slice,O=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",z="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",R="\\[[\\x20\\t\\r\\n\\f]*("+z+")(?:"+P+"*([*^$|!~]?=)"+P+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+z+"))|)"+P+"*\\]",H=":("+z+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|.*)\\)|)",U=new RegExp(P+"+","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),q=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),$=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),F=new RegExp(P+"|>"),Y=new RegExp(H),W=new RegExp("^"+z+"$"),K={ID:new RegExp("^#("+z+")"),CLASS:new RegExp("^\\.("+z+")"),TAG:new RegExp("^("+z+"|[*])"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Q=/HTML$/i,X=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){h()},ae=_e((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{L.apply(D=j.call(x.childNodes),x.childNodes),D[x.childNodes.length].nodeType}catch(e){L={apply:D.length?function(e,t){I.apply(e,j.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(e,t,r,i){var o,s,u,c,d,p,v,y=t&&t.ownerDocument,x=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==x&&9!==x&&11!==x)return r;if(!i&&(h(t),t=t||f,g)){if(11!==x&&(d=J.exec(e)))if(o=d[1]){if(9===x){if(!(u=t.getElementById(o)))return r;if(u.id===o)return r.push(u),r}else if(y&&(u=y.getElementById(o))&&b(t,u)&&u.id===o)return r.push(u),r}else{if(d[2])return L.apply(r,t.getElementsByTagName(e)),r;if((o=d[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!A[e+" "]&&(!m||!m.test(e))&&(1!==x||"object"!==t.nodeName.toLowerCase())){if(v=e,y=t,1===x&&(F.test(e)||$.test(e))){for((y=ee.test(e)&&ve(t.parentNode)||t)===t&&n.scope||((c=t.getAttribute("id"))?c=c.replace(re,ie):t.setAttribute("id",c=_)),s=(p=a(e)).length;s--;)p[s]=(c?"#"+c:":scope")+" "+be(p[s]);v=p.join(",")}try{return L.apply(r,y.querySelectorAll(v)),r}catch(t){A(e,!0)}finally{c===_&&t.removeAttribute("id")}}}return l(e.replace(V,"$1"),t,r,i)}function le(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function ue(e){return e[_]=!0,e}function ce(e){var t=f.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function de(e,t){for(var n=e.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=t}function he(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ae(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ue((function(t){return t=+t,ue((function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))}))}))}function ve(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},o=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Q.test(t||n&&n.nodeName||"HTML")},h=se.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:x;return a!=f&&9===a.nodeType&&a.documentElement?(p=(f=a).documentElement,g=!o(f),x!=f&&(i=f.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",oe,!1):i.attachEvent&&i.attachEvent("onunload",oe)),n.scope=ce((function(e){return p.appendChild(e).appendChild(f.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),n.attributes=ce((function(e){return e.className="i",!e.getAttribute("className")})),n.getElementsByTagName=ce((function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length})),n.getElementsByClassName=Z.test(f.getElementsByClassName),n.getById=ce((function(e){return p.appendChild(e).id=_,!f.getElementsByName||!f.getElementsByName(_).length})),n.getById?(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],m=[],(n.qsa=Z.test(f.querySelectorAll))&&(ce((function(e){var t;p.appendChild(e).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+B+")"),e.querySelectorAll("[id~="+_+"-]").length||m.push("~="),(t=f.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+_+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ce((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Z.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ce((function(e){n.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),v.push("!=",H)})),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=Z.test(p.compareDocumentPosition),b=t||Z.test(p.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},N=t?function(e,t){if(e===t)return d=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e==f||e.ownerDocument==x&&b(x,e)?-1:t==f||t.ownerDocument==x&&b(x,t)?1:c?O(c,e)-O(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return d=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==f?-1:t==f?1:i?-1:o?1:c?O(c,e)-O(c,t):0;if(i===o)return he(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?he(a[r],s[r]):a[r]==x?-1:s[r]==x?1:0},f):f},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(h(e),n.matchesSelector&&g&&!A[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){A(t,!0)}return se(t,f,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!=f&&h(e),b(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=f&&h(e);var i=r.attrHandle[t.toLowerCase()],o=i&&M.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,r=[],i=0,o=0;if(d=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(N),d){for(;t=e[o++];)t===e[o]&&(i=r.push(o));for(;i--;)e.splice(r[i],1)}return c=null,e},i=se.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},r=se.selectors={cacheLength:50,createPseudo:ue,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Y.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=S[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+P+"|$)"))&&S(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=se.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,h,f,p,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s,b=!1;if(m){if(o){for(;g;){for(h=t;h=h[g];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(b=(f=(u=(c=(d=(h=m)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===w&&u[1])&&u[2],h=f&&m.childNodes[f];h=++f&&h&&h[g]||(b=f=0)||p.pop();)if(1===h.nodeType&&++b&&h===t){c[e]=[w,f,b];break}}else if(y&&(b=f=(u=(c=(d=(h=t)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===w&&u[1]),!1===b)for(;(h=++f&&h&&h[g]||(b=f=0)||p.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++b||(y&&((c=(d=h[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]=[w,b]),h!==t)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return i[_]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ue((function(e,n){for(var r,o=i(e,t),a=o.length;a--;)e[r=O(e,o[a])]=!(n[r]=o[a])})):function(e){return i(e,0,n)}):i}},pseudos:{not:ue((function(e){var t=[],n=[],r=s(e.replace(V,"$1"));return r[_]?ue((function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))})):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}})),has:ue((function(e){return function(t){return se(e,t).length>0}})),contains:ue((function(e){return e=e.replace(te,ne),function(t){return(t.textContent||i(t)).indexOf(e)>-1}})),lang:ue((function(e){return W.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me((function(){return[0]})),last:me((function(e,t){return[t-1]})),eq:me((function(e,t,n){return[n<0?n+t:n]})),even:me((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:me((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:me((function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:me((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},r.pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pe(t);function ye(){}function be(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function _e(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=E++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,l){var u,c,d,h=[w,s];if(l){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,l))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(c=(d=t[_]||(t[_]={}))[t.uniqueID]||(d[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((u=c[o])&&u[0]===w&&u[1]===s)return h[2]=u[2];if(c[o]=h,h[2]=e(t,n,l))return!0}return!1}}function xe(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function we(e,t,n,r,i){for(var o,a=[],s=0,l=e.length,u=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),u&&t.push(s)));return a}function Ee(e,t,n,r,i,o){return r&&!r[_]&&(r=Ee(r)),i&&!i[_]&&(i=Ee(i,o)),ue((function(o,a,s,l){var u,c,d,h=[],f=[],p=a.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:we(g,h,e,s,l),v=n?i||(o?e:p||r)?[]:a:m;if(n&&n(m,v,s,l),r)for(u=we(v,f),r(u,[],s,l),c=u.length;c--;)(d=u[c])&&(v[f[c]]=!(m[f[c]]=d));if(o){if(i||e){if(i){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(m[c]=d);i(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&(u=i?O(o,d):h[c])>-1&&(o[u]=!(a[u]=d))}}else v=we(v===a?v.splice(p,v.length):v),i?i(null,a,v,l):L.apply(a,v)}))}function Se(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],l=a?1:0,c=_e((function(e){return e===t}),s,!0),d=_e((function(e){return O(t,e)>-1}),s,!0),h=[function(e,n,r){var i=!a&&(r||n!==u)||((t=n).nodeType?c(e,n,r):d(e,n,r));return t=null,i}];l<o;l++)if(n=r.relative[e[l].type])h=[_e(xe(h),n)];else{if((n=r.filter[e[l].type].apply(null,e[l].matches))[_]){for(i=++l;i<o&&!r.relative[e[i].type];i++);return Ee(l>1&&xe(h),l>1&&be(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(V,"$1"),n,l<i&&Se(e.slice(l,i)),i<o&&Se(e=e.slice(i)),i<o&&be(e))}h.push(n)}return xe(h)}return ye.prototype=r.filters=r.pseudos,r.setFilters=new ye,a=se.tokenize=function(e,t){var n,i,o,a,s,l,u,c=T[e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],u=r.preFilter;s;){for(a in n&&!(i=q.exec(s))||(i&&(s=s.slice(i[0].length)||s),l.push(o=[])),n=!1,(i=$.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(V," ")}),s=s.slice(n.length)),r.filter)!(i=K[a].exec(s))||u[a]&&!(i=u[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):T(e,l).slice(0)},s=se.compile=function(e,t){var n,i=[],o=[],s=k[e+" "];if(!s){for(t||(t=a(e)),n=t.length;n--;)(s=Se(t[n]))[_]?i.push(s):o.push(s);s=k(e,function(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,l,c){var d,p,m,v=0,y="0",b=o&&[],_=[],x=u,E=o||i&&r.find.TAG("*",c),S=w+=null==x?1:Math.random()||.1,T=E.length;for(c&&(u=a==f||a||c);y!==T&&null!=(d=E[y]);y++){if(i&&d){for(p=0,a||d.ownerDocument==f||(h(d),s=!g);m=e[p++];)if(m(d,a||f,s)){l.push(d);break}c&&(w=S)}n&&((d=!m&&d)&&v--,o&&b.push(d))}if(v+=y,n&&y!==v){for(p=0;m=t[p++];)m(b,_,a,s);if(o){if(v>0)for(;y--;)b[y]||_[y]||(_[y]=C.call(l));_=we(_)}L.apply(l,_),c&&!o&&_.length>0&&v+t.length>1&&se.uniqueSort(l)}return c&&(w=S,u=x),b};return n?ue(o):o}(o,i)),s.selector=e}return s},l=se.select=function(e,t,n,i){var o,l,u,c,d,h="function"==typeof e&&e,f=!i&&a(e=h.selector||e);if(n=n||[],1===f.length){if((l=f[0]=f[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===t.nodeType&&g&&r.relative[l[1].type]){if(!(t=(r.find.ID(u.matches[0].replace(te,ne),t)||[])[0]))return n;h&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(o=K.needsContext.test(e)?0:l.length;o--&&(u=l[o],!r.relative[c=u.type]);)if((d=r.find[c])&&(i=d(u.matches[0].replace(te,ne),ee.test(l[0].type)&&ve(t.parentNode)||t))){if(l.splice(o,1),!(e=i.length&&be(l)))return L.apply(n,i),n;break}}return(h||s(e,f))(i,t,!g,n,!t||ee.test(e)&&ve(t.parentNode)||t),n},n.sortStable=_.split("").sort(N).join("")===_,n.detectDuplicates=!!d,h(),n.sortDetached=ce((function(e){return 1&e.compareDocumentPosition(f.createElement("fieldset"))})),ce((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||de("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),n.attributes&&ce((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||de("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ce((function(e){return null==e.getAttribute("disabled")}))||de(B,(function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null})),se}(r);S.find=k,S.expr=k.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=k.uniqueSort,S.text=k.getText,S.isXMLDoc=k.isXML,S.contains=k.contains,S.escapeSelector=k.escape;var A=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},N=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},M=S.expr.match.needsContext;function D(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var C=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function I(e,t,n){return v(t)?S.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?S.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?S.grep(e,(function(e){return c.call(t,e)>-1!==n})):S.filter(t,e,n)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,(function(e){return 1===e.nodeType})))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter((function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return r>1?S.uniqueSort(n):n},filter:function(e){return this.pushStack(I(this,e||[],!1))},not:function(e){return this.pushStack(I(this,e||[],!0))},is:function(e){return!!I(this,"string"==typeof e&&M.test(e)?S(e):e||[],!1).length}});var L,j=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||L,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:j.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),C.test(r[1])&&S.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=b.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,L=S(b);var O=/^(?:parents|prev(?:Until|All))/,B={children:!0,contents:!0,next:!0,prev:!0};function P(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!M.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?c.call(S(e),this[0]):c.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return A(e,"parentNode")},parentsUntil:function(e,t,n){return A(e,"parentNode",n)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return A(e,"nextSibling")},prevAll:function(e){return A(e,"previousSibling")},nextUntil:function(e,t,n){return A(e,"nextSibling",n)},prevUntil:function(e,t,n){return A(e,"previousSibling",n)},siblings:function(e){return N((e.parentNode||{}).firstChild,e)},children:function(e){return N(e.firstChild)},contents:function(e){return null!=e.contentDocument&&a(e.contentDocument)?e.contentDocument:(D(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},(function(e,t){S.fn[e]=function(n,r){var i=S.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=S.filter(r,i)),this.length>1&&(B[e]||S.uniqueSort(i),O.test(e)&&i.reverse()),this.pushStack(i)}}));var z=/[^\x20\t\r\n\f]+/g;function R(e){return e}function H(e){throw e}function U(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return S.each(e.match(z)||[],(function(e,n){t[n]=!0})),t}(e):S.extend({},e);var t,n,r,i,o=[],a=[],s=-1,l=function(){for(i=i||e.once,r=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},u={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){S.each(n,(function(n,r){v(r)?e.unique&&u.has(r)||o.push(r):r&&r.length&&"string"!==w(r)&&t(r)}))}(arguments),n&&!t&&l()),this},remove:function(){return S.each(arguments,(function(e,t){for(var n;(n=S.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--})),this},has:function(e){return e?S.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},S.extend({Deferred:function(e){var t=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return S.Deferred((function(n){S.each(t,(function(t,r){var i=v(e[r[4]])&&e[r[4]];o[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&v(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,i){var o=0;function a(e,t,n,i){return function(){var s=this,l=arguments,u=function(){var r,u;if(!(e<o)){if((r=n.apply(s,l))===t.promise())throw new TypeError("Thenable self-resolution");u=r&&("object"==typeof r||"function"==typeof r)&&r.then,v(u)?i?u.call(r,a(o,t,R,i),a(o,t,H,i)):(o++,u.call(r,a(o,t,R,i),a(o,t,H,i),a(o,t,R,t.notifyWith))):(n!==R&&(s=void 0,l=[r]),(i||t.resolveWith)(s,l))}},c=i?u:function(){try{u()}catch(r){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(r,c.stackTrace),e+1>=o&&(n!==H&&(s=void 0,l=[r]),t.rejectWith(s,l))}};e?c():(S.Deferred.getStackHook&&(c.stackTrace=S.Deferred.getStackHook()),r.setTimeout(c))}}return S.Deferred((function(r){t[0][3].add(a(0,r,v(i)?i:R,r.notifyWith)),t[1][3].add(a(0,r,v(e)?e:R)),t[2][3].add(a(0,r,v(n)?n:H))})).promise()},promise:function(e){return null!=e?S.extend(e,i):i}},o={};return S.each(t,(function(e,r){var a=r[2],s=r[5];i[r[1]]=a.add,s&&a.add((function(){n=s}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),a.add(r[3].fire),o[r[0]]=function(){return o[r[0]+"With"](this===o?void 0:this,arguments),this},o[r[0]+"With"]=a.fireWith})),i.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=s.call(arguments),o=S.Deferred(),a=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?s.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(U(e,o.done(a(n)).resolve,o.reject,!t),"pending"===o.state()||v(i[n]&&i[n].then)))return o.then();for(;n--;)U(i[n],a(n),o.reject);return o.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){r.console&&r.console.warn&&e&&V.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){r.setTimeout((function(){throw e}))};var q=S.Deferred();function $(){b.removeEventListener("DOMContentLoaded",$),r.removeEventListener("load",$),S.ready()}S.fn.ready=function(e){return q.then(e).catch((function(e){S.readyException(e)})),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0,!0!==e&&--S.readyWait>0||q.resolveWith(b,[S]))}}),S.ready.then=q.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?r.setTimeout(S.ready):(b.addEventListener("DOMContentLoaded",$),r.addEventListener("load",$));var F=function(e,t,n,r,i,o,a){var s=0,l=e.length,u=null==n;if("object"===w(n))for(s in i=!0,n)F(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),u&&(a?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(S(e),n)})),t))for(;s<l;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:u?t.call(e):l?t(e[0],n):o},Y=/^-ms-/,W=/-([a-z])/g;function K(e,t){return t.toUpperCase()}function Q(e){return e.replace(Y,"ms-").replace(W,K)}var X=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},X(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[Q(t)]=n;else for(r in t)i[Q(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][Q(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(Q):(t=Q(t))in r?[t]:t.match(z)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Z=new G,J=new G,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function ne(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(n)}catch(e){}J.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return J.hasData(e)||Z.hasData(e)},data:function(e,t,n){return J.access(e,t,n)},removeData:function(e,t){J.remove(e,t)},_data:function(e,t,n){return Z.access(e,t,n)},_removeData:function(e,t){Z.remove(e,t)}}),S.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=J.get(o),1===o.nodeType&&!Z.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=Q(r.slice(5)),ne(o,r,i[r]));Z.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){J.set(this,e)})):F(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=J.get(o,e))||void 0!==(n=ne(o,e))?n:void 0;this.each((function(){J.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){J.remove(this,e)}))}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Z.get(e,t),n&&(!r||Array.isArray(n)?r=Z.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,(function(){S.dequeue(e,t)}),o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Z.get(e,n)||Z.access(e,n,{empty:S.Callbacks("once memory").add((function(){Z.remove(e,[t+"queue",n])}))})}}),S.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?S.queue(this[0],e):void 0===t?this:this.each((function(){var n=S.queue(this,e,t);S._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&S.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){S.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=Z.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=b.documentElement,se=function(e){return S.contains(e.ownerDocument,e)},le={composed:!0};ae.getRootNode&&(se=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(le)===e.ownerDocument});var ue=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&se(e)&&"none"===S.css(e,"display")};function ce(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},l=s(),u=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==u&&+l)&&ie.exec(S.css(e,t));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;a--;)S.style(e,t,c+u),(1-o)*(1-(o=s()/l||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+u),n=n||[]}return n&&(c=+c||+l||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=c,r.end=i)),i}var de={};function he(e){var t,n=e.ownerDocument,r=e.nodeName,i=de[r];return i||(t=n.body.appendChild(n.createElement(r)),i=S.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),de[r]=i,i)}function fe(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=Z.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ue(r)&&(i[o]=he(r))):"none"!==n&&(i[o]="none",Z.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}S.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ue(this)?S(this).show():S(this).hide()}))}});var pe,ge,me=/^(?:checkbox|radio)$/i,ve=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ye=/^$|^module$|\/(?:java|ecma)script/i;pe=b.createDocumentFragment().appendChild(b.createElement("div")),(ge=b.createElement("input")).setAttribute("type","radio"),ge.setAttribute("checked","checked"),ge.setAttribute("name","t"),pe.appendChild(ge),m.checkClone=pe.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!pe.cloneNode(!0).lastChild.defaultValue,pe.innerHTML="<option></option>",m.option=!!pe.lastChild;var be={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _e(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&D(e,t)?S.merge([e],n):n}function xe(e,t){for(var n=0,r=e.length;n<r;n++)Z.set(e[n],"globalEval",!t||Z.get(t[n],"globalEval"))}be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td,m.option||(be.optgroup=be.option=[1,"<select multiple='multiple'>","</select>"]);var we=/<|&#?\w+;/;function Ee(e,t,n,r,i){for(var o,a,s,l,u,c,d=t.createDocumentFragment(),h=[],f=0,p=e.length;f<p;f++)if((o=e[f])||0===o)if("object"===w(o))S.merge(h,o.nodeType?[o]:o);else if(we.test(o)){for(a=a||d.appendChild(t.createElement("div")),s=(ve.exec(o)||["",""])[1].toLowerCase(),l=be[s]||be._default,a.innerHTML=l[1]+S.htmlPrefilter(o)+l[2],c=l[0];c--;)a=a.lastChild;S.merge(h,a.childNodes),(a=d.firstChild).textContent=""}else h.push(t.createTextNode(o));for(d.textContent="",f=0;o=h[f++];)if(r&&S.inArray(o,r)>-1)i&&i.push(o);else if(u=se(o),a=_e(d.appendChild(o),"script"),u&&xe(a),n)for(c=0;o=a[c++];)ye.test(o.type||"")&&n.push(o);return d}var Se=/^([^.]*)(?:\.(.+)|)/;function Te(){return!0}function ke(){return!1}function Ae(e,t){return e===function(){try{return b.activeElement}catch(e){}}()==("focus"===t)}function Ne(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ne(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=ke;else if(!i)return e;return 1===o&&(a=i,i=function(e){return S().off(e),a.apply(this,arguments)},i.guid=a.guid||(a.guid=S.guid++)),e.each((function(){S.event.add(this,t,i,r,n)}))}function Me(e,t,n){n?(Z.set(e,t,!1),S.event.add(e,t,{namespace:!1,handler:function(e){var r,i,o=Z.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(S.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=s.call(arguments),Z.set(this,t,o),r=n(this,t),this[t](),o!==(i=Z.get(this,t))||r?Z.set(this,t,!1):i={},o!==i)return e.stopImmediatePropagation(),e.preventDefault(),i&&i.value}else o.length&&(Z.set(this,t,{value:S.event.trigger(S.extend(o[0],S.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Z.get(e,t)&&S.event.add(e,t,Te)}S.event={global:{},add:function(e,t,n,r,i){var o,a,s,l,u,c,d,h,f,p,g,m=Z.get(e);if(X(e))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(ae,i),n.guid||(n.guid=S.guid++),(l=m.events)||(l=m.events=Object.create(null)),(a=m.handle)||(a=m.handle=function(t){return void 0!==S&&S.event.triggered!==t.type?S.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(z)||[""]).length;u--;)f=g=(s=Se.exec(t[u])||[])[1],p=(s[2]||"").split(".").sort(),f&&(d=S.event.special[f]||{},f=(i?d.delegateType:d.bindType)||f,d=S.event.special[f]||{},c=S.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:p.join(".")},o),(h=l[f])||((h=l[f]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,p,a)||e.addEventListener&&e.addEventListener(f,a)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,c):h.push(c),S.event.global[f]=!0)},remove:function(e,t,n,r,i){var o,a,s,l,u,c,d,h,f,p,g,m=Z.hasData(e)&&Z.get(e);if(m&&(l=m.events)){for(u=(t=(t||"").match(z)||[""]).length;u--;)if(f=g=(s=Se.exec(t[u])||[])[1],p=(s[2]||"").split(".").sort(),f){for(d=S.event.special[f]||{},h=l[f=(r?d.delegateType:d.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=h.length;o--;)c=h[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));a&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,p,m.handle)||S.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)S.event.remove(e,f+t[u],n,r,!0);S.isEmptyObject(l)&&Z.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),l=S.event.fix(e),u=(Z.get(this,"events")||Object.create(null))[l.type]||[],c=S.event.special[l.type]||{};for(s[0]=l,t=1;t<arguments.length;t++)s[t]=arguments[t];if(l.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,l)){for(a=S.event.handlers.call(this,l,u),t=0;(i=a[t++])&&!l.isPropagationStopped();)for(l.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(l.result=r)&&(l.preventDefault(),l.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,r,i,o,a,s=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(o=[],a={},n=0;n<l;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?S(i,this).index(u)>-1:S.find(i,this,null,[u]).length),a[i]&&o.push(r);o.length&&s.push({elem:u,handlers:o})}return u=this,l<t.length&&s.push({elem:u,handlers:t.slice(l)}),s},addProp:function(e,t){Object.defineProperty(S.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return me.test(t.type)&&t.click&&D(t,"input")&&Me(t,"click",Te),!1},trigger:function(e){var t=this||e;return me.test(t.type)&&t.click&&D(t,"input")&&Me(t,"click"),!0},_default:function(e){var t=e.target;return me.test(t.type)&&t.click&&D(t,"input")&&Z.get(t,"click")||D(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Te:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Te,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Te,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Te,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},(function(e,t){S.event.special[e]={setup:function(){return Me(this,e,Ae),!1},trigger:function(){return Me(this,e),!0},_default:function(){return!0},delegateType:t}})),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){S.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||S.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),S.fn.extend({on:function(e,t,n,r){return Ne(this,e,t,n,r)},one:function(e,t,n,r){return Ne(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each((function(){S.event.remove(this,e,n,t)}))}});var De=/<script|<style|<link/i,Ce=/checked\s*(?:[^=]|=\s*.checked.)/i,Ie=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Le(e,t){return D(e,"table")&&D(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function je(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Oe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Be(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Z.hasData(e)&&(s=Z.get(e).events))for(i in Z.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);J.hasData(e)&&(o=J.access(e),a=S.extend({},o),J.set(t,a))}}function Pe(e,t){var n=t.nodeName.toLowerCase();"input"===n&&me.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function ze(e,t,n,r){t=l(t);var i,o,a,s,u,c,d=0,h=e.length,f=h-1,p=t[0],g=v(p);if(g||h>1&&"string"==typeof p&&!m.checkClone&&Ce.test(p))return e.each((function(i){var o=e.eq(i);g&&(t[0]=p.call(this,i,o.html())),ze(o,t,n,r)}));if(h&&(o=(i=Ee(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=o),o||r)){for(s=(a=S.map(_e(i,"script"),je)).length;d<h;d++)u=i,d!==f&&(u=S.clone(u,!0,!0),s&&S.merge(a,_e(u,"script"))),n.call(e[d],u,d);if(s)for(c=a[a.length-1].ownerDocument,S.map(a,Oe),d=0;d<s;d++)u=a[d],ye.test(u.type||"")&&!Z.access(u,"globalEval")&&S.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},c):x(u.textContent.replace(Ie,""),u,c))}return e}function Re(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(_e(r)),r.parentNode&&(n&&se(r)&&xe(_e(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),l=se(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=_e(s),r=0,i=(o=_e(e)).length;r<i;r++)Pe(o[r],a[r]);if(t)if(n)for(o=o||_e(e),a=a||_e(s),r=0,i=o.length;r<i;r++)Be(o[r],a[r]);else Be(e,s);return(a=_e(s,"script")).length>0&&xe(a,!l&&_e(e,"script")),s},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(X(n)){if(t=n[Z.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Z.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Re(this,e,!0)},remove:function(e){return Re(this,e)},text:function(e){return F(this,(function(e){return void 0===e?S.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return ze(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Le(this,e).appendChild(e)}))},prepend:function(){return ze(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Le(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return ze(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return ze(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(_e(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return S.clone(this,e,t)}))},html:function(e){return F(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!De.test(e)&&!be[(ve.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(_e(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return ze(this,arguments,(function(t){var n=this.parentNode;S.inArray(this,e)<0&&(S.cleanData(_e(this)),n&&n.replaceChild(t,this))}),e)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){S.fn[e]=function(e){for(var n,r=[],i=S(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),S(i[a])[t](n),u.apply(r,n.get());return this.pushStack(r)}}));var He=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),Ue=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=r),t.getComputedStyle(e)},Ve=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},qe=new RegExp(oe.join("|"),"i");function $e(e,t,n){var r,i,o,a,s=e.style;return(n=n||Ue(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||se(e)||(a=S.style(e,t)),!m.pixelBoxStyles()&&He.test(a)&&qe.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ae.appendChild(u).appendChild(c);var e=r.getComputedStyle(c);n="1%"!==e.top,l=12===t(e.marginLeft),c.style.right="60%",a=36===t(e.right),i=36===t(e.width),c.style.position="absolute",o=12===t(c.offsetWidth/3),ae.removeChild(u),c=null}}function t(e){return Math.round(parseFloat(e))}var n,i,o,a,s,l,u=b.createElement("div"),c=b.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===c.style.backgroundClip,S.extend(m,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,t,n,i;return null==s&&(e=b.createElement("table"),t=b.createElement("tr"),n=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",ae.appendChild(e).appendChild(t).appendChild(n),i=r.getComputedStyle(t),s=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===t.offsetHeight,ae.removeChild(e)),s}}))}();var Ye=["Webkit","Moz","ms"],We=b.createElement("div").style,Ke={};function Qe(e){return S.cssProps[e]||Ke[e]||(e in We?e:Ke[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ye.length;n--;)if((e=Ye[n]+t)in We)return e}(e)||e)}var Xe=/^(none|table(?!-c[ea]).+)/,Ge=/^--/,Ze={position:"absolute",visibility:"hidden",display:"block"},Je={letterSpacing:"0",fontWeight:"400"};function et(e,t,n){var r=ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function tt(e,t,n,r,i,o){var a="width"===t?1:0,s=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=S.css(e,n+oe[a],!0,i)),r?("content"===n&&(l-=S.css(e,"padding"+oe[a],!0,i)),"margin"!==n&&(l-=S.css(e,"border"+oe[a]+"Width",!0,i))):(l+=S.css(e,"padding"+oe[a],!0,i),"padding"!==n?l+=S.css(e,"border"+oe[a]+"Width",!0,i):s+=S.css(e,"border"+oe[a]+"Width",!0,i));return!r&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-s-.5))||0),l}function nt(e,t,n){var r=Ue(e),i=(!m.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=$e(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(He.test(a)){if(!n)return a;a="auto"}return(!m.boxSizingReliable()&&i||!m.reliableTrDimensions()&&D(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+tt(e,t,n||(i?"border":"content"),o,r,a)+"px"}function rt(e,t,n,r,i){return new rt.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=$e(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=Q(t),l=Ge.test(t),u=e.style;if(l||(t=Qe(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:u[t];"string"==(o=typeof n)&&(i=ie.exec(n))&&i[1]&&(n=ce(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(l?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var i,o,a,s=Q(t);return Ge.test(t)||(t=Qe(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=$e(e,t,r)),"normal"===i&&t in Je&&(i=Je[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],(function(e,t){S.cssHooks[t]={get:function(e,n,r){if(n)return!Xe.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?nt(e,t,r):Ve(e,Ze,(function(){return nt(e,t,r)}))},set:function(e,n,r){var i,o=Ue(e),a=!m.scrollboxSize()&&"absolute"===o.position,s=(a||r)&&"border-box"===S.css(e,"boxSizing",!1,o),l=r?tt(e,t,r,s,o):0;return s&&a&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-tt(e,t,"border",!1,o)-.5)),l&&(i=ie.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=S.css(e,t)),et(0,n,l)}}})),S.cssHooks.marginLeft=Fe(m.reliableMarginLeft,(function(e,t){if(t)return(parseFloat($e(e,"marginLeft"))||e.getBoundingClientRect().left-Ve(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),S.each({margin:"",padding:"",border:"Width"},(function(e,t){S.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+oe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(S.cssHooks[e+t].set=et)})),S.fn.extend({css:function(e,t){return F(this,(function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Ue(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)}),e,t,arguments.length>1)}}),S.Tween=rt,rt.prototype={constructor:rt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=rt.propHooks[this.prop];return e&&e.get?e.get(this):rt.propHooks._default.get(this)},run:function(e){var t,n=rt.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rt.propHooks._default.set(this),this}},rt.prototype.init.prototype=rt.prototype,rt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[Qe(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}},rt.propHooks.scrollTop=rt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=rt.prototype.init,S.fx.step={};var it,ot,at=/^(?:toggle|show|hide)$/,st=/queueHooks$/;function lt(){ot&&(!1===b.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(lt):r.setTimeout(lt,S.fx.interval),S.fx.tick())}function ut(){return r.setTimeout((function(){it=void 0})),it=Date.now()}function ct(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function dt(e,t,n){for(var r,i=(ht.tweeners[t]||[]).concat(ht.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ht(e,t,n){var r,i,o=0,a=ht.prefilters.length,s=S.Deferred().always((function(){delete l.elem})),l=function(){if(i)return!1;for(var t=it||ut(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),o=0,a=u.tweens.length;o<a;o++)u.tweens[o].run(r);return s.notifyWith(e,[u,r,n]),r<1&&a?n:(a||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:S.extend({},t),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},n),originalProperties:t,originalOptions:n,startTime:it||ut(),duration:n.duration,tweens:[],createTween:function(t,n){var r=S.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),c=u.props;for(function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=Q(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,u.opts.specialEasing);o<a;o++)if(r=ht.prefilters[o].call(u,e,c,u.opts))return v(r.stop)&&(S._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return S.map(c,dt,u),v(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),S.fx.timer(S.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u}S.Animation=S.extend(ht,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ce(n.elem,e,ie.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(z);for(var n,r=0,i=e.length;r<i;r++)n=e[r],ht.tweeners[n]=ht.tweeners[n]||[],ht.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,l,u,c,d="width"in t||"height"in t,h=this,f={},p=e.style,g=e.nodeType&&ue(e),m=Z.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,h.always((function(){h.always((function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()}))}))),t)if(i=t[r],at.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}f[r]=m&&m[r]||S.style(e,r)}if((l=!S.isEmptyObject(t))||!S.isEmptyObject(f))for(r in d&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(u=m&&m.display)&&(u=Z.get(e,"display")),"none"===(c=S.css(e,"display"))&&(u?c=u:(fe([e],!0),u=e.style.display||u,c=S.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===S.css(e,"float")&&(l||(h.done((function(){p.display=u})),null==u&&(c=p.display,u="none"===c?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",h.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=Z.access(e,"fxshow",{display:u}),o&&(m.hidden=!g),g&&fe([e],!0),h.done((function(){for(r in g||fe([e]),Z.remove(e,"fxshow"),f)S.style(e,r,f[r])}))),l=dt(g?m[r]:0,r,h),r in m||(m[r]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?ht.prefilters.unshift(e):ht.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ue).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=S.isEmptyObject(e),o=S.speed(t,n,r),a=function(){var t=ht(this,S.extend({},e),o);(i||Z.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",o=S.timers,a=Z.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&st.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||S.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=Z.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=S.timers,a=r?r.length:0;for(n.finish=!0,S.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),S.each(["toggle","show","hide"],(function(e,t){var n=S.fn[t];S.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ct(t,!0),e,r,i)}})),S.each({slideDown:ct("show"),slideUp:ct("hide"),slideToggle:ct("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){S.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(it=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),it=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){ot||(ot=!0,lt())},S.fx.stop=function(){ot=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(e,t){return e=S.fx&&S.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var i=r.setTimeout(t,e);n.stop=function(){r.clearTimeout(i)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var ft,pt=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return F(this,S.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){S.removeAttr(this,e)}))}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ft:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&D(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(z);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),ft={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=pt[t]||S.find.attr;pt[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=pt[a],pt[a]=i,i=null!=n(e,t,r)?a:null,pt[a]=o),i}}));var gt=/^(?:input|select|textarea|button)$/i,mt=/^(?:a|area)$/i;function vt(e){return(e.match(z)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function bt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(z)||[]}S.fn.extend({prop:function(e,t){return F(this,S.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[S.propFix[e]||e]}))}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):gt.test(e.nodeName)||mt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){S.propFix[this.toLowerCase()]=this})),S.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,l=0;if(v(e))return this.each((function(t){S(this).addClass(e.call(this,t,yt(this)))}));if((t=bt(e)).length)for(;n=this[l++];)if(i=yt(n),r=1===n.nodeType&&" "+vt(i)+" "){for(a=0;o=t[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,l=0;if(v(e))return this.each((function(t){S(this).removeClass(e.call(this,t,yt(this)))}));if(!arguments.length)return this.attr("class","");if((t=bt(e)).length)for(;n=this[l++];)if(i=yt(n),r=1===n.nodeType&&" "+vt(i)+" "){for(a=0;o=t[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):v(e)?this.each((function(n){S(this).toggleClass(e.call(this,n,yt(this),t),t)})):this.each((function(){var t,i,o,a;if(r)for(i=0,o=S(this),a=bt(e);t=a[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=yt(this))&&Z.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Z.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+vt(yt(n))+" ").indexOf(t)>-1)return!0;return!1}});var _t=/\r/g;S.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=v(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,S(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=S.map(i,(function(e){return null==e?"":e+""}))),(t=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=S.valHooks[i.type]||S.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(_t,""):null==n?"":n:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:vt(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],l=a?o+1:i.length;for(r=o<0?l:a?o:0;r<l;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!D(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=S.makeArray(t),a=i.length;a--;)((r=i[a]).selected=S.inArray(S.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],(function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=S.inArray(S(e).val(),t)>-1}},m.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),m.focusin="onfocusin"in r;var xt=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,i){var o,a,s,l,u,c,d,h,p=[n||b],g=f.call(e,"type")?e.type:e,m=f.call(e,"namespace")?e.namespace.split("."):[];if(a=h=s=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!xt.test(g+S.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),u=g.indexOf(":")<0&&"on"+g,(e=e[S.expando]?e:new S.Event(g,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),d=S.event.special[g]||{},i||!d.trigger||!1!==d.trigger.apply(n,t))){if(!i&&!d.noBubble&&!y(n)){for(l=d.delegateType||g,xt.test(l+g)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(n.ownerDocument||b)&&p.push(s.defaultView||s.parentWindow||r)}for(o=0;(a=p[o++])&&!e.isPropagationStopped();)h=a,e.type=o>1?l:d.bindType||g,(c=(Z.get(a,"events")||Object.create(null))[e.type]&&Z.get(a,"handle"))&&c.apply(a,t),(c=u&&a[u])&&c.apply&&X(a)&&(e.result=c.apply(a,t),!1===e.result&&e.preventDefault());return e.type=g,i||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(p.pop(),t)||!X(n)||u&&v(n[g])&&!y(n)&&((s=n[u])&&(n[u]=null),S.event.triggered=g,e.isPropagationStopped()&&h.addEventListener(g,wt),n[g](),e.isPropagationStopped()&&h.removeEventListener(g,wt),S.event.triggered=void 0,s&&(n[u]=s)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each((function(){S.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),m.focusin||S.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){S.event.simulate(t,e.target,S.event.fix(e))};S.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=Z.access(r,t);i||r.addEventListener(e,n,!0),Z.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=Z.access(r,t)-1;i?Z.access(r,t,i):(r.removeEventListener(e,n,!0),Z.remove(r,t))}}}));var Et=r.location,St={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var kt=/\[\]$/,At=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,Mt=/^(?:input|select|textarea|keygen)/i;function Dt(e,t,n,r){var i;if(Array.isArray(t))S.each(t,(function(t,i){n||kt.test(e)?r(e,i):Dt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==w(t))r(e,t);else for(i in t)Dt(e+"["+i+"]",t[i],n,r)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,(function(){i(this.name,this.value)}));else for(n in e)Dt(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&Mt.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!me.test(e))})).map((function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,(function(e){return{name:t.name,value:e.replace(At,"\r\n")}})):{name:t.name,value:n.replace(At,"\r\n")}})).get()}});var Ct=/%20/g,It=/#.*$/,Lt=/([?&])_=[^&]*/,jt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Bt=/^\/\//,Pt={},zt={},Rt="*/".concat("*"),Ht=b.createElement("a");function Ut(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(z)||[];if(v(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Vt(e,t,n,r){var i={},o=e===zt;function a(s){var l;return i[s]=!0,S.each(e[s]||[],(function(e,s){var u=s(t,n,r);return"string"!=typeof u||o||i[u]?o?!(l=u):void 0:(t.dataTypes.unshift(u),a(u),!1)})),l}return a(t.dataTypes[0])||!i["*"]&&a("*")}function qt(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Ht.href=Et.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?qt(qt(e,S.ajaxSettings),t):qt(S.ajaxSettings,e)},ajaxPrefilter:Ut(Pt),ajaxTransport:Ut(zt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,o,a,s,l,u,c,d,h,f=S.ajaxSetup({},t),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?S(p):S.event,m=S.Deferred(),v=S.Callbacks("once memory"),y=f.statusCode||{},_={},x={},w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(u){if(!a)for(a={};t=jt.exec(o);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?o:null},setRequestHeader:function(e,t){return null==u&&(e=x[e.toLowerCase()]=x[e.toLowerCase()]||e,_[e]=t),this},overrideMimeType:function(e){return null==u&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)E.always(e[E.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||w;return n&&n.abort(t),T(0,t),this}};if(m.promise(E),f.url=((e||f.url||Et.href)+"").replace(Bt,Et.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(z)||[""],null==f.crossDomain){l=b.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ht.protocol+"//"+Ht.host!=l.protocol+"//"+l.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=S.param(f.data,f.traditional)),Vt(Pt,f,t,E),u)return E;for(d in(c=S.event&&f.global)&&0==S.active++&&S.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ot.test(f.type),i=f.url.replace(It,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ct,"+")):(h=f.url.slice(i.length),f.data&&(f.processData||"string"==typeof f.data)&&(i+=(Tt.test(i)?"&":"?")+f.data,delete f.data),!1===f.cache&&(i=i.replace(Lt,"$1"),h=(Tt.test(i)?"&":"?")+"_="+St.guid+++h),f.url=i+h),f.ifModified&&(S.lastModified[i]&&E.setRequestHeader("If-Modified-Since",S.lastModified[i]),S.etag[i]&&E.setRequestHeader("If-None-Match",S.etag[i])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&E.setRequestHeader("Content-Type",f.contentType),E.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Rt+"; q=0.01":""):f.accepts["*"]),f.headers)E.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(!1===f.beforeSend.call(p,E,f)||u))return E.abort();if(w="abort",v.add(f.complete),E.done(f.success),E.fail(f.error),n=Vt(zt,f,t,E)){if(E.readyState=1,c&&g.trigger("ajaxSend",[E,f]),u)return E;f.async&&f.timeout>0&&(s=r.setTimeout((function(){E.abort("timeout")}),f.timeout));try{u=!1,n.send(_,T)}catch(e){if(u)throw e;T(-1,e)}}else T(-1,"No Transport");function T(e,t,a,l){var d,h,b,_,x,w=t;u||(u=!0,s&&r.clearTimeout(s),n=void 0,o=l||"",E.readyState=e>0?4:0,d=e>=200&&e<300||304===e,a&&(_=function(e,t,n){for(var r,i,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,E,a)),!d&&S.inArray("script",f.dataTypes)>-1&&S.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),_=function(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=u[l+" "+o]||u["* "+o]))for(i in u)if((s=i.split(" "))[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[i]:!0!==u[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(f,_,E,d),d?(f.ifModified&&((x=E.getResponseHeader("Last-Modified"))&&(S.lastModified[i]=x),(x=E.getResponseHeader("etag"))&&(S.etag[i]=x)),204===e||"HEAD"===f.type?w="nocontent":304===e?w="notmodified":(w=_.state,h=_.data,d=!(b=_.error))):(b=w,!e&&w||(w="error",e<0&&(e=0))),E.status=e,E.statusText=(t||w)+"",d?m.resolveWith(p,[h,w,E]):m.rejectWith(p,[E,w,b]),E.statusCode(y),y=void 0,c&&g.trigger(d?"ajaxSuccess":"ajaxError",[E,f,d?h:b]),v.fireWith(p,[E,w]),c&&(g.trigger("ajaxComplete",[E,f]),--S.active||S.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],(function(e,t){S[t]=function(e,n,r,i){return v(n)&&(i=i||r,r=n,n=void 0),S.ajax(S.extend({url:e,type:t,dataType:i,data:n,success:r},S.isPlainObject(e)&&e))}})),S.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return v(e)?this.each((function(t){S(this).wrapInner(e.call(this,t))})):this.each((function(){var t=S(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=v(e);return this.each((function(n){S(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){S(this).replaceWith(this.childNodes)})),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var $t={0:200,1223:204},Ft=S.ajaxSettings.xhr();m.cors=!!Ft&&"withCredentials"in Ft,m.ajax=Ft=!!Ft,S.ajaxTransport((function(e){var t,n;if(m.cors||Ft&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);t=function(e){return function(){t&&(t=n=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o($t[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),n=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=n:s.onreadystatechange=function(){4===s.readyState&&r.setTimeout((function(){t&&n()}))},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),S.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),S.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=S("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Yt,Wt=[],Kt=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Wt.pop()||S.expando+"_"+St.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",(function(e,t,n){var i,o,a,s=!1!==e.jsonp&&(Kt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Kt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Kt,"$1"+i):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||S.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=r[i],r[i]=function(){a=arguments},n.always((function(){void 0===o?S(r).removeProp(i):r[i]=o,e[i]&&(e.jsonpCallback=t.jsonpCallback,Wt.push(i)),a&&v(o)&&o(a[0]),a=o=void 0})),"script"})),m.createHTMLDocument=((Yt=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Yt.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((r=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(r)):t=b),o=!n&&[],(i=C.exec(e))?[t.createElement(i[1])]:(i=Ee([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=vt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)})).always(n&&function(e,t){a.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},S.expr.pseudos.animated=function(e){return S.grep(S.timers,(function(t){return e===t.elem})).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,l,u=S.css(e,"position"),c=S(e),d={};"static"===u&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),l=S.css(e,"left"),("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(l)||0),v(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+i),"using"in t?t.using.call(e,d):c.css(d)}},S.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){S.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===S.css(e,"position");)e=e.offsetParent;return e||ae}))}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;S.fn[e]=function(r){return F(this,(function(e,r,i){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i}),e,r,arguments.length)}})),S.each(["top","left"],(function(e,t){S.cssHooks[t]=Fe(m.pixelPosition,(function(e,n){if(n)return n=$e(e,t),He.test(n)?S(e).position()[t]+"px":n}))})),S.each({Height:"height",Width:"width"},(function(e,t){S.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){S.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return F(this,(function(t,n,i){var o;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?S.css(t,n,s):S.style(t,n,i,s)}),t,a?i:void 0,a)}}))})),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){S.fn[t]=function(e){return this.on(t,e)}})),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){S.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Qt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=s.call(arguments,2),i=function(){return e.apply(t||this,r.concat(s.call(arguments)))},i.guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=D,S.isFunction=v,S.isWindow=y,S.camelCase=Q,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Qt,"")},void 0===(n=function(){return S}.apply(t,[]))||(e.exports=n);var Xt=r.jQuery,Gt=r.$;return S.noConflict=function(e){return r.$===S&&(r.$=Gt),e&&r.jQuery===S&&(r.jQuery=Xt),S},void 0===i&&(r.jQuery=r.$=S),S}))},846:e=>{e.exports=function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return i(t[a][1][e]||e)}),u,u.exports,e,t,n,r)}return n[a].exports}for(var o=void 0,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}(e)},t.exports=n.default},{}]},{},[1])(1)},681:(e,t,n)=>{"use strict";function r(e,t){return Array(t+1).join(e)}function i(e){return"number"==typeof e}function o(e,t){return Math.pow(2,(e-69)/12)*(t||440)}n.r(t),n.d(t,{regex:()=>s,parse:()=>u,build:()=>c,midi:()=>d,freq:()=>h,letter:()=>f,acc:()=>p,pc:()=>g,step:()=>m,alt:()=>v,chroma:()=>y,oct:()=>b});var a=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function s(){return a}var l=[0,2,4,5,7,9,11];function u(e,t,n){if("string"!=typeof e)return null;var r=a.exec(e);if(!r||!t&&r[4])return null;var i={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};i.pc=i.letter+i.acc,i.step=(i.letter.charCodeAt(0)+3)%7,i.alt="b"===i.acc[0]?-i.acc.length:i.acc.length;var s=l[i.step]+i.alt;return i.chroma=s<0?12+s:s%12,r[3]&&(i.oct=+r[3],i.midi=s+12*(i.oct+1),i.freq=o(i.midi,n)),t&&(i.tonicOf=r[4]),i}function c(e,t,n){return null==e?null:e.step?c(e.step,e.alt,e.oct):e<0||e>6?null:"CDEFGAB".charAt(e)+(i(o=t)?o<0?r("b",-o):r("#",o):"")+function(e){return i(e)?""+e:""}(n);var o}function d(e){if((i(e)||"string"==typeof e)&&e>=0&&e<128)return+e;var t=u(e);return t&&function(e){return void 0!==e}(t.midi)?t.midi:null}function h(e,t){var n=d(e);return null===n?null:o(n,t)}function f(e){return(u(e)||{}).letter}function p(e){return(u(e)||{}).acc}function g(e){return(u(e)||{}).pc}function m(e){return(u(e)||{}).step}function v(e){return(u(e)||{}).alt}function y(e){return(u(e)||{}).chroma}function b(e){return(u(e)||{}).oct}},986:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){(function(t){e.exports=function(e,n){var r,i,o,a,s,l,u,c=t.window,d=c.document,h=d.documentElement,f=d.querySelector("body"),p=e.getContext("2d"),g=function(e){return"rgba(0,0,0,".concat(e/100,")")},m=Object.assign({viewport:null,styles:{"header,footer,section,article":g(8),"h1,a":g(10),"h2,h3,h4":g(8)},back:g(2),view:g(5),drag:g(10),interval:null},n),v=function(e,t,n,r){return n.split(/\s+/).forEach((function(n){return e[t](n,r)}))},y=function(e,t,n){return v(e,"addEventListener",t,n)},b=function(e,t,n){return v(e,"removeEventListener",t,n)},_=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return _(e.x-t.x,e.y-t.y,e.w,e.h)},w=function(e){var t=e.getBoundingClientRect();return{x:t.left+c.pageXOffset,y:t.top+c.pageYOffset}},E=function(e){var t=w(e),n=t.x,r=t.y;return _(n+e.clientLeft,r+e.clientTop,e.clientWidth,e.clientHeight)},S=(r=e.clientWidth,i=e.clientHeight,function(e,t){return Math.min(r/e,i/t)}),T=m.viewport,k=!1,A=function(e,t){t&&(p.beginPath(),p.rect(e.x,e.y,e.w,e.h),p.fillStyle=t,p.fill())},N=function(){var t,n,r,i,l,u,f;o=T?(l=w(i=T),u=l.x,f=l.y,_(u+i.clientLeft-i.scrollLeft,f+i.clientTop-i.scrollTop,i.scrollWidth,i.scrollHeight)):_(0,0,h.scrollWidth,h.scrollHeight),a=T?E(T):_(c.pageXOffset,c.pageYOffset,h.clientWidth,h.clientHeight),s=S(o.w,o.h),t=o.w*s,n=o.h*s,e.width=t,e.height=n,e.style.width="".concat(t,"px"),e.style.height="".concat(n,"px"),p.setTransform(1,0,0,1,0,0),p.clearRect(0,0,e.width,e.height),p.scale(s,s),A(x(o,o),m.back),r=m.styles,Object.keys(r).forEach((function(e){var t=r[e];(function(e){return Array.from((T||d).querySelectorAll(e))})(e).forEach((function(e){A(x(function(e){var t=w(e),n=t.x,r=t.y;return _(n,r,e.offsetWidth,e.offsetHeight)}(e),o),t)}))})),A(x(a,o),k?m.drag:m.view)},M=function(t){t.preventDefault();var n=E(e),r=(t.pageX-n.x)/s-a.w*l,i=(t.pageY-n.y)/s-a.h*u;T?(T.scrollLeft=r,T.scrollTop=i):c.scrollTo(r,i),N()},D=function t(n){k=!1,e.style.cursor="pointer",f.style.cursor="auto",b(c,"mousemove",M),b(c,"mouseup",t),M(n)};return e.style.cursor="pointer",y(e,"mousedown",(function(t){k=!0;var n=E(e),r=x(a,o);l=((t.pageX-n.x)/s-r.x)/r.w,u=((t.pageY-n.y)/s-r.y)/r.h,(l<0||l>1||u<0||u>1)&&(l=.5,u=.5),e.style.cursor="crosshair",f.style.cursor="crosshair",y(c,"mousemove",M),y(c,"mouseup",D),M(t)})),y(T||c,"load resize scroll",N),m.interval>0&&setInterval((function(){return N()}),m.interval),N(),{redraw:N}}}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}])},e.exports=t()},316:e=>{function t(e,t){return function(n,r,i,o){e(n,r,i,o),t(n,r,i,o)}}e.exports=function(e){return e.on=function(n,r){if(1===arguments.length&&"function"==typeof n)return e.on("event",n);var i="on"+n,o=e[i];return e[i]=o?t(o,r):r,e},e}},272:(e,t,n)=>{"use strict";var r=n(451),i=n(316),o=n(861),a=n(41),s=n(549);function l(e,t,n){return s(a(o(i(r(e,t,n)))))}e.exports&&(e.exports=l),"undefined"!=typeof window&&(window.SamplePlayer=l)},549:(e,t,n)=>{var r=n(846);e.exports=function(e){return e.listenToMidi=function(t,n){var i={},o=n||{},a=o.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:r(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!o.channel||n.channel===o.channel)switch(n.messageType){case"noteon":i[n.key]=e.play(n.key,0,{gain:a(n.velocity)});break;case"noteoff":i[n.key]&&(i[n.key].stop(),delete i[n.key])}},e},e}},861:(e,t,n)=>{"use strict";var r=n(46),i=function(e){return function(e){return null!==e&&e!==[]&&e>=0&&e<129}(e)?+e:r.midi(e)};e.exports=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:i,r=function(e){return e?n(e)||e:null};e.buffers=function(e,t){return Object.keys(e).reduce((function(n,r){return n[t(r)]=e[r],n}),{})}(e.buffers,r);var o=e.start;e.start=function(e,t,n){var i=r(e),a=i%1;return a&&(i=Math.floor(i),n=Object.assign(n||{},{cents:Math.floor(100*a)})),o(i,t,n)}}return e}},451:(e,t,n)=>{"use strict";var r=n(729),i={},o={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function a(e){return"number"==typeof e}var s=["attack","decay","sustain","release"];e.exports=function(e,t,n){var l=!1,u=0,c={},d=e.createGain();d.gain.value=1;var h=Object.assign({},o,n),f={context:e,out:d,opts:h};return t instanceof AudioBuffer?f.buffer=t:f.buffers=t,f.start=function(t,n,r){if(f.buffer&&null!==t)return f.start(null,t,n);var o=t?f.buffers[t]:f.buffer;if(o){if(l){var a=r||i;n=Math.max(e.currentTime,n||0),f.emit("start",n,t,a);var s=p(t,o,a);return s.id=function(t,n){return n.id=u++,c[n.id]=n,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),f.emit("ended",t,n.id,n)},n.id}(0,s),s.env.start(n),s.source.start(n),f.emit("started",n,s.id,s),a.duration&&s.stop(n+a.duration),s}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},f.play=function(e,t,n){return f.start(e,t,n)},f.stop=function(e,t){var n;return(t=t||Object.keys(c)).map((function(t){return(n=c[t])?(n.stop(e),n.id):null}))},f.connect=function(e){return l=!0,d.connect(e),f},f.emit=function(e,t,n,r){f.onevent&&f.onevent(e,t,n,r);var i=f["on"+e];i&&i(t,n,r)},f;function p(t,n,i){var o,l=e.createGain();return l.gain.value=0,l.connect(d),l.env=function(e,t,n){var i=r(e),o=t.adsr||n.adsr;return s.forEach((function(e,r){i[e]=o?o[r]:t[e]||n[e]})),i.value.value=a(t.gain)?t.gain:a(n.gain)?n.gain:1,i}(e,i,h),l.env.connect(l.gain),l.source=e.createBufferSource(),l.source.buffer=n,l.source.connect(l),l.source.loop=i.loop||h.loop,l.source.playbackRate.value=(o=i.cents||h.cents)?Math.pow(2,o/1200):1,l.source.loopStart=i.loopStart||h.loopStart,l.source.loopEnd=i.loopEnd||h.loopEnd,l.stop=function(n){var r=n||e.currentTime;f.emit("stop",r,t);var i=l.env.stop(r);l.source.stop(i)},l}}},41:e=>{"use strict";var t=Array.isArray,n={};e.exports=function(e){return e.schedule=function(r,i){var o,a,s,l,u=e.context.currentTime,c=r<u?u:r;return e.emit("schedule",c,i),i.map((function(r){return r?(t(r)?(o=r[0],a=r[1]):(o=r.time,a=r),function(e){return e&&"object"==typeof e}(a)?(s=a.name||a.key||a.note||a.midi||null,l=a):(s=a,l=n),e.start(s,c+(o||0),l)):null}))},e}},46:e=>{"use strict";var t=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,n=[0,2,4,5,7,9,11];function r(e,r,o){if("string"!=typeof e)return null;var a=t.exec(e);if(!a||!r&&a[4])return null;var s={letter:a[1].toUpperCase(),acc:a[2].replace(/x/g,"##")};return s.pc=s.letter+s.acc,s.step=(s.letter.charCodeAt(0)+3)%7,s.alt="b"===s.acc[0]?-s.acc.length:s.acc.length,s.chroma=n[s.step]+s.alt,a[3]&&(s.oct=+a[3],s.midi=s.chroma+12*(s.oct+1),s.freq=i(s.midi,o)),r&&(s.tonicOf=a[4]),s}function i(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var o={parse:r,regex:function(){return t},midiToFreq:i};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(e){o[e]=function(t){var n=r(t);return n&&void 0!==n[e]?n[e]:null}})),e.exports=o},346:(e,t,n)=>{"use strict";var r=n(665),i=n(272);function o(e){return/\.js(\?.*)?$/i.test(e)}function a(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}var s=n(975);s.instrument=function e(t,n,s){if(1===arguments.length)return function(n,r){return e(t,n,r)};var l=s||{},u=l.isSoundfontURL||o,c=l.nameToUrl||a,d=u(n)?n:c(n,l.soundfont,l.format);return r(t,d,{only:l.only||l.notes}).then((function(e){var r=i(t,e,l).connect(l.destination?l.destination:t.destination);return r.url=d,r.name=n,r}))},s.nameToUrl=a,e.exports&&(e.exports=s),"undefined"!=typeof window&&(window.Soundfont=s)},975:(e,t,n)=>{"use strict";var r=n(681);function i(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof i))return new i(e);this.nameToUrl=t||i.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function o(e,t){return t=t||{},function(n,i,o,a){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var s=n>0&&n<129?+n:r.midi(n),l=s?r.midiToFreq(s,440):null;if(l){o=o||.2;var u=(a=a||{}).destination||t.destination||e.destination,c=a.vcoType||t.vcoType||"sine",d=a.gain||t.gain||.4,h=e.createOscillator();h.type=c,h.frequency.value=l;var f=e.createGain();return f.gain.value=d,h.connect(f),f.connect(u),h.start(i),o>0&&h.stop(i+o),h}}}i.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},i.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var r={name:e,play:o(n,t)};if(this.instruments[e]=r,"default"!==e){var a=i.instrument(n,e,t).then((function(e){return r.play=e.play,r}));this.promises.push(a),r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),a.then(e)}}else r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return r},i.loadBuffers=function(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),i.instrument(e,t,n).then((function(e){return e.buffers}))},i.noteToMidi=r.midi,e.exports=i}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(974)})();
//# sourceMappingURL=app.js.map?id=b7b4d431b2c900f99cd4